if (self.CavalryLogger) { CavalryLogger.start_js(["yCbcy"]); }

__d("TrendingLongViewLogger",["Banzai"],(function(a,b,c,d,e,f){function g(a,c){setTimeout(function(){document.location.pathname===a.pathname&&(a.duration=c,b("Banzai").post("trending_long_view",a,{delay:2e3}))},c)}a={init:function(a,b){for(var c=0;c<b.length;++c)g(a,b[c])}};e.exports=a}),null);
__d("SearchFiltersPageLoader",["XUISubNavigation"],(function(a,b,c,d,e,f){"use strict";a={onPageTransition:function(){b("XUISubNavigation").skipNextTransition()}};e.exports=a}),null);
__d("BrowseLinkType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({RESULT_PERMALINK:"result_permalink",MODULE_ENDPOINT:"module_endpoint",EXPAND_INLINE:"expand_inline",MODAL:"modal"})}),null);
__d("XAsyncSearchInlineExpandStoryController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/search/async/expand_story/",{story_token:{type:"String"},has_snippet:{type:"Bool",defaultValue:!1},unicorn_story_id:{type:"String"},browse_location:{type:"String",defaultValue:"browse_location:browse"},expand_comments:{type:"Bool",defaultValue:!1}})}),null);
__d("XAsyncSearchStoryModalViewController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/search/async/story_modal/",{browse_location:{type:"String",defaultValue:"browse_location:browse"},story_token:{type:"String",required:!0},unicorn_story_id:{type:"String",required:!0},link_type:{type:"String",defaultValue:"modal"},expand_comments:{type:"Bool",defaultValue:!1}})}),null);
__d("DenseStoryInlineExpansion",["csx","cx","AsyncRequest","BanzaiODS","Bootloader","BrowseLinkType","CSS","DOM","Event","Parent","XAsyncSearchInlineExpandStoryController","XAsyncSearchStoryModalViewController","tidyEvent"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a={addListenerForClick:function(a,c){var d=!1;b("tidyEvent")(b("Event").listen(a,"click",function(event){var a=event.target;if(d&&!this.isModal(c)||this.isClickToNewWindow(event)||a instanceof HTMLElement&&this.isClickOnHeaderEntity(a))return;d=!0;event.preventDefault();event.stopPropagation();this.isModal(c)?this.handleModalClick(c,event):this.handleInlineExpansionClick(c,event)}.bind(this)))},handleModalClick:function(a,event){var c=event.target,d=this.shouldExpandComments(c);b("Bootloader").loadModules(["AsyncDialog"],function(c){var e=b("XAsyncSearchStoryModalViewController").getURIBuilder().setString("story_token",a.storyToken).setString("unicorn_story_id",a.unicornStoryID).setString("browse_location",a.browseLocation).setBool("expand_comments",d).getURI();c.send(new(b("AsyncRequest"))(e))},"DenseStoryInlineExpansion")},handleInlineExpansionClick:function(a,event){var c=a.snippetElem,d=c!=null,e=event.target;e=this.shouldExpandComments(e);b("DOM").replace(a.storyElem,a.placeholderElem);d=b("XAsyncSearchInlineExpandStoryController").getURIBuilder().setString("story_token",a.storyToken).setBool("has_snippet",d).setString("unicorn_story_id",a.unicornStoryID).setString("browse_location",a.browseLocation).setBool("expand_comments",e).getURI();b("BanzaiODS").bumpEntityKey("search_story_expansion","render_attempt");new(b("AsyncRequest"))().setURI(d).setHandler(function(d){b("DOM").replace(a.placeholderElem,d.payload),c!=null&&b("CSS").addClass(c,"_1nlc")}).setErrorHandler(function(a){b("BanzaiODS").bumpEntityKey("search_story_expansion","render_failure")}).send()},isModal:function(a){return a.linkType===b("BrowseLinkType").MODAL},shouldExpandComments:function(a){if(!(a instanceof HTMLElement))return!1;a=b("Parent").bySelector(a,"._-56");return a!=null},isClickOnHeaderEntity:function(a){a=b("Parent").bySelector(a,"._vwp")||b("Parent").byClass(a,"profileLink");return a!=null},isClickToNewWindow:function(event){return event.ctrlKey||event.metaKey}};e.exports=a}),null);