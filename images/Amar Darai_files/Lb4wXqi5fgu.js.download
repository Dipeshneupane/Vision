if (self.CavalryLogger) { CavalryLogger.start_js(["m22Cp"]); }

__d("FrameEditorSupportedGeneratedText",[],(function(a,b,c,d,e,f){e.exports={"%City_Name%":"City name","%CITY_NAME%":"City name (all caps)"}}),null);
__d("FXMediaEffectProduct",[],(function(a,b,c,d,e,f){e.exports={AML_CAMERA:"aml_camera",BIRTHDAY_CAMERA:"birthday_camera",BONFIRE:"bonfire",FACEBOOK:"facebook",FLASH:"flash",FLASH_ALDRIN:"flash_aldrin",INSTAGRAM:"instagram",MESSENGER:"messenger",MSQRD:"msqrd",TALK:"talk",ALOHA_APP:"aloha",AVATAR_EDITOR:"avatar",MOBILE_ID_CAPTURE:"mobile_id_capture"}}),null);
__d("FXProductVisibilityPolicyTypeLabels",[],(function(a,b,c,d,e,f){e.exports={ALL_PRODUCTS:"All products",OWNING_PRODUCT_ONLY:"Owning product only",SPECIFIC_PRODUCTS:"Specific products",ALL_EXCEPT_PRODUCTS:"All products except specific products",ANY_FACEBOOK_UNIVERSE:"Only Facebook-universe products"}}),null);
__d("MediaEffectCaptureModeLabels",[],(function(a,b,c,d,e,f){e.exports={PRECAPTURE_PHOTO:"Precapture Photo",POSTCAPTURE_PHOTO:"Postcapture Photo",PRECAPTURE_VIDEO:"Precapture Video",POSTCAPTURE_VIDEO:"Postcapture Video",LIVE:"Live",CARDS:"Cards",DIRECT:"Direct"}}),null);
__d("OzConstants",[],(function(a,b,c,d,e,f){e.exports={AUTHOR_TYPES:{BOT:"bot",TRAINER:"trainer",USER:"user"},ATTS:{COMMAND:"@COMMAND",IMAGE:"image",SUGG:"@SUGG",TEMPLATE:"template",SURVEY:"survey",QUICK_REPLIES:"@QUICK_REPLIES",OPENTABLEQR:"opentableQuickReply"},SESSION_INFO_EVENT:"iframenonce_fb_session_info",TOKENS:{USER_FIRST_NAME:"user-first-name"},REMINDERS:{RANGE_IN_YEARS:5},M_FBIDS:{M:"881263441913087",M_DEV:"1579802578966277",P:"506060876211905"}}}),null);
__d("AdsTargetingLocationMapMetaRecord",["cx","AdsCommonLocalMapUtils","AdsTargetingLocationUtils","GeoCoordinates","immutable","LeafletUtils","LocationConstants","leaflet","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i={},j=new Map(),k=350,l=Object.freeze({NONE:0,SHIFT_LEFT:-1,SHIFT_RIGHT:1});a=babelHelpers.inherits(m,b("immutable").Record({center:null,circleCenter:null,coordinateLists:null,geoLocation:null,icon:null,meta:null,name:null,popup:null,radius:0}));h=a&&a.prototype;function m(a){h.constructor.call(this,a)}m.prototype.hashCode=function(){var a=b("AdsTargetingLocationUtils").getUniqueKey(this.geoLocation);j.has(a)||j.set(a,b("AdsTargetingLocationUtils").getHashCode(this.geoLocation));return b("nullthrows")(j.get(a))};m.fromGeoLocations=function(a,c){var d=[];b("LocationConstants").locationTypes.forEach(function(b){(a[b]||[]).forEach(function(a){if(a.latitude==null||a.longitude==null)return;d.push(this.fromGeoLocationCached(a,c(a)))}.bind(this))}.bind(this));return b("immutable").Set(d)};m.fromGeoLocationCached=function(a,c){var d=b("AdsTargetingLocationUtils").getUniqueKey(a);i[d]||(i[d]=this.fromGeoLocation(a,c));return i[d]};m.fromGeoLocation=function(a,c){var d=[],e=0,f=new(b("GeoCoordinates"))(Number(a.latitude),Number(a.longitude));a.polygons&&a.polygons.length&&(d=this.generatePolygonLists(a.polygons));a.radius&&a.distance_unit&&(e=b("AdsTargetingLocationUtils").getRadiusInMeters(a.radius,a.distance_unit));return new m({center:f,coordinateLists:b("immutable").List(d),geoLocation:a,icon:null,meta:c,name:a.name,popup:null,radius:e})};m.generatePolygonLists=function(a){__p&&__p();var c=b("leaflet").latLngBounds(a),d=l.NONE;if(c.getEast()-c.getWest()>k){var e=this.boundsForShiftedMultipolygons(a,l.SHIFT_LEFT),f=this.boundsForShiftedMultipolygons(a,l.SHIFT_RIGHT);c=Math.abs(c.getEast()-c.getWest());var g=Math.abs(e.getEast()-e.getWest()),h=Math.abs(f.getEast()-f.getWest());(g<=c||h<=c)&&(Math.abs(e.getCenter().lng)<=Math.abs(f.getCenter().lng)?d=l.SHIFT_LEFT:d=l.SHIFT_RIGHT)}var i=[];a.forEach(function(a){var c=[];a.forEach(function(a){c.push(new(b("GeoCoordinates"))(Number(a.lat),this.shiftLongitude(b("LeafletUtils").wrapLongitude(Number(a.lng)),d)))}.bind(this));i.push(b("immutable").List(c))}.bind(this));return i};m.shiftLongitude=function(a,b){b===l.SHIFT_LEFT?a=a<0?a:a-360:b===l.SHIFT_RIGHT&&(a=a>0?a:a+360);return a};m.boundsForShiftedMultipolygons=function(a,c){var d=[];a.forEach(function(a){var e=[];a.forEach(function(a){e.push(b("LeafletUtils").toLatLng(new(b("GeoCoordinates"))(Number(a.lat),this.shiftLongitude(b("LeafletUtils").wrapLongitude(Number(a.lng)),c))))}.bind(this));d.push(e)}.bind(this));return b("leaflet").latLngBounds(d)};m.iconForSingleLocationSelected=function(){return b("leaflet").divIcon(babelHelpers["extends"]({},b("AdsCommonLocalMapUtils").LEAFLET_MARKER_LOCATION_PIN_ICON_SELECTED_OPTIONS,{className:"_tl9"}))};m.iconForSingleLocationNotSelected=function(){return b("leaflet").divIcon(babelHelpers["extends"]({},b("AdsCommonLocalMapUtils").LEAFLET_MARKER_LOCATION_PIN_ICON_NOT_SELECTED_OPTIONS,{className:"_tla"}))};e.exports=m}),null);
__d("AdsTargetingLocationClusterRecord",["cx","fbt","invariant","AdsTargetingLocationMapMetaRecord","GeoCoordinates","immutable","LegacyMapCoordinate","LocationConstants","MapRects","Rect","leaflet"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;a=b("LocationConstants").Aggregation;var k=a.AGGREGATION_RADIUS,l=a.LARGE_CLUSTER_THRESHOLD,m=a.MEDIUM_CLUSTER_THRESHOLD,n=a.SMALL_CLUSTER_THRESHOLD;j=babelHelpers.inherits(o,b("immutable").Record({center:null,members:b("immutable").Set(),radius:0,rect:null}));j&&j.prototype;o.fromSingleRecord=function(a,c){c=this.calculateAbsoluteCenter(a.geoLocation.latitude,a.geoLocation.longitude,c);return new o({center:c,members:b("immutable").Set.of(a),radius:k,rect:new(b("Rect"))(c.y,c.x,c.y,c.x)})};o.toSingleRecordWithOptions=function(a,c,d,e,f){__p&&__p();if(d||a.members.size>1){d=b("LegacyMapCoordinate").fromMap(a.center.x,a.center.y,c);c=new(b("GeoCoordinates"))(d.getLatitude(),d.getLongitude());d=f(a);f=0;var g={center:c,key:this.keyFromKeys(a.members.map(this.memberToKey).toArray()),name:d,radius:f,type:b("LocationConstants").CUSTOM_LOCATIONS};e=this.iconForCluster(e(a));var h=a.members.map(function(a){return a.meta});return new(b("AdsTargetingLocationMapMetaRecord"))({center:c,coordinateLists:null,geoLocation:g,icon:e,meta:h,name:d,popup:null,radius:f})}return a.members.first()};o.countFromCluster=function(a){return a.members.size};o.nameFromCluster=function(a){return h._("{count} Locations",[h._param("count",a.members.size)])};o.toSingleRecord=function(a,b){return this.toSingleRecordWithOptions(a,b,!1,this.countFromCluster,this.nameFromCluster)};o.memberToKey=function(a){return a.geoLocation.key};o.keyFromKeys=function(a){return a.join("-")};o.keysFromKey=function(a){return a.split("-")};o.iconForCluster=function(a){var c=[0,18],d="_n9c",e=o.markerIconSizeForCluster(a);e=[e,e];return b("leaflet").divIcon({className:d,html:a,iconSize:e,popupAnchor:c})};o.markerIconSizeForCluster=function(a){if(a==null||a<n)return 24;else if(a<m)return 36;else if(a<l)return 48;else return 60};o.markerRadiusForCluster=function(a){if(a==null||a<=1)return 100;else if(a<n)return 1e4;else if(a<m)return 4e4;else if(a<l)return 7e4;else return 1e5};o.calculateAbsoluteCenter=function(a,c,d){return b("LegacyMapCoordinate").fromLatLong(a,c).getMapXY(d)};o.combine=function(a,c){a.asMutable()===a||i(0),a.rect=b("MapRects").boundingBox(a.rect,c.rect),a.radius=Math.max(a.radius,c.radius),a.center=a.rect.getCenter(),a.members=a.members.union(c.members)};function o(){j.apply(this,arguments)}e.exports=o}),null);
__d("AdsTargetingAggregatedMapUtils",["AdsTargetingLocationClusterRecord","immutable","MapAggregation"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d,e){var f=a.map(function(a){return b("AdsTargetingLocationClusterRecord").fromSingleRecord(a,c).asMutable()}).toArray(),g=new(b("MapAggregation"))().aggregate(f,b("AdsTargetingLocationClusterRecord").combine);f=g.map(function(f){return b("AdsTargetingLocationClusterRecord").toSingleRecordWithOptions(f,c,a.size!==g.length,d||b("AdsTargetingLocationClusterRecord").countFromCluster,e||b("AdsTargetingLocationClusterRecord").nameFromCluster)});return b("immutable").Set(f)}function c(a){return b("immutable").Set(b("AdsTargetingLocationClusterRecord").keysFromKey(a))}d={aggregateMapRecords:a,extractRecordKey:b("AdsTargetingLocationClusterRecord").memberToKey,splitClusterKey:c};e.exports=d}),null);
__d("AdsTargetingLocationInlineMapUtils",["GeoCoordinates","LeafletUtils","LeafletView","LocationConstants","leaflet"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=1e4;function h(a){__p&&__p();var c=void 0;a.forEach(function(a){__p&&__p();var d=void 0;if(a.center&&a.radius){var e=a.center,f=a.radius;d=b("LeafletUtils").circleBounds(b("LeafletUtils").toLatLng(e),f)}else a.coordinateLists&&a.coordinateLists.size?a.coordinateLists.forEach(function(a){a=a.map(function(a){return b("LeafletUtils").toLatLng(new(b("GeoCoordinates"))(a.latitude,a.longitude))}).toArray();a=b("leaflet").latLngBounds(a);d=undefined===d?a:d.extend(a)}):a.center&&(d=b("LeafletUtils").circleBounds(b("LeafletUtils").toLatLng(a.center),g));undefined===c?c=d:c.extend(d)});return c}function a(a,c){c=h(c);return!c?a:a.setCenter(b("LeafletUtils").fromLatLng(c.getCenter()))}function c(a,c){return new(b("LeafletView"))({center:a.center,zoom:b("LocationConstants").getNextZoomRangeStart(c)})}function d(a){return a.type===b("LocationConstants").CUSTOM_LOCATIONS&&a.custom_type===b("LocationConstants").CUSTOM_TYPE_MULTI_CITY}f={centerToLocations:a,getAllBounds:h,isLocationForMultiCity:d,zoomToNextRange:c};e.exports=f}),null);
__d("AdsTargetingLocationMapPopup",["cx","FbtResultBase","React","isEmpty","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.state={showingPopoverMenu:!1},this.$1=function(){var a=b("isEmpty")(this.props.menuItems);return b("React").createElement("div",null,b("React").createElement("div",{className:(a?"_2e-k":"")+(a?"":" _37vz")},this.props.label),a?null:this.$2())}.bind(this),this.$5=function(a){return!!(this.props.menuItemsDisabled&&this.props.menuItemsDisabled[a])}.bind(this),this.$3=function(){this.setState({showingPopoverMenu:!this.state.showingPopoverMenu})}.bind(this),this.$6=function(a){this.setState({showingPopoverMenu:!1}),this.props.onMenuItemSelect(a,this.props.location)}.bind(this),c}a.prototype.render=function(){return b("React").createElement("div",{className:"_37vy"},this.$1())};a.prototype.$2=function(){var a="_37v-";return b("React").createElement("div",{className:"_37v_"},b("React").createElement("button",{className:a,type:"button",value:"locationpopoverbutton",onClick:this.$3},this.props.children),this.$4())};a.prototype.$4=function(){if(!this.state.showingPopoverMenu)return null;var a=b("nullthrows")(this.props.menuItems),c="_37w0",d=Object.keys(a).map(function(d){var e=this.$6.bind(this,d),f=a[d],g=this.$5(d);return b("React").createElement("button",{className:c,disabled:g,key:d,value:"locationpopoveritem",onClick:e},f)}.bind(this));return b("React").createElement("div",{className:"_37w1"},d)};a.propTypes={label:c.oneOfType([c.string,c.instanceOf(b("FbtResultBase"))]).isRequired,location:c.object.isRequired,menuItems:c.object,menuItemsDisabled:c.object,onMenuItemSelect:c.func.isRequired};e.exports=a}),null);
__d("AdsTargetingLocationTypeAliases",["keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirror")({DEFAULT:null,INVOKE_CALLBACK_ON_SINGLE_NODE:null,NONE:null,SHOW_POPUP:null,ZOOM_TO_MARKER:null,ZOOM_TO_NEXT_RANGE:null});c={CLICK_BEHAVIORS:a};e.exports=c}),null);
__d("AdsTargetingLocationInlineMap.react",["cx","fbt","ix","AdsCommonLocalMapUtils","AdsInterfacesLogger","AdsInterfacesLoggerConfigColumns","AdsTargetingLocationLoggingEvents","AdsTargetingLocationMapPopup","BanzaiODS","FBLogger","FBOverlayElement.react","FBTilesMap.react","FBTilesMapZoomOverlay.react","GeoCoordinates","Image.react","immutable","LeafletCircle.react","LeafletCircleMarker.react","LeafletMarker.react","LeafletMultiPolygon.react","LeafletPopup.react","LeafletUtils","LeafletView","LocationConstants","React","SUIBusinessTheme","SUIButton.react","TilesMapConfig","XUIButton.react","areEqual","emptyFunction","leaflet","performanceNow","AdsTargetingLocationInlineMapUtils","AdsTargetingLocationTypeAliases"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=b("React").PropTypes;var k=b("AdsTargetingLocationInlineMapUtils").centerToLocations,l=b("AdsTargetingLocationInlineMapUtils").getAllBounds,m=b("AdsTargetingLocationInlineMapUtils").isLocationForMultiCity,n=b("AdsTargetingLocationInlineMapUtils").zoomToNextRange,o=b("AdsTargetingLocationTypeAliases").CLICK_BEHAVIORS,p=new(b("LeafletView"))({center:new(b("GeoCoordinates"))(0,0),zoom:1}),q=1,r=2,s=b("React").createElement(b("Image.react"),{src:i("22149"),width:"12"}),t=b("React").createElement(b("Image.react"),{src:i("22118"),width:"16"}),u={INCLUDE:h._("Include"),EXCLUDE:h._("Exclude"),DELETE:h._("Delete")},v={DELETE:h._("Delete")},w=0;d=babelHelpers.inherits(a,b("React").Component);j=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=j.constructor).call.apply(a,[this].concat(e)),this.state={locating:!1,mapOptions:{scrollWheelZoom:!this.props.disableScrollWheelZoom,maxBounds:this.props.maxBounds},size:null,view:this.props.view||p,popupLocationKey:null},this.$1=function(a){__p&&__p();if(a.coordinateLists.size)return null;if(!a.geoLocation.type)return null;var c=b("LocationConstants").getPluralLocationType(a.geoLocation.type);switch(c){case b("LocationConstants").COUNTRIES:return new(b("LeafletView"))({center:a.center,zoom:r});case b("LocationConstants").COUNTRY_GROUPS:return new(b("LeafletView"))({center:a.center,zoom:q});case b("LocationConstants").CUSTOM_LOCATIONS:return a.geoLocation.custom_type===b("LocationConstants").CUSTOM_TYPE_MULTI_CITY?new(b("LeafletView"))({center:a.center,zoom:a.geoLocation.country?r:q}):null;default:return null}},this.$8=function(a,c){if(c)return a?b("AdsCommonLocalMapUtils").LEAFLET_TARGET_HIGHLIGHT_REGION_EXCLUDE_OPTIONS:b("AdsCommonLocalMapUtils").LEAFLET_TARGET_HIGHLIGHT_REGION_INCLUDE_OPTIONS;else return a?b("AdsCommonLocalMapUtils").LEAFLET_TARGET_REGION_EXCLUDE_OPTIONS:b("AdsCommonLocalMapUtils").LEAFLET_TARGET_REGION_INCLUDE_OPTIONS},this.$9=function(a,b,c){if(b)if(a)return c?"_3ag7":"_s6h";else return c?"_3ag8":"_s6i";else if(a)return c?"_3ag9":"_3i44";else return c?"_3aga":"_3i45"},this.$4=function(a,c,d,e){__p&&__p();var f=this.props.menuItems||(this.props.onlyInclusion?v:u),g=void 0;this.props.menuItems||(g=c?{INCLUDE:!1,EXCLUDE:!0,DELETE:!1}:{INCLUDE:!0,EXCLUDE:!1,DELETE:!1});var h={};c||this.props.excludedLocations.forEach(function(a,c){c=a.geoLocation;c.type===b("LocationConstants").CUSTOM_LOCATIONS&&c.custom_type===b("LocationConstants").CUSTOM_TYPE_MULTI_CITY&&(h[c.key]=!0)});a.forEach(function(a,i){__p&&__p();if(!c&&h[a.geoLocation.key]===!0)return;var j=this.state.popupLocationKey===a.geoLocation.key;i=this.props.highlightLocations.contains(a)||j;var k=a.geoLocation.type===b("LocationConstants").CUSTOM_LOCATIONS&&a.geoLocation.custom_type===b("LocationConstants").CUSTOM_TYPE_MULTI_CITY,l=(i?"h":"")+(c?"-":"")+a.geoLocation.key,n=this.$8(c,i),p=[],q=b("React").createElement(b("LeafletPopup.react"),{options:{autoPan:!1,closeButton:!1,className:"_1l0n",maxWidth:500}},a.popup||b("React").createElement(b("AdsTargetingLocationMapPopup"),{label:this.$10(a.geoLocation),location:a.geoLocation,menuItems:m(a.geoLocation)?v:f,menuItemsDisabled:g,onMenuItemSelect:this.props.onPopupMenuItemSelect}));q=j||[o.DEFAULT,o.SHOW_POPUP].includes(this.props.clickBehavior)?q:undefined;var r=this.$11(a),s=function(a){j&&a.target.openPopup()},t=function(b){this.state.popupLocationKey!==a.geoLocation.key&&this.setState({popupLocationKey:a.geoLocation.key})}.bind(this),u=function(b){this.state.popupLocationKey===a.geoLocation.key&&j&&this.setState({popupLocationKey:null})}.bind(this),w=function(a){this.props.showPopupOnHover&&t(a)}.bind(this),x=function(a){this.props.showPopupOnHover&&u(a)}.bind(this);k=a.icon||b("leaflet").divIcon(babelHelpers["extends"]({},b("AdsCommonLocalMapUtils").LEAFLET_MARKER_ICON_OPTIONS,{className:this.$9(c,i,k)}));p.push(b("React").createElement(b("LeafletMarker.react"),{coordinates:a.center,eventHandlers:{add:s,click:r,mouseover:w,mouseout:x,popupclose:u,popupopen:t},key:"m"+l,options:{clickable:!0,icon:k,zIndexOffset:i?1e3:0},popup:q}));s=!1;a.coordinateLists&&a.coordinateLists.size&&(p.push(b("React").createElement(b("LeafletMultiPolygon.react"),{coordinateLists:a.coordinateLists,key:"p"+l,options:n})),s=!0);r=a.circleCenter||a.center;r&&a.radius&&(p.push(b("React").createElement(b("LeafletCircle.react"),{center:r,key:"c"+l,options:n,radius:a.radius})),s||p.push(b("React").createElement(b("LeafletCircleMarker.react"),{center:r,key:"cm"+l,options:b("AdsCommonLocalMapUtils").LEAFLET_TARGET_MARKER_OPTIONS})));i?e.push.apply(e,p):d.push.apply(d,p)}.bind(this))}.bind(this),this.$10=function(a){return a.name},this.$12=function(){b("AdsInterfacesLogger").log({eventName:b("AdsTargetingLocationLoggingEvents").GEO_LOCATION_MAP_ZOOM_IN},b("AdsInterfacesLogger").LOG_TYPE_PRIMARY_APP);var a=this.state.view;a.zoom<b("TilesMapConfig").ZOOM_RANGE.MAX&&this.$3(a.setZoom(a.zoom+1))}.bind(this),this.$13=function(){b("AdsInterfacesLogger").log({eventName:b("AdsTargetingLocationLoggingEvents").GEO_LOCATION_MAP_ZOOM_OUT},b("AdsInterfacesLogger").LOG_TYPE_PRIMARY_APP);var a=this.state.view;a.zoom>b("TilesMapConfig").ZOOM_RANGE.MIN&&this.$3(a.setZoom(a.zoom-1))}.bind(this),this.$14=function(){b("AdsInterfacesLogger").log({eventName:b("AdsTargetingLocationLoggingEvents").GEO_LOCATION_MAP_ZOOM_TO_FIT},b("AdsInterfacesLogger").LOG_TYPE_PRIMARY_APP);var a=this.$2(this.state.size,this.props.locations.union(this.props.excludedLocations));this.$3(a)}.bind(this),this.$15=function(){var a=this.state.view.zoom<b("TilesMapConfig").ZOOM_RANGE.MAX?this.$12:undefined,c=this.state.view.zoom>b("TilesMapConfig").ZOOM_RANGE.MIN?this.$13:undefined,d=!this.props.disableCollapseButton&&b("React").createElement("div",{className:"_qh2"},b("React").createElement(b("XUIButton.react"),{className:"_qh3",image:t,label:h._("click to collaps map"),labelIsHidden:!0,type:"button",onClick:this.props.onCollapseMap}));return b("React").createElement(b("FBOverlayElement.react"),{horizontal:"right",key:"zoomControls",vertical:"top"},b("React").createElement("div",null,d,b("React").createElement(b("FBTilesMapZoomOverlay.react"),{className:"_3-8j",onZoomIn:a,onZoomOut:c}),b("React").createElement("div",{className:"_qh4"},b("React").createElement(b("XUIButton.react"),{className:"_qh5",image:s,label:h._("Zoom To Fit"),labelIsHidden:!0,type:"button",onClick:this.$14}))))}.bind(this),this.$16=function(){return b("React").createElement(b("FBOverlayElement.react"),{horizontal:"right",key:"addLocation",vertical:"bottom"},b("React").createElement("div",null,b("React").createElement(b("SUIButton.react"),{disabled:this.props.addingLocation,icon:b("React").createElement(b("Image.react"),{src:this.props.addLocationMode===b("LocationConstants").INCLUDE?i("22123"):i("22122")}),isDepressed:this.state.locating,label:h._("Drop Pin"),style:{marginBottom:"12px",marginRight:"12px"},theme:b("SUIBusinessTheme"),type:"button",onClick:this.$17})))}.bind(this),this.$7=function(){return this.props.hideAllControls?null:this.props.enableDropPin?[this.$15(),this.$16()]:[this.$15()]}.bind(this),this.$5=function(event){this.state.locating&&(this.setState({locating:!1}),this.props.onAddLocationFromMap(new(b("GeoCoordinates"))(event.latlng.lat,b("LeafletUtils").wrapLongitude(event.latlng.lng))))}.bind(this),this.$17=function(a){this.setState({locating:!this.state.locating})}.bind(this),this.$2=function(a,c){if(!a||0===c.size)return this.state.view;c=l(c);if(!c)return this.state.view;c=b("LeafletUtils").fitBounds(c,{width:a.x,height:a.y},{zoomRange:[0,20]});return c}.bind(this),this.$6=function(a){var b=this.state.view;this.props.centerLocations&&this.props.centerLocations.size>0?b=k(this.state.view,this.props.centerLocations):(this.props.locations.size>0||this.props.excludedLocations.size>0||this.props.fitLocations.size>0)&&(b=this.$2(a,this.props.locations.union(this.props.excludedLocations).union(this.props.fitLocations)));this.$3(b,a)}.bind(this),this.$3=function(a,b){b=b||this.state.size;this.props.view?this.setState({size:b}):this.setState({view:a,size:b});this.props.onViewChange&&this.props.onViewChange(a,b)}.bind(this),c}a.prototype.UNSAFE_componentWillMount=function(){w=b("performanceNow")()};a.prototype.componentDidMount=function(){var a,c=Math.floor(b("performanceNow")()-w);b("AdsInterfacesLogger").log({eventName:b("AdsTargetingLocationLoggingEvents").GEO_LOCATION_MAP_MOUNTING_TIME,data:(a={},a[b("AdsInterfacesLoggerConfigColumns").SCENARIO_DURATION]=c,a)},b("AdsInterfacesLogger").LOG_TYPE_PRIMARY_APP);b("BanzaiODS").bumpEntityKey("ads_targeting_location","geo_location_map_mounting_time",c)};a.prototype.UNSAFE_componentWillUpdate=function(a,c){b("performanceNow")()};a.prototype.UNSAFE_componentWillReceiveProps=function(a){__p&&__p();if(!b("LeafletUtils").areViewEqual(a.view,this.props.view))this.setState({view:a.view||p});else if(null!==this.state.size&&a.fitLocations.size>0&&(a.forceUpdate||!b("areEqual")(a.fitLocations,this.props.fitLocations))){var c=null;if(a.fitLocations.size==1){var d=a.fitLocations.first();c=this.$1(d)}c||(c=this.$2(this.state.size,a.fitLocations));this.$3(c)}b("areEqual")(a.maxBounds,this.props.maxBounds)||b("FBLogger")("ads").warn("AdsTargetingLocationInlineMap does not support changing maxBounds");a.view&&!a.onViewChange&&b("FBLogger")("ads").warn("AdsTargetingLocationInlineMap expects `onViewChange` if given `view`");a.mapHasFocus||this.setState({popupLocationKey:null})};a.prototype.shouldComponentUpdate=function(a,c){a=a.addLocationMode!==this.props.addLocationMode||a.enableDropPin!==this.props.enableDropPin||!b("areEqual")(a.highlightLocations,this.props.highlightLocations)||!b("areEqual")(a.locations,this.props.locations)||!b("areEqual")(a.excludedLocations,this.props.excludedLocations)||!b("areEqual")(a.mapHasFocus,this.props.mapHasFocus)||!b("LeafletUtils").areViewEqual(a.view,this.props.view);c=c!==undefined&&(c.size!=this.state.size||!b("LeafletUtils").areViewEqual(c.view,this.state.view)||c.popupLocationKey!==this.state.popupLocationKey||c.locating!=this.state.locating);return a||c};a.prototype.render=function(){var a=null;this.state.locating?a=this.props.addLocationMode===b("LocationConstants").INCLUDE?"_3aio":"_3aiw":a="_3-cr";var c=[],d=[];this.$4(this.props.locations,!1,c,d);this.$4(this.props.excludedLocations,!0,c,d);return b("React").createElement(b("FBTilesMap.react"),{className:a,eventHandlers:{click:this.$5},options:this.state.mapOptions,showReportButton:!1,showZoomControls:!1,view:this.state.view,onSizeSettled:this.$6,onViewChange:this.$3},this.$7(),c,d)};a.prototype.$18=function(a){var c=a.meta;if(!this.props.onSingleNodeClick||b("immutable").Set.isSet(c)&&c.size!==1){this.$19(a);return}a=b("immutable").Set.isSet(c)?c.first():c;this.props.onSingleNodeClick(a.getID())};a.prototype.$11=function(a){switch(this.props.clickBehavior){case o.DEFAULT:case o.ZOOM_TO_MARKER:return function(){return this.$20(a)}.bind(this);case o.ZOOM_TO_NEXT_RANGE:return function(){return this.$19(a)}.bind(this);case o.INVOKE_CALLBACK_ON_SINGLE_NODE:return function(){return this.$18(a)}.bind(this);default:return b("emptyFunction")}};a.prototype.$20=function(a){a=this.$2(this.state.size,b("immutable").Set.of(a));this.$3(a)};a.prototype.$19=function(a){this.$3(n(a,this.state.view.zoom))};a.propTypes={addLocationMode:c.string.isRequired,addingLocation:c.bool,clickBehavior:c.oneOf(Object.keys(o)),disableCollapseButton:c.bool,disableScrollWheelZoom:c.bool,enableDropPin:c.bool.isRequired,excludedLocations:c.instanceOf(b("immutable").Set).isRequired,fitLocations:c.instanceOf(b("immutable").Set).isRequired,forceUpdate:c.bool,hideAllControls:c.bool,highlightLocations:c.instanceOf(b("immutable").Set).isRequired,locations:c.instanceOf(b("immutable").Set).isRequired,mapHasFocus:c.bool,maxBounds:c.instanceOf(b("leaflet").LatLngBounds),menuItems:c.object,onlyInclusion:c.bool.isRequired,showPopupOnHover:c.bool,view:c.instanceOf(b("LeafletView")),onAddLocationFromMap:c.func.isRequired,onCollapseMap:c.func.isRequired,onPopupMenuItemSelect:c.func.isRequired,onViewChange:c.func};a.defaultProps={clickBehavior:o.DEFAULT,mapHasFocus:!0};e.exports=a}),null);
__d("AdsTargetingAggregatedMap.react",["AdsTargetingAggregatedMapUtils","AdsTargetingLocationInlineMap.react","FbtResultBase","immutable","LeafletUtils","LeafletView","LocationConstants","React","areEqual","emptyFunction","emptyObject","AdsTargetingLocationTypeAliases"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("AdsTargetingAggregatedMapUtils").aggregateMapRecords,i=b("AdsTargetingAggregatedMapUtils").extractRecordKey,j=b("AdsTargetingAggregatedMapUtils").splitClusterKey;c=b("React").Component;d=b("React").PropTypes;f=b("AdsTargetingLocationTypeAliases").CLICK_BEHAVIORS;var k=b("LocationConstants").Aggregation,l=k.MAX_LOCATIONS_SIZE,m=k.MIN_ZOOM_LEVEL_FOR_FILTERING;k=babelHelpers.inherits(a,c);g=k&&k.prototype;function a(a){__p&&__p();g.constructor.call(this,a),this.$5=function(a,b){a=this.props.onLocationsSelect;if(!a)return;a(this.$4(b))}.bind(this),this.$6=function(a,b){this.props.onViewChange&&this.props.onViewChange(a,b);if(!b){this.props.view||this.setState({view:a});return}this.$2(this.props,a,b)}.bind(this),this.state={bounds:null,clusteredLocations:b("immutable").Set(),inRangeLocations:b("immutable").Set(),locationRecordMap:b("immutable").Map(),size:null,view:this.props.view}}a.prototype.render=function(){return this.state.clusteredLocations.size>l?null:b("React").createElement("div",{style:{height:this.props.height}},this.$1())};a.prototype.UNSAFE_componentWillReceiveProps=function(a){this.$2(a)};a.prototype.shouldComponentUpdate=function(a,c){a=a.height!==this.props.height||!b("areEqual")(a.locationRecords,this.props.locationRecords)||!b("areEqual")(a.menuItems,this.props.menuItems)||!b("LeafletUtils").areViewEqual(a.view,this.props.view);c=c!==undefined&&(c.bounds&&!c.bounds.equals(this.state.bounds)||!b("areEqual")(c.clusteredLocations,this.state.clusteredLocations)||!b("LeafletUtils").areViewEqual(c.view,this.state.view));return a||c};a.prototype.$3=function(a,c){return c&&a?b("LeafletUtils").getViewBounds(a,{width:c.x,height:c.y}):b("LeafletUtils").WHOLE_WORLD_BOUNDS};a.prototype.$4=function(a){a=j(a.key);return a.map(function(a){return this.state.locationRecordMap.get(a)}.bind(this))};a.prototype.$2=function(a,c,d){__p&&__p();c=a.view||c||this.state.view;d=d||this.state.size;var e=this.$3(c,d),f=c&&c.zoom;if(f===undefined||!e)return;var g=!1;a.disableAggregation&&(g=a.disableAggregation(f));var j=void 0;f<m?j=a.locationRecords:j=a.locationRecords.filter(function(a){return e.contains(b("LeafletUtils").toLatLng(a.center))});a=f==this.state.zoom&&(j.equals(this.state.inRangeLocations)||j.map(i).equals(this.state.inRangeLocations.map(i)));var k=this.state.locationRecordMap;a||(k=b("immutable").Map().withMutations(function(a){j.forEach(function(b){return a.set(b.geoLocation.key,b)})}));void 0;g||j.size<2?g=j:a?g=this.state.clusteredLocations:g=h(j,f,this.props.countFromCluster,this.props.nameFromCluster);this.setState({bounds:e,clusteredLocations:g,inRangeLocations:j,locationRecordMap:k,size:d,view:c})};a.prototype.$1=function(){var a=this.state.clusteredLocations.isEmpty()?this.props.locationRecords:this.state.clusteredLocations;return b("React").createElement(b("AdsTargetingLocationInlineMap.react"),babelHelpers["extends"]({addLocationMode:b("LocationConstants").INCLUDE,addingLocation:!1,centerLocations:a,clickBehavior:this.props.clickBehavior,disableCollapseButton:this.props.disableCollapseButton,disableScrollWheelZoom:this.props.disableScrollWheelZoom,enableDropPin:!1,excludedLocations:b("immutable").Set(),fitLocations:b("immutable").Set(),highlightLocations:b("immutable").Set(),locations:this.state.clusteredLocations,maxBounds:b("LeafletUtils").WHOLE_WORLD_BOUNDS,menuItems:this.props.menuItems||b("emptyObject"),onlyInclusion:!0,showPopupOnHover:!0,view:this.state.view||undefined,onAddLocationFromMap:b("emptyFunction"),onCollapseMap:b("emptyFunction"),onSingleNodeClick:this.props.onSingleNodeClick,onPopupMenuItemSelect:this.$5,onViewChange:this.$6},this.props.inlineMapProps))};a.propTypes={clickBehavior:d.oneOf(Object.keys(f)),countFromCluster:d.func,disableAggregation:d.func,disableCollapseButton:d.bool,disableScrollWheelZoom:d.bool,height:d.number.isRequired,inlineMapProps:d.object,locationRecords:d.instanceOf(b("immutable").Set).isRequired,menuItems:d.shape({INCLUDE:d.oneOfType([d.instanceOf(b("FbtResultBase")),d.string]),EXCLUDE:d.oneOfType([d.instanceOf(b("FbtResultBase")),d.string]),DELETE:d.oneOfType([d.instanceOf(b("FbtResultBase")),d.string])}),nameFromCluster:d.func,view:d.instanceOf(b("LeafletView")),onLocationsSelect:d.func,onViewChange:d.func};a.defaultProps={clickBehavior:f.ZOOM_TO_NEXT_RANGE,inlineMapProps:{}};e.exports=a}),null);
__d("AdsTargetingLocationMapRecord",["AdsTargetingLocationMapMetaRecord","emptyFunction"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("AdsTargetingLocationMapMetaRecord"));g&&g.prototype;a.fromGeoLocation=function(a){return b("AdsTargetingLocationMapMetaRecord").fromGeoLocation(a,undefined)};a.fromGeoLocationCached=function(a){return b("AdsTargetingLocationMapMetaRecord").fromGeoLocationCached(a,undefined)};a.fromGeoLocations=function(a){return b("AdsTargetingLocationMapMetaRecord").fromGeoLocations(a,b("emptyFunction"))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("AdsDayPartingInterval",["DateConsts"],(function(a,b,c,d,e,f){"use strict";function a(a,c){this.start_minute=a*b("DateConsts").MIN_PER_HOUR,this.end_minute=c*b("DateConsts").MIN_PER_HOUR}e.exports=a}),null);
__d("DayPartingGrid",["AdsApiScheduleObjectFields","AdsApiScheduleObjectPaths","AdsApiScheduleObjectRecord","AdsDayPartingInterval","DayPartingUtils","getByPath"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("DayPartingUtils").DAYS_IN_WEEK,h=b("DayPartingUtils").HOURS_IN_DAY;function a(a){__p&&__p();if(a){this.hours=new Array(g);for(var c=0;c<g;c++)this.hours[c]=a.hours[c].slice();this.everyDay=a.everyDay.slice();this.allDay=a.allDay.slice()}else this.hours=this.$1(),this.allDay=b("DayPartingUtils").createArray(g,function(){return!1}),this.everyDay=b("DayPartingUtils").createArray(h,function(){return!1})}a.prototype.set=function(a,b,c,d,e){__p&&__p();var f;c<a&&(f=a,a=c,c=f);d<b&&(f=b,b=d,d=f);for(var f=a;f<=c;f++){for(var a=b;a<=d;a++)this.hours[f][a]=e;this.$2(f)}for(a=b;a<=d;a++)this.$3(a)};a.prototype.setEveryDay=function(a,b,c){if(b<a){var d=a;a=b;b=d}this.set(0,a,g-1,b,c)};a.prototype.setAllDay=function(a,b,c){if(b<a){var d=a;a=b;b=d}this.set(a,0,b,h-1,c)};a.prototype.isSelected=function(a,b){if(b===null&&a===null)return!1;if(b==null&&this.allDay&&a!=null)return!!this.allDay[a];if(a==null&&this.everyDay&&b!=null)return!!this.everyDay[b];return this.hours&&a!=null&&b!=null?!!this.hours[a][b]:!1};a.prototype.$2=function(a){var b=!0;for(var c=0;c<h;c++)if(this.hours[a][c]!==!0){b=!1;break}this.allDay[a]=b};a.prototype.$3=function(a){var b=!0;for(var c=0;c<g;c++)if(this.hours[c][a]!==!0){b=!1;break}this.everyDay[a]=b};a.prototype.getSchedule=function(){var a=new Array(7);for(var c=0;c<g;c++){var d=this.toAPIDayIndex(c);a[d]=this.$4(c)}return b("DayPartingUtils").mergeDays(a)};a.prototype.getScheduleWithTimezoneType=function(a){var c=new Array(7);for(var d=0;d<g;d++){var e=this.toAPIDayIndex(d);c[e]=this.$4(d)}e=b("DayPartingUtils").mergeDays(c);return e.map(function(c){var d;return new(b("AdsApiScheduleObjectRecord"))((d={},d[b("AdsApiScheduleObjectFields").START_MINUTE]=c.start_minute,d[b("AdsApiScheduleObjectFields").END_MINUTE]=c.end_minute,d[b("AdsApiScheduleObjectFields").DAYS]=c.days,d[b("AdsApiScheduleObjectFields").TIMEZONE_TYPE]=a,d))})};a.prototype.$4=function(a){__p&&__p();var c=[],d=null,e=function(a){if(d!==null){a=new(b("AdsDayPartingInterval"))(d,a);c.push(a)}};for(var f=0;f<h;f++){var g=this.hours[a][f];d===null?g===!0&&(d=f):g===!1&&(e(f),d=null)}d!==null&&e(h);return c};a.prototype.setSchedule=function(a){__p&&__p();var c=this.$1();if(a!=null&&a.length){a.forEach(function(a){var d=a[b("AdsApiScheduleObjectFields").DAYS];d!=null&&d.length&&d.forEach(function(d){var e=b("getByPath")(a,b("AdsApiScheduleObjectPaths").START_MINUTE),f=b("getByPath")(a,b("AdsApiScheduleObjectPaths").END_MINUTE);d=this.fromAPIDayIndex(d);e=e/60;f=f/60;for(var e=e;e<f;e++)c[d][e]=!0}.bind(this))}.bind(this));this.hours=c;for(var a=0;a<g;a++)this.$2(a);for(var a=0;a<h;a++)this.$3(a)}return this};a.prototype.toAPIDayIndex=function(a){return(a+1)%b("DayPartingUtils").DAYS_IN_WEEK};a.prototype.fromAPIDayIndex=function(a){return(a+6)%b("DayPartingUtils").DAYS_IN_WEEK};a.prototype.$1=function(){return b("DayPartingUtils").createArray(g,function(){return b("DayPartingUtils").createArray(h,function(){return!1})})};e.exports=a}),null);
__d("EventPermalinkCameraFramesLogging",["EventsActionsLogger"],(function(a,b,c,d,e,f){"use strict";e.exports={logClick:function(a,c,d){b("EventsActionsLogger").log(this._eventID,{type:b("EventsActionsLogger").Type.CLICK,target:a,surface:b("EventsActionsLogger").Surface.PERMALINK,mechanism:b("EventsActionsLogger").Mechanism.PERMALINK,target_id:c,acontext:d},{})}}}),null);
__d("MediaEffectHubViewTab",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ANALYTICS:"analytics",ARSTUDIO:"arstudio",HOME:"home",LEARN:"learn",MANAGE:"manage",TEMPLATES:"templates",JOIN:"join",INVITE:"invite"})}),null);
__d("XMediaEffectHubController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/{?tab}/",{tab:{type:"Enum",enumType:1},ref:{type:"Enum",enumType:1},flow_type:{type:"Enum",enumType:1},create:{type:"Bool",defaultValue:!1}})}),null);
__d("MediaEffectOwnerHubHeader.react",["fbt","Link.react","MediaEffectHubViewTab","React","XMediaEffectHubController","XUICardHeader.react","XUICardHeaderTitle.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){var a=this.props,c=a.hubLinkTab;a=a.title;var d=null;if(c){var e=b("XMediaEffectHubController").getURIBuilder().setEnum("tab",c).getURI();c=c===b("MediaEffectHubViewTab").LEARN?g._("Learn More"):g._("Manage Effects");d=b("React").createElement(b("Link.react"),{href:e,target:"_blank"},c)}return b("React").createElement(b("XUICardHeader.react"),{link:d,type:"secondary"},b("React").createElement(b("XUICardHeaderTitle.react"),null,a))};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectWebdriverIDs",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({HUB_EFFECT_TABLE:"hub_effect_table",HUB_EFFECT_TABLE_PREVIEW_COLUMN:"hub_effect_table_preview_column",LWE_FRAME_CREATION_DIALOG:"lwe_frame_creation_dialog",LWE_EFFECT_OWNER_POPOVER_BUTTON:"lwe_effect_owner_popover_button",LWE_EFFECT_APP_POPOVER_BUTTON:"lwe_effect_app_popover_button",LWE_EFFECT_FRAME_NAME_INPUT:"lwe_effect_frame_name_input",HUB_EFFECT_CREATE_BUTTON:"hub_effect_create_button",LWE_EFFECT_CONTINUE_BUTTON:"lwe_effect_continue_button",LWE_EFFECT_CONFIRMATION_DIALOG:"lwe_effect_confirmation_dialog",LWE_EFFECT_PUBLISHED_CONFIRMATION_DIALOG_DONE_BUTTON:"lwe_effect_published_confirmation_dialog_done_button",LWE_EFFECT_EDUCATION_CONTINUE_BUTTON:"lwe_effect_education_continue_button",LWE_EFFECT_SAVE_DRAFT_BUTTON:"lwe_effect_save_draft_button",LWE_EFFECT_SAVE_DRAFT_SPINNER:"lwe_effect_save_draft_spinner",HUB_AR_EFFECT_CREATE_BUTTON:"hub_ar_effect_create_button",HUB_AR_EFFECT_CREATION_DIALOG:"hub_ar_effect_creation_dialog",HUB_AR_EFFECT_CREATION_DIALOG_NEXT:"hub_ar_effect_creation_dialog_next",HUB_AR_EFFECT_CREATION_DIALOG_PUBLISH:"hub_ar_effect_creation_dialog_publish",HUB_AR_EFFECT_FORM:"hub_ar_effect_form",HUB_AR_EFFECT_FORM_UPLAOD_STEP:"hub_ar_effect_form_upload_step",HUB_AR_EFFECT_FORM_DETAILS_STEP:"hub_ar_effect_form_details_step",HUB_AR_EFFECT_FORM_REVIEW_STEP:"hub_ar_effect_form_review_step",HUB_AR_EFFECT_FORM_NAME:"hub_ar_effect_form_name",HUB_AR_EFFECT_FORM_EFFECT_ICON:"hub_ar_effect_form_effect_icon",HUB_AR_EFFECT_FORM_EFFECT_FILE:"hub_ar_effect_form_effect_file",HUB_AR_EFFECT_FORM_LEGAL_AGREEMENT:"hub_ar_effect_form_legal_agreement",HUB_AR_EFFECT_FORM_EFFECT_DESCRIPTION:"hub_ar_effect_form_effect_description",HUB_AR_EFFECT_FORM_SCREENCAST:"hub_ar_effect_form_screencast",SUCCESS_DIALOG:"success_dialog",SUCCESS_DIALOG_CLOSE_BUTTON:"success_dialog_close_button",HUB_AR_EFFECT_DETAIL_DIALOG:"hub_ar_effect_detail_dialog",HUB_AR_EFFECT_DETAIL_DIALOG_SAVE:"hub_ar_effect_detail_dialog_save",HUB_AR_EFFECT_DETAIL_DIALOG_REJECTION_REASONS:"hub_ar_effect_detail_dialog_rejection_reasons",TRYIT_PAGE_SEND_NOTIFICAITON:"tryit_page_send_notification",TRYIT_PAGE_NOTIFICATION_CONFIRMATION:"tryit_page_notification_confirmation",FILE_UPLOAD_PROGRESS_BAR:"file_upload_progress_bar"})}),null);
__d("EventPermalinkCameraFramesCreate.react",["cx","fbt","ix","AsyncDialog","AsyncRequest","EventPermalinkCameraFramesLogging","EventsActionsLogger","EventsPermalinkTabBar","Image.react","MediaEffectCreateStep","MediaEffectCreationReferrer","MediaEffectFlowType","MediaEffectHubViewTab","MediaEffectOwnerHubHeader.react","MediaEffectWebdriverIDs","React","ShimButton.react","XMediaEffectCreateDialogController","XUICard.react","XUICardSection.react"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=babelHelpers.inherits(a,b("React").PureComponent);j=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=j.constructor).call.apply(a,[this].concat(e)),this.$1=function(){b("EventPermalinkCameraFramesLogging").logClick(b("EventsActionsLogger").Target.FRAME_CREATE_RHC,this.props.eventID,this.props.actionContext);var a=b("XMediaEffectCreateDialogController").getURIBuilder().setEnum("flow_type",b("MediaEffectFlowType").EVENT).setFBID("source_id",this.props.eventID).setEnum("step",b("MediaEffectCreateStep").CREATE).setString("action_context",JSON.stringify(this.props.actionContext)).setEnum("active_tab",b("EventsPermalinkTabBar").getCurrentTab()).setEnum("ref",b("MediaEffectCreationReferrer").EVENT_PAGE).getURI();b("AsyncDialog").send(new(b("AsyncRequest"))(a))}.bind(this),c}a.prototype.render=function(){return b("React").createElement(b("XUICard.react"),{className:"_634s"},b("React").createElement(b("MediaEffectOwnerHubHeader.react"),{title:this.props.title,hubLinkTab:b("MediaEffectHubViewTab").LEARN}),b("React").createElement(b("XUICardSection.react"),null,b("React").createElement(b("ShimButton.react"),{className:"_weu","data-testid":b("MediaEffectWebdriverIDs").HUB_EFFECT_CREATE_BUTTON,onClick:this.$1},b("React").createElement(b("Image.react"),{src:i("293229")}),b("React").createElement("h1",{className:"_1x8l"},h._("Help people share at your event")),b("React").createElement("p",{className:"_wev"},h._("Create a custom camera frame for your event using handy templates. People can add it to the photos and videos they share with friends.")),b("React").createElement("p",{className:"_wew"},h._("Get Started")))))};e.exports=a}),null);
__d("FXEntMediaEffectStatus",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({DRAFT:"draft",SCHEDULED:"scheduled",ACTIVE:"active",INACTIVE:"inactive",COMPLETED:"completed",ARCHIVED:"archived",NOT_REVIEWED:"not_reviewed",IN_REVIEW:"in_review",APPROVED:"approved",NOT_APPROVED:"not_approved",UPDATE_IN_REVIEW:"update_in_review",UPDATE_REJECTED:"update_rejected",DISABLED:"disabled",NEEDS_ATTENTION:"needs_attention",DEPRECATED:"deprecated"})}),null);
__d("MediaEffectFunnelLoggingConstants",[],(function(a,b,c,d,e,f){"use strict";e.exports={CREATION_FUNNEL_LOGGING_NAME:"CREATIVE_STUDIO_CREATION_FUNNEL",FUNNEL_LOGGING_EVENT:{ADD_DYNAMIC_TEXT:"add_dynamic_text",ADD_TEXT:"add_text",ASSET_INPLACE_WARNING:"asset_inplace_warning",CANCEL:"cancel",CHANGE_CATEGORY:"change_category",CHANGE_EDITOR_BACKGROUND_COLOR:"change_editor_background_color",CHANGE_EDITOR_BACKGROUND_IMAGE:"change_editor_background_image",CHANGE_END_TIME:"change_end_time",CHANGE_LOCATION:"change_location",CHANGE_NAME:"change_name",CHANGE_OWNER:"change_owner",CHANGE_START_TIME:"change_start_time",CHANGE_TAG:"change_tag",CHANGE_TEXT_ALIGNMENT:"change_text_alignment",CHANGE_TEXT_COLOR:"change_text_color",CHANGE_TEXT_FONT:"change_text_font",CHANGE_TEXT_CONTENT:"change_text_content",DELETE_ASSET:"delete_asset",DUPLICATE_ASSET:"duplicate_asset",ENTER_CREATION_FLOW_FROM_INLINE_NUX:"enter_creation_flow_from_inline_nux",EXPLICIT_DROPOFF:"explicit_dropoff",GALLERY_VIEW:"gallery_view",GALLERY_MEDIA_CLICK:"gallery_media_click",PREVIEW_ON_CAMERA:"preview_on_camera",SAVE_AS_DRAFT:"save_as_draft",SET_SCALE_WITH_WIDTH:"set_scale_with_width",SET_SCALE_WITH_HEIGHT:"set_scale_with_height",SHOW_PREVIEW:"show_preview",SHOWN_INLINE_NUX:"shown_inline_nux",SUBMIT:"submit",UPDATE_STEP:"update_step",UPLOAD_FILE:"upload_file",UPLOAD_FINISHED:"upload_finished",DIALOG_LOADED:"dialog_loaded",BACKGROUND_AUTO_REMOVAL_PREVIEW:"background_auto_removal_preview",BACKGROUND_AUTO_REMOVAL_APPLIED:"background_auto_removal_applied",ASSET_AUTO_SNAPPING:"asset_auto_snapping"},FUNNEL_LOGGING_TIMEOUT:999999,FUNNEL_LOGGING_TAGS:{BROWSER_NAME:"browser_name",CREATION_FLOW_TYPE:"creation_flow_type",EFFECT_ID:"effect_id",FAILURE:"failure",FRAME_EDITOR_SHOWN:"frame_editor_shown",NEW_EFFECT:"new_effect",REF:"ref",SOURCE_ID:"source_id",SUCCESS:"success",DIALOG_TYPE:"dialog_type",IS_FIRST_TIME_SAVE_OR_SUBMIT:"is_first_time_save_or_submit"},FUNNEL_LOGGING_PAYLOAD:{ALIGNMENT:"alignment",ASSET_INPLACE_WARNING_TYPE:"asset_inplace_warning_type",COLOR:"color",IMAGE:"image",EFFECT_ID:"effect_id",FONT:"font",NEW_EFFECT:"new_effect",OWNER_FIRST_PARTY:"owner_first_party",OWNER_ID:"owner_id",OWNER_TYPE:"owner_type",RESULT:"result",SCALE_WITH_HEIGHT:"scale_with_height",SCALE_WITH_WIDTH:"scale_with_width",TEXT:"text",STEP:"step",ASSET_ID:"asset_id",ASSETS:"assets",ASSET_AUTO_SNAPPING_TYPE:"asset_auto_snapping_type"}}}),null);
__d("MediaEffectErrorCode",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({HAS_DISALLOWED_LOCATION:"has_disallowed_location"})}),null);
__d("MediaEffectError",["fbt","immutable","MediaEffectErrorCode"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;a=b("immutable").Record;c=a({code:null,message:null,messageItems:[],params:[]});h=babelHelpers.inherits(i,c);h&&h.prototype;i.fromObject=function(a){return new i(babelHelpers["extends"]({},a,{message:j(a.code,a.params),messageItems:k(a.code,a.params)}))};function i(){h.apply(this,arguments)}function j(a,c){switch(a){case b("MediaEffectErrorCode").HAS_DISALLOWED_LOCATION:if(!c||c.length===0)return null;if(c.length===1)return g._("The location you added is no longer available to use with frames. Select a different location or General for no location.");else return g._("Some of the locations you added are no longer available to use with frames. Change these locations or select General for no location:")}return null}function k(a,c){switch(a){case b("MediaEffectErrorCode").HAS_DISALLOWED_LOCATION:if(!c)return null;if(c.length===1)return[];else return c}return null}e.exports=i}),null);
__d("MediaEffectFrameEditorDispatcher",["ExplicitRegistrationReactDispatcher"],(function(a,b,c,d,e,f){"use strict";var g;c=babelHelpers.inherits(a,b("ExplicitRegistrationReactDispatcher"));g=c&&c.prototype;function a(a){g.constructor.call(this,a),this.dispatch=this.dispatch.bind(this)}e.exports=new a({strict:!0})}),null);
__d("MediaEffectMetadataViewStore",["FluxReduceStore","immutable","MediaEffectError","MediaEffectFrameEditorDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h,i=b("immutable").List,j=b("immutable").Map;c=b("immutable").Record;g=babelHelpers.inherits(k,c({errors:i(),fbRankingStrategy:"DEFAULT",instructions:j(),instagramAttributionData:i(),ownersData:i(),potentialOwnersForAttribution:j(),templateCategories:j()}));g&&g.prototype;function k(){g.apply(this,arguments)}h=babelHelpers.inherits(a,b("FluxReduceStore"));h&&h.prototype;a.prototype.getInitialState=function(){return new k()};a.prototype.reduce=function(a,c){__p&&__p();switch(c.type){case"update/fbRankingStrategy":a=a.set("fbRankingStrategy",c.value);break;case"init/effectMetadata":c=c.data;var d=c.activationJSData,e=c.instructionsData,f=c.instagramAttributionData,g=c.ownersData,h=c.errorsData,k=c.templateCategoryData,l=c.potentialOwnersForAttribution;c=d.fbBoosted;d=d.fbRankWeight;var m="DEFAULT";c?m="BOOST":d&&(m="MANUAL");var n=i((h||[]).map(function(a){return b("MediaEffectError").fromObject(a)}));a=a.withMutations(function(a){a.set("fbRankingStrategy",m).set("instructions",j(e)).set("instagramAttributionData",i(f)).set("ownersData",i(g)).set("potentialOwnersForAttribution",j(l)).set("errors",n).set("templateCategories",j(k))});break}return a};a.prototype.getMediaEffectOwnerFromID=function(a,b){if(!b)return null;a=a.filter(function(a){return a.id===b});return a.size===1?a.first():null};a.prototype.getOwner=function(a){return this.getMediaEffectOwnerFromID(this.getState().get("ownersData"),a)};a.prototype.getInstagramAttribution=function(a){return this.getMediaEffectOwnerFromID(this.getState().get("instagramAttributionData"),a)};a.prototype.isFirstParty=function(a){a=this.getOwner(a);return!a?!1:a.isFirstParty};a.prototype.isFirstPartyProduct=function(a,b){if(!this.isFirstParty(a))return!1;a=this.getOwner(a);return!a?!1:a.product===b};function a(){h.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("MediaEffectFrameEditorDispatcher"))}),null);
__d("MediaEffectEditorFunnelLogger",["invariant","FunnelLogger","MediaEffectFunnelLoggingConstants","MediaEffectMetadataStore","MediaEffectMetadataViewStore","MediaEffectReactFrameEditorImageAssetRecord","mergeDeep"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("MediaEffectFunnelLoggingConstants").CREATION_FUNNEL_LOGGING_NAME,i=b("MediaEffectFunnelLoggingConstants").FUNNEL_LOGGING_EVENT,j=b("MediaEffectFunnelLoggingConstants").FUNNEL_LOGGING_PAYLOAD,k=b("MediaEffectFunnelLoggingConstants").FUNNEL_LOGGING_TAGS;a={_funnelStarted:!1,_bootstrapData:undefined,startFunnel:function(){b("FunnelLogger").startFunnel(h),this._funnelStarted=!0},startFunnelWithData:function(a){this._bootstrapData=a,this._funnelStarted?this._appendAction(i.DIALOG_LOADED):this.startFunnel()},endFunnel:function(){this._funnelStarted=!1,b("FunnelLogger").endFunnel(h)},logAddDynamicText:function(a){var b;this._appendAction(i.ADD_DYNAMIC_TEXT,(b={},b[j.TEXT]=a,b))},logAddText:function(){this._appendAction(i.ADD_TEXT,{})},logCancel:function(){this._appendAction(i.CANCEL)},logChangeCategory:function(){this._appendActionIfNew(i.CHANGE_CATEGORY)},logChangeEditorBackgroundColor:function(a){var b;this._appendAction(i.CHANGE_EDITOR_BACKGROUND_COLOR,(b={},b[j.COLOR]=a,b))},logChangeEditorBackgroundImage:function(a){var b,c=a&&a.match(/.*?\/([^\/]*\.jpg)/);this._appendAction(i.CHANGE_EDITOR_BACKGROUND_IMAGE,(b={},b[j.IMAGE]=a?c?c[1]:"no image name found":"no image",b))},logChangeEndTime:function(){this._appendActionIfNew(i.CHANGE_END_TIME)},logChangeLocation:function(){this._appendActionIfNew(i.CHANGE_LOCATION)},logChangeName:function(){this._appendActionIfNew(i.CHANGE_NAME)},logPreviewAutoBackgroundRemoval:function(a){var b;this._appendAction(i.BACKGROUND_AUTO_REMOVAL_PREVIEW,(b={},b[j.ASSET_ID]=a,b))},logApplyAutoBackgroundRemoval:function(a){var b;this._appendAction(i.BACKGROUND_AUTO_REMOVAL_APPLIED,(b={},b[j.ASSET_ID]=a,b))},logAutoSnapping:function(a){var b;this._appendAction(i.ASSET_AUTO_SNAPPING,(b={},b[j.ASSET_AUTO_SNAPPING_TYPE]=a,b))},logChangeOwner:function(){this._appendActionIfNew(i.CHANGE_OWNER)},logChangeStartTime:function(){this._appendActionIfNew(i.CHANGE_START_TIME)},logChangeTag:function(){this._appendActionIfNew(i.CHANGE_TAG)},logChangeTextAlignment:function(a){var b;this._appendAction(i.CHANGE_TEXT_ALIGNMENT,(b={},b[j.ALIGNMENT]=a,b))},logChangeTextColor:function(a){var b;this._appendAction(i.CHANGE_TEXT_COLOR,(b={},b[j.COLOR]=a,b))},logChangeTextFont:function(a){var b;this._appendAction(i.CHANGE_TEXT_FONT,(b={},b[j.FONT]=a,b))},logChangeTextContent:function(a){var b;this._appendAction(i.CHANGE_TEXT_CONTENT,(b={},b[j.TEXT]=a,b))},logDeleteAsset:function(){this._appendAction(i.DELETE_ASSET)},logDuplicateAsset:function(){this._appendAction(i.DUPLICATE_ASSET)},logStep:function(a){var b;this._appendAction(i.UPDATE_STEP,(b={},b[j.STEP]=a,b))},logExplicitDropoff:function(a){var b;this._appendAction(i.EXPLICIT_DROPOFF,(b={},b[j.STEP]=a,b))},logSaveAsDraft:function(a,c,d){var e;a=a?k.SUCCESS:k.FAILURE;d=d?d.assets.toArray().map(function(a){var c=a instanceof b("MediaEffectReactFrameEditorImageAssetRecord");return{asset_type:c?"image":"text",is_processed:c?a.processApplied:!1,asset_id:c?a.stickerFBID:null,snappedType:c?a.autoSnappedType:null}}):[];this._appendAction(i.SAVE_AS_DRAFT,(e={},e[j.RESULT]=a,e[j.EFFECT_ID]=c,e[j.ASSETS]=d,e))},logPreviewOnCamera:function(){this._appendAction(i.PREVIEW_ON_CAMERA)},logSetScaleWithHeight:function(a){var b;this._appendAction(i.SET_SCALE_WITH_HEIGHT,(b={},b[j.SCALE_WITH_HEIGHT]=a,b))},logSetScaleWithWidth:function(a){var b;this._appendAction(i.SET_SCALE_WITH_WIDTH,(b={},b[j.SCALE_WITH_WIDTH]=a,b))},logSubmit:function(a,c,d){var e;a=a?k.SUCCESS:k.FAILURE;d=d?d.assets.toArray().map(function(a){var c=a instanceof b("MediaEffectReactFrameEditorImageAssetRecord");return{asset_type:c?"image":"text",is_processed:c?a.processApplied:!1,asset_id:c?a.stickerFBID:null,snappedType:c?a.autoSnappedType:null}}):[];this._appendAction(i.SUBMIT,(e={},e[j.RESULT]=a,e[j.EFFECT_ID]=c,e[j.ASSETS]=d,e))},logUploadFile:function(){this._appendAction(i.UPLOAD_FILE)},logUploadFinished:function(a){var b;a=a?k.SUCCESS:k.FAILURE;this._appendAction(i.UPLOAD_FINISHED,(b={},b[j.RESULT]=a,b))},logShownInlineNUX:function(){this._appendAction(i.SHOWN_INLINE_NUX)},logEnterCreationFlowFromInlineNUX:function(){this._appendAction(i.ENTER_CREATION_FLOW_FROM_INLINE_NUX)},logAssetInPlaceWarning:function(a){var b;this._appendAction(i.ASSET_INPLACE_WARNING,(b={},b[j.ASSET_INPLACE_WARNING_TYPE]=a,b))},logGalleryView:function(){this._appendAction(i.GALLERY_VIEW)},logGalleryMediaClick:function(){this._appendAction(i.GALLERY_MEDIA_CLICK)},_appendActionIfNew:function(a,c){if(!this._funnelStarted)return;c=b("mergeDeep")(c,this._getStandardPayload());b("FunnelLogger").appendActionWithPayloadIfNew(h,a,c)},_appendAction:function(a,c){if(!this._funnelStarted)return;c=b("mergeDeep")(c,this._getStandardPayload());b("FunnelLogger").appendActionWithPayload(h,a,c)},_getStandardPayload:function(){__p&&__p();var a,c=b("MediaEffectMetadataStore").getState(),d=this._bootstrapData&&this._bootstrapData.metadataJSData?this._bootstrapData.metadataJSData.id:undefined;c=c.selectedOwnerID;a=(a={},a[j.NEW_EFFECT]=!d,a);if(d){var e;a=babelHelpers["extends"]({},a,(e={},e[j.EFFECT_ID]=d,e))}if(c){d=b("MediaEffectMetadataViewStore").getOwner(c);d||g(0);a=babelHelpers["extends"]({},a,(e={},e[j.OWNER_FIRST_PARTY]=d.isFirstParty,e[j.OWNER_ID]=c,e[j.OWNER_TYPE]=d.type,e))}return a}};e.exports=a}),null);
__d("FXEntMediaEffectSubmissionStatus",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({PENDING:0,APPROVED:1,DENIED:2,DRAFT:3,ARCHIVED:4,DISABLED:5,TAKEN_DOWN:6,SUBMITTED_UNREVIEWED:7})}),null);
__d("MediaEffectQE",["immutable","QE2Logger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("immutable").Record({inExperiment:!1,params:{},universe:""}));g&&g.prototype;a.prototype.getParam=function(a){var c=arguments.length<=1||arguments[1]===undefined?!0:arguments[1];if(!this.inExperiment)return null;c&&b("QE2Logger").logExposureForUser(this.universe);return this.params[a]};a.prototype.getParamBool=function(a){var b=arguments.length<=1||arguments[1]===undefined?!0:arguments[1],c=this.getParam(a,b);return c==="0"?!1:!!c};a.prototype.getParamInt=function(a){var b=arguments.length<=1||arguments[1]===undefined?!0:arguments[1],c=this.getParam(a,b),d=parseInt(c,10);return isNaN(d)?null:d};a.prototype.getParamString=function(a){var b=arguments.length<=1||arguments[1]===undefined?!0:arguments[1],c=this.getParam(a,b);return typeof c==="string"?c:null};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectQEUtils",["MediaEffectFlowType","MediaEffectQE","MediaEffectUserContext"],(function(a,b,c,d,e,f){"use strict";var g=[b("MediaEffectFlowType").INSTAGRAM_STICKER,b("MediaEffectFlowType").LIVE_TEMPLATE];a={shouldDefaultToPortrait:function(a){if(this._shouldExclude(a))return!1;a=new(b("MediaEffectQE"))(b("MediaEffectUserContext").portraitCanvasQE);return a.getParamBool("show_portrait")},_shouldExclude:function(a){return g.includes(a)}};e.exports=a}),null);
__d("MediaEffectEditingStep.react",["cx","FXEntMediaEffectSubmissionStatus","MediaEffectFlowType","MediaEffectFullscreenFrameEditorContainer.react","MediaEffectQEUtils","MediaEffectReactFrameEditorCanvasContainer.react","MediaEffectReactFrameEditorPreviewContainer.react","MediaEffectValidationDialogContainer.react","React","Vector"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.$1=function(){return this.props.bootstrapData.metadataJSData.id};a.prototype.$2=function(){return!this.$1()};a.prototype.$3=function(){return this.$2()||!!this.props.frameEditorBootstrapData.frameData};a.prototype.$4=function(){var a=this.props.bootstrapData.metadataJSData.submissionStatus;return a===b("FXEntMediaEffectSubmissionStatus").DRAFT||a===b("FXEntMediaEffectSubmissionStatus").DENIED||this.props.flowType===b("MediaEffectFlowType").LIVE_TEMPLATE};a.prototype.render=function(){var a=this.props,c=a.context;a=a.frameEditorBootstrapData;var d=null,e=null;this.$3()&&(d=this.$4()?b("React").createElement(b("MediaEffectFullscreenFrameEditorContainer.react"),{context:{enableEditorCamera:c.enableEditorCamera,enableFontSettingsDialog:c.enableFontSettingsDialog,enableEditorFreeText:c.enableEditorFreeText},filtersData:a.filtersData,flowType:this.props.flowType,frameData:a.frameData}):b("React").createElement("div",{className:"_14bw _4a4u"},b("React").createElement(b("MediaEffectReactFrameEditorCanvasContainer.react"),{bootstrapData:a.frameData,includesPhoneFrame:b("MediaEffectQEUtils").shouldDefaultToPortrait(this.props.flowType),readOnly:!0})),e=this.$4()?null:b("React").createElement("div",{className:"_2odg"},b("React").createElement(b("MediaEffectReactFrameEditorPreviewContainer.react"),{previewScale:.3,previewSize:new(b("Vector"))(400,225)}),b("React").createElement("div",{className:"_3-8x"},b("React").createElement(b("MediaEffectReactFrameEditorPreviewContainer.react"),{previewScale:.3,previewSize:new(b("Vector"))(225,400)}))));return b("React").createElement("div",{className:"_3iei"},b("React").createElement(b("MediaEffectValidationDialogContainer.react"),null),d,e)};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectFrameCreateDialogDataStore",["FluxReduceStore","immutable","MediaEffectFlowType","MediaEffectFrameCreationStepsConfig","MediaEffectFrameEditorDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h;c=b("immutable").Record;var i=b("MediaEffectFrameCreationStepsConfig").CreationSteps;g=babelHelpers.inherits(j,c({currentStep:0,creationReferrer:null,dialogHeight:0,screenWidth:0,validatingStep:-1,flowType:null,shownInlineNUX:!1,sourceID:null,eventDialogContext:{}}));g&&g.prototype;function j(){g.apply(this,arguments)}h=babelHelpers.inherits(a,b("FluxReduceStore"));h&&h.prototype;a.prototype.getInitialState=function(){return new j()};a.prototype.reduce=function(a,b){__p&&__p();switch(b.type){case"init/effectData":a=a.set("validatingStep",-1);break;case"change/step":a=a.set("currentStep",b.step);break;case"form/validate":a=a.set("validatingStep",b.step);break;case"init/dialog":a=new j({creationReferrer:b.creationReferrer,flowType:b.flowType,sourceID:b.sourceID});break;case"init/eventDialog":a=a.set("eventDialogContext",b.dialogContext);break;case"set/screenDimensions":a=a.set("screenWidth",b.screenWidth).set("dialogHeight",b.dialogHeight);break;case"inlineNUX/enterCreationFlow":a=a.set("shownInlineNUX",!0);break}return a};a.prototype.isTemplateFlow=function(){return this.getState().flowType===b("MediaEffectFlowType").TEMPLATE};a.prototype.getCreationFlowType=function(){return this.getState().flowType};a.prototype.isValidating=function(){var a=this.getState();a=b("MediaEffectFrameCreationStepsConfig").getStep(a.flowType,a.validatingStep);return a!==i.NONE};function a(){h.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("MediaEffectFrameEditorDispatcher"))}),null);
__d("MediaEffectProfilePolicy",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SELF_LOCATION_ONLY:"self_location_only",LOCATION_PROHIBITED:"location_prohibited",USE_TRAILING_REVIEW:"use_trailing_review"})}),null);
__d("MediaEffectFrameCreationReview.react",["cx","fbt","Link.react","MediaEffectProfilePolicy","MediaEffectReviewStepConfig","React","XUIText.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){var a=!!this.props.owner&&this.props.owner.policies.includes(b("MediaEffectProfilePolicy").USE_TRAILING_REVIEW);a=a?h._("\"Publish\""):h._("\"Submit\"");a=b("React").createElement("div",{className:"_2pio _3s-b"},b("React").createElement(b("XUIText.react"),{weight:"normal"},h._("By clicking {button_name} you agree to the Camera Effects Platform {terms} and {policies} Effects are public for anyone to use.",[h._param("button_name",a),h._param("terms",b("React").createElement(b("Link.react"),{href:"/legal/camera_effects_platform_terms",target:"_blank"},h._("terms"))),h._param("policies",b("React").createElement(b("Link.react"),{href:"/legal/camera_effects_platform_policies",target:"_blank"},h._("policies.")))])));return b("React").createElement("div",{className:"_1d1n"},b("MediaEffectReviewStepConfig")[this.props.flowType].map(function(a,c){return b("React").createElement(a,babelHelpers["extends"]({},this.props,{key:c}))}.bind(this)),a)};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectFrameEditorConstants",[],(function(a,b,c,d,e,f){"use strict";a={EDITOR_BUFFER_SIZE:35,PORTRAIT_CANVAS_RATIO:9/16,PHONE_SCREEN_TO_FRAME_WIDTH_RATIO:1094/1216,PHONE_SCREEN_TO_FRAME_HEIGHT_RATIO:1956/2458};e.exports=a}),null);
__d("MediaEffectFullscreenFrameEditorSizingUtils",["MediaEffectFrameEditorConstants"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MediaEffectFrameEditorConstants").EDITOR_BUFFER_SIZE,h=212,i=12,j=60,k=60,l=12,m=40,n=200,o=4,p=40,q=70,r=12,s=50;a={getDialogWidth:function(a,b){return Math.max(l+h+g+i+this.getCanvasSize(a,b)+i+g+o+this.getPortraitPreviewHeight(a,b)+o+l)},getCanvasSize:function(a,b){return Math.max(0,Math.min(a-(m+h+g+i+i+g+n+m)-1,b-(2*g+p+j+k)-1))},getPortraitPreviewHeight:function(a,b){return Math.max(n,Math.min(a-(m+h+g+i+this.getCanvasSize(a,b)+i+g+m),this.getCanvasSize(a,b)/3))},getPortraitFullPreviewHeight:function(a,b){return Math.max(0,Math.min(b-96,3*this.getPortraitPreviewHeight(a,b)))},getSquareReviewPreviewWidth:function(a,b){var c=1+1.1325+1.2849*16/9+.25,d=120;a=(a-d)/c;d=b-(r+q+s+p+j+k);return Math.min(9*(d*.7694174757281553)/16,a)}};e.exports=a}),null);
__d("MediaEffectThumbnail.react",["Image.react","React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.prototype.render=function(){return b("React").createElement(b("Image.react"),this.props)};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectMaskPreview.react",["cx","fbt","MediaEffectThumbnail.react","React","XUIText.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(a,b){i.constructor.call(this,a,b)}a.prototype.render=function(){var a=this.props,c=a.cameraIconSrc;a=a.showTitles;return b("React").createElement("div",null,c?b("React").createElement("div",null,a?b("React").createElement(b("XUIText.react"),{className:"_2dih",display:"block"},h._("Effect Icon")):null,b("React").createElement(b("MediaEffectThumbnail.react"),{height:72,src:c,width:72})):null)};e.exports=a}),null);
__d("MediaEffectARStudioEffectArfxFileTypes",[],(function(a,b,c,d,e,f){"use strict";a=["@uncompressed.arfx","@pvr.arfx","@etc.arfx"];e.exports=a}),null);
__d("MediaEffectCard.react",["cx","React","Tooltip.react","XUICard.react","XUICardHeader.react","XUICardHeaderTitle.react","XUICardSection.react","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(a){h.constructor.call(this,a)}a.prototype.render=function(){var a="_-jo",c=null;if(!this.props.hideHeader){var d=this.props.tooltip?b("React").createElement(b("Tooltip.react"),{className:"_3-99",tooltip:this.props.tooltip},b("React").createElement("span",{className:"_3o-c"})):null;c=b("React").createElement(b("XUICardHeaderTitle.react"),null,this.props.title,d)}return b("React").createElement(b("XUICard.react"),{className:b("joinClasses")(a,this.props.className),style:{border:"none"}},b("React").createElement(b("XUICardHeader.react"),{className:"_-jp",type:"primary"},c),b("React").createElement(b("XUICardSection.react"),{background:"transparent",className:b("joinClasses")("_-jq _190n",this.props.sectionClassName),style:{borderTop:"none"}},this.props.children))};e.exports=a}),null);
__d("ProfileInfoAddImage.react",["ix","cx","xuiglyph","Image.react","React","joinClasses"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j;c=b("React").PropTypes;j=babelHelpers.inherits(a,b("React").Component);j&&j.prototype;a.prototype.render=function(){"use strict";return b("React").createElement("div",{className:b("joinClasses")(this.props.className,"_u08"+(this.props.size==="medium"?" _518l":""))},b("React").createElement(b("Image.react"),{className:"_u09",src:g("89665")}))};function a(){"use strict";j.apply(this,arguments)}a.propTypes={size:c.oneOf(["medium","large"])};a.defaultProps={size:"large"};e.exports=a}),null);
__d("MediaEffectMaskFileSelect.react",["cssVar","cx","fbt","CenteredContainer.react","FileInput.react","Layout.react","ProfileInfoAddImage.react","React","SUIBusinessTheme","SUILink.react","XUIError.react","XUIGrayText.react","XUIText.react","joinClasses"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("Layout.react").Column,l=b("Layout.react").FillColumn,m=function(a){var c=a.className,d=a.text;a=babelHelpers.objectWithoutProperties(a,["className","text"]);return b("React").createElement("div",{className:b("joinClasses")(c,"_2pid")},b("React").createElement(b("FileInput.react"),a,b("React").createElement(b("SUILink.react"),{showUnderline:"never",theme:b("SUIBusinessTheme")},b("React").createElement(b("Layout.react"),null,b("React").createElement(k,{className:"_3-92"},b("React").createElement(b("ProfileInfoAddImage.react"),null)),b("React").createElement(l,{style:{height:"36px"}},b("React").createElement(b("CenteredContainer.react"),{fullHeight:!0,horizontal:!1,vertical:!0},b("React").createElement(b("XUIText.react"),{display:"block",size:"body1",style:{color:"#4080ff"}},d)))))))},n=function(a){var c=a.className,d=a.disabled,e=a.files,f=a.expectFiles,g=a.preview,h=a.progress;a=babelHelpers.objectWithoutProperties(a,["className","disabled","files","expectFiles","preview","progress"]);var j=i._("Upload More Files");e.length===f&&(j=f>1?i._("Update Files"):i._("Update"));f=e[0].src;return b("React").createElement("div",{className:b("joinClasses")(c,"_2pid")},h,b("React").createElement(b("Layout.react"),null,b("React").createElement(k,{className:"_3-92"},g),b("React").createElement(l,{style:{minHeight:"36px"}},b("React").createElement("div",null,e.map(function(a){return b("React").createElement(b("XUIText.react"),{display:"block",key:a.name},b("React").createElement(b("XUIGrayText.react"),{shade:"dark",size:"body1"},a.name))})),b("React").createElement(b("Layout.react"),null,d?null:b("React").createElement(k,{className:"_3-92"},b("React").createElement(b("FileInput.react"),a,b("React").createElement("a",{href:"#"},b("React").createElement(b("XUIText.react"),{display:"block",size:"body1",style:{color:"#4080ff"}},j)))),f?b("React").createElement(l,null,b("React").createElement("a",{download:!0,href:f,target:"_blank"},b("React").createElement(b("XUIText.react"),{display:"block",size:"body1",style:{color:"#4080ff"}},i._("Download")))):null))))};j=babelHelpers.inherits(a,b("React").PureComponent);j&&j.prototype;a.prototype.render=function(){var a=this.props,c=a.disabled,d=a.expectFiles,e=a.error,f=a.files,g=a.preview,h=a.progress,i=a.text;a=babelHelpers.objectWithoutProperties(a,["disabled","expectFiles","error","files","preview","progress","text"]);return b("React").createElement(b("XUIError.react"),{xuiError:e},f.length===0?b("React").createElement(m,babelHelpers["extends"]({disabled:c,text:i},a)):b("React").createElement(n,babelHelpers["extends"]({disabled:c,expectFiles:d,files:f,preview:g,progress:h},a)))};function a(){j.apply(this,arguments)}e.exports=a}),null);
__d("XMediaEffectARFXValidateController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/effects/arfx/validate/",{})}),null);
__d("mediaEffectGKCheck",["MediaEffectGKConfig","invariant"],(function(a,b,c,d,e,f){"use strict";var g=b("MediaEffectGKConfig").gk_results;function a(a){return!!g[a]}e.exports=a}),null);
__d("MediaEffectMaskProjectFileUpload.react",["cx","fbt","AsyncUploadRequest","Image.react","MediaEffectCard.react","MediaEffectFrameEditorDispatcher","MediaEffectMaskFileSelect.react","React","XMediaEffectARFXValidateController","XUIText.react","mediaEffectGKCheck"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;a.supportsPackagedProjectUpload=function(){return b("mediaEffectGKCheck")("cep_arprojpkg_upload")};a.supportsArexportProjectUpload=function(){return b("mediaEffectGKCheck")("media_effects_upload_form_arexport")};a.getSupportedFileExtensions=function(){if(this.supportsArexportProjectUpload())return[".fbfxproj",".arprojpkg",".arexport"];else if(this.supportsPackagedProjectUpload())return[".fbfxproj",".arprojpkg"];else return[".fbfxproj"]};a.isProjectFileValid=function(a){if(a===null||a===undefined)return!1;var b=a.name;return this.getSupportedFileExtensions().some(function(a){return b?b.endsWith(a):!1})};a.validateProjectFile=function(a){if(!this.isProjectFileValid(a))if(this.supportsArexportProjectUpload())return h._("Please upload a .arexport or .arprojpkg file to continue");else if(this.supportsPackagedProjectUpload())return h._("Please upload a .fbfxproj or .arprojpkg file to continue");else return h._("Please upload a .fbfxproj file to continue");return null};a.getUploadTitleTooltip=function(){if(this.supportsArexportProjectUpload())return h._("You can use either the .arexport file or the .arprojpkg file for your effect");else if(this.supportsPackagedProjectUpload())return h._("You can use either the .arprojpkg file or the .fbfxproj file for your effect");else return h._("AR Studio will export a .fbfxproj file when you save your project.")};a.getExplanatoryText=function(){if(this.supportsArexportProjectUpload())return h._("Upload the .arexport file that was created when you exported your effect. Files must be smaller than 10MB. For best results, please upload a file that's 2MB or smaller. Learn more");else if(this.supportsPackagedProjectUpload())return h._("Upload either the .arprojpkg file that was created when you exported your project in AR Studio or the .fbfxproj file that were created when you saved it.");else return h._("Upload the .fbfxproj file created when saving your effect in AR Studio.")};a.getUploadLabel=function(){if(this.supportsArexportProjectUpload())return h._("Upload .arexport or .arprojpkg file");else if(this.supportsPackagedProjectUpload())return h._("Upload project file");return h._("Upload .fbfxproj File")};function a(a,b){i.constructor.call(this,a,b),this.state={isFileSizeValid:!1,showFileSizeWarning:!1,isCheckingVersion:!1},this.updateProjectFile=function(event){var a=event.target.files;if(a.length===0)return;var b=a[0];if(!b.name.endsWith("arexport"))return;this.setState(function(){this.validateARExportFile(b)}.bind(this))}.bind(this)}a.prototype.getIconPath=function(){return"/images/media_effect/icon/arprojpkg-icon.png"};a.prototype.validateARExportFile=function(a){__p&&__p();b("MediaEffectFrameEditorDispatcher").dispatch({type:"projectFile/selected",payload:{file:a}});var c=b("XMediaEffectARFXValidateController").getURIBuilder().getURI();c=new(b("AsyncUploadRequest"))(c).setAllowCrossOrigin(!1).setFiles({arexport:[a]});var d=this,e=[c.subscribe("success",function(a,b){a=b.getResponse().payload;d.setState({isFileSizeValid:a.isFileSizeValid,showFileSizeWarning:a.showFileSizeWarning,isCheckingVersion:!1})}),c.subscribe("complete",function(a,b){while(e.length)e.pop().unsubscribe()})];d.setState({isCheckingVersion:!0});c.send()};a.prototype.getErrorMessage=function(){var a=this.props,b=a.projectFile;a=a.isValidating;var c=this.state,d=c.isFileSizeValid;c.showFileSizeWarning;c=c.isCheckingVersion;if(!a||c)return null;return!d?h._("Upload a file that's smaller than 10MB."):this.constructor.validateProjectFile(b)};a.prototype.render=function(){var a=this.props,c=a.projectFile;a=a.disabled;var d=this.state.isCheckingVersion;return b("React").createElement(b("MediaEffectCard.react"),{className:"_3vkg",title:h._("Effect File"),tooltip:this.constructor.getUploadTitleTooltip()},b("React").createElement(b("XUIText.react"),{display:"block"},this.constructor.getExplanatoryText()),b("React").createElement(b("MediaEffectMaskFileSelect.react"),{accept:this.constructor.getSupportedFileExtensions().join(","),disabled:a,error:this.getErrorMessage(),expectFiles:1,files:c?[c]:[],name:"project_file",onChange:this.updateProjectFile,preview:b("React").createElement(b("Image.react"),{height:40,src:d?"/images/tablet/spinner/spinner-large-bgLight.gif":"/images/media_effect/icon/arfx-icon.png",width:32}),text:this.constructor.getUploadLabel()}))};e.exports=a}),null);
__d("XMediaEffectScreencastUploadController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/ar_effect/screencast_upload/",{review_material_id:{type:"FBID"}})}),null);
__d("MediaEffectMaskScreencastUpload.react",["cx","fbt","ArbiterToken","AsyncUploadRequest","MediaEffectCard.react","MediaEffectFrameEditorDispatcher","MediaEffectMaskFileSelect.react","ProgressBar.react","React","XMediaEffectScreencastUploadController","XUIButton.react","XUINotice.react","XUIText.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={listeners:[],progress:0,uploadError:!1,uploading:!1,abort:null},this.updateScreencastFile=function(event){__p&&__p();if(!event.target.files||event.target.files.length===0)return;var a=event.target.files[0];this.setState({uploading:!0,progress:0,uploadError:!1});b("MediaEffectFrameEditorDispatcher").dispatch({type:"effectScreencastFile/selected",payload:{file:a,src:null,reviewMaterialID:this.props.reviewMaterialID}});var c=b("XMediaEffectScreencastUploadController").getURIBuilder().getURI(),d=this.props.reviewMaterialID,e=new(b("AsyncUploadRequest"))().setURI(c).setAllowCrossOrigin(!1).setData({review_material_id:d}).setFiles({screencast:a});c=[e.subscribe("progress",function(a,b){var event=b.getProgressEvent();this.setState({progress:parseInt(event.loaded/event.total*100,10)})}.bind(this)),e.subscribe("failure",function(a,b){this.setState({uploadError:!0})}.bind(this)),e.subscribe("success",function(c,d){this.setState({uploading:!1,progress:100});c=d.getResponse();d=c.payload;c=d.reviewMaterialID;d=d.screencastSrc;b("MediaEffectFrameEditorDispatcher").dispatch({type:"effectScreencastFile/selected",payload:{file:a,src:d,reviewMaterialID:c}});this.setState({uploadError:!1})}.bind(this)),e.subscribe("complete",function(a,b){this&&this.$1()})];this.setState({listeners:c,abort:function(){return e.abort()}});e.send()}.bind(this),this.abortUpload=function(){this.$1();var a=this.state.abort;a&&a();this.setState({listeners:[],progress:0,uploadError:!1,uploading:!1,abort:null});b("MediaEffectFrameEditorDispatcher").dispatch({type:"effectScreencastFile/selected",payload:{file:null,src:null,reviewMaterialID:this.props.reviewMaterialID}})}.bind(this),c}a.validateScreencastFile=function(a,b){a=a;if(!a||!a.name||!a.name.endsWith(".mov")||!a.name.endsWith(".mp4"))return b?null:h._("Please select a video file of type MP4 or MOV");return!b?h._("Please wait for the file to finish uploading"):null};a.prototype.componentWillUnmount=function(){this.$1()};a.prototype.$1=function(){var a=this.state.listeners;while(a.length)a.pop().unsubscribe()};a.prototype.getErrorMessage=function(){var a=this.props,b=a.screencastFile,c=a.screencastSrc;a=a.isValidating;return!a?null:this.constructor.validateScreencastFile(b,c)};a.prototype.render=function(){var a=this.props,c=a.screencastFile;a=a.screencastSrc;var d=this.state,e=d.uploadError,f=d.uploading;d=d.progress;var g=this.getErrorMessage(),i=null;f?i=b("React").createElement("div",null,b("React").createElement(b("ProgressBar.react"),{label:d+"%",typesetting:"float",value:d}),b("React").createElement(b("XUIButton.react"),{className:"_3-8w",label:h._("Cancel"),onClick:this.abortUpload})):a?i=b("React").createElement("video",{controls:!0,src:a,width:"320px"}):e&&(i=b("React").createElement(b("XUINotice.react"),{warn:h._("Upload Failed")}));return b("React").createElement(b("MediaEffectCard.react"),{className:"_3vkg",title:h._("Screencast")},b("React").createElement(b("XUIText.react"),{display:"block"},h._("Upload a video of someone using the effect for our reviewers. If the effect uses targets, include a clear and steady image of the target in the video for 5 seconds. Screencasts are only visible to reviewers. See Apple's instructions for {ar studio link}.",[h._param("ar studio link",b("React").createElement("a",{href:"https://support.apple.com/en-us/HT201066#screen",target:"_blank"},h._("using Quicktime to capture a screencast")))])),b("React").createElement(b("MediaEffectMaskFileSelect.react"),{accept:"video/*",disabled:f,error:g,expectFiles:1,files:c?[c]:[],name:"screencast",onChange:this.updateScreencastFile,preview:b("React").createElement("div",{style:{width:320}},i),text:h._("Upload Screencast")}))};e.exports=a}),null);
__d("MediaEffectMaskThumbnailUpload.react",["cx","fbt","Event","MediaEffectCard.react","MediaEffectFrameEditorDispatcher","MediaEffectMaskFileSelect.react","MediaEffectThumbnail.react","MediaEffectThumbnailValidationConfig","React","XUIText.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=[".png",".jpg",".jpeg"];i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.validateThumbnail=function(a,c,d){__p&&__p();if(!c)return h._("Please upload an effect icon to continue");var e=a;if(e&&e.name&&e.name.length>0&&!j.some(function(a){return e.name?e.name.endsWith(a):!1}))return h._("Please upload a PNG or JPG file to continue");if(d){c=d.width*d.height;if(d.width!==d.height||c>b("MediaEffectThumbnailValidationConfig").maxResolution){a=Math.trunc(Math.sqrt(b("MediaEffectThumbnailValidationConfig").maxResolution));return h._("Camera effect icons must be square ratios and no more than {max height of image} x {max width of image}px",[h._param("max height of image",a),h._param("max width of image",a)])}}return null};a.prototype.updateThumbnailFile=function(event){var a=event.target.files[0],c=new FileReader();b("Event").listen(c,"load",function(d){var e=new window.Image();e.onload=function(){b("MediaEffectFrameEditorDispatcher").dispatch({type:"effectThumbnailFile/selected",payload:{file:a,src:c.result,dimensions:{width:e.width,height:e.height}}})};e.src=c.result});c.readAsDataURL(a)};a.prototype.getErrorMessage=function(){var a=this.props,b=a.cameraIconDimensions,c=a.cameraIconFile,d=a.cameraIconSrc;a=a.isValidating;return!a?null:this.constructor.validateThumbnail(c,d,b)};a.prototype.render=function(){var a=this.props,c=a.cameraIconFile;a=a.cameraIconSrc;var d=this.getErrorMessage();return b("React").createElement(b("MediaEffectCard.react"),{className:"_3vkg",title:h._("Effect Icon"),tooltip:h._("Include an image thumbnail for your effect that will appear in the camera tray.")},b("React").createElement(b("XUIText.react"),{display:"block"},h._("Upload a square effect icon that's 400 x 400 pixels. {effect icon link} to get started.",[h._param("effect icon link",b("React").createElement("a",{href:"https://developers.facebook.com/docs/ar-studio/design/effect-icons",target:"_blank"},h._("Download the effect icon template")))])),b("React").createElement(b("MediaEffectMaskFileSelect.react"),{accept:".png,.jpg,.jpeg",error:d,expectFiles:1,files:c?[c]:[],name:"thumbnail_file",onChange:this.updateThumbnailFile,preview:a?b("React").createElement(b("MediaEffectThumbnail.react"),{height:36,src:a,width:36}):b("React").createElement("div",null),text:h._("Upload effect icon (jpg or png)")}))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectMaskUploadDataStore",["FluxReduceStore","immutable","MediaEffectARStudioEffectArfxFileTypes","MediaEffectFrameEditorDispatcher","MediaEffectMaskProjectFileUpload.react","MediaEffectMaskScreencastUpload.react","MediaEffectMaskThumbnailUpload.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h;c=b("immutable").Record;var i=b("immutable").Set;g=babelHelpers.inherits(j,c({projectFile:null,projectFileForUpload:null,arfxFiles:i(),arfxFilesForUpload:i(),userIsAgreed:!1,effectDescription:null,effectThumbnailFile:null,effectThumbnailFileForUpload:null,effectThumbnailSrc:null,effectThumbnailIsAutogenerated:!1,effectThumbnailDimensions:null,hasFrameDescriptionError:!1,screencastFile:null,screencastSrc:null,reviewMaterialID:null,immutable:!1,arStudioVersionDiscontinuationDates:{},currentARStudioVersions:[],previousVersions:[],isAutoupgraded:!1}));g&&g.prototype;function j(){g.apply(this,arguments)}h=babelHelpers.inherits(a,b("FluxReduceStore"));h&&h.prototype;a.prototype.getInitialState=function(){return new j()};a.prototype.reduce=function(a,b){__p&&__p();var c=void 0,d=void 0,e=void 0;switch(b.type){case"init/maskUploadData":var f=b.data;a=f?new j(f).set("arfxFiles",i(f.arfxFiles)):new j();break;case"projectFile/selected":c=b.payload.file;c&&(a=this.getState().set("projectFileForUpload",c).set("projectFile",{name:c.name}),c.name.endsWith(".arexport")&&(a=a.set("arfxFiles",i()).set("arfxFilesForUpload",i())));break;case"arfxFile/selected":c=b.payload.file;var g=b.payload.type;a=this.getState();f=a.get("arfxFilesForUpload");f=f.remove(f.find(function(a){return a.name.endsWith(g)})).add(c);var h=a.get("arfxFiles");h=h.remove(h.find(function(a){return a.name.endsWith(g)})).add({name:c.name});a=a.set("arfxFilesForUpload",f).set("arfxFiles",h);break;case"effectDescription/change":a=this.getState().set("effectDescription",b.payload.text);break;case"effectScreencastFile/selected":c=b.payload.file;e=b.payload.reviewMaterialID;d=b.payload.src;a=this.getState().set("reviewMaterialID",e).set("screencastFile",c?{name:c.name}:null).set("screencastSrc",d);break;case"effectThumbnailFile/selected":c=b.payload.file;d=b.payload.src;f=b.payload.dimensions;c&&(a=this.getState().set("effectThumbnailFileForUpload",c).set("effectThumbnailFile",{name:c.name}).set("effectThumbnailSrc",d).set("effectThumbnailIsAutogenerated",!1).set("effectThumbnailDimensions",f));break;case"legalAgreement/userIsAgreed":h=b.payload.userIsAgreed;a=this.getState().set("userIsAgreed",h);break;case"update/descriptionValidation":a=this.getState().set("hasFrameDescriptionError",b.isInvalid);break;case"uploadMethod/change":a=this.getState().set("uploadMethod",b.payload.uploadMethod);break;case"update/isAutoupgraded":a=this.getState().set("isAutoupgraded",b.payload.isAutoupgraded);break;default:return a}return a};a.prototype.getRequestFiles=function(){var a=this.getState();return{effect_review_material_id:a.get("reviewMaterialID"),thumbnail_file:a.get("effectThumbnailFileForUpload"),project_file:a.get("projectFileForUpload"),mask_files:a.get("arfxFilesForUpload").toArray()}};a.prototype.getMinARStudioVersion=function(){var a=this.getState();a=a.currentARStudioVersions;return a.length?Math.min.apply(Math,a):0};a.prototype.getLatestARStudioVersion=function(){var a=this.getState();a=a.currentARStudioVersions;return a.length?Math.max.apply(Math,a):0};a.prototype.getVersionWillBeDiscontinued=function(){var a=this.getState();a=a.arStudioVersionDiscontinuationDates;return a&&a[this.getArfxTopVersion()]?!0:!1};a.prototype.getDiscontinuationDate=function(){var a=this.getState();a=a.arStudioVersionDiscontinuationDates;return a?a[this.getArfxTopVersion()]:null};a.prototype.getArfxTopVersion=function(){var a=this.getState();a=a.arfxFiles;a=a.map(function(a){return a.version&&Number(a.version)}).max();return a||0};a.prototype.isVersionOutOfDate=function(){var a=this.getArfxTopVersion(),b=this.getMinARStudioVersion();return!!a&&!!b&&a<b};a.prototype.isValidForSubmit=function(a){__p&&__p();var c=this.getState(),d=c.get("projectFile");if(b("MediaEffectMaskProjectFileUpload.react").validateProjectFile(d))return!1;if(!d.name.endsWith(".arexport")&&!this.validateArfxFiles(c.get("arfxFilesForUpload")))return!1;if(!a){if(b("MediaEffectMaskThumbnailUpload.react").validateThumbnail(c.get("effectThumbnailFile"),c.get("effectThumbnailSrc"),c.get("effectThumbnailDimensions")))return!1;if(!c.get("userIsAgreed"))return!1;d=this.getState().hasFrameDescriptionError;if(d)return!1;a=c.get("screencastFile");d=c.get("screencastSrc");if(b("MediaEffectMaskScreencastUpload.react").validateScreencastFile(a,d))return!1}return!0};a.prototype.validateArfxFiles=function(a){if(a.size===0)return!0;return a.size!==b("MediaEffectARStudioEffectArfxFileTypes").length?!1:b("MediaEffectARStudioEffectArfxFileTypes").every(function(b){return a.some(function(a){return a.name.endsWith(b)})})};function a(){h.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("MediaEffectFrameEditorDispatcher"))}),null);
__d("MediaEffectMaskPreviewContainer.react",["FluxContainer","MediaEffectMaskPreview.react","MediaEffectMaskUploadDataStore","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MediaEffectMaskUploadDataStore")]};a.calculateState=function(a){a=b("MediaEffectMaskUploadDataStore").getState();return{cameraIconSrc:a.get("effectThumbnailSrc")}};a.prototype.render=function(){var a=this.state.cameraIconSrc;return b("React").createElement(b("MediaEffectMaskPreview.react"),{cameraIconSrc:a,showTitles:this.props.showTitles})};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a)}),null);
__d("MediaEffectMetadataReviewItem.react",["cx","MediaEffectCard.react","React"],(function(a,b,c,d,e,f,g){"use strict";var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(a){h.constructor.call(this,a)}a.prototype.render=function(){return b("React").createElement(b("MediaEffectCard.react"),{className:this.props.className?this.props.className:"_3vkg",title:this.props.title},this.props.children)};e.exports=a}),null);
__d("FXMediaEffectType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({FRAME:"frame",GENERIC:"generic",MSQRD_MASK:"msqrd_mask",PARTICLE_EFFECT:"particle_effect",PROFILE_FRAME:"profile_frame",SHADER_FILTER:"shader_filter",STYLE_TRANSFER:"style_transfer",UNDERLAY:"underlay",WATERMARK:"watermark",PROFILE_OVERLAY_MASK_DEPRECATED:"profile_overlay_mask_DEPRECATED",TEST_MEDIA_EFFECT:"test_media_effect",FLT_TEST_MEDIA_EFFECT:"flt_test_media_effect"})}),null);
__d("MediaEffectHubStrings",["fbt","FXEntMediaEffectStatus","FXMediaEffectType"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=g._("Draft"),i=g._("Scheduled"),j=g._("Active"),k=g._("Inactive"),l=g._("Completed"),m=g._("Archived"),n=g._("Not Submitted"),o=g._("Approved"),p=g._("In Review"),q=g._("Not Approved"),r=g._("Updated Effect in Review"),s=g._("Updated Effect Not Approved");a=g._("Ongoing");var t=g._("Frame"),u=g._("Generic Effect"),v=g._("Mask"),w=g._("Reactive Effect"),x=g._("Profile Frame"),y=g._("Filter"),z=g._("Style Effect"),A=g._("Underlay");c={ongoing:a,getTextForEffectType:function(a){__p&&__p();switch(a){case b("FXMediaEffectType").FRAME:return t;case b("FXMediaEffectType").GENERIC:return u;case b("FXMediaEffectType").MSQRD_MASK:return v;case b("FXMediaEffectType").PARTICLE_EFFECT:return w;case b("FXMediaEffectType").PROFILE_FRAME:return x;case b("FXMediaEffectType").SHADER_FILTER:return y;case b("FXMediaEffectType").STYLE_TRANSFER:return z;case b("FXMediaEffectType").UNDERLAY:return A}return null},getTextForStatus:function(a){return this.getTextForMinorStatus(a)||this.getTextForMajorStatus(a)},getStatusText:function(a){__p&&__p();switch(a){case b("FXEntMediaEffectStatus").DRAFT:return h;case b("FXEntMediaEffectStatus").SCHEDULED:return i;case b("FXEntMediaEffectStatus").ACTIVE:return j;case b("FXEntMediaEffectStatus").INACTIVE:return k;case b("FXEntMediaEffectStatus").COMPLETED:return l;case b("FXEntMediaEffectStatus").ARCHIVED:return m;case b("FXEntMediaEffectStatus").NOT_REVIEWED:return n;case b("FXEntMediaEffectStatus").APPROVED:return o;case b("FXEntMediaEffectStatus").NOT_APPROVED:return q;case b("FXEntMediaEffectStatus").IN_REVIEW:return p;case b("FXEntMediaEffectStatus").UPDATE_REJECTED:return s;case b("FXEntMediaEffectStatus").UPDATE_IN_REVIEW:return r}return null}};e.exports=c}),null);
__d("MediaEffectLocationStrings",["fbt"],(function(a,b,c,d,e,f,g){"use strict";a={geoLocation:function(a,b){return g._("{open brace}{latitude}, {longitude}{close brace}",[g._param("open brace","("),g._param("latitude",a),g._param("longitude",b),g._param("close brace",")")])}};e.exports=a}),null);
__d("MediaEffectPlaceDescriptionRecord",["immutable"],(function(a,b,c,d,e,f){"use strict";var g;c=b("immutable").Record;g=babelHelpers.inherits(a,c({constrain_eligibility:!1,name:null,key:null,latitude:null,longitude:null,manual_geo:!1,polygons:null,radius:null}));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectLocationTargetingMap.react",["cx","fbt","AdsTargetingLocationInlineMap.react","AdsTargetingLocationMapRecord","FBOverlayBase.react","FBOverlayContainer.react","FBOverlayElement.react","GeoCoordinates","immutable","LocationConstants","MediaEffectLocationStrings","MediaEffectPlaceDescriptionRecord","React","Tooltip","XUIButton.react","XUIText.react","emptyFunction","idx"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$2=function(){var a=this.props.onManualLocationToggled||b("emptyFunction");a(!((a=this.props.location)!=null?a.manual_geo:a))}.bind(this),c}a.prototype.$1=function(a){if(!a||!a.latitude||!a.longitude)return null;var c=a.name||b("MediaEffectLocationStrings").geoLocation(a.latitude,a.longitude).toString();if(a.polygons&&a.polygons.length&&!a.manual_geo)return{latitude:a.latitude,longitude:a.longitude,name:c,polygons:a.polygons};return a.radius?{distance_unit:b("LocationConstants").KILOMETER_UNIT,latitude:a.latitude,longitude:a.longitude,name:c,radius:a.radius}:null};a.prototype.render=function(){var a=this.$1(this.props.location),c=b("immutable").Set().asMutable();if(a){a=b("AdsTargetingLocationMapRecord").fromGeoLocation(a).set("popup",b("React").createElement(b("XUIText.react"),null,a.name));c.add(a)}a=c.asImmutable();c=((c=this.props.location)!=null?c.manual_geo:c)?{text:h._("Default"),tooltip:h._("Switch to the default area where your effect can be discovered.")}:{text:h._("Custom"),tooltip:h._("Customize the area where your effect can be discovered.")};return b("React").createElement(b("FBOverlayContainer.react"),null,b("React").createElement(b("FBOverlayBase.react"),null,b("React").createElement("div",{className:this.props.className},b("React").createElement(b("AdsTargetingLocationInlineMap.react"),{addLocationMode:b("LocationConstants").INCLUDE,disableCollapseButton:!0,enableDropPin:!this.props.disabled&&!this.props.isLoading,excludedLocations:b("immutable").Set(),fitLocations:a,highlightLocations:b("immutable").Set(),locations:a,onAddLocationFromMap:this.props.onLocationSelected||b("emptyFunction"),onCollapseMap:b("emptyFunction"),onPopupMenuItemSelect:b("emptyFunction"),onlyInclusion:!0}))),((a=this.props.location)!=null?a.polygons:a)&&!this.props.disabled?b("React").createElement(b("FBOverlayElement.react"),{horizontal:"left",vertical:"top"},b("React").createElement(b("XUIButton.react"),babelHelpers["extends"]({className:"_mvk",label:c.text,onClick:this.$2,type:"button"},b("Tooltip").propsFor(c.tooltip)))):null)};e.exports=a}),null);
__d("SUIMediaEffectTheme",["cssVar","SUIBusinessTheme","SUITheme","SUITypeStyle"],(function(a,b,c,d,e,f,g){"use strict";a={white:"#FFFFFF",blue:"#4080ff",gray:"#bec2c9"};c={SUIToggle:{height:20,off:{hover:{backgroundColor:a.gray,color:a.white},normal:{backgroundColor:a.gray,color:a.white}},on:{hover:{backgroundColor:a.blue,color:a.white},normal:{backgroundColor:a.blue,color:a.white}},switchColor:a.white,typeStyle:new(b("SUITypeStyle"))({color:a.white,fontFamily:"Helvetica, Arial, sans-serif",fontSize:"12px",fontWeight:"700"})}};d=new(b("SUITheme"))({id:"mediaEffect",components:babelHelpers["extends"]({},b("SUIBusinessTheme"),c)});e.exports=d}),null);
__d("MediaEffectReviewMetadataSection.react",["cx","fbt","AdsTargetingAggregatedMap.react","AdsTargetingLocationMapRecord","FBCollapsibleList.react","LocationConstants","MediaEffectFlowType","MediaEffectHubStrings","MediaEffectLocationTargetingMap.react","React","SUIMediaEffectTheme","SUIText.react","SUIThemeContainer.react","XUIText.react","formatDate","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("FBCollapsibleList.react").Delimiters,k=200;function l(a){var c=b("joinClasses")(a.className,"_1d1k");return b("React").createElement("div",{className:c},b("React").createElement("div",{className:"_1d1h"},b("React").createElement(b("XUIText.react"),{weight:"bold"},a.title)),a.children)}c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(a){i.constructor.call(this,a)}a.prototype.getNone=function(){return h._("None")};a.prototype.getDateString=function(){var a=this.props,c=a.startTime;a=a.endTime;var d;!c?d=b("MediaEffectHubStrings").ongoing:d=h._("{start date} \u2014 {end date}",[h._param("start date",b("formatDate")(c,"M j, Y")),h._param("end date",a?b("formatDate")(a,"M j, Y"):b("MediaEffectHubStrings").ongoing)]);return d};a.prototype.getLocation=function(){var a;return this.props.location?b("React").createElement(b("MediaEffectLocationTargetingMap.react"),{className:"_10ev",disabled:!0,location:this.props.location}):this.props.placeDescription?b("React").createElement(b("AdsTargetingAggregatedMap.react"),{height:k,locationRecords:b("AdsTargetingLocationMapRecord").fromGeoLocations((a={},a[b("LocationConstants").CUSTOM_LOCATIONS]=[this.props.placeDescription],a))}):b("React").createElement(b("XUIText.react"),null,h._("Any location"))};a.prototype.getKeywords=function(){var a=b("React").createElement(b("FBCollapsibleList.react"),{delimiter:j.COMMA,display:"inline",numVisible:3,showLessLink:!0},this.props.tags.length>0?this.props.tags.map(function(a,c){return b("React").createElement(b("XUIText.react"),{key:c},a.title)}):[b("React").createElement(b("XUIText.react"),{key:"none"},this.getNone())]);return a};a.prototype.render=function(){__p&&__p();var a=this.getDateString(),c=b("React").createElement(l,{title:h._("Location")},this.getLocation());this.props.flowType===b("MediaEffectFlowType").MASK&&!this.props.canThirdPartyMaskLocation&&(c=null);var d=null;if(this.props.flowType===b("MediaEffectFlowType").MASK){var e=this.props.arfxFiles.map(function(a,c){return b("React").createElement("div",{key:c+1},b("React").createElement(b("SUIText.react"),{display:"truncate",size:"meta1"},a.name))}),f=this.props.projectFile;f&&e.unshift(b("React").createElement("div",{key:0},b("React").createElement(b("SUIText.react"),{display:"truncate",size:"meta1"},f.name)));d=b("React").createElement(b("SUIThemeContainer.react"),{theme:b("SUIMediaEffectTheme")},b("React").createElement(l,{className:"_hyk",title:h._("Files Uploaded")},e))}return b("React").createElement("div",{className:"_1d1l"},b("React").createElement("div",{className:"_1d1m"},b("React").createElement(l,{title:h._("Schedule")},b("React").createElement(b("XUIText.react"),{display:"block"},a||this.getNone())),c,d,b("React").createElement(l,{title:h._("Keywords")},this.getKeywords())))};e.exports=a}),null);
__d("MediaEffectReviewMaskContainer.react",["cx","fbt","ImageCore.react","MediaEffectMetadataReviewItem.react","MediaEffectReviewMetadataSection.react","React","XUICard.react","XUIText.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("MediaEffectReviewMetadataSection.react"));i=c&&c.prototype;function a(a){i.constructor.call(this,a)}a.prototype.$MediaEffectReviewMaskContainer1=function(a,c){var d=arguments.length<=2||arguments[2]===undefined?"":arguments[2];return b("React").createElement(b("MediaEffectMetadataReviewItem.react"),{className:d,title:a},c)};a.prototype.$MediaEffectReviewMaskContainer2=function(a,c){return this.$MediaEffectReviewMaskContainer1(a,b("React").createElement(b("XUIText.react"),{display:"block"},c))};a.prototype.$MediaEffectReviewMaskContainer3=function(a,c){return this.$MediaEffectReviewMaskContainer1(a,b("React").createElement(b("XUIText.react"),{display:"block"},c))};a.prototype.$MediaEffectReviewMaskContainer4=function(){var a=this.props.arfxFiles.map(function(a){return a.name}).sort(function(a,b){return a>b?1:a<b?-1:0});this.props.projectFile&&a.unshift(this.props.projectFile.name);return b("React").createElement("div",null,a.map(function(a,c){return b("React").createElement(b("XUIText.react"),{display:"block",key:c},a)}))};a.prototype.$MediaEffectReviewMaskContainer5=function(a){var c=this.props,d=c.app;c=c.owner;var e=b("React").createElement(b("XUIText.react"),{display:"block"},this.getNone()),f="";c=c&&(c.isFirstParty||c.type==="page");if(!c)return null;d&&(e=[b("React").createElement(b("ImageCore.react"),{className:"_5hh3",key:"app_img",src:d.src}),b("React").createElement(b("XUIText.react"),{className:"_3ax0",display:"inline",key:"app_name"},d.name)],f="_3ax1");return this.$MediaEffectReviewMaskContainer1(a,e,f)};a.prototype.render=function(){return b("React").createElement("div",{className:"_2041 _190n"},b("React").createElement(b("XUIText.react"),{className:"_3os1",display:"block"},h._("Effect summary")),b("React").createElement(b("XUICard.react"),{className:"_2o1j"},this.$MediaEffectReviewMaskContainer3(h._("Name"),this.props.frameName),b("React").createElement("div",{className:"_204i"}),this.$MediaEffectReviewMaskContainer3(h._("Description"),this.props.description),this.$MediaEffectReviewMaskContainer1(h._("Effect file"),this.$MediaEffectReviewMaskContainer4()),b("React").createElement("div",{className:"_204i"}),this.$MediaEffectReviewMaskContainer5(h._("Connected app")),this.$MediaEffectReviewMaskContainer1(h._("Location"),this.getLocation()),this.$MediaEffectReviewMaskContainer2(h._("Schedule"),this.getDateString()||this.getNone()),b("React").createElement("div",{className:"_204i"}),this.$MediaEffectReviewMaskContainer1(h._("Keywords"),this.getKeywords())))};e.exports=a}),null);
__d("MediaEffectFrameCreationReviewContainer.react",["cx","FluxContainer","MediaEffectFlowType","MediaEffectFrameCreateDialogDataStore","MediaEffectFrameCreationReview.react","MediaEffectFrameEditorDispatcher","MediaEffectFullscreenFrameEditorSizingUtils","MediaEffectMaskPreviewContainer.react","MediaEffectMaskUploadDataStore","MediaEffectMetadataStore","MediaEffectMetadataViewStore","MediaEffectReviewMaskContainer.react","React","mediaEffectGKCheck"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;a.getStores=function(){return[b("MediaEffectMetadataStore"),b("MediaEffectMetadataViewStore"),b("MediaEffectFrameCreateDialogDataStore"),b("MediaEffectMaskUploadDataStore")]};a.calculateState=function(){var a=b("MediaEffectMetadataStore").getState(),c=a.get("selectedOwnerID"),d=b("MediaEffectFrameCreateDialogDataStore").getState(),e=d.screenWidth;d=d.dialogHeight;e=b("MediaEffectFullscreenFrameEditorSizingUtils").getDialogWidth(e,d);var f=b("MediaEffectMaskUploadDataStore").getState();return{name:a.get("name"),effectDescription:f.get("effectDescription"),selectedOwner:b("MediaEffectMetadataViewStore").getOwner(c),tags:a.get("tags"),startTime:a.startTime,endTime:a.endTime,location:a.location,placeDescription:a.placeDescription,dialogWidth:e,dialogHeight:d,arfxFiles:f.get("arfxFiles").toArray(),projectFile:f.get("projectFile"),effectThumbnailFile:f.get("effectThumbnailFile"),thumbnailSrc:f.get("effectThumbnailSrc"),selectedAppID:a.get("connectAppID")}};function a(a){h.constructor.call(this,a)}a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.constructor.getStores())};a.prototype.render=function(){if(this.props.flowType===b("MediaEffectFlowType").MASK&&b("mediaEffectGKCheck")("media_effects_upload_form_arexport")){var a=this.props.appsData.filter(function(a){return a.id===this.state.selectedAppID}.bind(this))[0];return b("React").createElement("div",{className:"_2i5k"},b("React").createElement("div",{className:"_2i5l"},b("React").createElement(b("MediaEffectReviewMaskContainer.react"),{app:a,arfxFiles:this.state.arfxFiles,canThirdPartyMaskLocation:this.props.canThirdPartyMaskLocation,description:this.state.effectDescription,dialogHeight:this.state.dialogHeight,dialogWidth:this.state.dialogWidth,effectThumbnailFile:this.state.effectThumbnailFile,endTime:this.state.endTime,flowType:this.props.flowType,frameName:this.state.name,location:this.state.location,owner:this.state.selectedOwner,placeDescription:this.state.placeDescription,projectFile:this.state.projectFile,startTime:this.state.startTime,tags:this.state.tags,thumbnailImageSrc:this.state.thumbnailSrc})),b("React").createElement(b("MediaEffectMaskPreviewContainer.react"),{showTitles:!0}))}else return b("React").createElement(b("MediaEffectFrameCreationReview.react"),{arfxFiles:this.state.arfxFiles,canThirdPartyMaskLocation:this.props.canThirdPartyMaskLocation,dialogHeight:this.state.dialogHeight,dialogWidth:this.state.dialogWidth,effectThumbnailFile:this.state.effectThumbnailFile,endTime:this.state.endTime,flowType:this.props.flowType,frameName:this.state.name,location:this.state.location,owner:this.state.selectedOwner,placeDescription:this.state.placeDescription,projectFile:this.state.projectFile,startTime:this.state.startTime,tags:this.state.tags,thumbnailImageSrc:this.state.thumbnailSrc})};e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MediaEffectFrameCreationStepsConfig",["fbt","invariant","immutable","MediaEffectEditingStep.react","MediaEffectFlowType","MediaEffectFrameCreationReviewContainer.react","MediaEffectMaskFileUploadStep.react","MediaEffectTargetingStep.react","MediaEffectTemplateColorStepContainer.react","MediaEffectTemplateNewColorStepContainer.react","MediaEffectTemplateVariationStepContainer.react","keyMirror","mediaEffectGKCheck"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("keyMirror")({NONE:"",COLORS:"",EDITING:"",MASK_UPLOAD:"",NEW_COLORS:"",TARGETING:"",REVIEW:"",VARIATIONS:""}),j=(d={},d[b("MediaEffectFlowType").BASIC_HUB]=[i.EDITING,i.TARGETING,i.REVIEW],d[b("MediaEffectFlowType").INTERNAL_TOOL]=[i.TARGETING],d[b("MediaEffectFlowType").MASK]=[i.MASK_UPLOAD,i.TARGETING,i.REVIEW],d[b("MediaEffectFlowType").TEMPLATE]=b("mediaEffectGKCheck")("media_effect_frame_editor_template_variations")?[i.EDITING,i.COLORS,i.NEW_COLORS,i.VARIATIONS,i.TARGETING,i.REVIEW]:[i.EDITING,i.TARGETING,i.REVIEW],d[b("MediaEffectFlowType").EVENT]=[i.EDITING,i.REVIEW],d[b("MediaEffectFlowType").BIRTHDAY]=[i.EDITING,i.REVIEW],d[b("MediaEffectFlowType").LIVE_TEMPLATE]=[i.EDITING],d[b("MediaEffectFlowType").INSTAGRAM_STICKER]=[i.EDITING,i.TARGETING,i.REVIEW],d);d=(f={},f[i.EDITING]={component:b("MediaEffectEditingStep.react"),label:g._("Design")},f[i.COLORS]={component:b("MediaEffectTemplateColorStepContainer.react"),label:g._("Source Palette")},f[i.NEW_COLORS]={component:b("MediaEffectTemplateNewColorStepContainer.react"),label:g._("Destination Palette")},f[i.VARIATIONS]={component:b("MediaEffectTemplateVariationStepContainer.react"),label:g._("Variations")},f[i.MASK_UPLOAD]={component:b("MediaEffectMaskFileUploadStep.react"),label:g._("Upload")},f[i.TARGETING]={component:b("MediaEffectTargetingStep.react"),label:g._("Details")},f[i.REVIEW]={component:b("MediaEffectFrameCreationReviewContainer.react"),label:g._("Review")},f);function a(a,b){a=k(a).indexOf(b);a>=0||h(0);return a}function c(a,b){return b>=0?k(a).get(b):i.NONE}function k(a){return b("immutable").List(j[a])}e.exports={ComponentConfigs:d,CreationSteps:i,getStepIndex:a,getSteps:k,StepsConfigs:j,getStep:c}}),null);
__d("MediaEffectReviewPreviewSection.react",["cx","MediaEffectFramePhonePreviewContainer.react","MediaEffectFullscreenFrameEditorSizingUtils","MediaEffectOwnerByline.react","MediaEffectQEUtils","MediaEffectReactFrameEditorPreviewCanvasContainer.react","React","XUIText.react"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var c=b("MediaEffectFullscreenFrameEditorSizingUtils").getSquareReviewPreviewWidth(a.dialogWidth,a.dialogHeight),d=16*c/9;return b("React").createElement("div",{className:"_2pio",style:{position:"relative"}},b("React").createElement("div",{style:{position:"absolute",width:"100%",height:"100%"}},b("React").createElement("div",{className:"_1ouw"},b("React").createElement(b("XUIText.react"),{className:"_1d1g",title:a.frameName},a.frameName)),a.owner?b("React").createElement(b("MediaEffectOwnerByline.react"),{owner:a.owner}):null),b("React").createElement("div",{className:"_3s-9"},b("React").createElement("div",{className:"_5gzu _fh0 _3-98"},b("React").createElement(b("MediaEffectReactFrameEditorPreviewCanvasContainer.react"),{previewHeight:c,previewWidth:c})),b("React").createElement("div",{className:"_fh0"},b("React").createElement(b("MediaEffectFramePhonePreviewContainer.react"),{previewHeight:c,previewWidth:d})),b("React").createElement("div",{className:"_fh0"},b("React").createElement(b("MediaEffectFramePhonePreviewContainer.react"),{previewHeight:d,previewWidth:c}))))};e.exports=a}),null);
__d("MediaEffectReviewMaskPreviewSection.react",["cx","Image.react","MediaEffectThumbnail.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.getSquircleIcon=function(){var a=this.props.thumbnailImageSrc;return!a?null:b("React").createElement(b("MediaEffectThumbnail.react"),{className:"_4bmc _3-92",height:72,src:a,width:72})};a.prototype.getOwnerBlock=function(){var a=this.props.owner;return!a?null:b("React").createElement("div",null,b("React").createElement(b("Image.react"),{className:"_4bmc _3-90",src:a.src}),a.name)};a.prototype.render=function(){return b("React").createElement("div",{className:"_4bmd"},b("React").createElement("div",null,this.getSquircleIcon(),b("React").createElement("div",{className:"_4bme"},b("React").createElement("span",{className:"_4bmf"},this.props.frameName),this.getOwnerBlock())))};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectReviewStepConfig",["MediaEffectFlowType","MediaEffectReviewMaskPreviewSection.react","MediaEffectReviewMetadataSection.react","MediaEffectReviewPreviewSection.react"],(function(a,b,c,d,e,f){"use strict";c=(a={},a[b("MediaEffectFlowType").BASIC_HUB]=[b("MediaEffectReviewPreviewSection.react"),b("MediaEffectReviewMetadataSection.react")],a[b("MediaEffectFlowType").TEMPLATE]=[b("MediaEffectReviewPreviewSection.react"),b("MediaEffectReviewMetadataSection.react")],a[b("MediaEffectFlowType").EVENT]=[b("MediaEffectReviewPreviewSection.react")],a[b("MediaEffectFlowType").BIRTHDAY]=[b("MediaEffectReviewPreviewSection.react")],a[b("MediaEffectFlowType").MASK]=[b("MediaEffectReviewMaskPreviewSection.react"),b("MediaEffectReviewMetadataSection.react")],a[b("MediaEffectFlowType").INSTAGRAM_STICKER]=[b("MediaEffectReviewPreviewSection.react"),b("MediaEffectReviewMetadataSection.react")],a);e.exports=c}),null);
__d("MediaEffectTargetingFramePreview.react",["cx","fbt","MediaEffectQEUtils","MediaEffectReactFrameEditorPreviewContainer.react","React","Vector","XUIText.react"],(function(a,b,c,d,e,f,g,h){"use strict";var i;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){return b("React").createElement("div",null,b("React").createElement(b("XUIText.react"),{className:"_2dih",display:"block"},h._("Preview")),b("React").createElement(b("MediaEffectReactFrameEditorPreviewContainer.react"),{previewScale:.3,previewSize:new(b("Vector"))(400,625)}),b("React").createElement("div",{className:"_3-8x"},b("React").createElement(b("MediaEffectReactFrameEditorPreviewContainer.react"),{previewScale:.3,previewSize:new(b("Vector"))(400,400)})),b("React").createElement("div",{className:"_3-8x"},b("React").createElement(b("MediaEffectReactFrameEditorPreviewContainer.react"),{previewScale:.3,previewSize:new(b("Vector"))(625,400)})))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectTargetingStep.react",["cx","MediaEffectFlowType","MediaEffectMaskPreviewContainer.react","MediaEffectMetadataContainer.react","MediaEffectTargetingFramePreview.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){var a=this.props,c=a.context,d=a.bootstrapData;a=a.flowType;return b("React").createElement("div",{className:"_2i5k"},b("React").createElement("div",{className:"_2i5l"},b("React").createElement(b("MediaEffectMetadataContainer.react"),{bootstrapData:d,canThirdPartyUpdateThumbnail:!1,context:{allowLocationFrameCreation:c.allowLocationFrameCreation,explainFBOnly:c.explainFBOnly,includesFBOnly:c.includesFBOnly,canThirdPartyMaskLocation:c.canThirdPartyMaskLocation},flowType:this.props.flowType})),a===b("MediaEffectFlowType").MASK?b("React").createElement(b("MediaEffectMaskPreviewContainer.react"),{showTitles:!0}):b("React").createElement(b("MediaEffectTargetingFramePreview.react"),null))};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("InspirationsCaptureMode",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({PRECAPTURE_PHOTO:"precapture_photo",POSTCAPTURE_PHOTO:"postcapture_photo",PRECAPTURE_VIDEO:"precapture_video",POSTCAPTURE_VIDEO:"postcapture_video",LIVE:"live",CARDS:"cards",DIRECT:"direct"})}),null);
__d("MediaEffectFirstPartySettingsCard.react",["cx","fbt","InputLabel.react","InspirationsCaptureMode","MediaEffectCaptureModeLabels","MediaEffectCard.react","MediaEffectMetadataActionCreators","React","XUICard.react","XUICheckboxInput.react","XUIText.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.$1=function(event){event.target.checked?b("MediaEffectMetadataActionCreators").addCaptureMode(event.target.value):b("MediaEffectMetadataActionCreators").removeCaptureMode(event.target.value)};a.prototype.render=function(){var a=this.props.effect,c=[];Object.keys(b("InspirationsCaptureMode")).forEach(function(d){c.push(b("React").createElement("div",{className:"_3-8w",key:d},b("React").createElement(b("InputLabel.react"),{label:b("MediaEffectCaptureModeLabels")[d]},b("React").createElement(b("XUICheckboxInput.react"),{defaultChecked:a!==null&&a!==undefined&&a.captureModes&&a.captureModes.includes(b("InspirationsCaptureMode")[d]),onChange:this.$1,value:b("InspirationsCaptureMode")[d]}))))}.bind(this));return b("React").createElement("div",{className:"_3or3"},b("React").createElement("div",{className:"_4s2u"},b("React").createElement(b("XUIText.react"),{className:"_3os1",display:"block"},h._("First-party only settings"))),b("React").createElement(b("XUICard.react"),{className:"_3os2"},b("React").createElement(b("MediaEffectCard.react"),{className:"_3os2",title:h._("Capture modes"),tooltip:""},c)))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectEventDataDispatcher",["GraphAPI","MediaEffectFrameEditorDispatcher","promiseDone"],(function(a,b,c,d,e,f){"use strict";a={loadEventData:function(a){b("promiseDone")(b("GraphAPI")("2.5").object("eventID",a).get({fields:"name, place{name, location{city}}, start_time, end_time"}).then(function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"event/getSuccess",event:a})}))}};e.exports=a}),null);
__d("MediaEffectEventDataStore",["FluxLoadObjectStore","MediaEffectEventDataDispatcher","MediaEffectFrameEditorDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("FluxLoadObjectStore"));g&&g.prototype;a.prototype.reduce=function(a,b){switch(b.type){case"event/getSuccess":return this.__handleOne(a,b.event.id,babelHelpers["extends"]({},b.event));default:return a}};a.prototype.__load=function(a){b("MediaEffectEventDataDispatcher").loadEventData(a)};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("MediaEffectFrameEditorDispatcher"))}),null);
__d("MediaEffectEventOwnerTile.react",["ix","cx","fbt","Image.react","ProfileTile.react","React","XUIText.react","fbglyph","formatDate","parseISODate"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;j=babelHelpers.inherits(a,b("React").PureComponent);j&&j.prototype;a.prototype.$1=function(a,c){var d="";a&&(d+=b("formatDate")(b("parseISODate")(a),"D M j"));c&&(d+=" - "+b("formatDate")(b("parseISODate")(c),"D M j"));return d};a.prototype.$2=function(a){var b="";a&&(b+=a.name,a.location&&(b+=", "+a.location.city));return b};a.prototype.render=function(){var a=this.props.event,c=a.start_time,d=a.end_time,e=a.place,f=a.name;a=a.id;c=this.$1(c,d);d=this.$2(e);e=b("React").createElement(b("Image.react"),{src:g("117711")});return this.props.style==="byline"?b("React").createElement("div",{className:"_5zsm"},b("React").createElement("div",{className:"_3rd0"},e),b("React").createElement("div",{className:"_5zsn"},b("React").createElement(b("XUIText.react"),{weight:"bold"},i._("Event:")),b("React").createElement(b("XUIText.react"),{className:"_3-99"},i._("{date range}",[i._param("date range",c)]),c!==""&&d!==""?", ":null,i._("{location}",[i._param("location",d)])))):b("React").createElement(b("ProfileTile.react"),{desc:b("React").createElement(b("XUIText.react"),{size:"meta1"},i._("{date range}",[i._param("date range",c)]),c!==""&&d!==""?", ":null,i._("{location}",[i._param("location",d)])),id:a,imageProps:{src:g("114508"),className:"_3ykz"},name:f,tileProps:{className:"_3yk-",target:"_blank"},titleProps:{className:"_3yk_"}})};function a(){j.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectEventOwnerBylineTileContainer.react",["FluxContainer","LoadingIndicator.react","MediaEffectEventDataStore","MediaEffectEventOwnerTile.react","MediaEffectFrameEditorDispatcher","MediaEffectMetadataStore","React","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(h,b("React").PureComponent);g&&g.prototype;h.getStores=function(){return[b("MediaEffectEventDataStore"),b("MediaEffectMetadataStore")]};h.calculateState=function(){var a=b("MediaEffectMetadataStore").getState().selectedOwnerID;return a?{event:b("MediaEffectEventDataStore").get(a)}:{}};h.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(h.getStores())};h.prototype.render=function(){var event=this.state.event;return event&&event.hasValue()?b("React").createElement(b("MediaEffectEventOwnerTile.react"),{event:b("nullthrows")(this.state.event).getValueEnforcing(),style:"byline"}):b("React").createElement(b("LoadingIndicator.react"),{color:"white",size:"medium"})};function h(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(h)}),null);
__d("MediaEffectReactFrameEditorScalarSizeRecord",["immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;a=b("immutable").Record;g=babelHelpers.inherits(h,a({canvas_size_percentage:50,pixels:0}));g&&g.prototype;h.canonical=function(a,b,c){return new h({canvas_size_percentage:100*b/a})};h.prototype.toAbsolute=function(a){return this.canvas_size_percentage/100*a+this.pixels};function h(){g.apply(this,arguments)}e.exports=h}),null);
__d("MediaEffectReactFrameEditorSize",["immutable","MediaEffectReactFrameEditorScalarSizeRecord","Vector"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h,i,j,k;a=b("immutable").Record;g=babelHelpers.inherits(l,a({width:null,height:null}));g&&g.prototype;l.canonical=function(a,c){return new l({width:b("MediaEffectReactFrameEditorScalarSizeRecord").canonical(c.x,a.w(),a.w()/2+a.l),height:b("MediaEffectReactFrameEditorScalarSizeRecord").canonical(c.y,a.h(),a.h()/2+a.t)})};l.prototype.isValid=function(){return Boolean(this.width&&this.height)};l.prototype.toAbsolute=function(a){return new(b("Vector"))(this.width.toAbsolute(a.x),this.height.toAbsolute(a.y))};function l(){g.apply(this,arguments)}h=babelHelpers.inherits(m,a({width:null,aspect_ratio:null}));h&&h.prototype;m.canonical=function(a,c){return new m({width:b("MediaEffectReactFrameEditorScalarSizeRecord").canonical(c.x,a.w(),a.w()/2+a.l),aspect_ratio:a.w()/a.h()})};m.prototype.isValid=function(){return Boolean(this.width&&this.aspect_ratio&&this.aspect_ratio>0)};m.prototype.toAbsolute=function(a){a=this.width.toAbsolute(a.x);return new(b("Vector"))(a,a/this.aspect_ratio)};m.prototype.getDerivedAspectRatio=function(){return this.aspect_ratio};m.prototype.getDerivedWidth=function(){return this.width};m.prototype.getDerivedHeight=function(){return new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:this.width.canvas_size_percentage/this.getDerivedAspectRatio()})};m.prototype.getScaledWithWidth=function(){return this};m.prototype.getNotScaledWithWidth=function(){return new p({width:this.getDerivedWidth(),height:this.getDerivedHeight(),aspect_ratio:this.getDerivedAspectRatio()})};m.prototype.getScaledWithHeight=function(){return new o({width:this.getDerivedWidth(),height:this.getDerivedHeight(),aspect_ratio:this.getDerivedAspectRatio()})};m.prototype.getNotScaledWithHeight=function(){return this};function m(){h.apply(this,arguments)}i=babelHelpers.inherits(n,a({height:null,aspect_ratio:null}));i&&i.prototype;n.canonical=function(a,c){return new l({height:b("MediaEffectReactFrameEditorScalarSizeRecord").canonical(c.y,a.h(),a.h()/2+a.t),aspect_ratio:a.w()/a.h()})};n.prototype.isValid=function(){return Boolean(this.height&&this.aspect_ratio&&this.aspect_ratio>0)};n.prototype.toAbsolute=function(a){a=this.height.toAbsolute(a.y);return new(b("Vector"))(a*this.aspect_ratio,a)};n.prototype.getDerivedAspectRatio=function(){return this.aspect_ratio};n.prototype.getDerivedWidth=function(){return new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:this.height.canvas_size_percentage*this.getDerivedAspectRatio()})};n.prototype.getDerivedHeight=function(){return this.height};n.prototype.getScaledWithWidth=function(){return new o({width:this.getDerivedWidth(),height:this.getDerivedHeight(),aspect_ratio:this.getDerivedAspectRatio()})};n.prototype.getNotScaledWithWidth=function(){return this};n.prototype.getScaledWithHeight=function(){return this};n.prototype.getNotScaledWithHeight=function(){return new p({width:this.getDerivedWidth(),height:this.getDerivedHeight(),aspect_ratio:this.getDerivedAspectRatio()})};function n(){i.apply(this,arguments)}j=babelHelpers.inherits(o,a({width:null,height:null,aspect_ratio:null}));j&&j.prototype;o.canonical=function(a,c){return new l({width:b("MediaEffectReactFrameEditorScalarSizeRecord").canonical(c.x,a.w(),a.w()/2+a.l),height:b("MediaEffectReactFrameEditorScalarSizeRecord").canonical(c.y,a.h(),a.h()/2+a.t),aspect_ratio:a.w()/a.h()})};o.prototype.isValid=function(){return Boolean(this.width&&this.height&&this.aspect_ratio&&this.aspect_ratio>0)};o.prototype.toAbsolute=function(a){var c=this.width.toAbsolute(a.x);a=this.height.toAbsolute(a.y);var d=Math.min(c,a*this.aspect_ratio);a=Math.min(a,c/this.aspect_ratio);return new(b("Vector"))(d,a)};o.prototype.getDerivedAspectRatio=function(){return this.aspect_ratio};o.prototype.getDerivedWidth=function(){return this.width};o.prototype.getDerivedHeight=function(){return this.height};o.prototype.getScaledWithWidth=function(){return this};o.prototype.getNotScaledWithWidth=function(){return new n({height:this.getDerivedHeight(),aspect_ratio:this.getDerivedAspectRatio()})};o.prototype.getScaledWithHeight=function(){return this};o.prototype.getNotScaledWithHeight=function(){return new m({width:this.getDerivedWidth(),aspect_ratio:this.getDerivedAspectRatio()})};function o(){j.apply(this,arguments)}k=babelHelpers.inherits(p,a({width:null,height:null,aspect_ratio:null}));k&&k.prototype;p.canonical=function(a,c){return new l({width:b("MediaEffectReactFrameEditorScalarSizeRecord").canonical(c.x,a.w(),a.w()/2+a.l),height:b("MediaEffectReactFrameEditorScalarSizeRecord").canonical(c.y,a.h(),a.h()/2+a.t),aspect_ratio:a.w()/a.h()})};p.prototype.isValid=function(){return Boolean(this.width&&this.height&&this.aspect_ratio&&this.aspect_ratio>0)};p.prototype.toAbsolute=function(a){var c=this.width.toAbsolute(a.x);a=this.height.toAbsolute(a.y);var d=Math.max(c,a*this.aspect_ratio);a=Math.max(a,c/this.aspect_ratio);return new(b("Vector"))(d,a)};p.prototype.getDerivedAspectRatio=function(){return this.aspect_ratio};p.prototype.getDerivedWidth=function(){return this.width};p.prototype.getDerivedHeight=function(){return this.height};p.prototype.getScaledWithWidth=function(){return new m({width:this.getDerivedWidth(),aspect_ratio:this.getDerivedAspectRatio()})};p.prototype.getNotScaledWithWidth=function(){return this};p.prototype.getScaledWithHeight=function(){return new n({height:this.getDerivedHeight(),aspect_ratio:this.getDerivedAspectRatio()})};p.prototype.getNotScaledWithHeight=function(){return this};function p(){k.apply(this,arguments)}e.exports={Stretch:l,ScaleWidth:m,ScaleHeight:n,Fit:o,Fill:p}}),null);
__d("MediaEffectEditorAsset",["fbt","MediaEffectEditorFunnelLogger","MediaEffectMetadataActionCreators","MediaEffectReactFrameEditorSize","SimpleXUIDialog"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function a(a,b){this.updateAsset(a,b)}a.prototype.getProps=function(){return{assetID:this.$1,assetData:this.$2}};a.prototype.updateAsset=function(a,b){(a!==this.$1||b!==this.$2)&&(this.$1=a,this.$2=b)};a.prototype.isScalingWithWidth=function(){if(!this.$2)return!1;if(this.isTextAsset())return!1;var a=this.$2.assetSize;return!a?!0:a instanceof b("MediaEffectReactFrameEditorSize").Fit||a instanceof b("MediaEffectReactFrameEditorSize").ScaleWidth};a.prototype.isScalingWithHeight=function(){if(!this.$2)return!1;if(this.isTextAsset())return!0;var a=this.$2.assetSize;return!a?!0:a instanceof b("MediaEffectReactFrameEditorSize").Fit||a instanceof b("MediaEffectReactFrameEditorSize").ScaleHeight};a.prototype.toggleScaleWithWidth=function(){if(!this.$2)return;var a=this.$2.assetSize;if(!a)return;var c=this.isScalingWithWidth()?a.getNotScaledWithWidth():a.getScaledWithWidth();if(c===a)return;b("MediaEffectMetadataActionCreators").updateAssetSize(this.$1,c)};a.prototype.toggleScaleWithHeight=function(){if(!this.$2)return;var a=this.$2.assetSize;if(!a)return;var c=this.isScalingWithHeight()?a.getNotScaledWithHeight():a.getScaledWithHeight();if(c===a)return;b("MediaEffectMetadataActionCreators").updateAssetSize(this.$1,c)};a.prototype.isTextAsset=function(){return this.$2&&this.$2.assetType()==="MediaEffectReactFrameEditorTextAssetRecord"};a.prototype.$3=function(){b("MediaEffectMetadataActionCreators").raiseAsset(this.$1)};a.prototype.$4=function(){b("MediaEffectMetadataActionCreators").raiseAsset(this.$1,!0)};a.prototype.$5=function(){b("MediaEffectMetadataActionCreators").lowerAsset(this.$1)};a.prototype.$6=function(){b("MediaEffectMetadataActionCreators").lowerAsset(this.$1,!0)};a.prototype.$7=function(a){a.target.files[0]&&b("MediaEffectMetadataActionCreators").replaceImage(this.$1,a.target.files[0])};a.prototype.$8=function(){b("MediaEffectMetadataActionCreators").duplicateAsset(this.$1)};a.prototype.$9=function(){this.isTextAsset()||(this.toggleScaleWithWidth(),b("MediaEffectEditorFunnelLogger").logSetScaleWithWidth((!this.isScalingWithWidth()).toString()))};a.prototype.$10=function(){this.isTextAsset()||(this.toggleScaleWithHeight(),b("MediaEffectEditorFunnelLogger").logSetScaleWithHeight((!this.isScalingWithHeight()).toString()))};a.prototype.$11=function(){b("SimpleXUIDialog").showConfirm(this.isTextAsset()?g._("Are you sure you want to delete this text?"):g._("Are you sure you want to delete this art?"),null,function(a){return a?b("MediaEffectMetadataActionCreators").deleteAsset(this.$1):null}.bind(this))};e.exports=a}),null);
__d("MediaEffectAssetValidationStore",["FluxMapStore","MediaEffectFrameEditorDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("FluxMapStore"));g&&g.prototype;a.prototype.reduce=function(a,b){switch(b.type){case"asset/validate":return a.set(b.stickerFBID,b.result);default:return a}};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("MediaEffectFrameEditorDispatcher"))}),null);
__d("MediaEffectEditorSideMenu.react",["cx","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={highlightedIndex:null},this.$1=function(a){var b=this.props.items[a];b&&m(b)?this.$2(a):this.$2(null)}.bind(this),this.$3=function(){this.$2(null)}.bind(this),b}a.prototype.$2=function(a){this.setState({highlightedIndex:a})};a.prototype.render=function(){var a=this.props;return b("React").createElement("div",{className:"_2qs3"},b("React").createElement("div",{className:"_2qs4"},a.title),b("React").createElement("ul",{className:"_2qs5",onMouseLeave:this.$3},a.items.map(function(a,c){switch(a.type){case"item":return b("React").createElement(k,{hidden:a.hidden,index:c,isDisabled:a.isDisabled,isFullSize:a.isFullSize,isHighlighted:c===this.state.highlightedIndex,isNoAction:a.isNoAction,key:c,label:a.label,onClick:a.onClick,onMouseEnter:this.$1});case"separator":return b("React").createElement(l,{key:c});default:return null}}.bind(this))))};a.defaultProps={items:[]};d=babelHelpers.inherits(k,b("React").PureComponent);i=d&&d.prototype;function k(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.$1=function(){this.props.onClick(this.props.index)}.bind(this),this.$2=function(){this.props.onMouseEnter(this.props.index)}.bind(this),b}k.prototype.render=function(){if(this.props.hidden)return null;var a=["_2qs6"];this.props.isHighlighted&&!this.props.isDisabled&&!this.props.isNoAction&&a.push("_2qs8");this.props.isDisabled&&a.push("_2qs9");this.props.isFullSize&&a.push("_3kqu");a=b("joinClasses").apply(null,a);return b("React").createElement("li",{className:a,onClick:this.$1,onMouseEnter:this.$2,role:"menuitem",style:{cursor:this.props.isDisabled||this.props.isNoAction?"default":"pointer"}},this.props.label)};j=babelHelpers.inherits(l,b("React").PureComponent);j&&j.prototype;l.prototype.render=function(){return b("React").createElement("li",{className:"_2qsa"})};function l(){j.apply(this,arguments)}function m(a){return a.type==="item"&&!a.isDisabled&&!a.isNoAction}e.exports=a}),null);
__d("MediaEffectEditorSideMenuContainer.react",["cx","fbt","DOMQuery","FBToggleSwitch.react","FileInput.react","FluxContainer","LeftRight.react","MediaEffectAssetValidationStore","MediaEffectEditorAsset","MediaEffectEditorFunnelLogger","MediaEffectEditorSideMenu.react","MediaEffectFlowType","MediaEffectMetadataActionCreators","MediaEffectReactFrameEditorCanvasDataStore","MediaEffectReactFrameEditorDataStore","MediaEffectReactFrameEditorImageAssetRecord","MediaEffectReactFrameEditorTextAssetRecord","React","ReactDOM","SimpleXUIDialog","emptyFunction"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=null,this.$2=null,this.$3=null,this.$4=null,this.$5=null,this.$6=[],this.$7=[],this.$8=[],this.$9=function(){var a=this.state.currentAsset;if(!a)return;a=a.getProps();a=a.assetID;b("MediaEffectMetadataActionCreators").raiseAsset(a)}.bind(this),this.$10=function(){var a=this.state.currentAsset;if(!a)return;a=a.getProps();a=a.assetID;b("MediaEffectMetadataActionCreators").raiseAsset(a,!0)}.bind(this),this.$11=function(){var a=this.state.currentAsset;if(!a)return;a=a.getProps();a=a.assetID;b("MediaEffectMetadataActionCreators").lowerAsset(a)}.bind(this),this.$12=function(){var a=this.state.currentAsset;if(!a)return;a=a.getProps();a=a.assetID;b("MediaEffectMetadataActionCreators").lowerAsset(a,!0)}.bind(this),this.$13=function(a){var c=this.state.currentAsset;if(!c)return;c=c.getProps();c=c.assetID;a.target.files[0]&&b("MediaEffectMetadataActionCreators").replaceImage(c,a.target.files[0])}.bind(this),this.$14=function(){var a=this.state.currentAsset;if(!a)return;a=a.getProps();a=a.assetID;b("MediaEffectMetadataActionCreators").duplicateAsset(a)}.bind(this),this.$15=function(){var a=this.state.currentAsset;if(!a)return;a.isTextAsset()||(a.toggleScaleWithWidth(),b("MediaEffectEditorFunnelLogger").logSetScaleWithWidth((!a.isScalingWithWidth()).toString()))}.bind(this),this.$16=function(){var a=this.state.currentAsset;if(!a)return;a.isTextAsset()||(a.toggleScaleWithHeight(),b("MediaEffectEditorFunnelLogger").logSetScaleWithHeight((!a.isScalingWithHeight()).toString()))}.bind(this),this.$17=function(){var a=this.state.currentAsset;if(!a)return;var c=a.getProps(),d=c.assetID;b("SimpleXUIDialog").showConfirm(a.isTextAsset()?h._("Are you sure you want to delete this text?"):h._("Are you sure you want to delete this art?"),null,function(a){return a?b("MediaEffectMetadataActionCreators").deleteAsset(d):null})}.bind(this),c}a.calculateState=function(a){__p&&__p();var c=b("MediaEffectReactFrameEditorCanvasDataStore").getState();if(c.selectedAssets.isEmpty())return{currentAsset:null};var d=b("MediaEffectReactFrameEditorDataStore").getState();d=d.assets.withMutations(function(a){a.forEach(function(c,d){if(c instanceof b("MediaEffectReactFrameEditorImageAssetRecord")){var e=null;c.stickerFBID&&(e=b("MediaEffectAssetValidationStore").get(c.stickerFBID));c=c.set("validationResult",e);a.set(d,c)}})});c=c.selectedAssets.first();d=d.get(c);return a&&a.currentAsset&&a.currentAsset.getProps().assetID===c&&a.currentAsset.getProps().assetData===d?a:{currentAsset:new(b("MediaEffectEditorAsset"))(c,d)}};a.getStores=function(){return[b("MediaEffectReactFrameEditorDataStore"),b("MediaEffectReactFrameEditorCanvasDataStore"),b("MediaEffectAssetValidationStore")]};a.prototype.render=function(){__p&&__p();var a=this.state.currentAsset;if(!a)return b("React").createElement(b("MediaEffectEditorSideMenu.react"),{items:[],title:h._("No item selected")});var c=a.isTextAsset();c=[{type:"item",label:h._("Bring forward"),onClick:this.$9},{type:"item",label:h._("Bring to front"),onClick:this.$10},{type:"item",label:h._("Send backward"),onClick:this.$11},{type:"item",label:h._("Send to back"),onClick:this.$12},{type:"separator"},{type:"item",isFullSize:!0,hidden:c,label:!c&&b("React").createElement(b("FileInput.react"),{accept:"image/x-png, image/jpeg, image/png",containerClassName:"_40-0 _40-1",multiple:!1,onChange:this.$13},b("React").createElement("a",{style:{color:"inherit",textDecoration:"none"}},h._("Replace Art"))),onClick:b("emptyFunction")},{type:"item",label:h._("Duplicate"),onClick:this.$14},{type:"item",label:h._("Delete"),onClick:this.$17},{type:"separator"},{type:"item",label:b("React").createElement("div",{className:"_11o1"},b("React").createElement(b("LeftRight.react"),null,h._("Shrink with width"),b("React").createElement(b("FBToggleSwitch.react"),{animate:!0,checked:a.isScalingWithWidth(),disabled:c,ref:function(a){return a&&this.$6.push(b("DOMQuery").find(b("ReactDOM").findDOMNode(a),"input"))}.bind(this)})),b("React").createElement("div",{className:"_11o2"})),onClick:this.$15},{type:"item",label:b("React").createElement("div",{className:"_11o1"},b("React").createElement(b("LeftRight.react"),null,h._("Shrink with height"),b("React").createElement(b("FBToggleSwitch.react"),{animate:!0,checked:a.isScalingWithHeight(),disabled:c,ref:function(a){return a&&this.$7.push(b("DOMQuery").find(b("ReactDOM").findDOMNode(a),"input"))}.bind(this)})),b("React").createElement("div",{className:"_11o2"})),onClick:this.$16}];a=a.getProps();a.assetData;return b("React").createElement(b("MediaEffectEditorSideMenu.react"),{items:c,title:h._("Actions")})};e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MediaEffectFrameEditorBirthdayCelebrationTemplateSelector.react",["ix","cx","Image.react","MediaEffectFrameEditorTemplateGrid.react","React","fbglyph"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(a){i.constructor.call(this,a),this.$1=function(){this.$2("Birthdays")}.bind(this),this.$3=function(){this.$2("Celebrations")}.bind(this),this.state={selectedCategory:"Birthdays"}}a.prototype.$2=function(a){this.setState({selectedCategory:a})};a.prototype.render=function(){var a=this.state.selectedCategory==="Birthdays"?this.props.birthdayTemplates:this.props.celebrationTemplates;return b("React").createElement("div",null,b("React").createElement("div",{className:"_3-94"},b("React").createElement("a",{className:"_2w6x _3-fi _hto _htp"+(this.state.selectedCategory==="Birthdays"?" _hts":"")+" _3-fj",href:"#",onClick:this.$1},b("React").createElement(b("Image.react"),{className:"_3-8x _3-94",src:this.state.selectedCategory==="Birthdays"?g("114499"):g("122508")}),b("React").createElement("div",null,"Birthdays")),b("React").createElement("a",{className:"_2w6x _3-fi _hto _htt"+(this.state.selectedCategory==="Celebrations"?" _hts":"")+" _3-fj",href:"#",onClick:this.$3},b("React").createElement(b("Image.react"),{className:"_3-8x _3-94",src:this.state.selectedCategory==="Celebrations"?g("114650"):g("122659")}),b("React").createElement("div",null,"Celebrations"))),b("React").createElement(b("MediaEffectFrameEditorTemplateGrid.react"),{activeTemplate:this.props.activeTemplate,templates:a}))};e.exports=a}),null);
__d("MediaEffectFrameEditorDataRecord",["immutable","MediaEffectReactFrameEditorImageAssetRecord"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("immutable").List;d=b("immutable").Map;f=b("immutable").Record;g=babelHelpers.inherits(a,f({assets:d(),assetOrder:c(),frameFBID:null,filterID:null,templateFBID:null,containsJPEG:!1}));g&&g.prototype;a.prototype.withNewAsset=function(a,b){return this.withMutations(function(c){c.set("assets",this.assets.set(a,b)).set("assetOrder",this.assetOrder.push(a))}.bind(this))};a.prototype.withDeletedAsset=function(a){var b=this.assetOrder,c=this.assets,d=b.indexOf(a),e=b.splice(d,1),f=c.remove(a);return this.withMutations(function(a){a.set("assets",f).set("assetOrder",e)})};a.prototype.replaceAsset=function(a,b){return this.set("assets",this.assets.set(a,b))};a.prototype.withAssetMutation=function(a,b){var c=this.assets,d=c.get(a);return!d?this:this.set("assets",c.set(a,d.withMutations(b)))};a.prototype.withTextAssetMutation=function(a,c){var d=this.assets,e=d.get(a);if(!e)return this;e instanceof b("MediaEffectReactFrameEditorImageAssetRecord")?e.assocTextAsset&&(e=e.set("assocTextAsset",e.assocTextAsset.withMutations(c))):e=e.withMutations(c);return this.set("assets",d.set(a,e))};a.prototype.withRaisedAsset=function(a,b){return this.$MediaEffectFrameEditorDataRecord1(a,b,1)};a.prototype.withLoweredAsset=function(a,b){return this.$MediaEffectFrameEditorDataRecord1(a,b,-1)};a.prototype.$MediaEffectFrameEditorDataRecord1=function(a,b,c){__p&&__p();var d=this.assetOrder,e=this.assets,f=e.get(a),g=d.indexOf(a);if(g===(c>0?d.size-1:0))return this;b=b?c>0?d.size:0:g+c;for(;b<d.size&&b>0;b+=c){var h=e.get(d.get(b));if(f.assetType()===h.assetType())break}h=d.splice(g,1).splice(b,0,a);return this.set("assetOrder",h)};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectFrameEditorMultiCategoryTemplateSelector.react",["cx","fbt","MediaEffectFrameEditorTemplateGrid.react","MediaEffectMetadataActionCreators","React","SUIBusinessTheme","SUISelector.react","SUISelectorOption.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(a){i.constructor.call(this,a),this.$2=function(a){if(a===this.state.selectedCategory)return;this.setState({selectedCategory:a});a=this.$1(a);b("MediaEffectMetadataActionCreators").applyTemplate(a?a.first():null)}.bind(this),this.state={selectedCategory:null}}a.prototype.$1=function(a){return!a?null:this.props.categories.get(a)};a.prototype.$3=function(){return b("React").createElement(b("SUISelector.react"),{canSelectMultiple:!1,onChange:this.$2,theme:b("SUIBusinessTheme"),value:this.state.selectedCategory,width:184},b("React").createElement(b("SUISelectorOption.react"),{value:null},h._("None")),this.props.categories.keySeq().map(function(a){return b("React").createElement(b("SUISelectorOption.react"),{key:a,value:a},a)}))};a.prototype.$4=function(){var a=this.$1(this.state.selectedCategory);return!a?null:b("React").createElement(b("MediaEffectFrameEditorTemplateGrid.react"),{activeTemplate:this.props.activeTemplate,showNoTemplate:!1,templates:a})};a.prototype.render=function(){return b("React").createElement("div",null,b("React").createElement("div",{className:"_3-96"},this.$3()),this.$4())};e.exports=a}),null);
__d("WebGLShaderCode",["regeneratorRuntime","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("immutable").List,h=b("immutable").Set;a.prototype.getDirectDeps=function(){return h()};a.prototype.generateAllCodeFragments=b("regeneratorRuntime").mark(function a(){__p&&__p();var c,d,e,f,g,h,i,j,k,l,m,n;return b("regeneratorRuntime").wrap(function(a){__p&&__p();while(1)switch(a.prev=a.next){case 0:c=new Set(),d=this.getCodeFragment(),c.add(d),(e=this.getDirectDeps(),f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 4:if(!f){a.next=10;break}if(!(g>=e.length)){a.next=7;break}return a.abrupt("break",35);case 7:h=e[g++];a.next=14;break;case 10:g=e.next();if(!g.done){a.next=13;break}return a.abrupt("break",35);case 13:h=g.value;case 14:i=h,(j=i.generateAllCodeFragments(),k=Array.isArray(j),l=0,j=k?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 16:if(!k){a.next=22;break}if(!(l>=j.length)){a.next=19;break}return a.abrupt("break",33);case 19:m=j[l++];a.next=26;break;case 22:l=j.next();if(!l.done){a.next=25;break}return a.abrupt("break",33);case 25:m=l.value;case 26:n=m;if(c.has(n)){a.next=31;break}a.next=30;return n;case 30:c.add(n);case 31:a.next=16;break;case 33:a.next=4;break;case 35:a.next=37;return d;case 37:case"end":return a.stop()}},a,this)});a.prototype.getAllCodeFragments=function(){return g(this.generateAllCodeFragments())};a.prototype.getCodeFragment=function(){return""};function a(){}e.exports=a}),null);
__d("WebGLShaderLibraryCode",["WebGLShaderCode"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("WebGLShaderCode"));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectColorComponentShaderCode",["WebGLShaderLibraryCode"],(function(a,b,c,d,e,f){"use strict";var g;c=babelHelpers.inherits(a,b("WebGLShaderLibraryCode"));g=c&&c.prototype;function a(a){g.constructor.call(this),this.$MediaEffectColorComponentShaderCode1=a||4}a.prototype.getCodeFragment=function(){return"\n    precision mediump float;\n\n    #define MAX_NUM_COMPONENTS "+this.$MediaEffectColorComponentShaderCode1+"\n    // These is not just MAX_NUM_COMPONENTS so we don't have to keep changing\n    // the program all the time. That might be unnecessary though.\n    uniform int u_num_components;\n\n    struct Component\n    {\n      vec3 hsl;\n      vec3 hslwidth;\n    };\n\n    uniform Component u_source[MAX_NUM_COMPONENTS];\n\n    float component_scores[MAX_NUM_COMPONENTS];\n\n    float discreteComponentScore(Component component, vec3 hsl) {\n      float normhuediff = (\n        mod(hsl.x - component.hsl.x + 0.5, 1.0) - 0.5\n      ) / component.hslwidth.x;\n      vec2 normsldiff = (\n        (hsl.yz - component.hsl.yz) / component.hslwidth.yz\n      );\n      vec3 normscore = vec3(\n        (1.0 - abs(normhuediff)) / component.hslwidth.x,\n        (vec2(1.0, 1.0) - abs(normsldiff)) / component.hslwidth.yz\n      );\n      if (!(normscore.x > 0.0 && normscore.x < 1000000.0)) {\n        return -10.0;\n      }\n      if (!(normscore.y > 0.0 && normscore.y < 1000000.0)) {\n        return -10.0;\n      }\n      if (!(normscore.z > 0.0 && normscore.z < 1000000.0)) {\n        return -10.0;\n      }\n      return normscore.x * normscore.y * normscore.z;\n    }\n\n    float lightnessCentrality(float lightness) {\n      return 1.0 - abs(2.0 * lightness - 1.0);\n    }\n\n    float avg(float x, float y) {\n      return (x + y) / 2.0;\n    }\n\n    float getNaturalSaturation(vec3 hsl) {\n      return hsl.y * lightnessCentrality(hsl.z);\n    }\n\n    float getSaturationSignificance(vec3 hsl1, vec3 hsl2) {\n      float saturationSignificance = clamp(\n        avg(\n          lightnessCentrality(hsl1.z),\n          lightnessCentrality(hsl2.z)\n        ),\n        0.01, 1.0\n      );\n      return saturationSignificance;\n    }\n\n    float getHueSignificance(vec3 hsl1, vec3 hsl2) {\n      float sat1 = getNaturalSaturation(hsl1);\n      float sat2 = getNaturalSaturation(hsl2);\n      float saturation = avg(sat1, sat2);\n      float hueSignificance = clamp(\n        saturation,\n        0.01, 1.0\n      );\n      return hueSignificance;\n    }\n\n    float componentScore(Component component, vec3 hsl) {\n      float saturationSignificance = getSaturationSignificance(\n        component.hsl, hsl\n      );\n      float hueSignificance = getHueSignificance(component.hsl, hsl);\n      vec3 width = component.hslwidth + vec3(0.01);\n      width /= vec3(hueSignificance, saturationSignificance, 1.0);\n      float normhuediff = (\n        mod(hsl.x - component.hsl.x + 0.5, 1.0) - 0.5\n      ) / width.x;\n      float normsatdiff = (\n        getNaturalSaturation(hsl) - getNaturalSaturation(component.hsl)\n      ) / width.y;\n      float normlightdiff = (\n        (hsl.z - component.hsl.z) / width.z\n      );\n      vec3 score = max(vec3(\n        (1.0 - abs(normhuediff)),\n        (1.0 - abs(normsatdiff)),\n        (1.0 - abs(normlightdiff))\n      ), vec3(0.0));\n      vec3 normscore = vec3(\n        score.x,\n        score.y,\n        score.z\n      );\n\n      return normscore.x * normscore.y * normscore.z;\n    }\n\n    void computeComponentScores(vec3 hsl) {\n      for (int index = 0; index < MAX_NUM_COMPONENTS; index++) {\n        float score = 0.0;\n        if (index < u_num_components) {\n          score = componentScore(u_source[index], hsl);\n        }\n        component_scores[index] = score;\n      }\n    }\n    "};e.exports=a}),null);
__d("MediaEffectImageIOShaderCode",["WebGLShaderLibraryCode"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("WebGLShaderLibraryCode"));g&&g.prototype;a.prototype.getCodeFragment=function(){return"\n    precision mediump float;\n\n    // our texture\n    uniform sampler2D u_image;\n    uniform int u_alpha_premultiplied;\n\n    // the texCoords passed in from the vertex shader.\n    varying vec2 v_texCoord;\n\n    vec4 premultiplyAlpha(vec4 src) {\n      if (u_alpha_premultiplied == 0) {\n        return src;\n      }\n      return vec4(src.rgb * src.a, src.a);\n    }\n\n    vec4 demultiplyAlpha(vec4 src) {\n      if (u_alpha_premultiplied == 0 || src.a == 0.0) {\n        return src;\n      }\n      return vec4(src.rgb / src.a, src.a);\n    }\n\n    vec4 getInputColor() {\n      return demultiplyAlpha(texture2D(u_image, v_texCoord));\n    }\n\n    void setOutputColor(vec4 value) {\n      gl_FragColor = premultiplyAlpha(value);\n    }\n    "};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("WebGLShaderMainCode",["WebGLShaderCode"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("WebGLShaderCode"));g&&g.prototype;a.prototype.toString=function(){return this.getAllCodeFragments().join("\n\n")};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("WebGLFragmentShaderCode",["WebGLShaderMainCode"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("WebGLShaderMainCode"));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("WebGLShaderColorTransformCode",["WebGLShaderLibraryCode"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("WebGLShaderLibraryCode"));g&&g.prototype;a.prototype.getCodeFragment=function(){return"\n    precision mediump float;\n\n    float e = 1e-10;\n\n    vec3 hue2rgb(float h) {\n      return clamp(\n        vec3(\n          abs(h*6.0 - 3.0) - 1.0,\n          2.0 - abs(h*6.0 - 2.0),\n          2.0 - abs(h*6.0 - 4.0)\n        ),\n        0.0,\n        1.0\n      );\n    }\n\n    vec3 hsl2rgb(vec3 hsl) {\n      vec3 rgb = hue2rgb(hsl.x);\n      float c = (1.0 - abs(2.0*hsl.z - 1.0)) * hsl.y;\n      return (rgb - 0.5)*c + hsl.z;\n    }\n\n    vec3 rgb2hsl(vec3 rgb){\n      vec3 hsl = vec3(0.0);\n      float minrgb = min(rgb.r, min(rgb.g, rgb.b));\n      float maxrgb = max(rgb.r, max(rgb.g, rgb.b));\n      hsl.z = (maxrgb + minrgb) / 2.0;\n      if (maxrgb > minrgb) {\n        float rgbrange = maxrgb - minrgb;\n        hsl.y = (\n          hsl.z < .05 ?\n          rgbrange / (maxrgb + minrgb) :\n          rgbrange / (2.0 - (maxrgb + minrgb))\n        );\n        if (rgb.r == maxrgb) {\n          hsl.x = (rgb.g - rgb.b) / rgbrange / 6.0;\n        } else if (rgb.g == maxrgb) {\n          hsl.x = (2.0 + (rgb.b - rgb.r) / rgbrange) / 6.0;\n        } else {\n          hsl.x = (4.0 + (rgb.r - rgb.g) / rgbrange) / 6.0;\n        }\n\n        hsl.x = mod(hsl.x, 1.0);\n      }\n      return hsl;\n    }\n    "};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("WebGLShaderEaseThroughCode",["WebGLShaderLibraryCode"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("WebGLShaderLibraryCode"));g&&g.prototype;a.prototype.getCodeFragment=function(){return"\n    precision mediump float;\n\n    // A clamped linear interpolation through (0, 0) and (x0, y0)\n    float easeThroughZero(float x0, float y0, float x) {\n      return clamp(x * y0 / x0, 0.0, 1.0);\n    }\n\n    // A clamped linear interpolation through (1, 1) and (x0, y0)\n    float easeThroughOne(float x0, float y0, float x) {\n      return clamp(\n        x * (y0 - 1.0) / (x0 - 1.0) + (x0 - y0) / (x0 - 1.0),\n        0.0, 1.0\n      );\n    }\n\n    // A clamped linear interpolation through (x0, y0) of gradient 1\n    float easeThroughCorner(float x0, float y0, float x) {\n      return clamp(\n        x + (y0 - x0),\n        0.0, 1.0\n      );\n    }\n\n    // A hyperbolic interpolation through (0, 0), (x0, y0) and (1, 1)\n    // Doesn't behave too stably when x0 or y0 is close to 0 or 1\n    float easeThroughRawHyperbola(float x0, float y0, float x) {\n      float a = x0 / y0 * (y0 - 1.0) / (x0 - 1.0) ;\n      return x / (a * (1.0 - x) + x);\n    }\n\n    // The above hyperbolic interpolation patched for individual degenerative\n    // values of x0 and y0.\n    float easeThroughHyperbola(float x0, float y0, float x) {\n      if (x0 == 1.0 || (y0 == 1.0 && x0 != 0.0)) {\n        return easeThroughZero(x0, y0, x);\n      }\n      if (x0 == 0.0 || y0 == 0.0) {\n        return easeThroughOne(x0, y0, x);\n      }\n      return easeThroughRawHyperbola(x0, y0, x);\n    }\n\n    // A hybrid blend of the above, preferring:\n    //  linear through (1, 1) when (x0, y0) close to (0, 0)\n    //  linear through (0, 0) when (x0, y0) close to (1, 1)\n    //  linear of gradient 1 when (x0, y0) close to (0, 1) or (1, 0)\n    //  hyperbolic interpolation when (x0, y0) fairly central\n    float easeThrough(float x0, float y0, float x) {\n      float zeroWeight = x0 * y0;\n      zeroWeight *= zeroWeight;\n      float oneWeight = (1.0 - x0) * (1.0 - y0);\n      oneWeight *= oneWeight;\n      float cornerWeight = y0 * (1.0 - x0) + x0 * (1.0 - y0);\n      cornerWeight *= cornerWeight;\n      float hyperbolaWeight = 16.0 * x0 * y0 * (1.0 - x0) * (1.0 - y0);\n      return (\n        zeroWeight * easeThroughZero(x0, y0, x) +\n        oneWeight * easeThroughOne(x0, y0, x) +\n        cornerWeight * easeThroughCorner(x0, y0, x) +\n        hyperbolaWeight * easeThroughHyperbola(x0, y0, x)\n      ) / (zeroWeight + oneWeight + cornerWeight + hyperbolaWeight);\n    }\n    "};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectColorTransformFragmentShaderCode",["immutable","MediaEffectColorComponentShaderCode","MediaEffectImageIOShaderCode","WebGLFragmentShaderCode","WebGLShaderColorTransformCode","WebGLShaderEaseThroughCode"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("immutable").Set;g=babelHelpers.inherits(a,b("WebGLFragmentShaderCode"));g&&g.prototype;a.prototype.getDirectDeps=function(){return h.of(new(b("WebGLShaderColorTransformCode"))(),new(b("MediaEffectColorComponentShaderCode"))(),new(b("MediaEffectImageIOShaderCode"))(),new(b("WebGLShaderEaseThroughCode"))())};a.prototype.getCodeFragment=function(){return"\n    precision mediump float;\n\n    #define UNMAPPED_WEIGHT 0.5\n\n    float epsilon = 1e-10;\n\n    uniform Component u_dest[MAX_NUM_COMPONENTS];\n\n    float bounceWrap(float x) {\n      return 1.0 - abs(abs(x) - 1.0);\n    }\n\n    float componentWeight(float score) {\n      if (score > 0.9999) {\n        return 10.0;\n      }\n      return -log(1.0 - score);\n    }\n\n    vec3 componentTransform(Component source, Component dest, vec3 point) {\n      vec3 wrapped = vec3(\n        mod(point.x + dest.hsl.x - source.hsl.x, 1.0),\n        easeThrough(source.hsl.y, dest.hsl.y, point.y),\n        easeThrough(source.hsl.z, dest.hsl.z, point.z)\n      );\n      return wrapped;\n    }\n\n    vec3 colorTransform(vec3 rgb) {\n      vec3 numerator = rgb * UNMAPPED_WEIGHT;\n      vec3 hsl = rgb2hsl(rgb);\n      computeComponentScores(hsl);\n      float denominator = UNMAPPED_WEIGHT;\n      for (int index = 0; index < MAX_NUM_COMPONENTS; index++) {\n        if (component_scores[index] <= 0.0) {\n          continue;\n        }\n        Component component = u_source[index];\n        float weight = componentWeight(component_scores[index]);\n        denominator += weight;\n        vec3 transformed = componentTransform(\n          u_source[index], u_dest[index], hsl\n        );\n        numerator += weight * hsl2rgb(transformed);\n      }\n      return numerator / denominator;\n    }\n\n    void main() {\n      vec4 src = getInputColor();\n      setOutputColor(src);\n      if (src.a == 0.0) {\n       return;\n      }\n      vec3 newrgb = colorTransform(src.rgb);\n      setOutputColor(vec4(newrgb, src.a));\n    }\n    "};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectHighlightFragmentShaderCode",["immutable","MediaEffectColorComponentShaderCode","MediaEffectImageIOShaderCode","WebGLFragmentShaderCode","WebGLShaderColorTransformCode"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("immutable").Set;g=babelHelpers.inherits(a,b("WebGLFragmentShaderCode"));g&&g.prototype;a.prototype.getDirectDeps=function(){return h.of(new(b("WebGLShaderColorTransformCode"))(),new(b("MediaEffectColorComponentShaderCode"))(),new(b("MediaEffectImageIOShaderCode"))())};a.prototype.getCodeFragment=function(){return"\n    precision mediump float;\n\n    uniform int u_highlight_component;\n\n    void main() {\n      vec4 src = getInputColor();\n      setOutputColor(src);\n      if (src.a == 0.0) {\n        return;\n      }\n      vec3 rgb = src.rgb;\n      vec3 hsl = rgb2hsl(rgb);\n      computeComponentScores(hsl);\n      for(int index = 0; index < MAX_NUM_COMPONENTS; index++) {\n        if (index == u_highlight_component - 1) {\n          setOutputColor(vec4(\n            rgb,\n            src.a * clamp(componentScore(u_source[index], hsl), 0.0, 1.0))\n          );\n          return;\n        }\n      }\n    }\n    "};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("WebGLVertexShaderCode",["WebGLShaderMainCode"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("WebGLShaderMainCode"));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectVertexShaderCode",["WebGLVertexShaderCode"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("WebGLVertexShaderCode"));g&&g.prototype;a.prototype.getCodeFragment=function(){return"\n    attribute vec2 a_position;\n    attribute vec2 a_texCoord;\n\n    uniform vec2 u_resolution;\n\n    varying vec2 v_texCoord;\n\n    void main() {\n       // convert the rectangle from pixels to 0.0 to 1.0\n       vec2 zeroToOne = a_position / u_resolution;\n\n       // convert from 0->1 to 0->2\n       vec2 zeroToTwo = zeroToOne * 2.0;\n\n       // convert from 0->2 to -1->+1 (clipspace)\n       vec2 clipSpace = zeroToTwo - 1.0;\n\n       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n\n       // pass the texCoord to the fragment shader\n       // The GPU will interpolate this value between points.\n       v_texCoord = a_texCoord;\n    }\n    "};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectImageTransmogrifier",["invariant","Promise","regeneratorRuntime","EventListener","MediaEffectColorTransformFragmentShaderCode","MediaEffectHighlightFragmentShaderCode","MediaEffectVertexShaderCode","getErrorNameFromWebGLErrorCode"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j;function k(a){var c=new Image();c.crossOrigin="anonymous";c.src=a;a=new(b("Promise"))(function(a,b){c.onload=function(){return a(c)}});return a}function l(c){__p&&__p();if(!a.WebGLRenderingContext)throw new Error("WebGLRenderingContext not available.");var d=["webgl","experimental-webgl","webkit-3d","moz-webgl"],e=null,f=null,g=b("EventListener").listen(c,"webglcontextcreationerror",function(a){return f=a.statusMessage});for(var h=0;h<d.length;h++){try{e=c.getContext(d[h],{premultipliedAlpha:!0})}catch(a){}if(e)break}g.remove();if(!e){f||(f="Unknown error.");throw new Error("Failed to acquire rendering context: "+f)}return e}function m(a,c,d){__p&&__p();a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d?1:0);d=a.createTexture();if(!d)throw new Error("Failed to create texture: "+b("getErrorNameFromWebGLErrorCode")(a.getError()));a.bindTexture(a.TEXTURE_2D,d);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,c)}function n(a,b,c,d,e){var f=b;b=b+d;d=c;c=c+e;a.bufferData(a.ARRAY_BUFFER,new Float32Array([f,d,b,d,f,c,f,c,b,d,b,c]),a.STATIC_DRAW)}function o(a){var c=a.createShader(a.VERTEX_SHADER);if(!c)throw new Error("Failed to create vertex shader: "+b("getErrorNameFromWebGLErrorCode")(a.getError()));a.shaderSource(c,new(b("MediaEffectVertexShaderCode"))().toString());a.compileShader(c);if(!a.getShaderParameter(c,a.COMPILE_STATUS))throw new Error("Failed to intialize vertex shader: "+b("getErrorNameFromWebGLErrorCode")(a.getError()));return c}function p(a,c,d,e){__p&&__p();var f=o(a),g=a.createProgram();if(!g)throw new Error("Failed to create shader program: "+b("getErrorNameFromWebGLErrorCode")(a.getError()));a.attachShader(g,f);a.attachShader(g,e);a.linkProgram(g);if(!a.getProgramParameter(g,a.LINK_STATUS))throw new Error("Failed to link shader program: "+b("getErrorNameFromWebGLErrorCode")(a.getError()));f=a.getAttribLocation(g,"a_position");e=a.getAttribLocation(g,"a_texCoord");var h=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,h);n(a,0,0,c,d);c=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c);a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),a.STATIC_DRAW);a.clearColor(0,0,0,0);a.clear(a.COLOR_BUFFER_BIT);a.useProgram(g);a.enableVertexAttribArray(f);a.bindBuffer(a.ARRAY_BUFFER,h);d=2;h=a.FLOAT;var i=!1,j=0,k=0;a.vertexAttribPointer(f,d,h,i,j,k);a.enableVertexAttribArray(e);a.bindBuffer(a.ARRAY_BUFFER,c);a.vertexAttribPointer(e,d,h,i,j,k);return g}function q(a,b,c,d,e,f){__p&&__p();var g=a.getUniformLocation(b,"u_resolution");a.uniform2f(g,a.canvas.width,a.canvas.height);a.viewport(0,0,a.canvas.width,a.canvas.height);g=a.getUniformLocation(b,"u_alpha_premultiplied");a.uniform1i(g,c?1:0);g=a.getUniformLocation(b,"u_num_components");a.uniform1i(g,f);c=a.getUniformLocation(b,"u_highlight_component");a.uniform1i(c,e);g=void 0;for(g=0;g<f;g++){c=a.getUniformLocation(b,"u_source["+g+"].hsl");e=a.getUniformLocation(b,"u_source["+g+"].hslwidth");var h=d.components.get(g);a.uniform3f(c,h.hue,h.saturation,h.lightness);a.uniform3f(e,h.hueVariation,h.saturationVariation,h.lightnessVariation)}}function r(a,b,c,d,e){var f=Math.min(d.components.size,e.components.size);q(a,b,c,d,0,f);c=void 0;for(c=0;c<f;c++){d=a.getUniformLocation(b,"u_dest["+c+"].hsl");var g=a.getUniformLocation(b,"u_dest["+c+"].hslwidth"),h=e.components.get(c);a.uniform3f(d,h.hue,h.saturation,h.lightness);a.uniform3f(g,h.hueVariation,h.saturationVariation,h.lightnessVariation)}}function s(a,b,c,d,e){var f=d.components.size;q(a,b,c,d,e,f)}function t(a){a.drawArrays(a.TRIANGLES,0,6)}function c(a,b,c,d,e,f,g){this.imageURI=a,this.alphaPremultiplied=b,this.sourceColorPalette=c,this.image=d,this.canvas=e,this.glContext=f,this.shaderProgram=g}c.prototype.execute=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:this.$1||(this.$1=this.$2());return a.abrupt("return",this.$1);case 2:case"end":return a.stop()}},null,this)};c.prototype.$2=function(){__p&&__p();var a,c;return b("regeneratorRuntime").async(function(d){__p&&__p();while(1)switch(d.prev=d.next){case 0:if(!(!this.image||this.image.src!==this.imageURI)){d.next=4;break}d.next=3;return b("regeneratorRuntime").awrap(k(this.imageURI));case 3:this.image=d.sent;case 4:this.width=this.image.width;this.height=this.image.height;this.canvas||(this.canvas=document.createElement("canvas"));this.canvas.width=this.width;this.canvas.height=this.height;this.glContext||(this.glContext=l(this.canvas));a=this.glContext;m(a,this.image,this.alphaPremultiplied);this.shaderProgram||(this.shaderProgram=p(a,this.width,this.height,this.getFragmentShader(a)));c=this.shaderProgram;this.configureTransmogrification(a,c);t(a,c);return d.abrupt("return",this);case 17:case"end":return d.stop()}},null,this)};c.prototype.toBlob=function(){__p&&__p();var a=this;return b("regeneratorRuntime").async(function(c){__p&&__p();while(1)switch(c.prev=c.next){case 0:if(this.blob){c.next=3;break}c.next=3;return b("regeneratorRuntime").awrap(function(){__p&&__p();var c,d;return b("regeneratorRuntime").async(function(e){__p&&__p();while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(a.execute());case 2:a.canvas||g(0);c=a.canvas;d=new(b("Promise"))(function(a,b){c.toBlob(a)});e.next=7;return b("regeneratorRuntime").awrap(d);case 7:a.blob=e.sent;case 8:case"end":return e.stop()}},null,a)}());case 3:return c.abrupt("return",this.blob);case 4:case"end":return c.stop()}},null,this)};c.prototype.getFragmentShader=function(a){var c=a.createShader(a.FRAGMENT_SHADER);if(!c)throw new Error("Failed to create fragment shader: "+b("getErrorNameFromWebGLErrorCode")(a.getError()));var d=this.getShaderSource();a.shaderSource(c,d);a.compileShader(c);if(!a.getShaderParameter(c,a.COMPILE_STATUS))throw new Error("Failed to intialize fragment shader: "+b("getErrorNameFromWebGLErrorCode")(a.getError()));return c};c.prototype.configureTransmogrification=function(a,b){};c.prototype.getShaderSource=function(){return""};h=babelHelpers.inherits(d,c);i=h&&h.prototype;function d(a,b,c,d,e,f,g,h){i.constructor.call(this,a,b,c,e,f,g,h),this.$ColorTransform1=d}d.prototype.getShaderSource=function(){return new(b("MediaEffectColorTransformFragmentShaderCode"))().toString()};d.prototype.configureTransmogrification=function(a,b){r(a,b,this.alphaPremultiplied,this.sourceColorPalette,this.$ColorTransform1)};h=babelHelpers.inherits(f,c);j=h&&h.prototype;function f(a,b,c,d,e,f,g,h){j.constructor.call(this,a,b,c,e,f,g,h),this.$HighlightTransform1=d}f.prototype.getShaderSource=function(){return new(b("MediaEffectHighlightFragmentShaderCode"))().toString()};f.prototype.configureTransmogrification=function(a,b){s(a,b,this.alphaPremultiplied,this.sourceColorPalette,this.$HighlightTransform1)};e.exports={HighlightTransform:f,ColorTransform:d,Transmogrifier:c}}),null);
__d("MediaEffectFrameEditorColorMappedImage.react",["regeneratorRuntime","EventListener","MediaEffectImageTransmogrifier","React","SubscriptionsHandler"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").PureComponent);g=c&&c.prototype;function a(a){g.constructor.call(this,a),this.$7=function(a){this.$2=a,a?(this.$4.addSubscriptions(b("EventListener").listen(a,"webglcontextlost",this.$8),b("EventListener").listen(a,"webglcontextrestored",this.$9)),this.$10()):this.$4.release()}.bind(this),this.$8=function(){this.$3=null,this.$5=null}.bind(this),this.$9=function(){this.$10()}.bind(this),this.$4=new(b("SubscriptionsHandler"))()}a.prototype.$10=function(){__p&&__p();return b("regeneratorRuntime").async(function(a){__p&&__p();while(1)switch(a.prev=a.next){case 0:if(this.$2){a.next=2;break}return a.abrupt("return");case 2:if(this.props.imageURI){a.next=4;break}return a.abrupt("return");case 4:this.props.highlightComponent?this.$6=new(b("MediaEffectImageTransmogrifier").HighlightTransform)(this.props.imageURI,!0,this.props.sourcePalette,this.props.highlightComponent,this.$1,this.$2,this.$3,this.$5):this.props.transformPalette?this.$6=new(b("MediaEffectImageTransmogrifier").ColorTransform)(this.props.imageURI,!0,this.props.sourcePalette,this.props.transformPalette,this.$1,this.$2,this.$3,this.$5):this.$6=null,this.$6&&this.$6.execute().then(function(a){a&&a===this.$6&&(this.$3=a.glContext,this.$1=a.image,this.$5=a.shaderProgram)}.bind(this))["catch"](function(a){});case 6:case"end":return a.stop()}},null,this)};a.prototype.render=function(){this.$10();return b("React").createElement("canvas",{ref:this.$7,style:{width:this.props.size.x,height:this.props.size.y}})};e.exports=a}),null);
__d("MediaEffectFrameEditorPixelCanvas.react",["cx","regeneratorRuntime","Image.react","MediaEffectFrameEditorColorMappedImage.react","MediaEffectFrameRenderer","React","ReactDOM","ResponsiveBlock.react","Vector"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(a){__p&&__p();h.constructor.call(this,a),this.$4=!1,this.$6=function(event){__p&&__p();var a=this.state,b=a.imageURI;a=a.size;var c=this.$2;if(event.button!==0||!b||!a||!c)return;this.props.onSamplingStart&&!event.shiftKey&&this.props.onSamplingStart();var d=document.createElement("canvas");d.width=a.x*window.devicePixelRatio;d.height=a.y*window.devicePixelRatio;var e=new Image(),f=d.getContext("2d");if(!f)throw new Error("Cannot get rendering context");this.$1=f;this.$4=!0;a=c.getBoundingClientRect();var g=(event.clientX-a.left)*window.devicePixelRatio,h=(event.clientY-a.top)*window.devicePixelRatio;e.onload=function(){f.drawImage(e,0,0);var a=f.getImageData(g,h,1,1);a=a.data;this.props.onAddSample&&this.props.onAddSample([a[0],a[1],a[2],a[3]])}.bind(this);e.src=b}.bind(this),this.$7=function(event){var a=this.$2,b=this.$1,c=this.$4,d=this.props.onAddSample;if(c&&b&&a&&d){c=a.getBoundingClientRect();a=(event.clientX-c.left)*window.devicePixelRatio;c=(event.clientY-c.top)*window.devicePixelRatio;b=b.getImageData(a,c,1,1);a=b.data;d([a[0],a[1],a[2],a[3]])}}.bind(this),this.$8=function(event){if(!this.$4||event.button!==0)return;this.$4=!1;this.$1=null}.bind(this),this.$15=function(a,c){this.setState({size:new(b("Vector"))(a,c)})}.bind(this),this.$11=function(a){if(a){a=b("ReactDOM").findDOMNode(a);this.$2=a instanceof HTMLImageElement?a:null}else this.$2=null}.bind(this),this.state={imageURI:null,size:null}}a.prototype.componentDidMount=function(){this.$3=!0};a.prototype.componentWillUnmount=function(){this.$3=!1};a.prototype.setState=function(a){this.$3&&h.setState.call(this,a)};a.prototype.$5=function(event){event.preventDefault()};a.prototype.$9=function(){__p&&__p();var a;return b("regeneratorRuntime").async(function(c){__p&&__p();while(1)switch(c.prev=c.next){case 0:if(this.state.size){c.next=2;break}return c.abrupt("return");case 2:c.next=4;return b("regeneratorRuntime").awrap(b("MediaEffectFrameRenderer")(this.props.assets,this.props.assetOrder,this.state.size));case 4:a=c.sent,this.setState({imageURI:a});case 6:case"end":return c.stop()}},null,this)};a.prototype.$10=function(){if(!this.state.imageURI||!this.state.size)return null;var a=!!this.props.onAddSample&&!!this.props.onSamplingStart;return b("React").createElement(b("Image.react"),{onDragStart:this.$5,onMouseDown:a?this.$6:null,onMouseMove:a?this.$7:null,onMouseOut:a?this.$8:null,onMouseUp:a?this.$8:null,ref:this.$11,src:this.state.imageURI,style:{width:this.state.size.x,height:this.state.size.y}})};a.prototype.$12=function(){return!this.state.imageURI||!this.state.size?null:b("React").createElement(b("MediaEffectFrameEditorColorMappedImage.react"),{highlightComponent:this.props.highlightComponent,imageURI:this.state.imageURI,size:this.state.size,sourcePalette:this.props.sourcePalette,transformPalette:this.props.transformPalette})};a.prototype.$13=function(){return this.$10()};a.prototype.$14=function(){if(this.props.transformPalette||this.props.highlightComponent)return this.$12();else return this.$13()};a.prototype.render=function(){this.$9()["catch"](function(a){});return b("React").createElement(b("ResponsiveBlock.react"),{className:"_3g0j",onResize:this.$15},b("React").createElement("div",{className:"_3g0k"},b("React").createElement("div",{className:"_24s9"},this.$14())))};e.exports=a}),null);
__d("MediaEffectFrameEditorPixelCanvasContainer.react",["FluxContainer","MediaEffectFrameEditorDispatcher","MediaEffectFrameEditorPixelCanvas.react","MediaEffectTemplateDataStore","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MediaEffectTemplateDataStore")]};a.calculateState=function(a,c){a=b("MediaEffectTemplateDataStore").getFrameData(c.localTemplateID);return{assets:a.assets,assetOrder:a.assetOrder}};a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.constructor.getStores())};a.prototype.render=function(){var a=babelHelpers["extends"]({},this.props,this.state);return b("React").createElement(b("MediaEffectFrameEditorPixelCanvas.react"),a)};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("AssetHorizontalAlignmentType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({LEFT:"left",RIGHT:"right",CENTER:"center"})}),null);
__d("MediaEffectFrameEditorCardTab.react",["React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.prototype.render=function(){return b("React").createElement("div",null,this.props.children)};function a(){g.apply(this,arguments)}a.defaultProps={activeHeader:null};e.exports=a}),null);
__d("MediaEffectFrameEditorTabbedCard.react",["cx","Grid.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=b("Grid.react").GridItem;c=babelHelpers.inherits(k,b("React").PureComponent);h=c&&c.prototype;function k(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=function(){this.props.onItemClick(this.props.index)}.bind(this),b}k.prototype.render=function(){return b("React").createElement("a",{href:"#",onClick:this.$1},b("React").createElement("div",{className:"_zn2"+(this.props.active?" _zn4":"")},this.props.active?this.props.activeContent||this.props.content:this.props.content))};d=babelHelpers.inherits(a,b("React").PureComponent);i=d&&d.prototype;function a(a){i.constructor.call(this,a),this.$1=function(a){this.setState({activeTabIndex:a})}.bind(this),this.state={activeTabIndex:null}}a.prototype.render=function(){var a=this.props.children,c=b("React").Children.map(a.filter(function(a){return!!a}),function(a,c){return b("React").createElement(j,null,b("React").createElement(k,{active:c===this.state.activeTabIndex,activeContent:a.props.activeHeader,content:a.props.header,index:c,onItemClick:this.$1}))}.bind(this));a=b("React").Children.map(a.filter(function(a){return!!a}),function(a,c){return b("React").createElement("div",{className:(c===this.state.activeTabIndex?"_zn4":"")+(c!==this.state.activeTabIndex?" _zn8":"")},a)}.bind(this));return b("React").createElement("div",{className:"_zn9",onMouseDown:this.props.onMouseDown},b("React").createElement(b("Grid.react"),{cols:c.length,style:{margin:"auto"}},c),a)};e.exports=a}),null);
__d("MediaEffectFrameEditorTextPropertiesDialog.react",["cx","ix","AssetHorizontalAlignmentType","Grid.react","Image.react","MediaEffectEditorFunnelLogger","MediaEffectFrameEditorCardTab.react","MediaEffectFrameEditorTabbedCard.react","MediaEffectMetadataActionCreators","React","XUIContextualDialog.react","color-picker","immutable"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k,l=b("Grid.react").GridItem,m=b("immutable").Set,n=h("86665"),o=h("86667"),p=h("86669"),q=h("86666"),r=h("86668"),s=h("86670"),t=h("86671"),u=h("86672"),v=[b("AssetHorizontalAlignmentType").LEFT,b("AssetHorizontalAlignmentType").CENTER,b("AssetHorizontalAlignmentType").RIGHT];c=babelHelpers.inherits(w,b("React").PureComponent);i=c&&c.prototype;function w(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.$1=function(){this.props.onChange(this.props.value)}.bind(this),b}w.prototype.render=function(){return b("React").createElement("a",{href:"#",onClick:this.$1},this.props.children)};d=babelHelpers.inherits(x,b("React").PureComponent);j=d&&d.prototype;function x(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=j.constructor).call.apply(a,[this].concat(d)),this.$1=function(){this.props.onChange(this.props.font)}.bind(this),b}x.prototype.render=function(){return b("React").createElement("div",{onClick:this.$1,role:"menuitem",tabIndex:"0"},b("React").createElement("div",{className:"_1jhm"},b("React").createElement("div",{className:"_1jhn"},this.props.isSelected?"\u2713":null),b("React").createElement("span",{style:{fontFamily:this.props.font.getFontFamily()}},this.props.font.getName())))};f=babelHelpers.inherits(a,b("React").PureComponent);k=f&&f.prototype;function a(a){k.constructor.call(this,a),this.$4=function(a){b("MediaEffectMetadataActionCreators").updateTextFonts(m([this.props.localAssetID]),a)}.bind(this),this.$3=function(a){var c=this.props.assetData.font.getID()===a.getID();return b("React").createElement(l,{key:a.getID()},b("React").createElement(x,{font:a,isSelected:c,onChange:this.$4}))}.bind(this),this.$7=function(a){b("MediaEffectMetadataActionCreators").updateTextAlignments(m([this.props.localAssetID]),a)}.bind(this),this.$10=function(a){b("MediaEffectMetadataActionCreators").updateTextColors(m([this.props.localAssetID]),a),this.$1=a}.bind(this),this.$9=function(){this.$1&&(b("MediaEffectEditorFunnelLogger").logChangeTextColor(this.$1),this.$1=null)}.bind(this),this.$11=function(){return this.props.context}.bind(this),this.$1=null}a.prototype.$2=function(){return b("React").createElement(b("MediaEffectFrameEditorCardTab.react"),{activeHeader:b("React").createElement("div",{className:"_1jhq"},b("React").createElement(b("Image.react"),{className:"_1jhr",src:u})),header:b("React").createElement("div",{className:"_1jhq"},b("React").createElement(b("Image.react"),{className:"_1jhr",src:t})),key:"fonts"},b("React").createElement(b("Grid.react"),{alignh:"left",alignv:"middle",cols:1,width:"100%"},this.props.fonts.map(this.$3)))};a.prototype.$5=function(){return!this.props.assetData.isDynamicText()?null:b("React").createElement(b("MediaEffectFrameEditorCardTab.react"),{activeHeader:this.$6(this.props.assetData.textHorizontalAlignment,!0),header:this.$6(this.props.assetData.textHorizontalAlignment,!1),key:"alignment"},b("React").createElement(b("Grid.react"),{alignh:"center",alignv:"middle",cols:v.length,style:{margin:"auto"}},v.map(function(a){return b("React").createElement(l,{key:a},b("React").createElement(w,{onChange:this.$7,value:a},this.$6(a,a===this.props.assetData.textHorizontalAlignment)))}.bind(this))))};a.prototype.$6=function(a,c){return b("React").createElement("div",{className:"_1jhq"},b("React").createElement(b("Image.react"),{className:"_1jhr",src:{center:c?q:n,left:c?r:o,right:c?s:p}[a]}))};a.prototype.$8=function(){return b("React").createElement(b("MediaEffectFrameEditorCardTab.react"),{header:b("React").createElement("div",{className:"_1jhq"},b("React").createElement("div",{className:"_1jhs"},b("React").createElement("div",{className:"_1jht",style:{backgroundColor:this.props.assetData.color}})))},b("React").createElement("div",{className:"_1jhu",onMouseLeave:this.$9,onMouseUp:this.$9},b("React").createElement(b("color-picker"),{className:"_1jhv",color:this.props.assetData.color,onChange:this.$10})))};a.prototype.$12=function(a){a.preventDefault()};a.prototype.render=function(){return b("React").createElement("div",{className:"_1jhw"},b("React").createElement(b("XUIContextualDialog.react"),{alignment:"center",autoFocus:!1,contextRef:this.$11,key:"contextualDialog",position:"below",shown:this.props.shown,width:b("XUIContextualDialog.react").WIDTH.NORMAL},b("React").createElement(b("MediaEffectFrameEditorTabbedCard.react"),{onMouseDown:this.$12},this.$2(),this.$5(),this.$8())))};e.exports=a}),null);
__d("MediaEffectFrameEditorTextPropertiesDialogContainer.react",["FluxContainer","MediaEffectFrameEditorDispatcher","MediaEffectFrameEditorTextPropertiesDialog.react","MediaEffectReactFrameEditorCanvasDataStore","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MediaEffectReactFrameEditorCanvasDataStore")]};a.calculateState=function(a,c){return{fonts:b("MediaEffectReactFrameEditorCanvasDataStore").getFonts()}};a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.constructor.getStores())};a.prototype.render=function(){var a=babelHelpers["extends"]({},this.props,this.state);return b("React").createElement(b("MediaEffectFrameEditorTextPropertiesDialog.react"),a)};function a(){g.apply(this,arguments)}a.defaultProps={};e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MediaEffectFramePreviewTypes",["keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirror")({PORTRAIT:"",LANDSCAPE:"",PROFILE:""});e.exports=a}),null);
__d("MediaEffectFramePreviewConfigs",["fbt","MediaEffectFramePreviewTypes"],(function(a,b,c,d,e,f,g){"use strict";a=288;c=512;d=104;d=(f={},f[b("MediaEffectFramePreviewTypes").PORTRAIT]={label:g._("Portrait"),size:{previewHeight:c,previewWidth:a}},f[b("MediaEffectFramePreviewTypes").PROFILE]={label:g._("Profile"),size:{previewHeight:d,previewWidth:d}},f[b("MediaEffectFramePreviewTypes").LANDSCAPE]={label:g._("Landscape"),size:{previewHeight:a,previewWidth:c}},f);e.exports=d}),null);
__d("MediaEffectFramePhonePreview.react",["cx","Image.react","MediaEffectFramePreviewConfigs","MediaEffectFramePreviewTypes","MediaEffectReactFrameEditorPreviewCanvas.react","React","Vector"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=361;d=643;f=811;g=400;var i=f/d,j=g/c,k=g/c,l=f/d;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.$1=function(){var a=this.props,c=a.previewWidth;a=a.previewHeight;if(c===a)return b("MediaEffectFramePreviewTypes").PROFILE;else if(c>a)return b("MediaEffectFramePreviewTypes").LANDSCAPE;else return b("MediaEffectFramePreviewTypes").PORTRAIT};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.previewWidth;a=a.previewHeight;c===a&&(c=b("MediaEffectFramePreviewConfigs")[b("MediaEffectFramePreviewTypes").PORTRAIT].size.previewWidth,a=b("MediaEffectFramePreviewConfigs")[b("MediaEffectFramePreviewTypes").PORTRAIT].size.previewHeight);var d=a>c,e=d?k:i,f=d?l:j,g=this.props.previewImage;if(!g)switch(this.$1()){case b("MediaEffectFramePreviewTypes").PORTRAIT:g="/images/media_effect/frame_preview/phone_portrait.png";break;case b("MediaEffectFramePreviewTypes").LANDSCAPE:g="/images/media_effect/frame_preview/phone_landscape.png";break;case b("MediaEffectFramePreviewTypes").PROFILE:g="/images/media_effect/frame_preview/phone_profile.png";break}return b("React").createElement("div",{className:"_3076",style:{height:a*f,width:c*e}},b("React").createElement("div",{className:(d?"_5znd":"")+(d?"":" _5znl")},b("React").createElement("div",{className:this.$1()===b("MediaEffectFramePreviewTypes").PROFILE?"_60qj":""},b("React").createElement(b("MediaEffectReactFrameEditorPreviewCanvas.react"),{assetOrder:this.props.assetOrder,assets:this.props.assets,backgroundColor:this.props.backgroundColor,backgroundImage:this.props.backgroundImage,previewSize:new(b("Vector"))(this.props.previewWidth,this.props.previewHeight),videoSourceID:this.props.videoSourceID}))),b("React").createElement(b("Image.react"),{className:"_43y6",height:a*f,src:g,width:c*e}))};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectFramePhonePreviewContainer.react",["FluxContainer","MediaEffectFrameEditorDispatcher","MediaEffectFramePhonePreview.react","MediaEffectReactFrameEditorCanvasDataStore","MediaEffectReactFrameEditorDataStore","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.calculateState=function(){var a=b("MediaEffectReactFrameEditorDataStore").getState(),c=b("MediaEffectReactFrameEditorCanvasDataStore").getState();return{assets:a.assets,assetOrder:a.assetOrder,backgroundColor:c.backgroundColor,backgroundImage:c.backgroundImage}};a.getStores=function(){return[b("MediaEffectReactFrameEditorDataStore"),b("MediaEffectReactFrameEditorCanvasDataStore")]};a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.constructor.getStores())};a.prototype.render=function(){return b("React").createElement(b("MediaEffectFramePhonePreview.react"),{assetOrder:this.state.assetOrder,assets:this.state.assets,backgroundColor:this.state.backgroundColor,backgroundImage:this.state.backgroundImage,previewHeight:this.props.previewHeight,previewImage:this.props.previewImage,previewWidth:this.props.previewWidth,videoSourceID:this.props.videoSourceID})};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MediaEffectFrameRenderer",["Promise","regeneratorRuntime","MediaEffectReactFrameEditorImageAssetRecord","Vector","mediaEffectGKCheck"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=800,h=.625;function i(a){var c=new Image();c.crossOrigin="anonymous";c.src=a;a=new(b("Promise"))(function(a,b){c.onload=function(){return a(c)}});return a}function j(a,c,d,e){__p&&__p();var f,g,h;return b("regeneratorRuntime").async(function(j){__p&&__p();while(1)switch(j.prev=j.next){case 0:j.next=2;return b("regeneratorRuntime").awrap(i(e.getURI()));case 2:f=j.sent;g=e.assetSize;if(g){j.next=6;break}throw new Error("Asset size not set",e);case 6:g.isValid()||(g=g.set("aspect_ratio",f.width/f.height));if(g.isValid()){j.next=9;break}throw new Error("Asset size not valid",e);case 9:a=g.toAbsolute(d),h=e.position.toAbsolute(d,a),c.drawImage(f,h.getLeft(),h.getTop(),h.getWidth(),h.getHeight());case 12:case"end":return j.stop()}},null,this)}function k(a,c,d,e){__p&&__p();var f,g,h,i,j;return b("regeneratorRuntime").async(function(b){__p&&__p();while(1)switch(b.prev=b.next){case 0:f=e.assetSize;if(f){b.next=3;break}throw new Error("Asset size not set",e);case 3:if(f.isValid()){b.next=5;break}throw new Error("Asset size not valid",e);case 5:a=f.toAbsolute(d);g=e.position.toAbsolute(d,a);h=g.getHeight()+"px";i=e.font.getFontFamily();c.font=h+" "+i;c.fillStyle=e.color;c.textAlign=e.textHorizontalAlignment;j=d.x/2;b.t0=e.textHorizontalAlignment;b.next=b.t0==="left"?16:b.t0==="center"?18:b.t0==="right"?20:22;break;case 16:j=g.getLeft();return b.abrupt("break",22);case 18:j=g.getCenter().x;return b.abrupt("break",22);case 20:j=g.getRight();return b.abrupt("break",22);case 22:c.fillText(e.content,j,g.getBottom(),g.getWidth());case 23:case"end":return b.stop()}},null,this)}function l(a,c,d,e){__p&&__p();return b("regeneratorRuntime").async(function(f){__p&&__p();while(1)switch(f.prev=f.next){case 0:if(!(e instanceof b("MediaEffectReactFrameEditorImageAssetRecord"))){f.next=5;break}f.next=3;return b("regeneratorRuntime").awrap(j(a,c,d,e));case 3:f.next=7;break;case 5:f.next=7;return b("regeneratorRuntime").awrap(k(a,c,d,e));case 7:case"end":return f.stop()}},null,this)}function m(a,c,d){__p&&__p();var e,f,g;return b("regeneratorRuntime").async(function(h){__p&&__p();while(1)switch(h.prev=h.next){case 0:e=c.map(function(b){return a.get(b)});f=document.createElement("canvas");f.width=d.x;f.height=d.y;g=f.getContext("2d",{premultipliedAlpha:!0});if(g){h.next=7;break}throw new Error("Cannot get rendering context");case 7:h.next=9;return b("regeneratorRuntime").awrap(b("Promise").all(e.map(function(a){return l(f,g,d,a)}).toArray()));case 9:return h.abrupt("return",f);case 10:case"end":return h.stop()}},null,this)}function a(a,c,d){__p&&__p();var e,f,i,j,k,l,n,o,p,q,r,s,t,u;return b("regeneratorRuntime").async(function(v){__p&&__p();while(1)switch(v.prev=v.next){case 0:if(!(d.x===0||d.y===0)){v.next=2;break}return v.abrupt("return",0);case 2:e=Math.min(d.y,g);f=e*d.x/d.y;i=e;v.next=7;return b("regeneratorRuntime").awrap(m(a,c,new(b("Vector"))(f,i)));case 7:j=v.sent;k=j.getContext("2d");if(k){v.next=11;break}throw new Error("Cannot get rendering context");case 11:l=0;n=0;o=i;p=f;b("mediaEffectGKCheck")("media_effect_coverage_test_v2")&&(p=Math.floor(f*h),l=Math.floor((f-p)/2),o=Math.floor(i*h),n=Math.floor((i-o)/2));q=p*o;r=k.getImageData(l,n,p,o);s=r.data;t=0;for(u=3;u<s.length;u+=4)t+=s[u];return v.abrupt("return",t/(255*q));case 22:case"end":return v.stop()}},null,this)}function c(a,c,d){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(m(a,c,d.mul(window.devicePixelRatio)));case 2:e=f.sent;return f.abrupt("return",e.toDataURL());case 4:case"end":return f.stop()}},null,this)}c.percentageCovered=a;e.exports=c}),null);
__d("MediaEffectWarnings.react",["cx","List.react","React","XUICard.react","XUICardSection.react","XUINotice.react","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){var a=this.props,c=a.message,d=a.items,e=a.use,f=a.className;a=a.onDismiss;d=d&&d.length>0?b("React").createElement(b("List.react"),{border:"none",className:"_45qz"},d.map(function(a,c){return b("React").createElement("li",{key:c},a.trim())})):null;return b("React").createElement(b("XUICard.react"),{className:b("joinClasses")(f,"_2ex6 _3-8x _190n")},b("React").createElement(b("XUICardSection.react"),{background:"transparent",className:"_190n",style:{borderTop:"none"}},b("React").createElement(b("XUINotice.react"),{onDismiss:a,use:e||"warn"},c,d)))};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectRejectedReviewResult.react",["cx","fbt","Link.react","MediaEffectWarnings.react","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){var a=this.props.reasons;if(!a||a.length===0)return null;a=a.map(function(a){return typeof a==="string"?a.trim():a}).filter(Boolean);var c=b("React").createElement(b("Link.react"),{href:"/legal/camera_effects_platform_terms",target:"_blank"},h._("terms")),d=b("React").createElement(b("Link.react"),{href:"/legal/camera_effects_platform_policies",target:"_blank"},h._("policies."));c=this.props.isTrailingReview?h._("Your effect distribution stopped because it doesn't meet the Camera Effects Platform {terms} and {policies}",[h._param("terms",c),h._param("policies",d)]):h._("Your effect wasn't approved because it doesn't meet the Camera Effects Platform {terms} and {policies}",[h._param("terms",c),h._param("policies",d)]);return b("React").createElement(b("MediaEffectWarnings.react"),{className:"_21ks",items:a,message:c})};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectFullscreenFrameEditor.react",["cx","ix","Image.react","MediaEffectFullscreenFrameEditorControls.react","MediaEffectFullscreenFrameEditorPreviewPanelContainer.react","MediaEffectMetadataActionCreators","MediaEffectQEUtils","MediaEffectReactFrameEditorCanvasContainer.react","MediaEffectRejectedReviewResult.react","React","Vector"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.$1=function(a){var c=a.files;if(c)for(var d=0;d<c.length;d++){var e=c.item(d);e&&b("MediaEffectMetadataActionCreators").addImage(e)}a.value=""};a.prototype.$2=function(){navigator.getUserMedia&&navigator.getUserMedia({video:!0},function(a){return b("MediaEffectMetadataActionCreators").startCamera(window.URL.createObjectURL(a))},function(a){return!1})};a.prototype.$3=function(){var a=this.props.rejectReasons;return a&&a.length!==0?b("React").createElement(b("MediaEffectRejectedReviewResult.react"),{reasons:a}):null};a.prototype.render=function(){return b("React").createElement("div",{className:"_1skh"},b("React").createElement("div",null,b("React").createElement(b("MediaEffectFullscreenFrameEditorControls.react"),{assetNum:this.props.assetNum,cameraEnabled:this.props.cameraEnabled,cameraPaused:this.props.cameraPaused,canvasBgColor:this.props.canvasBgColor,context:this.props.context,filterID:this.props.filterID,filtersData:this.props.filtersData,flowType:this.props.flowType,fontColor:this.props.fontColor,frameData:this.props.frameData,isFrameValid:this.props.isFrameValid,isValidating:this.props.isValidating,loading:this.props.loading,selectedTextIDs:this.props.selectedTextIDs}),this.$3()),b("React").createElement("div",{className:"_2yvx"},b("React").createElement(b("MediaEffectReactFrameEditorCanvasContainer.react"),{bootstrapData:this.props.frameData,enableEditorFreeText:this.props.context.enableEditorFreeText,enableFontSettingsDialog:this.props.context.enableFontSettingsDialog,includesPhoneFrame:b("MediaEffectQEUtils").shouldDefaultToPortrait(this.props.flowType),showTitle:!1})),b("React").createElement("div",{className:"_1skk"},b("React").createElement(b("MediaEffectFullscreenFrameEditorPreviewPanelContainer.react"),{previewScale:.3,previewSize:new(b("Vector"))(400,225)})),b("React").createElement("div",{className:"_zn8"},b("React").createElement(b("Image.react"),{src:h("86663")}),b("React").createElement(b("Image.react"),{src:h("86664")})))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectFullscreenFrameEditorContainer.react",["FluxContainer","MediaEffectFrameCreateDialogDataStore","MediaEffectFullscreenFrameEditor.react","MediaEffectMetadataStore","MediaEffectReactFrameEditorCanvasDataStore","MediaEffectReactFrameEditorDataStore","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=function(a){return a?a.assetType()==="MediaEffectReactFrameEditorTextAssetRecord":!1},i=function(a){return a?a.assetType()==="MediaEffectReactFrameEditorImageAssetRecord":!1};g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MediaEffectFrameCreateDialogDataStore"),b("MediaEffectMetadataStore"),b("MediaEffectReactFrameEditorCanvasDataStore"),b("MediaEffectReactFrameEditorDataStore")]};a.calculateState=function(a,c){var d=b("MediaEffectReactFrameEditorDataStore").getState();a=b("MediaEffectReactFrameEditorCanvasDataStore").getState();c=b("MediaEffectFrameCreateDialogDataStore").getState();c=c.flowType;var e=a.selectedAssets.filter(function(a){return h(d.assets.get(a))}),f=d.assets.some(function(a){return i(a)&&!a.stickerFBID});return{canvasBgColor:a.backgroundColor,filterID:d.filterID,flowType:c,fontColor:e.size>0?d.assets.get(e.first()).color:"#ffffff",loading:f,selectedTextIDs:e,cameraEnabled:a.cameraSource!=null,cameraPaused:a.cameraPaused,isFrameValid:b("MediaEffectReactFrameEditorDataStore").isValidForSubmit(),isValidating:b("MediaEffectFrameCreateDialogDataStore").isValidating(),rejectReasons:b("MediaEffectMetadataStore").getState().get("rejectReasons"),assetNum:d.assets.size}};a.prototype.render=function(){var a=babelHelpers["extends"]({},this.props,this.state);return b("React").createElement(b("MediaEffectFullscreenFrameEditor.react"),a)};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MediaEffectFullscreenFrameEditorControls.react",["cx","fbt","ix","FileInput.react","FrameEditorSupportedGeneratedText","Image.react","MediaEffectEditorSideMenuContainer.react","MediaEffectFlowType","MediaEffectFrameEditorTemplatePanelContainer.react","MediaEffectMetadataActionCreators","MediaEffectUserContext","PopoverMenu.react","React","ReactXUIMenu","XUIError.react","XUIContextualDialog.react","XUIContextualDialogTitle.react","XUIContextualDialogBody.react","mediaEffectGKCheck"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("ReactXUIMenu").Item;c=babelHelpers.inherits(a,b("React").PureComponent);j=c&&c.prototype;function a(a){j.constructor.call(this,a),this.$3=function(a){a=a.target;a instanceof HTMLInputElement&&this.$4(a)}.bind(this),this.state={uploadArtTooltipShown:!1}}a.prototype.$1=function(){return b("React").createElement(b("ReactXUIMenu"),{onItemClick:this.$2},this.props.context.enableEditorFreeText?b("React").createElement(k,{key:"freetext",value:null},"Free text"):null,Object.keys(b("FrameEditorSupportedGeneratedText")).map(function(a){return b("React").createElement(k,{key:a,value:a},b("FrameEditorSupportedGeneratedText")[a])}))};a.prototype.$2=function(a,c){b("MediaEffectMetadataActionCreators").addText(c.item.getValue())};a.prototype.$4=function(a){var c=a.files;if(c)for(var d=0;d<c.length;d++){var e=c.item(d);e&&b("MediaEffectMetadataActionCreators").addImage(e)}a.value=""};a.prototype.$5=function(){navigator.getUserMedia&&navigator.getUserMedia({video:!0},function(a){return b("MediaEffectMetadataActionCreators").startCamera(window.URL.createObjectURL(a))},function(a){return!1})};a.prototype.$6=function(){if(this.props.isValidating&&this.props.assetNum===0)if(this.props.context.enableEditorFreeText)return h._("Please insert some text or an art asset to continue");else return h._("Please insert an art asset to continue");return null};a.prototype.$7=function(){var a=h._("Enter text here").toString();b("MediaEffectMetadataActionCreators").addText(a,null,null)};a.prototype.$8=function(){var a=b("React").createElement(b("XUIContextualDialog.react"),{contextRef:function(){return this.uploadArtButton}.bind(this),hideOnBlur:!0,hoverShowDelay:1e3,hoverContextRef:function(){return this.uploadArtButton}.bind(this),position:"right",shown:this.state.uploadArtTooltipShown,width:b("XUIContextualDialog.react").WIDTH.NORMAL},b("React").createElement(b("XUIContextualDialogTitle.react"),null,h._("Upload Art")),b("React").createElement(b("XUIContextualDialogBody.react"),null,h._("Upload PNGs with a transparent background. You can upload multiple PNGs at a time.")));return b("React").createElement(b("FileInput.react"),{accept:"image/x-png, image/jpeg, image/png",multiple:!0,onChange:this.$3,onMouseEnter:function(){this.setState({uploadArtTooltipShown:!0})}.bind(this),onMouseLeave:function(){this.setState({uploadArtTooltipShown:!1})}.bind(this)},b("React").createElement("a",{className:"_2w6x _3-fi _3-fj",href:"#"},b("React").createElement(b("Image.react"),{className:"_3-8x",height:"44",src:i("86673"),width:"44"}),b("React").createElement("div",{ref:function(a){this.uploadArtButton=a}.bind(this)}),a,b("React").createElement("div",null,h._("Upload Art"))))};a.prototype.$9=function(){return b("React").createElement("a",{className:"_2w6x _3-fi _3-fj",href:"#",onClick:this.$7},b("React").createElement(b("Image.react"),{className:"_3-8x",height:"44",src:i("86675"),width:"44"}),b("React").createElement("div",null,h._("Insert Text")))};a.prototype.$10=function(){return b("React").createElement(b("PopoverMenu.react"),{alignv:"middle",menu:this.$1()},b("React").createElement("a",{className:"_2w6x _3-fi _3-fj",href:"#"},b("React").createElement(b("Image.react"),{className:"_3-8x",height:"44",src:i("86675"),width:"44"}),b("React").createElement("div",null,"Text")))};a.prototype.$11=function(){return b("MediaEffectUserContext").includesFBOnly?this.$10():this.$9()};a.prototype.render=function(){var a=b("mediaEffectGKCheck")("media_effect_template")&&this.props.flowType!==b("MediaEffectFlowType").EVENT&&this.props.flowType!==b("MediaEffectFlowType").TEMPLATE,c=this.$6();return b("React").createElement("div",{className:"_2j1s"},b("React").createElement(b("XUIError.react"),{xuiError:c},b("React").createElement("div",{className:c?"_3gvu":""},b("React").createElement("div",{className:"_1pbz _3-96"},this.$8(),this.props.context.enableEditorFreeText||b("MediaEffectUserContext").includesFBOnly?this.$11():null),a?b("React").createElement(b("MediaEffectFrameEditorTemplatePanelContainer.react"),null):null)),b("React").createElement(b("MediaEffectEditorSideMenuContainer.react"),{flowType:this.props.flowType}))};e.exports=a}),null);
__d("MediaEffectFullscreenFrameEditorPreviewPanel.react",["ix","cx","fbt","Image.react","MediaEffectQEUtils","MediaEffectReactFrameEditorPreviewContainer.react","React","Vector","XUIContextualDialog.react","XUIContextualDialogBody.react","XUIContextualDialogTitle.react","fbglyph"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=babelHelpers.inherits(a,b("React").PureComponent);j=c&&c.prototype;function a(a){j.constructor.call(this,a),this.state={showPreviewFormatTooltip:!1}}a.prototype.render=function(){var a=this.props.portraitCanvasWidth/this.props.popoverPortraitCanvasWidth,c=b("React").createElement("div",{className:"_3-8z"},b("React").createElement(b("MediaEffectReactFrameEditorPreviewContainer.react"),{previewScale:a,previewSize:new(b("Vector"))(this.props.popoverPortraitCanvasWidth,this.props.popoverPortraitCanvasHeight)})),d=b("React").createElement("div",{className:"_3-8z"},b("React").createElement(b("MediaEffectReactFrameEditorPreviewContainer.react"),{previewScale:a,previewSize:new(b("Vector"))(this.props.popoverPortraitCanvasWidth,this.props.popoverPortraitCanvasWidth)}));a=b("React").createElement("div",{className:"_3-8z"},b("React").createElement(b("MediaEffectReactFrameEditorPreviewContainer.react"),{previewScale:a,previewSize:new(b("Vector"))(this.props.popoverPortraitCanvasHeight,this.props.popoverPortraitCanvasWidth)}));var e=b("React").createElement(b("Image.react"),{src:g("126340")}),f=b("React").createElement(b("XUIContextualDialog.react"),{contextRef:function(){return this.previewFormatsTitle}.bind(this),hideOnBlur:!0,hoverContextRef:function(){return this.previewFormatsTitle}.bind(this),hoverShowDelay:1e3,position:"left",shown:this.state.showPreviewFormatTooltip,width:b("XUIContextualDialog.react").WIDTH.NORMAL},b("React").createElement(b("XUIContextualDialogTitle.react"),null,i._("Preview Formats")),b("React").createElement(b("XUIContextualDialogBody.react"),null,i._("Your art will automatically be positioned to work on different photo and video orientations.")));return b("React").createElement("div",null,b("React").createElement("div",{onMouseEnter:function(){this.setState({showPreviewFormatTooltip:!0})}.bind(this),onMouseLeave:function(){this.setState({showPreviewFormatTooltip:!1})}.bind(this)},b("React").createElement("span",{className:"_202m"},i._("Preview Formats")),e),b("React").createElement("div",{ref:function(a){this.previewFormatsTitle=a}.bind(this)}),f,this.props.previewConfig.showPortrait&&c,this.props.previewConfig.showProfile&&d,this.props.previewConfig.showLandscape&&a)};e.exports=a}),null);
__d("MediaEffectFullscreenFrameEditorPreviewPanelContainer.react",["FluxContainer","MediaEffectFlowType","MediaEffectFrameCreateDialogDataStore","MediaEffectFrameEditorDispatcher","MediaEffectFullscreenFrameEditorPreviewPanel.react","MediaEffectFullscreenFrameEditorSizingUtils","MediaEffectReactFrameEditorCanvasDataStore","MediaEffectReactFrameEditorDataStore","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MediaEffectReactFrameEditorDataStore"),b("MediaEffectReactFrameEditorCanvasDataStore"),b("MediaEffectFrameCreateDialogDataStore")]};a.calculateState=function(a){a=b("MediaEffectReactFrameEditorDataStore").getState();var c=b("MediaEffectReactFrameEditorCanvasDataStore").getState(),d=b("MediaEffectFrameCreateDialogDataStore").getState(),e=d.screenWidth;d=d.dialogHeight;var f=b("MediaEffectFullscreenFrameEditorSizingUtils").getPortraitPreviewHeight(e,d),g=9/16*f;e=b("MediaEffectFullscreenFrameEditorSizingUtils").getPortraitFullPreviewHeight(e,d);d=9/16*e;var h=b("MediaEffectFrameCreateDialogDataStore").getState().flowType;return{assets:a.assets,assetOrder:a.assetOrder,backgroundColor:c.backgroundColor,backgroundImage:c.backgroundImage,cameraEnabled:c.cameraSource!=null,portraitCanvasWidth:g,portraitCanvasHeight:f,popoverPortraitCanvasWidth:d,popoverPortraitCanvasHeight:e,previewConfig:{showLandscape:h!==b("MediaEffectFlowType").LIVE_TEMPLATE,showProfile:h!==b("MediaEffectFlowType").LIVE_TEMPLATE,showPortrait:!0}}};a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.constructor.getStores())};a.prototype.render=function(){var a=babelHelpers["extends"]({},this.props,this.state);return b("React").createElement(b("MediaEffectFullscreenFrameEditorPreviewPanel.react"),a)};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MediaEffectColorPaletteComponentRecord",["immutable","colr-convert"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;a=b("immutable").Record;function h(a){return("00"+a.toString(16)).substr(-2)}function i(a,b){a=a||0;b=b||b===0?b:1;return b+k()*(a-b)}function j(a,b){a=a||0;b=b||b===0?b:1;var c=2*Math.random()-1;c=(c*c*c+1)/2;return a+c*(b-a)}function k(a,b){a=a||0;b=b||b===0?b:1;var c=Math.random();c=c*c;return a+c*(b-a)}function l(a,b){a=a||0;b=b||b===0?b:1;return a+Math.random()*(b-a)}g=babelHelpers.inherits(m,a({hue:.5,saturation:1,lightness:.5,hueVariation:.05,saturationVariation:.3,lightnessVariation:.3}));g&&g.prototype;m.random=function(){return new m({hue:l(),saturation:i(),lightness:j(),hueVariation:k(.05,.4),saturationVariation:l(.2,1),lightnessVariation:l(.2,1)})};m.prototype.toRGB=function(){var a=b("colr-convert").hsl.rgb([this.hue*360,this.saturation*100,this.lightness*100]).map(Math.floor);return"#"+a.map(h).join("")};m.prototype.toString=function(){return[this.hue.toFixed(3)+"+"+this.hueVariation.toFixed(3),this.saturation.toFixed(3)+"+"+this.saturationVariation.toFixed(3),this.lightness.toFixed(3)+"+"+this.lightnessVariation.toFixed(3)].join(":")};function m(){g.apply(this,arguments)}e.exports=m}),null);
__d("MediaEffectColorPaletteRecord",["immutable","MediaEffectColorPaletteComponentRecord"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("immutable").List;a=b("immutable").Record;g=babelHelpers.inherits(i,a({components:h()}));g&&g.prototype;i.random=function(){return new i({components:h.of(b("MediaEffectColorPaletteComponentRecord").random(),b("MediaEffectColorPaletteComponentRecord").random(),b("MediaEffectColorPaletteComponentRecord").random(),b("MediaEffectColorPaletteComponentRecord").random())})};i.prototype.getMainColor=function(){return this.components.size===0?null:this.components.get(0).toRGB()};i.prototype.toString=function(){return this.components.map(function(a){return a.toString()}).join(",")};function i(){g.apply(this,arguments)}e.exports=i}),null);
__d("MediaEffectReactFrameEditorScalarAssetPositionRecord",["immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;a=b("immutable").Record;g=babelHelpers.inherits(h,a({anchor_origin:"asset_start",anchor_asset_size_percentage:50,anchor_pixel_offset:0,asset_origin:"canvas_start",asset_canvas_size_percentage:50,asset_pixel_offset:0}));g&&g.prototype;h.canonical=function(a,b,c){__p&&__p();var d=c-a/2;if(Math.abs(d)<.01)return new h();if(d>0){d=a-(c+b/2);return new h({anchor_origin:"asset_end",anchor_asset_size_percentage:0,asset_origin:"canvas_end",asset_canvas_size_percentage:100*d/a})}else{d=c-b/2;return new h({anchor_origin:"asset_start",anchor_asset_size_percentage:0,asset_origin:"canvas_start",asset_canvas_size_percentage:100*d/a})}};h.prototype.isBackendCompatible=function(){return this.anchor_pixel_offset||this.asset_pixel_offset||this.anchor_origin==="asset_start"&&this.asset_origin==="canvas_end"||this.anchor_origin==="asset_end"&&this.asset_origin==="canvas_start"?!1:this.anchor_asset_size_percentage===50&&this.asset_canvas_size_percentage===50||this.anchor_asset_size_percentage===0};h.prototype.getStart=function(a,b){a=this.$MediaEffectReactFrameEditorScalarAssetPositionRecord1(a);b=this.$MediaEffectReactFrameEditorScalarAssetPositionRecord2(b);return a-b};h.prototype.$MediaEffectReactFrameEditorScalarAssetPositionRecord1=function(a){var b=a*this.asset_canvas_size_percentage/100+this.asset_pixel_offset;if(this.asset_origin==="canvas_start")return b;else return a-b};h.prototype.$MediaEffectReactFrameEditorScalarAssetPositionRecord2=function(a){var b=a*this.anchor_asset_size_percentage/100+this.anchor_pixel_offset;if(this.anchor_origin==="asset_start")return b;else return a-b};function h(){g.apply(this,arguments)}e.exports=h}),null);
__d("MediaEffectReactFrameEditorAssetPositionRecord",["immutable","MediaEffectReactFrameEditorScalarAssetPositionRecord","Rect"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;a=b("immutable").Record;g=babelHelpers.inherits(h,a({x:new(b("MediaEffectReactFrameEditorScalarAssetPositionRecord"))(),y:new(b("MediaEffectReactFrameEditorScalarAssetPositionRecord"))()}));g&&g.prototype;h.fromCenter=function(a,c){return new h({x:new(b("MediaEffectReactFrameEditorScalarAssetPositionRecord"))({anchor_origin:"asset_start",anchor_asset_size_percentage:50,anchor_pixel_offset:0,asset_origin:"canvas_start",asset_canvas_size_percentage:a,asset_pixel_offset:0}),y:new(b("MediaEffectReactFrameEditorScalarAssetPositionRecord"))({anchor_origin:"asset_start",anchor_asset_size_percentage:50,anchor_pixel_offset:0,asset_origin:"canvas_start",asset_canvas_size_percentage:c,asset_pixel_offset:0})})};h.canonical=function(a,c){return new h({x:b("MediaEffectReactFrameEditorScalarAssetPositionRecord").canonical(c.x,a.w(),a.w()/2+a.l),y:b("MediaEffectReactFrameEditorScalarAssetPositionRecord").canonical(c.y,a.h(),a.h()/2+a.t)})};h.prototype.isBackendCompatible=function(){return this.x.isBackendCompatible()&&this.y.isBackendCompatible()};h.prototype.toAbsolute=function(a,c){var d=this.x.getStart(a.x,c.x);a=this.y.getStart(a.y,c.y);return new(b("Rect"))(a,d+c.x,a+c.y,d)};function h(){g.apply(this,arguments)}e.exports=h}),null);
__d("MediaEffectReactFrameDeserializer",["invariant","immutable","MediaEffectColorPaletteComponentRecord","MediaEffectColorPaletteRecord","MediaEffectReactFrameEditorAssetPositionRecord","MediaEffectReactFrameEditorCanvasDataStore","MediaEffectReactFrameEditorImageAssetRecord","MediaEffectReactFrameEditorScalarAssetPositionRecord","MediaEffectReactFrameEditorScalarSizeRecord","MediaEffectReactFrameEditorSize","MediaEffectReactFrameEditorTemplateRecord","MediaEffectReactFrameEditorTextAssetRecord"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("immutable").List,i=b("immutable").Map;function j(a){return!a||a==="0"?null:a}function k(a){a=a.split("+");var b=parseFloat(a[0]);a=parseFloat(a[1]);b>=0&&b<=1||g(0);a>=0&&a<=1||g(0);return{value:b,variation:a}}function l(a){a=a.split(":").map(k);a.length===3||g(0);return new(b("MediaEffectColorPaletteComponentRecord"))({hue:a[0].value,saturation:a[1].value,lightness:a[2].value,hueVariation:a[0].variation,saturationVariation:a[1].variation,lightnessVariation:a[2].variation})}function m(a){return!a?new(b("MediaEffectColorPaletteRecord"))({components:h()}):new(b("MediaEffectColorPaletteRecord"))({components:h(a.split(",").map(l))})}function n(a,c){c=a;return new(b("MediaEffectReactFrameEditorAssetPositionRecord"))({x:new(b("MediaEffectReactFrameEditorScalarAssetPositionRecord"))({anchor_asset_size_percentage:c.horizontal_alignment==="center"?50:0,anchor_origin:c.horizontal_alignment==="right"?"asset_end":"asset_start",asset_origin:c.horizontal_alignment==="right"?"canvas_end":"canvas_start",asset_canvas_size_percentage:c.horizontal_alignment==="center"?50:c.horizontal_margin}),y:new(b("MediaEffectReactFrameEditorScalarAssetPositionRecord"))({anchor_asset_size_percentage:c.vertical_alignment==="center"?50:0,anchor_origin:c.vertical_alignment==="bottom"?"asset_end":"asset_start",asset_origin:c.vertical_alignment==="bottom"?"canvas_end":"canvas_start",asset_canvas_size_percentage:c.vertical_alignment==="center"?50:c.vertical_margin})})}function o(a,c,d){d=c.size_dimension==="width";var e=a.size_dimension==="height";if(!d&&!e)return new(b("MediaEffectReactFrameEditorSize").Fill)({width:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:a.size}),height:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:c.size}),aspect_ratio:a.size/c.size});if(d&&e)return new(b("MediaEffectReactFrameEditorSize").Fit)({width:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:c.size}),height:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:a.size}),aspect_ratio:c.size/a.size});return d?new(b("MediaEffectReactFrameEditorSize").ScaleWidth)({width:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:c.size})}):new(b("MediaEffectReactFrameEditorSize").ScaleHeight)({height:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:a.size})})}function p(a,c,d){return new(b("MediaEffectReactFrameEditorSize").Stretch)({width:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:c.textbox_width}),height:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:c.size})})}function q(a){var c=j(a.source_template_asset_id);return new(b("MediaEffectReactFrameEditorImageAssetRecord"))({assetFBID:j(a.asset_id),dynamic_sticker_pack_id:j(a.dynamic_sticker_pack_id),dynamic_sticker_type:a.dynamic_sticker_type,stickerFBID:a.sticker_id,sourceTemplateAssetFBID:c,hostedImageURI:a.sticker_url,position:n(a.landscape_position,a.portrait_position),assetSize:o(a.landscape_position,a.portrait_position,b("MediaEffectReactFrameEditorCanvasDataStore").getState().canvasSize),readOnly:!!c,assocTextAsset:a.assoc_text_asset&&r(a.assoc_text_asset)})}function r(a){var c=a.font_name||a.custom_font_id;!c&&g(0);return new(b("MediaEffectReactFrameEditorTextAssetRecord"))({assetFBID:j(a.asset_id),content:a.content,font:b("MediaEffectReactFrameEditorCanvasDataStore").getFont(c),color:"#"+a.color,sourceTemplateAssetFBID:j(a.source_template_asset_id),textHorizontalAlignment:a.portrait_position.text_horizontal_alignment,position:n(a.landscape_position,a.portrait_position),assetSize:p(a.landscape_position,a.portrait_position,b("MediaEffectReactFrameEditorCanvasDataStore").getState().canvasSize)})}function a(a){__p&&__p();var b=i(),c=h().withMutations(function(c){__p&&__p();b=b.withMutations(function(b){__p&&__p();a.stickers.forEach(function(a,d){a=q(a);a=a.set("localAssetID",d+1);a.assocTextAsset&&(a=a.set("assocTextAsset",a.assocTextAsset.set("localAssetID",d+1)));c.push(a.localAssetID);b.set(a.localAssetID,a)}),a.text.forEach(function(d,e){d=r(d);d=d.set("localAssetID",a.stickers.length+e+1);c.push(d.localAssetID);b.set(d.localAssetID,d)})})});return{assets:b,assetOrder:c,frameFBID:a.fbid,filterID:a.filter_id,templateFBID:j(a.source_template_id),colorPalette:m(a.color_palette)}}function c(a){return new(b("MediaEffectReactFrameEditorTemplateRecord"))({templateFBID:a.id,previewURL:a.uri,sourceTemplateFBID:a.source_id,variants:h(a.variant_ids),colorPalette:m(a.color_palette)})}e.exports={deserializeData:a,deserializeColorPalette:m,deserializeTemplate:c}}),null);
__d("MediaEffectReactFrameEditorAsset.react",["ix","cx","fbt","DOMQuery","FBDragHandle.react","FBToggleSwitch.react","FileInput.react","InputLabel.react","MediaEffectEditorAsset","MediaEffectEditorFunnelLogger","MediaEffectFlowType","MediaEffectMetadataActionCreators","MediaEffectReactFrameEditorCanvasImageAsset.react","MediaEffectReactFrameEditorImageAsset.react","MediaEffectReactFrameEditorImageAssetRecord","MediaEffectReactFrameEditorTextAsset.react","MediaEffectReactFrameEditorTextAssetRecord","MountedContextMenu.react","PopoverMenu.react","React","ReactDOM","ReactXUIMenu","MenuSeparator.react","SimpleXUIDialog","XUIPopoverButton.react","XUIError.react","SUIButton.react","SUIGlyphIcon.react","SUIMediaEffectTheme","fbglyph","emptyFunction","immutable","nullthrows"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("ReactXUIMenu").Item,l=b("ReactXUIMenu").ItemNoAction;c=b("immutable").Map;function m(a){return{top:a.t,left:a.l,width:a.w(),height:a.h(),position:"absolute"}}d=babelHelpers.inherits(a,b("React").PureComponent);j=d&&d.prototype;function a(a){__p&&__p();j.constructor.call(this,a),this.$1=[],this.$2=[],this.$3=null,this.$4=null,this.$5=null,this.$6=function(){!this.props.readOnly&&this.props.enableEditorFreeText&&b("MediaEffectMetadataActionCreators").editText(this.props.localAssetID)}.bind(this),this.$7=function(){return this.props.initialPositionMap}.bind(this),this.$8=function(){var a;for(var b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return(a=this.props).onDrag.apply(a,[this.props.localAssetID].concat(c))}.bind(this),this.$9=function(){b("MediaEffectMetadataActionCreators").raiseAsset(this.props.localAssetID)}.bind(this),this.$10=function(){var a=this.props,c=a.assetData;a=a.localAssetID;b("MediaEffectMetadataActionCreators").removeBackground(a,c.stickerFBID);this.setState({hasProcessed:!0});b("MediaEffectEditorFunnelLogger").logApplyAutoBackgroundRemoval(this.props.assetData.stickerFBID)}.bind(this),this.$11=function(){b("MediaEffectMetadataActionCreators").raiseAsset(this.props.localAssetID,!0)}.bind(this),this.$12=function(){b("MediaEffectMetadataActionCreators").lowerAsset(this.props.localAssetID)}.bind(this),this.$13=function(){b("MediaEffectMetadataActionCreators").lowerAsset(this.props.localAssetID,!0)}.bind(this),this.$14=function(a){a.target.files[0]&&b("MediaEffectMetadataActionCreators").replaceImage(this.props.localAssetID,a.target.files[0])}.bind(this),this.$15=function(){b("MediaEffectMetadataActionCreators").duplicateAsset(this.props.localAssetID)}.bind(this),this.$16=function(){var a=b("nullthrows")(this.$5);a.isTextAsset()||(a.toggleScaleWithWidth(),b("MediaEffectEditorFunnelLogger").logSetScaleWithWidth((!a.isScalingWithWidth()).toString()))}.bind(this),this.$17=function(){var a=b("nullthrows")(this.$5);a.isTextAsset()||(a.toggleScaleWithHeight(),b("MediaEffectEditorFunnelLogger").logSetScaleWithHeight((!a.isScalingWithHeight()).toString()))}.bind(this),this.$18=function(){var a=b("nullthrows")(this.$5);b("SimpleXUIDialog").showConfirm(a.isTextAsset()?i._("Are you sure you want to delete this text?"):i._("Are you sure you want to delete this art?"),null,function(a){return a?b("MediaEffectMetadataActionCreators").deleteAsset(this.props.localAssetID):null}.bind(this))}.bind(this),this.$19=function(event){if(this.props.readOnly)return;event.button===0&&(!this.props.selected?(event.shiftKey||b("MediaEffectMetadataActionCreators").deselectAll(),b("MediaEffectMetadataActionCreators").selectAsset(this.props.localAssetID)):event.shiftKey&&b("MediaEffectMetadataActionCreators").deselectAsset(this.props.localAssetID))}.bind(this),this.$20=function(){this.setState({isInPreview:!0}),b("MediaEffectEditorFunnelLogger").logPreviewAutoBackgroundRemoval(this.props.assetData.stickerFBID)}.bind(this),this.$21=function(){this.setState({isInPreview:!1})}.bind(this),this.$5=new(b("MediaEffectEditorAsset"))(a.localAssetID,a.assetData),this.state={isInPreview:!1,hasProcessed:!1}}a.prototype.UNSAFE_componentWillReceiveProps=function(a){var c=b("nullthrows")(this.$5);c.updateAsset(a.localAssetID,a.assetData)};a.prototype.componentDidUpdate=function(){var a=b("nullthrows")(this.$5);this.$1.forEach(function(b){return b.checked=a.isScalingWithWidth()});this.$2.forEach(function(b){return b.checked=a.isScalingWithHeight()})};a.prototype.$22=function(a){a.button===0&&(a.stopPropagation(),a.preventDefault())};a.prototype.$23=function(a,b){a=a||this.props.assetData.assetSize;b=b||this.props.assetData.position;if(!a||!a.isValid())return null;a=a.toAbsolute(this.props.canvasSize);b=b.toAbsolute(this.props.canvasSize,a);return b};a.prototype.$24=function(a){return this.props.assetData instanceof b("MediaEffectReactFrameEditorImageAssetRecord")?this.$25(this.props.assetData,a):this.$26(this.props.assetData,a)};a.prototype.$25=function(a,c){return a.assocTextAsset&&(this.props.selected||this.props.editedTextID===this.props.localAssetID)?this.$26(a.assocTextAsset,c):this.props.isInCanvas?b("React").createElement(b("MediaEffectReactFrameEditorCanvasImageAsset.react"),{imageRecord:a,isInPreview:this.state.isInPreview,key:this.props.localAssetID,localAssetID:this.props.localAssetID}):b("React").createElement(b("MediaEffectReactFrameEditorImageAsset.react"),{imageRecord:a,isInPreview:this.state.isInPreview,key:this.props.localAssetID,localAssetID:this.props.localAssetID})};a.prototype.$27=function(){var a=this.props.assetData;if(a instanceof b("MediaEffectReactFrameEditorImageAssetRecord")){a=a.validationResult;if(a&&!a.success)return a.reason}return null};a.prototype.$26=function(a,c){return b("React").createElement(b("MediaEffectReactFrameEditorTextAsset.react"),{assetData:a,canvasSize:this.props.canvasSize,editing:this.props.editedTextID===this.props.localAssetID,enableFontSettingsDialog:this.props.enableFontSettingsDialog,key:this.props.localAssetID,localAssetID:this.props.localAssetID,position:c,readOnly:this.props.readOnly,textboxHeight:c&&c.h()})};a.prototype.$28=function(a,c){if(this.props.readOnly)return;a=b("ReactDOM").findDOMNode(a);if(!(a instanceof HTMLElement))return;c=b("React").createElement(b("MountedContextMenu.react"),{menu:c,mountedTriggerElem:a});a=a.children[0];b("ReactDOM").render(c,a)};a.prototype.$29=function(){var a=b("nullthrows")(this.$5),c=a.isTextAsset();this.props.flowType===b("MediaEffectFlowType").TEMPLATE;return b("React").createElement(b("ReactXUIMenu"),null,b("React").createElement(k,{onclick:this.$9},i._("Bring forward")),b("React").createElement(k,{onclick:this.$11},i._("Bring to front")),b("React").createElement(k,{onclick:this.$12},i._("Send backward")),b("React").createElement(k,{onclick:this.$13},i._("Send to back")),b("React").createElement(b("MenuSeparator.react"),null),!c&&b("React").createElement(k,{renderas:"label"},b("React").createElement(b("FileInput.react"),{accept:"image/x-png, image/jpeg, image/png",multiple:!1,onChange:this.$14},b("React").createElement("a",{style:{color:"inherit",textDecoration:"none"}},i._("Replace Art")))),b("React").createElement(k,{onclick:this.$15},i._("Duplicate")),b("React").createElement(k,{onclick:this.$18},i._("Delete")),b("React").createElement(b("MenuSeparator.react"),null),b("React").createElement(l,{onclick:this.$16},b("React").createElement(b("InputLabel.react"),{label:i._("Shrink with width")},b("React").createElement(b("FBToggleSwitch.react"),{animate:!0,checked:a.isScalingWithWidth(),disabled:c,ref:function(a){return a&&this.$1.push(b("DOMQuery").find(b("ReactDOM").findDOMNode(a),"input"))}.bind(this)}))),b("React").createElement(l,{onclick:this.$17},b("React").createElement(b("InputLabel.react"),{label:i._("Shrink with height")},b("React").createElement(b("FBToggleSwitch.react"),{animate:!0,checked:a.isScalingWithHeight(),disabled:c,ref:function(a){return a&&this.$2.push(b("DOMQuery").find(b("ReactDOM").findDOMNode(a),"input"))}.bind(this)}))))};a.prototype.$30=function(){var a=this.props.assetData;return a instanceof b("MediaEffectReactFrameEditorImageAssetRecord")?!!a.processedImageURI:!1};a.prototype.$31=function(){return!this.$30()||this.state.hasProcessed?!1:!0};a.prototype.render=function(){var a=this.$23(),c=a?m(a):{display:"none"};a&&(this.$3||(this.$3=this.$29()),this.$4||(this.$4=this.$29()));a=b("React").createElement("div",{style:c},this.$24(a));var d=this.$27();if(!this.props.readOnly&&this.props.editedTextID!==this.props.localAssetID)return b("React").createElement("div",{onDoubleClick:this.$6,onMouseDown:this.$19},b("React").createElement(b("FBDragHandle.react"),{horizontal:!0,initialData:this.$7,key:this.props.localAssetID,onChange:this.$8,onEnd:this.props.onDrop,stopOnLeave:!1,vertical:!0},a,b("React").createElement(b("XUIError.react"),{xuiError:d},b("React").createElement("div",{className:"_sdt",ref:function(a){return a&&this.$4&&this.$28(a,this.$4)}.bind(this),style:c},b("React").createElement("div",null),b("React").createElement("div",{className:"_1ytk"},b("React").createElement("div",{className:"_1ytl"}),this.$3?b("React").createElement("div",null,b("React").createElement(b("PopoverMenu.react"),{alignh:"center",alignv:"top",className:"_1ytm",menu:this.$3,onMouseDown:this.$22},b("React").createElement(b("XUIPopoverButton.react"),null)),this.$31()?b("React").createElement("div",{className:"_d2q"},b("React").createElement(b("SUIButton.react"),{className:"_d2q",icon:b("React").createElement(b("SUIGlyphIcon.react"),{srcDefault:g("115218")}),label:i._("Make the background transparent"),labelIsHidden:!0,onClick:this.$10,onMouseLeave:this.$21,onMouseOver:this.$20,theme:b("SUIMediaEffectTheme"),tooltip:i._("Make the background transparent"),tooltipDelay:200,use:"special"})):null):null)))));else return b("React").createElement(b("XUIError.react"),{xuiError:d},a)};a.defaultProps={onDrag:b("emptyFunction"),onDrop:b("emptyFunction"),initialPositionMap:c(),isValidating:!1,readOnly:!1,selected:!1,editedTextID:null,enableFontSettingsDialog:!1,enableEditorFreeText:!1,flowType:null,isInCanvas:!1};e.exports=a}),null);
__d("MediaEffectReactFrameEditorCamera.react",["React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.prototype.render=function(){return b("React").createElement("div",{style:{position:"absolute",overflow:"hidden",left:"50%",top:"50%",marginLeft:-(this.props.width/2),marginTop:-(this.props.height/2)}},b("React").createElement("video",{autoPlay:!0,ref:"video",style:{width:this.props.width,height:this.props.height,objectFit:"cover"},src:this.props.videoSrc}))};a.prototype.componentDidUpdate=function(a){a.cameraPaused&&!this.props.cameraPaused?this.refs.video.play():!a.cameraPaused&&this.props.cameraPaused&&this.refs.video.pause()};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectReactFrameEditorCameraContainer.react",["FluxContainer","MediaEffectReactFrameEditorCamera.react","MediaEffectReactFrameEditorCanvasDataStore","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.getStores=function(){return[b("MediaEffectReactFrameEditorCanvasDataStore")]};a.calculateState=function(a,c){a=b("MediaEffectReactFrameEditorCanvasDataStore").getState();return{cameraPaused:a.cameraPaused,videoSrc:a.cameraSource}};a.prototype.render=function(){var a=babelHelpers["extends"]({},this.props,this.state);return b("React").createElement(b("MediaEffectReactFrameEditorCamera.react"),a)};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MediaEffectCanvasEducation.react",["cx","fbt","React"],(function(a,b,c,d,e,f,g,h){"use strict";var i;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_3fsi"},b("React").createElement("div",{className:"_vzg"},b("React").createElement("div",{className:"_3fsj"},h._("Drag and Drop PNGs")),b("React").createElement("div",{className:"_3fso"},h._("or use the Upload Art button"))))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("AssetVerticalAlignmentType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({TOP:"top",BOTTOM:"bottom",CENTER:"center"})}),null);
__d("MediaEffectReactFrameEditorGridlines.react",["cx","fbt","AssetHorizontalAlignmentType","AssetVerticalAlignmentType","MediaEffectFrameEditorConstants","React","nullthrows"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("MediaEffectFrameEditorConstants").EDITOR_BUFFER_SIZE;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){var a=this.props.asset.get("assetSize").toAbsolute(this.props.canvasSize),b=this.props.asset.get("position").toAbsolute(this.props.canvasSize,a),c=this.$1(this.props.asset,this.props.canvasSize);return this.props.type==="vertical"?this.$2(b,a,c):this.$3(b,a,c)};a.prototype.$2=function(a,c,d){var e={},f={};e.left=-5+j+a.l+c.x/2+"px";e.height=Math.max(d.vMargin-2,0)+"px";e.height==="0px"&&(e.borderBottom="0px");d.vMargin<40?(d.assetVAlign===b("AssetVerticalAlignmentType").TOP?f.top="-20px":f.bottom="-20px",f.left="-3px"):(f.right="10px",f.top=d.vMargin/2-8+"px");if(d.assetVAlign===b("AssetVerticalAlignmentType").CENTER)return b("React").createElement("div",null,this.$4(babelHelpers["extends"]({},e,{top:j}),f,"Centered"),this.$4(babelHelpers["extends"]({},e,{bottom:j}),f,"Centered"));d.assetVAlign===b("AssetVerticalAlignmentType").TOP?e.top=j:e.bottom=j;return this.$4(e,f,d.relativeVMargin.toFixed(0)+"%")};a.prototype.$4=function(a,c,d){return b("React").createElement("div",{style:a,className:"_4ro5"},b("React").createElement("div",{className:"_4ro6"}),b("React").createElement("div",{className:"_4ro7"}),b("React").createElement("div",{style:c,className:"_4ro8"},d==="Centered"?h._("Centered"):d))};a.prototype.$3=function(a,c,d){var e={},f={};e.top=-5+j+a.t+c.y/2+"px";e.width=Math.max(d.hMargin-2,0)+"px";e.width==="0px"&&(e.borderRight="0px");d.hMargin<40?(d.assetHAlign===b("AssetHorizontalAlignmentType").LEFT?f.left="-23px":f.right="-23px",f.top="-3px"):(f.top="-15px",f.left=d.hMargin/3+"px");if(d.assetHAlign===b("AssetHorizontalAlignmentType").CENTER)return b("React").createElement("div",null,this.$5(babelHelpers["extends"]({},e,{left:j}),f,"Centered"),this.$5(babelHelpers["extends"]({},e,{right:j}),f,"Centered"));d.assetHAlign===b("AssetHorizontalAlignmentType").LEFT?e.left=j:e.right=j;return this.$5(e,f,d.relativeHMargin.toFixed(0)+"%")};a.prototype.$5=function(a,c,d){return b("React").createElement("div",{style:a,className:"_4ro9"},b("React").createElement("div",{className:"_4roa"}),b("React").createElement("div",{className:"_4rob"}),b("React").createElement("div",{style:c,className:"_4ro8"},d==="Centered"?h._("Centered"):d))};a.prototype.$1=function(a,c){var d=b("nullthrows")(a.assetSize).toAbsolute(c);a=a.position;d=a.toAbsolute(c,d);return{assetHAlign:a.x.asset_origin==="canvas_start"?a.x.anchor_asset_size_percentage===50?b("AssetHorizontalAlignmentType").CENTER:b("AssetHorizontalAlignmentType").LEFT:b("AssetHorizontalAlignmentType").RIGHT,assetVAlign:a.y.asset_origin==="canvas_start"?a.y.anchor_asset_size_percentage===50?b("AssetVerticalAlignmentType").CENTER:b("AssetVerticalAlignmentType").TOP:b("AssetVerticalAlignmentType").BOTTOM,hMargin:a.x.asset_origin==="canvas_start"?d.l:c.x-d.r,vMargin:a.y.asset_origin==="canvas_start"?d.t:c.y-d.b,relativeHMargin:a.x.asset_canvas_size_percentage,relativeVMargin:a.y.asset_canvas_size_percentage}};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectReactFrameEditorCanvas.react",["cx","fbt","Image.react","immutable","LayerAutoFocusReact","LayerFadeOnHide","LayerHideOnBlur","LayerHideOnEscape","MediaEffectCanvasEducation.react","MediaEffectFrameEditorConstants","MediaEffectFrameRenderer","MediaEffectMetadataActionCreators","MediaEffectReactFrameEditorAsset.react","MediaEffectReactFrameEditorAssetPositionRecord","MediaEffectReactFrameEditorCameraContainer.react","MediaEffectReactFrameEditorGridlines.react","MediaEffectReactFrameEditorSelectionBoxContainer.react","MountedContextMenu.react","React","ReactDOM","ReactXUIMenu","nullthrows","promiseDone","Rect","SimpleXUIDialog","throttle","Vector","XUIDialog.react","XUIDialogBody.react","XUIDialogTitle.react","XUIError.react","XUIText.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("immutable").Map,k=b("MediaEffectFrameEditorConstants").EDITOR_BUFFER_SIZE,l=b("ReactXUIMenu").Item,m=10,n=j({Delete:"DELETE",Backspace:"DELETE",Escape:"UNSELECT",ArrowLeft:"NUDGELEFT",ArrowRight:"NUDGERIGHT",ArrowUp:"NUDGEUP",ArrowDown:"NUDGEDOWN"}),o=j({"?":"SHOWKEY_BINDINGS"});function p(a){return b("React").createElement("div",{style:{margin:"0 auto 8px auto",width:a.width+2*k}},b("React").createElement(b("XUIText.react"),{className:"_38wf _1e6t"},h._("Canvas")))}c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){__p&&__p();var a;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];(a=i.constructor).call.apply(a,[this].concat(d));this.state={canvasErrorMessage:null,showKeyBindings:!1};this.$26=b("throttle")(function(a){b("promiseDone")(b("MediaEffectFrameRenderer").percentageCovered(a.assets,a.assetOrder,new(b("Vector"))(a.canvasWidth,a.canvasHeight)).then(function(a){this.props.updateCoverage(a),a>.5?this.setState({canvasErrorMessage:h._("Your frame covers large canvas space, please consider freeing more space.")}):this.setState({canvasErrorMessage:null})}.bind(this)))}.bind(this),1e3);this.$30=function(a){setTimeout(!a&&this.$28(),0)}.bind(this);this.$33=function(){b("MediaEffectMetadataActionCreators").addText(null,this.$6,this.$7)}.bind(this);this.$16=function(event){__p&&__p();if(event.button===0&&this.$17&&(event.target===this.$1||event.target===this.$17))b("MediaEffectMetadataActionCreators").deselectAll();else if(this.props.editedTextID)return;else if(event.button===2&&event.target===this.$1){var a=b("ReactDOM").findDOMNode(this.$1).getBoundingClientRect(),c=event.clientX-a.left;a=event.clientY-a.top;this.$6=c/this.props.canvasWidth*100;this.$7=a/this.props.canvasHeight*100}this.$29();event.preventDefault()}.bind(this);this.$29=function(){this.$17&&this.$17.focus()}.bind(this);this.$13=function(event){var a=n.get(event.key);this.$34(a,event)}.bind(this);this.$14=function(event){var a=o.get(event.key);this.$34(a,event)}.bind(this);this.$10=function(a,b,c,d,e,f){return this.$36(a,null,null,b,c,d,e,f)}.bind(this);this.$12=function(a){a.preventDefault();if(!a.dataTransfer||this.props.readOnly)return;a=a.dataTransfer.files;if(a)for(var c=0;c<a.length;c++){var d=a.item(c);d&&b("MediaEffectMetadataActionCreators").addImage(d)}}.bind(this);this.$5=j({DELETE:function(event){return this.$18(event)}.bind(this),UNSELECT:function(event){return this.$19(event)}.bind(this),NUDGELEFT:function(event){return this.$20(event)}.bind(this),NUDGERIGHT:function(event){return this.$21(event)}.bind(this),NUDGEUP:function(event){return this.$22(event)}.bind(this),NUDGEDOWN:function(event){return this.$23(event)}.bind(this),SHOWKEY_BINDINGS:function(event){return this.$24(event)}.bind(this)});this.$8=this.$8.bind(this);this.$9=this.$9.bind(this);this.$2=this.$25();this.$4=!1}a.prototype.UNSAFE_componentWillReceiveProps=function(a){!this.props.assets.equals(a.assets)&&a.assets.every(function(a){return!!a.assetSize})&&this.$26(a)};a.prototype.$9=function(a){this.$27(a.target)};a.prototype.$28=function(){this.setState({showKeyBindings:!1}),this.$29()};a.prototype.$31=function(){return!this.state.showKeyBindings?null:b("React").createElement(b("XUIDialog.react"),{autohide:5e3,behaviors:{LayerFadeOnHide:b("LayerFadeOnHide"),LayerAutoFocusReact:b("LayerAutoFocusReact"),LayerHideOnBlur:b("LayerHideOnBlur"),LayerHideOnEscape:b("LayerHideOnEscape")},onToggle:this.$30,shown:this.state.showKeyBindings,titleID:"frame-editor-key-bindings",width:445},b("React").createElement(b("XUIDialogTitle.react"),null,b("React").createElement("span",null,"Keyboard Shortcut Help")),b("React").createElement(b("XUIDialogBody.react"),null,b("React").createElement("ul",null,b("React").createElement("li",null,b("React").createElement("span",{className:"_5hbk"},"\u2190"),",",b("React").createElement("span",{className:"_5hbk"},"\u2192"),",",b("React").createElement("span",{className:"_5hbk"},"\u2191"),",",b("React").createElement("span",{className:"_5hbk"},"\u2193"),"\u2014 move selected items"),b("React").createElement("li",null,b("React").createElement("span",{className:"_5hbk"},"Ctrl"),"+",b("React").createElement("span",{className:"_5hbk"},"\u2190"),",",b("React").createElement("span",{className:"_5hbk"},"\u2192"),",",b("React").createElement("span",{className:"_5hbk"},"\u2191"),",",b("React").createElement("span",{className:"_5hbk"},"\u2193"),"\u2014 move selected items by 10%"),b("React").createElement("li",null,b("React").createElement("span",{className:"_5hbk"},"Delete"),",",b("React").createElement("span",{className:"_5hbk"},"Backspace"),"\u2014 delete selected items"),b("React").createElement("li",null,b("React").createElement("span",{className:"_5hbk"},"Escape"),"\u2014 unselect all"))))};a.prototype.$27=function(a){var c=a.files;if(c)for(var d=0;d<c.length;d++){var e=c.item(d);e&&b("MediaEffectMetadataActionCreators").addImage(e,this.$6,this.$7)}a.value=""};a.prototype.$32=function(a,c){a=b("ReactDOM").findDOMNode(a);if(!(a instanceof HTMLElement))return;c=b("React").createElement(b("MountedContextMenu.react"),{menu:c,mountedTriggerElem:a});a=a.children[0];b("ReactDOM").render(c,a)};a.prototype.$25=function(){return b("React").createElement(b("ReactXUIMenu"),null,b("React").createElement(l,{onclick:this.$8},h._("Add new art here")),this.props.enableEditorFreeText?b("React").createElement(l,{onclick:this.$33},h._("Insert Text")):null)};a.prototype.$8=function(){var a=new MouseEvent("click");b("nullthrows")(this.$3).dispatchEvent(a)};a.prototype.$11=function(event){event.preventDefault()};a.prototype.$34=function(a,event){if(a&&!this.props.editedTextID){a=this.$5.get(a);a&&(a(event),event.preventDefault())}};a.prototype.$15=function(event){var a=n.get(event.key);if(a)switch(a){case"NUDGELEFT":case"NUDGERIGHT":case"NUDGEUP":case"NUDGEDOWN":b("MediaEffectMetadataActionCreators").setIsDragging(!1);break;default:break}};a.prototype.$19=function(event){b("MediaEffectMetadataActionCreators").deselectAll()};a.prototype.$18=function(event){__p&&__p();if(this.props.selectedAssets.size===0)return;var a=this.props.selectedAssets,c=a.count(function(a){return this.props.assets.get(a).assetType()==="MediaEffectReactFrameEditorTextAssetRecord"}.bind(this)),d=a.count(function(a){return this.props.assets.get(a).assetType()==="MediaEffectReactFrameEditorImageAssetRecord"}.bind(this)),e=null;d===0?e=c>1?h._("Are you sure you want to delete these text items?"):h._("Are you sure you want to delete this text item?"):c===0?e=d>1?h._("Are you sure you want to delete these art assets?"):h._("Are you sure you want to delete this art asset?"):e=h._("Are you sure you want to delete these assets?");this.$4=!0;b("SimpleXUIDialog").showConfirm(e,null,function(c){c&&a.forEach(function(a){b("MediaEffectMetadataActionCreators").deleteAsset(a)}),this.$4=!1,this.$29()}.bind(this),null)};a.prototype.$22=function(event){this.$35(new(b("Vector"))(0,-1),event)};a.prototype.$23=function(event){this.$35(new(b("Vector"))(0,1),event)};a.prototype.$20=function(event){this.$35(new(b("Vector"))(-1,0),event)};a.prototype.$21=function(event){this.$35(new(b("Vector"))(1,0),event)};a.prototype.$35=function(a,event){var b=event.ctrlKey?10:1;a=a.mul(b).mul(this.props.canvasWidth/100,this.props.canvasHeight/100);this.$36(null,!0,b!==1,a.x,a.y,null,null,this.$37())};a.prototype.$24=function(event){this.setState({showKeyBindings:!0})};a.prototype.$36=function(a,c,d,e,f,g,h,i){__p&&__p();g=j().withMutations(function(b){i.forEach(function(c,d){(d===a||this.props.selectedAssets.has(d))&&b.set(d,c)}.bind(this))}.bind(this));h=b("Rect").minimumBoundingBox(g.toArray());if(!c){c=this.$38(e,f,h);e=c[0];f=c[1]}else if(!d){c=this.$39(e,f,h);e=c[0];f=c[1]}d=this.$40(e,f,g);e=d[0];f=d[1];i.forEach(function(c,d){if(d!==a&&!this.props.selectedAssets.has(d))return;c=c.add(e,f);var g=b("MediaEffectReactFrameEditorAssetPositionRecord").canonical(c,this.$41());["x","y"].map(function(a){return g=g.set(a,g[a].set("asset_canvas_size_percentage",Math.round(g[a].asset_canvas_size_percentage)))});b("MediaEffectMetadataActionCreators").updateAssetPosition(d,g)}.bind(this));b("MediaEffectMetadataActionCreators").setIsDragging(!0)};a.prototype.$42=function(){b("MediaEffectMetadataActionCreators").setIsDragging(!1)};a.prototype.$38=function(a,b,c){var d=c.getCenter();c=c.add(a,b);var e=this.$41().div(2);c=c.getCenter();c=c.sub(e);Math.abs(c.x)<m&&(a=e.x-d.x);Math.abs(c.y)<m&&(b=e.y-d.y);return[a,b]};a.prototype.$39=function(a,b,c){__p&&__p();var d=c.getCenter(),e=c.add(a,b),f=this.$41().div(2);e=e.getCenter();d=d.sub(f);e=e.sub(f);e.x*d.x<0&&(a=-d.x);e.y*d.y<0&&(b=-d.y);if(d.x===0){f=100*c.l/this.props.canvasWidth;a=this.props.canvasWidth/100*Math.sign(a)*(1+f-Math.ceil(f))}if(d.y===0){e=100*c.t/this.props.canvasHeight;b=this.props.canvasHeight/100*Math.sign(b)*(1+e-Math.ceil(e))}return[a,b]};a.prototype.$40=function(a,b,c){c.forEach(function(c,d){d=c.add(a,b);d.l>this.props.canvasWidth&&(a-=d.l-this.props.canvasWidth);d.t>this.props.canvasHeight&&(b-=d.t-this.props.canvasHeight);d.l+d.w()<0&&(a-=d.l+d.w());d.t+d.h()<0&&(b-=d.t+d.h())}.bind(this));return[a,b]};a.prototype.$37=function(){return this.props.assets.map(function(a){return a.assetSize&&a.position.toAbsolute(this.$41(),a.assetSize.toAbsolute(this.$41()))}.bind(this))};a.prototype.$43=function(){return j().withMutations(function(a){this.props.selectedAssets.forEach(function(b){if(this.props.assets.has(b)){var c=this.props.assets.get(b);c.assetSize&&c.position&&a.set(b,c.position.toAbsolute(this.$41(),c.assetSize.toAbsolute(this.$41())))}}.bind(this))}.bind(this))};a.prototype.$41=function(){return new(b("Vector"))(this.props.canvasWidth,this.props.canvasHeight)};a.prototype.render=function(){__p&&__p();var a=this.props.assets.count()===0?b("React").createElement(b("MediaEffectCanvasEducation.react"),null):null,c=this.props.includesPhoneFrame,d=this.props.canvasHeight/b("MediaEffectFrameEditorConstants").PHONE_SCREEN_TO_FRAME_HEIGHT_RATIO,e=this.props.canvasWidth/b("MediaEffectFrameEditorConstants").PHONE_SCREEN_TO_FRAME_WIDTH_RATIO;d=c?(d-this.props.canvasHeight)/2:k;e=c?(e-this.props.canvasWidth)/2:k;return b("React").createElement("div",null,this.$31(),this.props.showTitle?b("React").createElement(p,{width:this.props.canvasWidth}):null,b("React").createElement("div",{className:"_384m"+(c?" _3fqm":""),onDragOver:this.$11,onDrop:this.$12,onKeyDown:this.$13,onKeyPress:this.$14,onKeyUp:this.$15,onMouseDown:this.$16,ref:function(a){a&&(this.$17=a)}.bind(this),style:{width:this.props.canvasWidth+2*e,height:this.props.canvasHeight+2*d},tabIndex:0},c?b("React").createElement(b("Image.react"),{className:"_3fqn",src:"/images/media_effect/frame_preview/phone_portrait.png",style:{width:Math.floor(this.props.canvasWidth/b("MediaEffectFrameEditorConstants").PHONE_SCREEN_TO_FRAME_WIDTH_RATIO),height:Math.floor(this.props.canvasHeight/b("MediaEffectFrameEditorConstants").PHONE_SCREEN_TO_FRAME_HEIGHT_RATIO)}}):null,b("React").createElement("div",{className:"_ymq _2z_m"+(c?" _3fqo":""),style:{backgroundColor:this.props.backgroundColor,width:this.props.canvasWidth,height:this.props.canvasHeight,left:e-1,top:d-1}},this.props.cameraEnabled?b("React").createElement(b("MediaEffectReactFrameEditorCameraContainer.react"),{height:this.props.canvasHeight,width:this.props.canvasWidth}):null,b("React").createElement(b("XUIError.react"),{xuiError:this.state.canvasErrorMessage},b("React").createElement("div",{className:"_384n",ref:function(a){a&&!this.props.readOnly&&(this.$1=a,this.$32(a,this.$2))}.bind(this),style:{backgroundImage:this.props.backgroundImage?"url('"+this.props.backgroundImage.uri+"')":null,backgroundSize:this.props.backgroundImage?"cover":null,backgroundPosition:this.props.backgroundImage?"center":null,width:this.props.canvasWidth,height:this.props.canvasHeight}},b("React").createElement("div",null),a,this.props.assetOrder.map(function(a){var c=this.props.assets.get(a);return b("React").createElement(b("MediaEffectReactFrameEditorAsset.react"),{assetData:c,canvasSize:this.$41(),editedTextID:this.props.editedTextID,enableEditorFreeText:this.props.enableEditorFreeText,enableFontSettingsDialog:this.props.enableFontSettingsDialog,flowType:this.props.flowType,focusCanvas:this.$29,initialPositionMap:this.$37(),isInCanvas:!0,isValidating:this.props.isValidating,key:a,localAssetID:a,onDrag:this.$10,onDrop:this.$42,readOnly:this.props.readOnly||c.readOnly,selected:this.props.selectedAssets.has(a)})}.bind(this))))),b("React").createElement(b("MediaEffectReactFrameEditorSelectionBoxContainer.react"),{canvasHeight:this.props.canvasHeight,canvasWidth:this.props.canvasWidth,includesPhoneFrame:this.props.includesPhoneFrame,selectedAssets:this.props.selectedAssets}),b("React").createElement("div",{className:(c?"":"_34j2")+(c?" _3fqp":"")+" _34j3",style:{top:d-1,width:e-1,height:this.props.canvasHeight+2}}),b("React").createElement("div",{className:(c?"":"_34j2")+(c?" _3fqp":"")+" _34j4",style:{top:d-1,width:e-1,height:this.props.canvasHeight+2}}),b("React").createElement("div",{className:(c?"":"_34j2")+(c?" _3fqp":"")+" _34j6",style:{width:this.props.canvasWidth+2*e,height:d-1}}),b("React").createElement("div",{className:(c?"":"_34j2")+(c?" _3fqp":"")+" _34j7",style:{width:this.props.canvasWidth+2*e,height:d-1}}),this.props.isDragging?this.props.selectedAssets.map(function(a){var c=this.props.assets.get(a);return b("React").createElement("div",{key:a},b("React").createElement(b("MediaEffectReactFrameEditorGridlines.react"),{asset:c,canvasSize:this.$41(),type:"vertical"}),b("React").createElement(b("MediaEffectReactFrameEditorGridlines.react"),{asset:c,canvasSize:this.$41(),type:"horizontal"}))}.bind(this)):null),b("React").createElement("input",{accept:"image/x-png, image/jpeg, image/png",multiple:!0,onChange:this.$9,ref:function(a){this.$3=a}.bind(this),style:{display:"none"},type:"file"}))};e.exports=a}),null);
__d("MediaEffectImageSnappingUtils",["immutable","MediaEffectReactFrameEditorAssetPositionRecord","MediaEffectReactFrameEditorScalarAssetPositionRecord","MediaEffectReactFrameEditorScalarSizeRecord","MediaEffectReactFrameEditorSize","keyMirror"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=.1,h=200,i=b("keyMirror")({TOP:null,LEFT:null,BOTTOM:null,RIGHT:null}),j=i.TOP,k=i.LEFT,l=i.RIGHT,m=i.BOTTOM;function n(a){return b("immutable").Map().withMutations(function(c){return c.set(b("immutable").Set([j,k]),{position:new(b("MediaEffectReactFrameEditorAssetPositionRecord"))({x:p(),y:p()})}).set(b("immutable").Set([j,l]),{position:new(b("MediaEffectReactFrameEditorAssetPositionRecord"))({x:q(),y:p()})}).set(b("immutable").Set([k,m]),{position:new(b("MediaEffectReactFrameEditorAssetPositionRecord"))({x:p(),y:q()})}).set(b("immutable").Set([l,m]),{position:new(b("MediaEffectReactFrameEditorAssetPositionRecord"))({x:q(),y:q()})}).set(b("immutable").Set([k,l,j]),{position:new(b("MediaEffectReactFrameEditorAssetPositionRecord"))({x:r(),y:p()}),size:s(a)}).set(b("immutable").Set([j]),{position:new(b("MediaEffectReactFrameEditorAssetPositionRecord"))({x:r(),y:p()}),size:s(a)}).set(b("immutable").Set([k,l,m]),{position:new(b("MediaEffectReactFrameEditorAssetPositionRecord"))({x:r(),y:q()}),size:s(a)}).set(b("immutable").Set([m]),{position:new(b("MediaEffectReactFrameEditorAssetPositionRecord"))({x:r(),y:q()}),size:s(a)})})}var o=new Map();function p(){return new(b("MediaEffectReactFrameEditorScalarAssetPositionRecord"))({anchor_origin:"asset_start",anchor_asset_size_percentage:0,anchor_pixel_offset:0,asset_origin:"canvas_start",asset_canvas_size_percentage:0,asset_pixel_offset:0})}function q(){return new(b("MediaEffectReactFrameEditorScalarAssetPositionRecord"))({anchor_origin:"asset_end",anchor_asset_size_percentage:0,anchor_pixel_offset:0,asset_origin:"canvas_end",asset_canvas_size_percentage:0,asset_pixel_offset:0})}function r(){return new(b("MediaEffectReactFrameEditorScalarAssetPositionRecord"))({anchor_origin:"asset_start",anchor_asset_size_percentage:50,anchor_pixel_offset:0,asset_origin:"canvas_start",asset_canvas_size_percentage:50,asset_pixel_offset:0})}function s(a){return new(b("MediaEffectReactFrameEditorSize").ScaleWidth)({width:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:100}),aspect_ratio:a}).getScaledWithHeight()}function a(a,c){__p&&__p();if(o.get(a)!==undefined)return o.get(a);var d=document.createElement("canvas"),e=c.width,f=c.height;if(e===0||f===0)return null;var p=Math.min(e,200);f=p*f/e;e=p;d.width=e;d.height=f;p=d.getContext("2d");p.drawImage(c,0,0,e,f);var q=new Map();Object.keys(i).forEach(function(a){return q.set(a,0)});d=new Set();c=Math.ceil(e/h);var r=Math.floor(e/c),s=r*255*g;for(var t=0;t<e;t+=c)d.has(j)||(q.set(j,q.get(j)+p.getImageData(t,0,1,1).data[3]),Number(q.get(j))>s&&d.add(j)),d.has(m)||(q.set(m,q.get(m)+p.getImageData(t,f-1,1,1).data[3]),Number(q.get(m))>s&&d.add(m));c=Math.ceil(f/h);r=Math.floor(f/c);s=r*255*g;for(var t=0;t<f;t+=c)d.has(k)||(q.set(k,q.get(k)+p.getImageData(0,t,1,1).data[3]),Number(q.get(k))>s&&d.add(k)),d.has(l)||(q.set(l,q.get(l)+p.getImageData(e-1,t,1,1).data[3]),Number(q.get(l))>s&&d.add(l));p.clearRect(0,0,e,f);p.restore();r=n(e/f).get(b("immutable").Set(d));o.set(a,r);return r}function c(){o.clear()}e.exports={ImageEdges:i,getSnappingSpecs:a,init:c}}),null);
__d("MediaEffectReactFrameEditorCanvasContainer.react",["FluxContainer","MediaEffectAssetValidationStore","MediaEffectFrameCreateDialogDataStore","MediaEffectFrameEditorConstants","MediaEffectFrameEditorDispatcher","MediaEffectImageSnappingUtils","MediaEffectReactFrameEditorCanvas.react","MediaEffectReactFrameEditorCanvasDataStore","MediaEffectReactFrameEditorDataStore","MediaEffectReactFrameEditorImageAssetRecord","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("MediaEffectFrameEditorConstants").EDITOR_BUFFER_SIZE;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MediaEffectReactFrameEditorDataStore"),b("MediaEffectReactFrameEditorCanvasDataStore"),b("MediaEffectFrameCreateDialogDataStore"),b("MediaEffectAssetValidationStore")]};a.calculateState=function(a,c){__p&&__p();a=b("MediaEffectReactFrameEditorDataStore").getState();var d=b("MediaEffectReactFrameEditorCanvasDataStore").getState(),e=b("MediaEffectFrameCreateDialogDataStore").getState(),f=a.assets.withMutations(function(a){a.forEach(function(c,d){if(c instanceof b("MediaEffectReactFrameEditorImageAssetRecord")){var e=null;c.stickerFBID&&(e=b("MediaEffectAssetValidationStore").get(c.stickerFBID));c=c.set("validationResult",e);a.set(d,c)}})}),g=c.width?c.width-2*h:d.canvasWidth;c=c.height?c.height-2*h:d.canvasHeight;return{assets:f,assetOrder:a.assetOrder,backgroundColor:d.backgroundColor,backgroundImage:d.backgroundImage,cameraEnabled:!!d.cameraSource,canvasHeight:c,canvasWidth:g,editedTextID:d.editedTextID,selectedAssets:d.selectedAssets,isDragging:d.isDragging,flowType:e.flowType,isValidating:b("MediaEffectFrameCreateDialogDataStore").isValidating()}};a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.constructor.getStores()),b("MediaEffectImageSnappingUtils").init()};a.prototype.$1=function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"coverage/update",canvasCoverage:a})};a.prototype.render=function(){var a=babelHelpers["extends"]({},this.props,this.state);return b("React").createElement(b("MediaEffectReactFrameEditorCanvas.react"),babelHelpers["extends"]({},a,{updateCoverage:this.$1}))};function a(){g.apply(this,arguments)}a.defaultProps={readOnly:!1,enableFontSettingsDialog:!1,enableEditorFreeText:!1,showTitle:!1,includesPhoneFrame:!1};e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MediaEffectFrameEditorFont",["immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h;b("immutable").Map;d=b("immutable").Record;g=babelHelpers.inherits(a,d({id:null,name:null,source:null}));g&&g.prototype;a.prototype.getName=function(){return this.name};a.prototype.getFontFamily=function(){return"'"+this.id+"'"};a.prototype.getID=function(){return this.id};a.prototype.getSystemFontName=function(){return null};a.prototype.getCustomFontID=function(){return this.id};a.prototype.getSource=function(){return this.source};function a(){g.apply(this,arguments)}h=babelHelpers.inherits(c,d({fontFamily:null,name:null}));h&&h.prototype;c.prototype.getName=function(){return this.name||this.fontFamily};c.prototype.getFontFamily=function(){return this.fontFamily};c.prototype.getID=function(){return this.fontFamily};c.prototype.getSystemFontName=function(){return this.fontFamily};c.prototype.getCustomFontID=function(){return null};c.prototype.getSource=function(){return null};function c(){h.apply(this,arguments)}e.exports.CustomFontRecord=a;e.exports.SystemFontRecord=c}),null);
__d("XMediaEffectAsyncFontController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/async_fonts/",{font_ids:{type:"FBIDSet"}})}),null);
__d("MediaEffectReactFrameEditorCanvasDataStore",["AsyncRequest","FluxReduceStore","immutable","MediaEffectFrameEditorConstants","MediaEffectFrameEditorDispatcher","MediaEffectFrameEditorFont","MediaEffectFullscreenFrameEditorSizingUtils","MediaEffectMetadataActionCreators","MediaEffectQEUtils","MediaEffectReactFrameDeserializer","MediaEffectReactFrameEditorDataStore","XMediaEffectAsyncFontController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h,i=b("immutable").List;c=b("immutable").Map;d=b("immutable").OrderedMap;f=b("immutable").Record;var j=b("immutable").Set,k=400,l=400,m=2400;g=babelHelpers.inherits(n,f({selectedAssets:j(),editedTextID:null,isDragging:!1,unsavedChanges:!1,fullImageSize:m,cameraSource:null,cameraPaused:!1,canvasWidth:k,canvasHeight:l,backgroundColor:"#ffffff",backgroundImage:null,fonts:c(),templates:c(),templateCategories:d(),canvasCoverage:0}));g&&g.prototype;n.prototype.getTemplate=function(a){return!a?null:this.templates.get(a)};n.prototype.getTemplateVariants=function(a){__p&&__p();a=this.getTemplate(a);if(!a)return null;a=a.sourceTemplateFBID?this.getTemplate(a.sourceTemplateFBID):a;if(!a)return null;a=a.variants.splice(0,0,a.templateFBID);a=a.map(function(a){return this.getTemplate(a)}.bind(this));return i(a.toArray().filter(Boolean))};function n(){g.apply(this,arguments)}h=babelHelpers.inherits(a,b("FluxReduceStore"));h&&h.prototype;a.prototype.getInitialState=function(){return new n()};a.prototype.reduce=function(a,c){__p&&__p();switch(c.type){case"select/assetOnly":a=a.set("selectedAssets",j([c.localAssetID])).set("editedTextID",null);break;case"select/asset":a=a.set("selectedAssets",a.selectedAssets.add(c.localAssetID)).set("editedTextID",null);break;case"delete/asset":a=a.set("unsavedChanges",!0).set("selectedAssets",a.selectedAssets.remove(c.localAssetID)).set("editedTextID",null);break;case"duplicate/asset":a=a.set("selectedAssets",j([b("MediaEffectReactFrameEditorDataStore").getState().assets.map(function(a){return a.localAssetID}).max()]));break;case"deselect/asset":a=a.set("selectedAssets",a.selectedAssets.remove(c.localAssetID)).set("editedTextID",null);break;case"deselect/all":a=a.set("selectedAssets",a.selectedAssets.clear()).set("editedTextID",null);break;case"edit/text":var d=c.localAssetID;a=a.set("editedTextID",d);d&&b("MediaEffectReactFrameEditorDataStore").getState().assets.get(d).get("assocTextAsset")&&(a=a.set("selectedAssets",a.selectedAssets.remove(d)));break;case"select/all":a=a.set("selectedAssets",j.fromKeys(b("MediaEffectReactFrameEditorDataStore").getState().assets));a.set("editedTextID",null);break;case"init/frameData":a=a.set("selectedAssets",j()).set("canvasCoverage",0).set("isDragging",!1).set("unsavedChanges",!1);break;case"add/fontData":c.data&&(a=a.set("fonts",this.$MediaEffectReactFrameEditorCanvasDataStore1(a.fonts,c.data)));break;case"add/templateData":a=this.$MediaEffectReactFrameEditorCanvasDataStore2(a,c.data,c.variants);break;case"set/isDragging":a=a.set("isDragging",c.isDragging);break;case"coverage/update":a=a.set("canvasCoverage",c.canvasCoverage);break;case"save":a=a.set("unsavedChanges",!1);break;case"add/image":case"add/text":case"update/assetPosition":case"update/assetSize":case"update/asset/raise":case"update/asset/lower":case"update/textContent":case"update/textFonts":a=a.set("unsavedChanges",!0);break;case"set/cameraSource":a=a.set("cameraSource",c.cameraSource);break;case"pause/camera":a=a.set("cameraPaused",!0);break;case"resume/camera":a=a.set("cameraPaused",!1);break;case"update/backgroundColor":a=a.set("backgroundColor",c.color);break;case"update/backgroundImage":a=a.set("backgroundImage",c.image);break;case"set/screenDimensions":d=b("MediaEffectFullscreenFrameEditorSizingUtils").getCanvasSize(c.screenWidth,c.dialogHeight);var e=b("MediaEffectQEUtils").shouldDefaultToPortrait(c.flowType),f=d;e&&(d*=b("MediaEffectFrameEditorConstants").PHONE_SCREEN_TO_FRAME_HEIGHT_RATIO,f=d*b("MediaEffectFrameEditorConstants").PORTRAIT_CANVAS_RATIO);a=a.set("canvasWidth",f).set("canvasHeight",d);break;case"apply/template":a=this.$MediaEffectReactFrameEditorCanvasDataStore3(a,c.templateFBID,c.frameData);break;case"bootstrap/fontData":this.$MediaEffectReactFrameEditorCanvasDataStore4();break}return a};a.prototype.$MediaEffectReactFrameEditorCanvasDataStore4=function(){var a=b("XMediaEffectAsyncFontController").getURIBuilder().getURI();new(b("AsyncRequest"))(a).setHandler(function(a){return b("MediaEffectMetadataActionCreators").addFontData(a.getPayload())}).send()};a.prototype.$MediaEffectReactFrameEditorCanvasDataStore3=function(a,b,c){return a.setIn(["templates",b,"frameData"],c)};a.prototype.$MediaEffectReactFrameEditorCanvasDataStore1=function(a,c){var d=[];a=a.withMutations(function(a){c.forEach(function(c){var e=new(b("MediaEffectFrameEditorFont").CustomFontRecord)({id:c.id,name:c.name,source:c.uri}),f=a.get(e.getID());(!f||f.id!==e.id||f.name!==e.name||f.source!==e.source)&&(d.push(c),a.set(e.getID(),e))})});this.$MediaEffectReactFrameEditorCanvasDataStore5(d);return a};a.prototype.$MediaEffectReactFrameEditorCanvasDataStore2=function(a,b,c){return a.withMutations(function(a){Object.keys(b).forEach(function(c){var d=b[c];this.$MediaEffectReactFrameEditorCanvasDataStore6(a,d);d=d.map(function(a){return a.id});a.setIn(["templateCategories",c],i(d))}.bind(this)),this.$MediaEffectReactFrameEditorCanvasDataStore6(a,c)}.bind(this))};a.prototype.$MediaEffectReactFrameEditorCanvasDataStore6=function(a,c){c.forEach(function(c){if(!a.templates.has(c.id)){var d=b("MediaEffectReactFrameDeserializer").deserializeTemplate(c);a.setIn(["templates",c.id],d)}})};a.prototype.$MediaEffectReactFrameEditorCanvasDataStore5=function(a){__p&&__p();var b=document.getElementById("custom_frame_fonts"),c=b||document.createElement("style");b||c.setAttribute("id","custom_frame_fonts");a=j(a.map(function(a){return"@font-face { font-family: '"+a.id+"'; src: url('"+a.uri+"') format('opentype');}"}));for(var d=0;d<c.childNodes.length;++d){var e=c.childNodes.item(d);e instanceof Text&&a["delete"](e.data)}a.forEach(function(a){return c.appendChild(document.createTextNode(a))});if(!b){e=document.head||document.getElementsByTagName("head")[0];e&&e.appendChild(c)}};a.prototype.hasUnsavedChanges=function(){return this.getState().unsavedChanges};a.prototype.getFont=function(a){var b=this.getState().fonts;a=b.get(a);return a||b.first()};a.prototype.getFonts=function(){return this.getState().fonts.toArray().sort(function(a,b){return a.getName().toLowerCase().localeCompare(b.getName().toLowerCase())})};a.prototype.getInitialImageScale=function(){var a=this.getState().fullImageSize;return 100/a};function a(){h.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("MediaEffectFrameEditorDispatcher"))}),null);
__d("MediaEffectReactFrameEditorCanvasImageAsset.react",["MediaEffectEditorFunnelLogger","MediaEffectImageSnappingUtils","MediaEffectMetadataActionCreators","MediaEffectReactFrameEditorImageAsset.react","React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").PureComponent);g=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$1=function(a){a=b("ReactDOM").findDOMNode(a);if(a instanceof HTMLImageElement){a=b("MediaEffectImageSnappingUtils").getSnappingSpecs(this.props.localAssetID,a);if(a){var c=a.size?"banner":"corner";b("MediaEffectEditorFunnelLogger").logAutoSnapping(c);b("MediaEffectMetadataActionCreators").setAutoSnapping(this.props.localAssetID,c,a)}}}.bind(this),c}a.prototype.render=function(){return b("React").createElement(b("MediaEffectReactFrameEditorImageAsset.react"),babelHelpers["extends"]({},this.props,{adjustPosition:this.$1}))};e.exports=a}),null);
__d("MediaEffectValidationTypes",["keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirror")({ASSET_NUMBER_LIMIT:"",CANVAS_COVERAGE_LIMIT:""});e.exports=a}),null);
__d("MediaEffectReactFrameEditorDataStore",["fbt","FluxReduceStore","MediaEffectFrameCreateDialogDataStore","MediaEffectFrameEditorDataRecord","MediaEffectFrameEditorDispatcher","MediaEffectMetadataActionCreators","MediaEffectReactFrameDeserializer","MediaEffectReactFrameEditorAssetPositionRecord","MediaEffectReactFrameEditorCanvasDataStore","MediaEffectReactFrameEditorImageAssetRecord","MediaEffectReactFrameEditorScalarSizeRecord","MediaEffectReactFrameEditorSize","MediaEffectReactFrameEditorTextAssetRecord","MediaEffectTemplateDataStore","MediaEffectValidationTypes","Vector","setImmediate"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=1,j="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=";function k(){return i++}h=babelHelpers.inherits(a,b("FluxReduceStore"));h&&h.prototype;a.prototype.getInitialState=function(){return new(b("MediaEffectFrameEditorDataRecord"))()};a.prototype.$MediaEffectReactFrameEditorDataStore1=function(a){var c=this.getInitialState();if(a){a=b("MediaEffectReactFrameDeserializer").deserializeData(a);c=c.set("assets",a.assets).set("assetOrder",a.assetOrder).set("frameFBID",a.frameFBID).set("filterID",a.filterID).set("templateFBID",a.templateFBID)}a=c.assets.size>0?Math.max.apply(Math,c.assets.map(function(a){return a.localAssetID}).toArray()):0;i=a+1;return c};a.prototype.reduce=function(a,c){__p&&__p();switch(c.type){case"init/frameData":a=this.$MediaEffectReactFrameEditorDataStore1(c.data);break;case"save":c.effectID&&(a=a.set("frameFBID",c.effectID));break;case"add/image":a.assets.size>15?b("setImmediate")(function(){return b("MediaEffectMetadataActionCreators").addValidation(b("MediaEffectValidationTypes").ASSET_NUMBER_LIMIT)}):(function(){var d=k(),e=new(b("MediaEffectReactFrameEditorImageAssetRecord"))({localAssetID:d,file:c.imageFile,localImageURI:URL.createObjectURL(c.imageFile),position:c.position?c.position:new(b("MediaEffectReactFrameEditorAssetPositionRecord"))(),assetSize:null});a=a.withNewAsset(d,e);e.upload()["catch"](function(a){});b("setImmediate")(function(){b("MediaEffectMetadataActionCreators").deselectAll(),b("MediaEffectMetadataActionCreators").selectAsset(d)})})();break;case"replace/image":var d=a.assets.get(c.localAssetID)||new(b("MediaEffectReactFrameEditorImageAssetRecord"))();d=new(b("MediaEffectReactFrameEditorImageAssetRecord"))({localAssetID:c.localAssetID,file:c.imageFile,localImageURI:URL.createObjectURL(c.imageFile),position:d.position,assetSize:d.assetSize});a=a.replaceAsset(c.localAssetID,d);d.upload()["catch"](function(a){});break;case"update/image":d=a.assets.get(c.localAssetID);if(d){d=d.set("processedImageURI",c.imageURI);a=a.replaceAsset(c.localAssetID,d)}break;case"replace/startRemovingBackground":d=a.assets.get(c.localAssetID);if(d){d=d.set("stickerFBID",null);a=a.replaceAsset(c.localAssetID,d)}break;case"replace/imageBackground":d=a.assets.get(c.localAssetID);if(d){d=d.set("localImageURI",c.imageURI).set("stickerFBID",c.imageID).set("processApplied",!0);a=a.replaceAsset(c.localAssetID,d)}break;case"update/textImage":d=c.localAssetID;var e=c.localImageURI,f=c.file,g=c.textContent,h=c.assetSize,i=a.assets.get(d);if(!i)break;var j=i.assocTextAsset;if(!j||e===i.localImageURI&&g===j.content)break;i=b("MediaEffectReactFrameEditorCanvasDataStore").getState();j=i.canvasWidth;i=i.canvasHeight;var l=new(b("MediaEffectReactFrameEditorSize").Fit)({width:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:h.x/j*100}),height:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:h.y/i*100}),aspect_ratio:h.y?h.x/h.y:1});a=a.withAssetMutation(d,function(a){return a.set("localImageURI",e).set("file",f).set("assetSize",l)});a=a.withTextAssetMutation(c.localAssetID,function(a){return a.set("content",g).set("dirty",!0)});break;case"add/text":var m=c.content?this.newTextAsset(c.content,c.position):this.newTextImageAsset(c.position);m instanceof b("MediaEffectReactFrameEditorImageAssetRecord")&&window.setTimeout(function(){b("MediaEffectMetadataActionCreators").deselectAll(),window.setTimeout(function(){b("MediaEffectMetadataActionCreators").editText(m.localAssetID)})},0);a=a.withNewAsset(m.localAssetID,m);break;case"duplicate/asset":j=k();i=this.$MediaEffectReactFrameEditorDataStore2(j,a.assets.get(c.localAssetID));i&&(a=a.withNewAsset(j,i));break;case"update/assetPosition":var n=c.position;a=a.withAssetMutation(c.localAssetID,function(a){a=a.set("position",n);a instanceof b("MediaEffectReactFrameEditorImageAssetRecord")&&(a=a.set("autoSnappedType",null));return a});break;case"update/assetSize":var o=c.size;a=a.withAssetMutation(c.localAssetID,function(a){a=a.set("assetSize",o);a instanceof b("MediaEffectReactFrameEditorImageAssetRecord")&&(a=a.set("autoSnappedType",null));return a});break;case"update/autoSnapping":(function(){var d=c.autoSnappedType,e=c.specs,f=e.size,b=e.position;a=a.withAssetMutation(c.localAssetID,function(a){return a.set("assetSize",f?f:a.assetSize).set("position",b?b:a.position).set("autoSnappedType",d)})})();break;case"update/assetNativeSize":a=this.$MediaEffectReactFrameEditorDataStore3(a,c.localAssetID,c.size);break;case"update/stickerFBID":var p=c.stickerFBID;h=c.localTemplateID?c.localTemplateID:null;(!b("MediaEffectFrameCreateDialogDataStore").isTemplateFlow()||h===b("MediaEffectTemplateDataStore").getState().currentTemplateVariationID)&&(a=a.withAssetMutation(c.localAssetID,function(a){return a.set("stickerFBID",p)}),a=a.withTextAssetMutation(c.localAssetID,function(a){return a.set("dirty",!1)}));break;case"update/asset/raise":d=c.toTop;a=a.withRaisedAsset(c.localAssetID,d);break;case"update/asset/lower":j=c.toBottom;a=a.withLoweredAsset(c.localAssetID,j);break;case"delete/asset":a=a.withDeletedAsset(c.localAssetID);break;case"update/textContent":var q=c.content;a=a.withTextAssetMutation(c.localAssetID,function(a){return a.set("content",q)});break;case"update/textFonts":var r=c.font;c.localTextIDs.forEach(function(b){return a=a.withTextAssetMutation(b,function(a){return a.set("font",r)})});break;case"update/textColors":var s=c.color;c.localTextIDs.forEach(function(b){return a=a.withTextAssetMutation(b,function(a){return a.set("color",s)})});break;case"update/textAlignments":var t=c.textAlignment;c.localTextIDs.forEach(function(b){return a=a.withTextAssetMutation(b,function(a){return a.set("textHorizontalAlignment",t)})});break;case"update/frameFilterID":a=a.set("filterID",c.filterID);break;case"apply/template":a=this.$MediaEffectReactFrameEditorDataStore4(a,c.templateFBID,c.frameData);break;case"clear/template":a=this.$MediaEffectReactFrameEditorDataStore5(a);break;case"change/step":b("MediaEffectFrameCreateDialogDataStore").isTemplateFlow()&&(a=b("MediaEffectTemplateDataStore").getFrameData(null));break;case"set/currentTemplateVariation":a=b("MediaEffectTemplateDataStore").getFrameData(c.localTemplateID);break}return a};a.prototype.$MediaEffectReactFrameEditorDataStore5=function(a){a.assets.forEach(function(b){b.sourceTemplateAssetFBID&&(a=a.withDeletedAsset(b.localAssetID))});return a.set("templateFBID",null)};a.prototype.$MediaEffectReactFrameEditorDataStore4=function(a,c,d){a=this.$MediaEffectReactFrameEditorDataStore5(a);a=a.set("templateFBID",d.frameFBID).set("filterID",d.filterID);d.assetOrder.forEach(function(c){var e=k();c=d.assets.get(c);c=c.set("localAssetID",e).set("sourceTemplateAssetFBID",c.assetFBID).set("assetFBID",null).set("readOnly",c instanceof b("MediaEffectReactFrameEditorImageAssetRecord"));a=a.withNewAsset(e,c)});return a};a.prototype.$MediaEffectReactFrameEditorDataStore2=function(a,b){if(b.assetType()!=="MediaEffectReactFrameEditorImageAssetRecord")return this.$MediaEffectReactFrameEditorDataStore6(a,b);var c=b.assocTextAsset;if(!b.stickerFBID&&!c)return null;else if(c)return this.$MediaEffectReactFrameEditorDataStore7(a,b,c);return this.$MediaEffectReactFrameEditorDataStore8(a,b)};a.prototype.$MediaEffectReactFrameEditorDataStore8=function(a,c){return new(b("MediaEffectReactFrameEditorImageAssetRecord"))({assetSize:c.assetSize,file:c.file,hostedImageURI:c.hostedImageURI,localImageURI:c.localImageURI,nativeSize:c.nativeSize,stickerFBID:c.stickerFBID,assetFBID:null,localAssetID:a,position:new(b("MediaEffectReactFrameEditorAssetPositionRecord"))()})};a.prototype.$MediaEffectReactFrameEditorDataStore6=function(a,c){return new(b("MediaEffectReactFrameEditorTextAssetRecord"))({assetSize:c.assetSize,color:c.color,content:c.content,font:c.font,textHorizontalAlignment:c.textHorizontalAlignment,assetFBID:null,localAssetID:a,position:new(b("MediaEffectReactFrameEditorAssetPositionRecord"))()})};a.prototype.$MediaEffectReactFrameEditorDataStore7=function(a,c,d){d=new(b("MediaEffectReactFrameEditorTextAssetRecord"))({localAssetID:a,font:d.font,fontName:d.fontName,content:d.content,color:d.color,textHorizontalAlignment:d.textHorizontalAlignment});return new(b("MediaEffectReactFrameEditorImageAssetRecord"))({localAssetID:a,localImageURI:j,position:new(b("MediaEffectReactFrameEditorAssetPositionRecord"))(),assocTextAsset:d,assetSize:c.assetSize})};a.prototype.getEffectID=function(){return this.getState().frameFBID};a.prototype.areAllImageAssetsUploaded=function(){var a=this.getState().assets;return a.every(function(a){var c=a instanceof b("MediaEffectReactFrameEditorTextAssetRecord");return c||!!a.stickerFBID||!!a.assocTextAsset})};a.prototype.hasAssets=function(){var a=this.getState().assets;return a.size>0};a.prototype.isValidForSubmit=function(){var a=this.getState().assets;return a.size>0&&a.every(function(a){var c=a instanceof b("MediaEffectReactFrameEditorTextAssetRecord");return c||!!a.stickerFBID||!!a.assocTextAsset})};a.prototype.newTextAsset=function(a,c){var d=k();return new(b("MediaEffectReactFrameEditorTextAssetRecord"))({localAssetID:d,position:c||new(b("MediaEffectReactFrameEditorAssetPositionRecord"))(),font:b("MediaEffectReactFrameEditorCanvasDataStore").getState().fonts.first(),fontName:b("MediaEffectReactFrameEditorCanvasDataStore").getState().fonts.first().getName(),content:a,assetSize:new(b("MediaEffectReactFrameEditorSize").Stretch)({height:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:10}),width:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:100})}),color:"#ffffff",textHorizontalAlignment:"center"})};a.prototype.newTextImageAsset=function(a){var c=g._("Enter text here").toString(),d=k();c=new(b("MediaEffectReactFrameEditorTextAssetRecord"))({localAssetID:d,font:b("MediaEffectReactFrameEditorCanvasDataStore").getState().fonts.first(),fontName:b("MediaEffectReactFrameEditorCanvasDataStore").getState().fonts.first().getName(),content:c,color:"#ffffff",textHorizontalAlignment:"center"});var e=b("MediaEffectReactFrameEditorCanvasDataStore").getState(),f=e.canvasHeight;e=e.canvasWidth;return new(b("MediaEffectReactFrameEditorImageAssetRecord"))({localAssetID:d,localImageURI:j,position:a||new(b("MediaEffectReactFrameEditorAssetPositionRecord"))(),assocTextAsset:c,assetSize:new(b("MediaEffectReactFrameEditorSize").Fit)({height:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:10}),width:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:100}),aspect_ratio:100*e/10*f})})};a.prototype.$MediaEffectReactFrameEditorDataStore3=function(a,c,d){__p&&__p();a=a.withAssetMutation(c,function(a){return a.set("nativeSize",d)});var e=a.assets.get(c).assetSize,f=!!a.assets.get(c).assocTextAsset;if(d.y){var g=d.x/d.y;if(!e){f=f?100/b("MediaEffectReactFrameEditorCanvasDataStore").getState().canvasHeight:b("MediaEffectReactFrameEditorCanvasDataStore").getInitialImageScale();e=new(b("MediaEffectReactFrameEditorSize").Fit)({width:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:d.x*f}),height:new(b("MediaEffectReactFrameEditorScalarSizeRecord"))({canvas_size_percentage:d.y*f}),aspect_ratio:g})}else e=e.set("aspect_ratio",g)}a=a.withAssetMutation(c,function(a){return a.set("assetSize",e)});var h=a.assets.get(c).position;e&&e.isValid()&&h&&!h.isBackendCompatible()&&(function(){var d=b("MediaEffectReactFrameEditorCanvasDataStore").getState(),f=d.canvasWidth;d=d.canvasHeight;f=new(b("Vector"))(f,d);var g=b("MediaEffectReactFrameEditorAssetPositionRecord").canonical(h.toAbsolute(f,e.toAbsolute(f)),f);a=a.withAssetMutation(c,function(a){return a.set("position",g)})})();return a};function a(){h.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("MediaEffectFrameEditorDispatcher"))}),null);
__d("MediaEffectReactFrameEditorImageAsset.react",["cx","Image.react","MediaEffectMetadataActionCreators","React","ReactDOM","Vector","XUISpinner.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$4=function(){this.$2=!0,this.$1&&(this.$5(),this.$6()&&(this.props.adjustPosition&&this.props.adjustPosition(this.$1)))}.bind(this),b}a.prototype.$5=function(){if(this.$3)return;this.$3=!0;var a=b("ReactDOM").findDOMNode(this.$1);b("MediaEffectMetadataActionCreators").updateAssetNativeSize(this.props.localAssetID,new(b("Vector"))(a.width,a.height))};a.prototype.$6=function(){if(this.props.imageRecord.assocTextAsset)return!1;return this.props.imageRecord.stickerFBID?!1:!0};a.prototype.render=function(){return b("React").createElement("div",null,b("React").createElement(b("Image.react"),{className:"_55jn _4u2a",onLoad:this.$4,ref:function(a){this.$1=a,this.$1&&this.$2&&this.$5()}.bind(this),src:this.props.isInPreview&&this.props.imageRecord.processedImageURI?this.props.imageRecord.processedImageURI:this.props.imageRecord.getURI()}))};e.exports=a}),null);
__d("MediaEffectArtValidationType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({MEDIA_EFFECT_ART_VALID:"media_effect_art_valid",MEDIA_EFFECT_ART_IS_EVENT_COVER_PHOTO:"media_effect_art_is_event_cover_photo",MEDIA_EFFECT_ART_IS_PHOTO:"media_effect_art_is_photo"})}),null);
__d("XGetUploadedImageForFrameEditorController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/media_effect/swipeable_frame/image/upload_poll/",{job_id:{type:"String",required:!0}})}),null);
__d("XUploadImageForFrameEditorController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/media_effect/swipeable_frame/image/upload/",{})}),null);
__d("XUploadImageWithConversionForFrameEditorController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/media_effect/swipeable_frame/image/upload_convert/",{})}),null);
__d("MediaEffectReactFrameEditorImageAssetRecord",["regeneratorRuntime","Promise","AsyncRequest","AsyncRequestUtil","AsyncResponse","AsyncUploadRequest","immutable","MediaEffectArtValidationType","MediaEffectFrameCreateDialogDataStore","MediaEffectImageTransmogrifier","MediaEffectMetadataActionCreators","MediaEffectReactFrameEditorDataStore","MediaEffectTemplateDataStore","XGetUploadedImageForFrameEditorController","XUploadImageForFrameEditorController","XUploadImageWithConversionForFrameEditorController","retry"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;d=b("immutable").Record;a.URL=a.URL||a.webkitURL;g=babelHelpers.inherits(c,d({localAssetID:null,file:null,localImageURI:null,hostedImageURI:null,processedImageURI:null,processApplied:!1,assetSize:null,nativeSize:null,position:null,stickerFBID:null,assetFBID:null,readOnly:!1,sourceTemplateAssetFBID:null,validationResult:null,autoSnappedType:null,assocTextAsset:null}));g&&g.prototype;c.prototype.getURI=function(){if(this.localImageURI)return this.localImageURI;if(this.hostedImageURI)return this.hostedImageURI;throw new Error("ImageAssetRecord has no URI")};c.prototype.assetType=function(){return"MediaEffectReactFrameEditorImageAssetRecord"};c.prototype.reColored=function(a,c){__p&&__p();var d,e,f;return b("regeneratorRuntime").async(function(g){__p&&__p();while(1)switch(g.prev=g.next){case 0:d=new(b("MediaEffectImageTransmogrifier").ColorTransform)(this.getURI(),!1,a,c);g.next=3;return b("regeneratorRuntime").awrap(d.toBlob());case 3:e=g.sent;f=URL.createObjectURL(e);return g.abrupt("return",this.withMutations(function(a){a.set("file",e),a.set("localImageURI",f),a.set("hostedImageURI",null),a.set("stickerFBID",null),a.set("sourceTemplateAssetFBID",a.assetFBID),a.set("assetFBID",null),a.set("validationResult",null)}));case 6:case"end":return g.stop()}},null,this)};c.prototype.upload=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return b("regeneratorRuntime").awrap(this.$MediaEffectReactFrameEditorImageAssetRecord1()["catch"](function(a){this.$MediaEffectReactFrameEditorImageAssetRecord2()}.bind(this)));case 2:case"end":return a.stop()}},null,this)};c.prototype.$MediaEffectReactFrameEditorImageAssetRecord2=function(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:a=b("MediaEffectTemplateDataStore").getState().currentTemplateVariationID;c.next=3;return b("regeneratorRuntime").awrap(this.$MediaEffectReactFrameEditorImageAssetRecord3(a));case 3:case"end":return c.stop()}},null,this)};c.prototype.$MediaEffectReactFrameEditorImageAssetRecord1=function(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:a=b("MediaEffectTemplateDataStore").getState().currentTemplateVariationID;c.next=3;return b("regeneratorRuntime").awrap(this.$MediaEffectReactFrameEditorImageAssetRecord4(a));case 3:case"end":return c.stop()}},null,this)};c.prototype.$MediaEffectReactFrameEditorImageAssetRecord5=function(a,c){__p&&__p();return b("regeneratorRuntime").async(function(d){__p&&__p();while(1)switch(d.prev=d.next){case 0:return d.abrupt("return",new(b("Promise"))(function(d,e){var f=new(b("AsyncUploadRequest"))(a).setFiles({flist:[c]}).setData({flow_source_id:b("MediaEffectFrameCreateDialogDataStore").getState().sourceID,flow_type:b("MediaEffectFrameCreateDialogDataStore").getState().flowType}).setAllowCrossOrigin(!1);f.subscribe("success",function(a,b){return d(b.getResponse().getPayload())});f.subscribe("failure",function(a,b){return e(b.getResponse())});f.send()}));case 1:case"end":return d.stop()}},null,this)};c.prototype.$MediaEffectReactFrameEditorImageAssetRecord3=function(a){__p&&__p();var c,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=b("XUploadImageForFrameEditorController").getURIBuilder().getURI();e.next=3;return b("regeneratorRuntime").awrap(b("retry").onError(b("AsyncResponse")).untilValueMatches(function(a){return!!a.id}).limit(3).call(this.$MediaEffectReactFrameEditorImageAssetRecord5.bind(this,c,this.file)));case 3:d=e.sent,b("MediaEffectMetadataActionCreators").updateStickerFBID(this.localAssetID,d.id.toString(),a);case 5:case"end":return e.stop()}},null,this)};c.prototype.$MediaEffectReactFrameEditorImageAssetRecord4=function(a){__p&&__p();var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(this.$MediaEffectReactFrameEditorImageAssetRecord6());case 2:c=d.sent;d.next=5;return b("regeneratorRuntime").awrap(this.$MediaEffectReactFrameEditorImageAssetRecord7(c,a));case 5:case"end":return d.stop()}},null,this)};c.prototype.$MediaEffectReactFrameEditorImageAssetRecord6=function(){__p&&__p();var a,c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:a=b("XUploadImageWithConversionForFrameEditorController").getURIBuilder().getURI();d.next=3;return b("regeneratorRuntime").awrap(b("retry").onError(b("AsyncResponse")).untilValueMatches(function(a){return!!a.job_id}).limit(3).call(this.$MediaEffectReactFrameEditorImageAssetRecord5.bind(this,a,this.file)));case 3:c=d.sent;return d.abrupt("return",c.job_id.toString());case 5:case"end":return d.stop()}},null,this)};c.prototype.$MediaEffectReactFrameEditorImageAssetRecord7=function(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(b("retry").withBackoff(1.5).withMaxInterval(1e4).onError(b("AsyncResponse")).limit(15).untilValueMatches(function(a){return a&&a.id}).call(this.$MediaEffectReactFrameEditorImageAssetRecord8.bind(this,a,c)));case 2:d=e.sent,b("MediaEffectMetadataActionCreators").updateValidationResult(d.id.toString(),{success:d.validationResult,validateType:d.validationReasons.length?d.validationReasons[0].validateType:b("MediaEffectArtValidationType").MEDIA_EFFECT_ART_VALID,reason:d.validationReasons.length?d.validationReasons[0].reason:""},c),b("MediaEffectMetadataActionCreators").updateStickerFBID(this.localAssetID,d.id.toString(),c),b("MediaEffectMetadataActionCreators").processBackground(this.localAssetID,d.id.toString());case 6:case"end":return e.stop()}},null,this)};c.prototype.$MediaEffectReactFrameEditorImageAssetRecord8=function(a,c){__p&&__p();var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:c=b("XGetUploadedImageForFrameEditorController").getURIBuilder().setString("job_id",a).getURI();d=new(b("AsyncRequest"))(c).setAllowCrossOrigin(!1);f.next=4;return b("regeneratorRuntime").awrap(b("AsyncRequestUtil").send(d));case 4:e=f.sent;return f.abrupt("return",e.getPayload());case 6:case"end":return f.stop()}},null,this)};c.prototype.getInstanceFromStore=function(){return b("MediaEffectReactFrameEditorDataStore").getState().assets.get(this.localAssetID)};function c(){g.apply(this,arguments)}e.exports=c}),null);
__d("MediaEffectReactFrameEditorPreview.react",["cx","LayerHideOnBlur","MediaEffectFramePhonePreviewContainer.react","MediaEffectFramePreviewConfigs","MediaEffectFramePreviewTypes","MediaEffectReactFrameEditorCameraContainer.react","MediaEffectReactFrameEditorPreviewCanvas.react","React","Vector","XUIContextualDialog.react","XUIContextualDialogBody.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(a){h.constructor.call(this,a),this.$4=function(){return this.setState({showFullPreview:!0})}.bind(this),this.$3=function(){return this.setState({showFullPreview:!1})}.bind(this),this.$6=function(){return this.thumbnailRoot}.bind(this),this.$7=function(a){a!==this.state.showFullPreview&&this.setState({showFullPreview:a})}.bind(this),this.state={showFullPreview:!1}}a.prototype.$1=function(){var a=this.props.previewSize,c=a.x;a=a.y;if(c===a)return b("MediaEffectFramePreviewTypes").PROFILE;else if(c>a)return b("MediaEffectFramePreviewTypes").LANDSCAPE;else return b("MediaEffectFramePreviewTypes").PORTRAIT};a.prototype.$2=function(a){var c=this.props.previewSize.x*a;a=this.props.previewSize.y*a;return b("React").createElement("div",{className:"_5gzu",onMouseOut:this.$3,onMouseOver:this.$4,style:{backgroundColor:this.props.backgroundColor,width:c,height:a}},this.props.cameraEnabled?b("React").createElement(b("MediaEffectReactFrameEditorCameraContainer.react"),{height:a,width:c}):null,b("React").createElement(b("MediaEffectReactFrameEditorPreviewCanvas.react"),{assetOrder:this.props.assetOrder,assets:this.props.assets,backgroundColor:this.props.cameraEnabled?"transparent":this.props.backgroundColor,backgroundImage:this.props.backgroundImage,disableBackgroundImage:this.props.cameraEnabled,previewSize:new(b("Vector"))(c,a)}))};a.prototype.$5=function(){var a=b("MediaEffectFramePreviewConfigs")[this.$1()].label;return b("React").createElement(b("XUIContextualDialog.react"),{autoFocus:!1,behaviors:{LayerHideOnBlur:b("LayerHideOnBlur")},contextRef:this.$6,focusContextOnHide:!1,key:"contextualDialog",label:a,onToggle:this.$7,position:"left",shown:this.state.showFullPreview},b("React").createElement(b("XUIContextualDialogBody.react"),null,b("React").createElement(b("MediaEffectFramePhonePreviewContainer.react"),b("MediaEffectFramePreviewConfigs")[this.$1()].size),b("React").createElement("div",{className:"_4qx4"},a)))};a.prototype.render=function(){return b("React").createElement("div",null,b("React").createElement("div",{ref:function(a){return this.thumbnailRoot=a}.bind(this)},this.$2(this.props.previewScale)),this.$5())};e.exports=a}),null);
__d("MediaEffectReactFrameEditorPreviewCanvas.react",["cx","fbt","CenteredContainer.react","MediaEffectReactFrameEditorAsset.react","React","VideoComponentWithLoopingPlayback.react","VideoDataContainer.react","VideoPlayer.react","XUIText.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.$1=function(){var a=this.props,c=a.assets;a=a.previewSize;if(c.size!==0)return null;c=void 0;a.x>a.y?c=h._("LANDSCAPE"):a.x===a.y?c=h._("PROFILE"):c=h._("PORTRAIT");return b("React").createElement("div",{className:"_29ep"},b("React").createElement(b("XUIText.react"),{size:"meta1"},c))};a.prototype.render=function(){var a=this.props,c=a.backgroundColor,d=a.backgroundImage,e=a.disableBackgroundImage,f=a.previewSize;return b("React").createElement("div",{className:"_5mqu",style:{backgroundColor:c,backgroundImage:e?"none":d&&d.sprited===!1?"url('"+d.uri+"')":null,backgroundPosition:d?"center":null,backgroundSize:d?"cover":f.x>f.y?f.x/10:f.y/10,height:f.y,width:f.x}},b("React").createElement(b("CenteredContainer.react"),{className:"_207i",fullHeight:!0,horizontal:!0,vertical:!0},this.$1()),this.props.videoSourceID?b("React").createElement(b("VideoDataContainer.react"),{videoID:this.props.videoSourceID},b("React").createElement(b("VideoPlayer.react"),{autoplay:!0,height:f.y,startMuted:!0,videoData:b("VideoDataContainer.react").VIDEO_DATA_PLACEHOLDER,width:f.x},b("React").createElement(b("VideoComponentWithLoopingPlayback.react"),{infiniteLooping:!0}))):null,this.props.assetOrder.map(function(a){return b("React").createElement(b("MediaEffectReactFrameEditorAsset.react"),{assetData:this.props.assets.get(a),canvasSize:f,key:a,localAssetID:a,readOnly:!0})}.bind(this)))};function a(){i.apply(this,arguments)}a.defaultProps={disableBackgroundImage:!1};e.exports=a}),null);
__d("MediaEffectReactFrameEditorPreviewCanvasContainer.react",["FluxContainer","MediaEffectFrameEditorDispatcher","MediaEffectReactFrameEditorCanvasDataStore","MediaEffectReactFrameEditorDataStore","MediaEffectReactFrameEditorPreviewCanvas.react","React","Vector"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MediaEffectReactFrameEditorDataStore"),b("MediaEffectReactFrameEditorCanvasDataStore")]};a.calculateState=function(a,c){a=b("MediaEffectReactFrameEditorDataStore").getState();var d=b("MediaEffectReactFrameEditorCanvasDataStore").getState();return{assets:a.assets,assetOrder:a.assetOrder,backgroundColor:d.backgroundColor,backgroundImage:d.backgroundImage,cameraEnabled:d.cameraSource!=null,previewSize:new(b("Vector"))(c.previewWidth,c.previewHeight)}};a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.constructor.getStores())};a.prototype.render=function(){return b("React").createElement(b("MediaEffectReactFrameEditorPreviewCanvas.react"),this.state)};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MediaEffectReactFrameEditorPreviewContainer.react",["FluxContainer","MediaEffectFrameEditorDispatcher","MediaEffectReactFrameEditorCanvasDataStore","MediaEffectReactFrameEditorDataStore","MediaEffectReactFrameEditorPreview.react","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MediaEffectReactFrameEditorDataStore"),b("MediaEffectReactFrameEditorCanvasDataStore")]};a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.constructor.getStores())};a.calculateState=function(a){a=b("MediaEffectReactFrameEditorDataStore").getState();var c=b("MediaEffectReactFrameEditorCanvasDataStore").getState();return{assets:a.assets,assetOrder:a.assetOrder,backgroundColor:c.backgroundColor,backgroundImage:c.backgroundImage,cameraEnabled:c.cameraSource!=null}};a.prototype.render=function(){var a=babelHelpers["extends"]({},this.props,this.state);return b("React").createElement(b("MediaEffectReactFrameEditorPreview.react"),a)};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MediaEffectReactFrameEditorSelectionBox.react",["cx","FBDragHandle.react","immutable","MediaEffectFrameEditorConstants","MediaEffectMetadataActionCreators","MediaEffectReactFrameEditorAssetPositionRecord","React","Rect"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("immutable").Map,j=b("MediaEffectFrameEditorConstants").EDITOR_BUFFER_SIZE;function k(a,b,c,d){a=(a*c+b*d)/(c*c+d*d);return[c*a,d*a]}function l(event){return event&&(event.metaKey||event.ctrlKey)}function m(a,b){var c=(b.r+b.l)/2;b=(b.t+b.b)/2;a.t=Math.min(a.t,b-1);a.r=Math.max(a.r,c+1);a.b=Math.max(a.b,b+1);a.l=Math.min(a.l,c-1)}c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){__p&&__p();var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$3=function(a,b,c,d,e,event){__p&&__p();c=e.boundingRect;if(this.props.fixedAspectRatio){d=k(a,b,c.w(),c.h());a=d[0];b=d[1]}d=c.add(0,0);d.l+=a;d.t+=b;d.l=Math.min(d.r-1,d.l);d.t=Math.min(d.b-1,d.t);l(event)&&(d.r-=a,d.b-=b,m(d,c));this.$7(c,d,e.assetRects)}.bind(this),this.$4=function(a,b,c,d,e,event){__p&&__p();c=e.boundingRect;if(this.props.fixedAspectRatio){d=k(a,b,-c.w(),c.h());a=d[0];b=d[1]}d=c.add(0,0);d.r+=a;d.t+=b;d.r=Math.max(d.l+1,d.r);d.t=Math.min(d.b-1,d.t);l(event)&&(d.l-=a,d.b-=b,m(d,c));this.$7(c,d,e.assetRects)}.bind(this),this.$5=function(a,b,c,d,e,event){__p&&__p();c=e.boundingRect;if(this.props.fixedAspectRatio){d=k(a,b,c.w(),-c.h());a=d[0];b=d[1]}d=c.add(0,0);d.l+=a;d.b+=b;d.l=Math.min(d.r-1,d.l);d.b=Math.max(d.t+1,d.b);l(event)&&(d.r-=a,d.t-=b,m(d,c));this.$7(c,d,e.assetRects)}.bind(this),this.$6=function(a,b,c,d,e,event){__p&&__p();c=e.boundingRect;if(this.props.fixedAspectRatio){d=k(a,b,-c.w(),-c.h());a=d[0];b=d[1]}d=c.add(0,0);d.r+=a;d.b+=b;d.r=Math.max(d.l+1,d.r);d.b=Math.max(d.t+1,d.b);l(event)&&(d.l-=a,d.t-=b,m(d,c));this.$7(c,d,e.assetRects)}.bind(this),b}a.prototype.render=function(){__p&&__p();if(this.props.assets.size===0)return null;var a=this.$1(),c=b("Rect").minimumBoundingBox(a.toArray());if(c.x===0||c.y===0)return null;var d={assetRects:a,boundingRect:c};a=function(){return d};var e=this.props.canvasHeight/b("MediaEffectFrameEditorConstants").PHONE_SCREEN_TO_FRAME_HEIGHT_RATIO,f=this.props.canvasWidth/b("MediaEffectFrameEditorConstants").PHONE_SCREEN_TO_FRAME_WIDTH_RATIO;e=this.props.includesPhoneFrame?(e-this.props.canvasHeight)/2:j;f=this.props.includesPhoneFrame?(f-this.props.canvasWidth)/2:j;return b("React").createElement("div",{className:"_2z_m",style:{top:e-1,left:f-1},onMouseDown:this.$2},b("React").createElement("div",{className:"_2z_n",style:{top:c.t,left:c.l,width:c.w(),height:c.h()}},b("React").createElement(b("FBDragHandle.react"),{cursor:"nwse-resize",horizontal:!0,initialData:a,onChange:this.$3,stopOnLeave:!1,vertical:!0},b("React").createElement("div",{className:"_2z_o"})),b("React").createElement(b("FBDragHandle.react"),{cursor:"nesw-resize",horizontal:!0,initialData:a,onChange:this.$4,stopOnLeave:!1,vertical:!0},b("React").createElement("div",{className:"_2z_p"})),b("React").createElement(b("FBDragHandle.react"),{cursor:"nesw-resize",horizontal:!0,initialData:a,onChange:this.$5,stopOnLeave:!1,vertical:!0},b("React").createElement("div",{className:"_2z_t"})),b("React").createElement(b("FBDragHandle.react"),{cursor:"nwse-resize",horizontal:!0,initialData:a,onChange:this.$6,stopOnLeave:!1,vertical:!0},b("React").createElement("div",{className:"_2z_u"}))))};a.prototype.$2=function(event){event.stopPropagation()};a.prototype.$1=function(){var a=this.props.assets,b=i();b=b.withMutations(function(b){a.forEach(function(a){a&&a.assetSize&&b.set(a.localAssetID,a.position.toAbsolute(this.props.canvasSize,a.assetSize.toAbsolute(this.props.canvasSize)))}.bind(this))}.bind(this));return b};a.prototype.$7=function(a,c,d){__p&&__p();var e=function(b){return c.r*(b-a.l)/a.w()+c.l*(a.r-b)/a.w()},f=function(b){return c.b*(b-a.t)/a.h()+c.t*(a.b-b)/a.h()};d.forEach(function(a,c){var d=this.props.assets.get(c);if(!d)return;a=new(b("Rect"))(f(a.t),e(a.r),f(a.b),e(a.l));d=d.assetSize;d&&(d.width&&d.width.pixels!==0?d=d.set("width",d.width.set("pixels",a.w())):d.width&&(d=d.set("width",d.width.set("canvas_size_percentage",a.w()*100/this.props.canvasSize.x))),d.height&&d.height.pixels!==0?d=d.set("height",d.height.set("pixels",a.h())):d.height&&(d=d.set("height",d.height.set("canvas_size_percentage",a.h()*100/this.props.canvasSize.y))));b("MediaEffectMetadataActionCreators").updateAssetSize(c,d);d=b("MediaEffectReactFrameEditorAssetPositionRecord").canonical(a,this.props.canvasSize);b("MediaEffectMetadataActionCreators").updateAssetPosition(c,d)}.bind(this))};e.exports=a}),null);
__d("MediaEffectReactFrameEditorSelectionBoxContainer.react",["FluxContainer","immutable","MediaEffectFrameEditorDispatcher","MediaEffectReactFrameEditorDataStore","MediaEffectReactFrameEditorSelectionBox.react","React","Vector"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("immutable").Map;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MediaEffectReactFrameEditorDataStore")]};a.calculateState=function(a,c){var d=b("MediaEffectReactFrameEditorDataStore").getState().get("assets");a=h(c.selectedAssets.map(function(a){return[a,d.get(a)]}));var e=a.some(function(a){return a&&a.assetSize&&a.assetSize.aspect_ratio!==null});return{assets:a,canvasSize:new(b("Vector"))(c.canvasWidth,c.canvasHeight),fixedAspectRatio:e}};a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.constructor.getStores())};a.prototype.render=function(){var a=babelHelpers["extends"]({},this.props,this.state);return b("React").createElement(b("MediaEffectReactFrameEditorSelectionBox.react"),a)};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("XMediaEffectAsyncTemplateLoadController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/template/load/",{template_id:{type:"FBID"}})}),null);
__d("MediaEffectReactFrameEditorTemplateRecord",["regeneratorRuntime","AsyncRequest","immutable","MediaEffectReactFrameDeserializer","XMediaEffectAsyncTemplateLoadController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("immutable").List;d=b("immutable").Record;g=babelHelpers.inherits(a,d({templateFBID:null,previewURL:null,frameData:null,sourceTemplateFBID:null,variants:c(),colorPalette:null}));g&&g.prototype;a.prototype.getColor=function(){return!this.colorPalette?null:this.colorPalette.getMainColor()};a.prototype.genFrameData=function(){__p&&__p();var a,c,d;return b("regeneratorRuntime").async(function(e){__p&&__p();while(1)switch(e.prev=e.next){case 0:if(!this.frameData){e.next=2;break}return e.abrupt("return",this.frameData);case 2:a=b("XMediaEffectAsyncTemplateLoadController").getURIBuilder().getURI();e.next=5;return b("regeneratorRuntime").awrap(new(b("AsyncRequest"))().setURI(a).setData({template_id:this.templateFBID}).exec());case 5:c=e.sent;d=c.payload.frameData;return e.abrupt("return",b("MediaEffectReactFrameDeserializer").deserializeData(d));case 8:case"end":return e.stop()}},null,this)};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectReactFrameEditorTextAsset.react",["cx","CanvasToBlobImpl","DOMQuery","MediaEffectFrameEditorTextPropertiesDialogContainer.react","MediaEffectMetadataActionCreators","MediaEffectReactFrameEditorAssetPositionRecord","React","ReactDOM","Rect","Vector","debounce","html2canvas-v0.5","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=.5,j=.1;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(a,c){__p&&__p();h.constructor.call(this,a,c),this.$6=function(a){if(this.props.readOnly)return;if(!this.props.editing)return;this.$3=a.target.textContent;this.$7()}.bind(this),this.$9=function(a){if(this.props.readOnly)return;if(!this.props.editing)return;var b=a.nativeEvent.srcElement;this.$8(b.clientWidth)||a.preventDefault()}.bind(this),this.$10=function(a){if(this.props.readOnly)return;if(!this.props.editing)return;(a.key==="Enter"||a.key==="Escape")&&(this.doneEditing(),a.preventDefault())}.bind(this),this.$11=function(a){if(this.props.readOnly)return;if(!this.props.editing)return;this.doneEditing()}.bind(this),this.$7=b("debounce")(function(){return this.updateAssetImage(!1)}.bind(this),500),this.$2=null,this.$1=null,this.$5=function(){},this.$3=a.assetData.content,this.$4=0,this.state={contextReady:!1}}a.prototype.$8=function(a){__p&&__p();var c=this.props.position||new(b("Rect"))(0,0,0,0),d=c.l,e=this.props.canvasSize.x,f=this.props.textboxHeight||60;f=f*i;d=d+a+f<e;if(d)return!0;a=c.sub(f,0);if(a.l>0){b("MediaEffectMetadataActionCreators").updateAssetPosition(this.props.localAssetID,b("MediaEffectReactFrameEditorAssetPositionRecord").canonical(a,new(b("Vector"))(this.props.canvasSize.x,this.props.canvasSize.y)));return!0}else return!1};a.prototype.$12=function(){return this.props.assetData.isDynamicText()};a.prototype.$13=function(){this.$4=window.getSelection().anchorOffset||0};a.prototype.$14=function(){__p&&__p();if(!this.isElementRendered())return;var a=b("DOMQuery").find(this.$1,"div.text-node");if(a.childNodes.length===0)return;var c=document.createRange(),d=window.getSelection(),e=Math.min(a.childNodes[0].length,this.$4);c.setStart(a.childNodes[0],e);c.collapse(!0);d.removeAllRanges();d.addRange(c)};a.prototype.doneEditing=function(){this.$5(),this.props.assetData.content!==this.$3&&b("MediaEffectMetadataActionCreators").updateTextContent(this.props.localAssetID,this.$3),setTimeout(function(){b("MediaEffectMetadataActionCreators").editText(null),setTimeout(function(){return b("MediaEffectMetadataActionCreators").deselectAll()},0)},0)};a.prototype.updateAssetImage=function(a){__p&&__p();var c,d=this;if(this.props.readOnly)return;var e=this.$3;if(!this.$12()&&this.$1&&this.isElementRendered()&&e){var c=function(){__p&&__p();var c=new(b("Rect"))(d.$1);if(!c.getWidth()||!c.getHeight())return{v:void 0};var f=new(b("Vector"))(c.getWidth(),c.getHeight());d.$13();b("html2canvas-v0.5")(d.$1,{onrendered:function(c){var d=c.toDataURL("image/png");this.$14();this.$5=function(){this.$5=function(){},b("MediaEffectMetadataActionCreators").updateTextImage(this.props.assetData.localAssetID,e,d,b("CanvasToBlobImpl").getBlob(d,"image/png"),f)}.bind(this);a&&this.$5()}.bind(d),background:undefined,useCORS:!0})}();if(typeof c==="object")return c.v}};a.prototype.componentWillUnmount=function(){if(this.props.readOnly)return;if(this.$12()&&this.props.assetData.content!==this.$3){b("MediaEffectMetadataActionCreators").updateTextContent(this.props.localAssetID,this.$3);return}this.$3&&this.$5()};a.prototype.componentDidUpdate=function(a,b){if(this.props.readOnly)return;this.isElementRendered()&&(this.$2=this.$2||setTimeout(function(){this.updateAssetImage(!0)}.bind(this),200));this.props!==a&&this.$7()};a.prototype.componentDidMount=function(){if(this.props.editing){var a=b("DOMQuery").find(this.$1,"div.text-node");if(a.childNodes.length===0)return;this.$4=a.childNodes[0].length;this.$14()}};a.prototype.isElementRendered=function(){return!!b("ReactDOM").findDOMNode(this.$1)};a.prototype.render=function(){var a=this.props.textboxHeight||60,c=a*i;a=a*(1-i)/2;var d=c*j,e=this.props.assetData&&this.props.assetData.font?this.props.assetData.font.getFontFamily():"",f=this.$12()?"_3lz7":"_1kg8",g=!this.props.readOnly&&this.props.editing;g&&(f=b("joinClasses")("_1r26",f));a=this.$12()?{padding:a+"px "+d+"px"}:{padding:a+"px "+d+"px",textAlign:"justify"};return b("React").createElement("div",{className:f,contentEditable:g,onBlur:this.$11,onInput:this.$6,onKeyDown:this.$10,onKeyPress:this.$9,ref:function(a){this.$1=a,this.setState({contextReady:!0})}.bind(this),style:{color:this.props.assetData.color,fontFamily:e,fontSize:c,textAlign:this.props.assetData.textHorizontalAlignment,lineHeight:c+"px"}},b("React").createElement("div",{className:"text-node",style:a},this.props.assetData.content),this.state.contextReady&&this.$1&&!this.props.readOnly&&this.props.editing&&this.props.enableFontSettingsDialog?b("React").createElement(b("MediaEffectFrameEditorTextPropertiesDialogContainer.react"),{assetData:this.props.assetData,context:this.$1,localAssetID:this.props.localAssetID,shown:!0}):null)};e.exports=a}),null);
__d("MediaEffectReactFrameEditorTextAssetRecord",["regeneratorRuntime","immutable","MediaEffectReactFrameEditorDataStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("immutable").Record;var h=/^\%.*\%$/;g=babelHelpers.inherits(a,c({assetSize:null,color:null,content:null,font:null,localAssetID:null,position:null,textHorizontalAlignment:null,readOnly:!1,sourceTemplateAssetFBID:null,assetFBID:null,dirty:!1}));g&&g.prototype;a.prototype.assetType=function(){return"MediaEffectReactFrameEditorTextAssetRecord"};a.prototype.getParentImageAsset=function(){var a=b("MediaEffectReactFrameEditorDataStore").getState().assets.get(this.localAssetID);return a===this?null:a};a.prototype.isDynamicText=function(){return h.test(this.content)};a.prototype.reColored=function(a,c){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",this);case 1:case"end":return a.stop()}},null,this)};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectReactFrameSerializer",["regeneratorRuntime","Promise","MediaEffectReactFrameEditorCanvasDataStore","MediaEffectReactFrameEditorImageAssetRecord","MediaEffectReactFrameEditorSize","MediaEffectReactFrameEditorTextAssetRecord","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){a=a.position;return{horizontal_alignment:a.x.anchor_asset_size_percentage!==0?"center":a.x.asset_origin==="canvas_start"?"left":"right",horizontal_margin:a.x.asset_canvas_size_percentage,vertical_alignment:a.y.anchor_asset_size_percentage!==0?"center":a.y.asset_origin==="canvas_start"?"top":"bottom",vertical_margin:a.y.asset_canvas_size_percentage}}function h(a,c){c=b("nullthrows")(a.assetSize);a=g(a);if(c instanceof b("MediaEffectReactFrameEditorSize").Fill||c instanceof b("MediaEffectReactFrameEditorSize").ScaleWidth)return babelHelpers["extends"]({},a,{size:c.width.canvas_size_percentage,size_dimension:"width"});else if(c instanceof b("MediaEffectReactFrameEditorSize").Fit||c instanceof b("MediaEffectReactFrameEditorSize").ScaleHeight)return babelHelpers["extends"]({},a,{size:c.height.canvas_size_percentage,size_dimension:"height"});else throw new Error("Unserializable frame.")}function i(a,c){c=b("nullthrows")(a.assetSize);a=g(a);if(c instanceof b("MediaEffectReactFrameEditorSize").Fit||c instanceof b("MediaEffectReactFrameEditorSize").ScaleWidth)return babelHelpers["extends"]({},a,{size:c.width.canvas_size_percentage,size_dimension:"width"});else if(c instanceof b("MediaEffectReactFrameEditorSize").Fill||c instanceof b("MediaEffectReactFrameEditorSize").ScaleHeight)return babelHelpers["extends"]({},a,{size:c.height.canvas_size_percentage,size_dimension:"height"});else throw new Error("Unserializable frame.")}function j(a){__p&&__p();var c=a.getParentImageAsset();if(c){c=g(c);return babelHelpers["extends"]({},c,{size:0,textbox_width:0,text_horizontal_alignment:a.textHorizontalAlignment,size_dimension:"height"})}c=a.assetSize;var d=g(a);if(!c||!(c instanceof b("MediaEffectReactFrameEditorSize").Stretch))throw new Error("Unserializable frame.");return babelHelpers["extends"]({},d,{size:c.height?c.height.canvas_size_percentage:0,textbox_width:c.width?c.width.canvas_size_percentage:0,text_horizontal_alignment:a.textHorizontalAlignment,size_dimension:"height"})}function k(a,c){var d=b("MediaEffectReactFrameEditorCanvasDataStore").getState().canvasSize;return{landscape_position:h(a,d),portrait_position:i(a,d),rotation:0,source_template_asset_id:a.sourceTemplateAssetFBID,z_index:c}}function l(a,b){var c=j(a);return{portrait_position:c,landscape_position:c,asset_id:a.assetFBID||-a.localAssetID,content:a.content,font_name:a.font.getSystemFontName(),font_size:c.size,custom_font_id:a.font.getCustomFontID(),color:a.color.substr(1),text_horizontal_alignment:a.textHorizontalAlignment,rotation:0,source_template_asset_id:a.sourceTemplateAssetFBID,z_index:b}}function m(a,c){__p&&__p();var d;return b("regeneratorRuntime").async(function(e){__p&&__p();while(1)switch(e.prev=e.next){case 0:if(!(a.assocTextAsset&&a.assocTextAsset.dirty)){e.next=3;break}e.next=3;return b("regeneratorRuntime").awrap(a.upload());case 3:d=a.getInstanceFromStore();return e.abrupt("return",babelHelpers["extends"]({},k(d,c),{sticker_id:d.stickerFBID,is_face_sticker:!1,dynamic_sticker_pack_id:null,dynamic_sticker_type:null,asset_id:d.assetFBID||-d.localAssetID,assoc_text_asset:d.assocTextAsset&&l(d.assocTextAsset,c)}));case 5:case"end":return e.stop()}},null,this)}function a(a){__p&&__p();var c,d,e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){__p&&__p();while(1)switch(k.prev=k.next){case 0:c={};d=[];e={};f=a.assetOrder;g=a.assets;h=f.map(function(a,c){a=g.get(a);return a instanceof b("MediaEffectReactFrameEditorTextAssetRecord")?l(a,c):null}).toArray();h.forEach(function(a){a&&(d.push(a),e[a.asset_id]=a)});i=[];f.forEach(function(a,c){a=g.get(a);a instanceof b("MediaEffectReactFrameEditorImageAssetRecord")&&i.push(m(a,c))});k.next=11;return b("regeneratorRuntime").awrap(b("Promise").all(i));case 11:j=k.sent;j.forEach(function(a){c[a.asset_id]=a});return k.abrupt("return",{stickers:j,sticker_edges:c,text:d,text_edges:e,fbid:a.frameFBID,filter_id:a.filterID});case 14:case"end":return k.stop()}},null,this)}e.exports={genSerializeFrame:a}}),null);
__d("MediaEffectMetadataValidationUtils",["MediaEffectPlaceDescriptionRecord"],(function(a,b,c,d,e,f){"use strict";var g={validateName:function(a){return!!a&&a.trim()!==""},validateOwnerID:function(a){return!!a&&a.trim()!==""},validateTemplateCategoryID:function(a){return!!a&&a.trim()!==""},validateLocationPageID:function(a){return!!a&&a.toString().trim()!==""},validateLocation:function(a){return!!a&&(g.validateLocationPageID(a.key)||a.latitude!==null&&a.longitude!==null)},validateTimeRange:function(a,b){return a&&b&&a.getTime()>=b.getTime()?!1:!0}};e.exports=g}),null);
__d("PlaceSearchSuppressionVersion",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ADS_TARGETING:"ads_targeting_suppression",CAMERA_LOCATION_FRAMES:"camera_location_frames_suppression",GRAPH_API:"graph_api_suppression",MAIN_TYPEAHEAD:"main_typeahead_suppression",QUERIED_CHECKIN:"queried_checkin_suppression",QUERYLESS_CHECKIN:"queryless_checkin_suppression",SET_SEARCH:"set_search_suppression",SUGGESTIFIER:"suggestifier_suppression",HEALTH_BLOOD_DONATION_HOSPITALS:"health_blood_donation_hospitals_suppression",PROD_SUPPRESSION:"prod_suppression"})}),null);
__d("MediaEffectLocationTargetingPageTypeahead.react",["cx","fbt","CameraEffectsPOITypeaheadSearchGK","FBOverlayBase.react","FBOverlayContainer.react","FBOverlayElement.react","MediaEffectEditorFunnelLogger","MediaEffectMetadataValidationUtils","MediaEffectPlaceDescriptionRecord","PlaceSearchConstants","PlaceSearchSuppressionVersion","React","ReactComposerLocationSearchSource","SearchableEntry","XUISpinner.react","XUITextInput.react","XUITypeahead.react","idx","mediaEffectGKCheck"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(a){i.constructor.call(this,a),this.$4=function(a,c){var d=a.getUniqueID();b("MediaEffectEditorFunnelLogger").logChangeLocation();this.setState({query:a.getTitle()},function(){return this.props.onLocationSelected(d)}.bind(this))}.bind(this),this.$5=function(event){this.setState({query:event.target.value})}.bind(this),this.$6=function(){this.props.onLocationSelected(null),this.setState({query:""})}.bind(this),this.state=this.$1()}a.prototype.UNSAFE_componentWillReceiveProps=function(a){var b={};this.props.isLoading&&!a.isLoading&&!((a=a.location)!=null?a.name:a)&&(b.query="");this.setState(b)};a.prototype.$2=function(){return b("ReactComposerLocationSearchSource")({},{hide_geo:!1,allow_poi:b("CameraEffectsPOITypeaheadSearchGK").gkResult,allow_country:!0,suppression_version:b("PlaceSearchSuppressionVersion").CAMERA_LOCATION_FRAMES},{event_name:b("PlaceSearchConstants").SOURCE_CAMERA_MEDIA_EFFECT_UPLOAD,event_specific_data:{context:"places_typeahead:"+b("PlaceSearchConstants").SOURCE_CAMERA_MEDIA_EFFECT_UPLOAD,source:b("PlaceSearchConstants").SOURCE_CAMERA_MEDIA_EFFECT_UPLOAD,ref:"MediaEffectMetadataLocation.react"}})};a.prototype.$1=function(){var a;return{query:((a=this.props.location)!=null?a.name:a)||"",searchSource:this.$2()}};a.prototype.$3=function(){var a=this.props,c=a.isValidating;a=a.location;if(c&&this.props.isLoading)return h._("Loading location data");a=b("MediaEffectMetadataValidationUtils").validateLocationPageID((a=a)!=null?a.key:a);return c&&!a?h._("Please enter a location"):null};a.prototype.render=function(){if(this.state.isLoading||this.props.location&&this.props.location.key&&!this.props.location.name)return b("React").createElement(b("FBOverlayContainer.react"),{className:"_3_kx"},b("React").createElement(b("FBOverlayBase.react"),null,b("React").createElement(b("XUITextInput.react"),{className:"_3_kx",defaultValue:this.state.query,disabled:!0,height:"tall",xuiError:this.$3()})),b("React").createElement(b("FBOverlayElement.react"),{horizontal:"right"},b("React").createElement(b("XUISpinner.react"),{className:"_61s8",size:"large"})));var a=this.props.location&&this.props.location.key&&this.props.location.name?new(b("SearchableEntry"))({uniqueID:this.props.location.key,title:this.props.location.name,type:this.props.location.type}):null;return b("React").createElement(b("XUITypeahead.react"),{className:"_3_kx",clearable:!0,disabled:this.props.disabled,highlightOnSelect:!0,onChange:this.$5,onClear:this.$6,onSelectAttempt:this.$4,placeholder:h._("Type the name of a country, city or landmark"),queryString:this.state.query,searchSource:this.state.searchSource,selectedEntry:a,showEntriesOnFocus:!0,tallInput:!0,viewStyle:"rich",xuiError:this.$3()})};e.exports=a}),null);
__d("MediaEffectLocationTargetingGeoCoordinateTypeahead.react",["cx","FBOverlayBase.react","FBOverlayContainer.react","FBOverlayElement.react","GeoCoordinates","MediaEffectLocationStrings","React","XUICloseButton.react","XUITextInput.react"],(function(a,b,c,d,e,f,g){"use strict";var h;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){return b("React").createElement(b("FBOverlayContainer.react"),{className:"_3_kx"},b("React").createElement(b("FBOverlayBase.react"),null,b("React").createElement(b("XUITextInput.react"),{className:"_3_kx",disabled:!0,height:"tall",value:b("MediaEffectLocationStrings").geoLocation(this.props.location.latitude,this.props.location.longitude).toString()})),b("React").createElement(b("FBOverlayElement.react"),{horizontal:"right"},b("React").createElement(b("XUICloseButton.react"),{className:"_61te"+(this.props.disabled?" hidden_elem":""),onClick:this.props.onClear,size:"medium",type:"button"})))};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectLocationTargetingTypeahead.react",["GeoCoordinates","MediaEffectLocationTargetingGeoCoordinateTypeahead.react","MediaEffectLocationTargetingPageTypeahead.react","MediaEffectPlaceDescriptionRecord","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").PureComponent);g=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.$1=function(){return this.props.onLocationSelected(null)}.bind(this),b}a.prototype.render=function(){return this.props.location&&this.props.location.latitude&&this.props.location.longitude&&!this.props.location.key?b("React").createElement(b("MediaEffectLocationTargetingGeoCoordinateTypeahead.react"),{disabled:this.props.disabled,location:new(b("GeoCoordinates"))(this.props.location.latitude,this.props.location.longitude),onClear:this.$1}):b("React").createElement(b("MediaEffectLocationTargetingPageTypeahead.react"),{disabled:this.props.disabled,isLoading:this.props.isLoading,isValidating:this.props.isValidating,location:this.props.location,onLocationSelected:this.props.onLocationSelected,selectedOwner:this.props.selectedOwner})};e.exports=a}),null);
__d("MediaEffectExceptionReason",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ACTIVATION_ADD_BOOSTING_FAIL:"activation_add_boosting_fail",ACTIVATION_REMOVE_BOOSTING_FAIL:"activation_remove_boosting_fail",ACTIVATION_SERIALIZE_FAIL:"activation_serialize_fail",ACTIVATION_CREATE_FAIL:"activation_create_fail",EFFECT_STATUS_CHANGE_FAIL:"effect_status_change_fail",RENDER:"render",RESIZE_FAIL:"resize_fail",DIRECT_SUPPORT_CASE_CREATION_FAIL:"direct_support_case_creation_fail",OPEN_DETAIL_DIALOG_FAIL:"open_detail_dialog_fail",LOCATION_TARGET_TYPE_SELECTION_FAIL:"location_target_type_selection_fail",TYPEAHEAD_LOCATION_SELECTION_FAIL:"typeahead_location_selection_fail",MAP_LOCATION_SELECTION_FAIL:"map_location_selection_fail",RADIUS_SELECTION_FAIL:"radius_selection_fail",MANNUAL_GEO_SELECTION_FAIL:"manual_geo_selection_fail",NOTIFICATION_FAIL:"notification_fail",RTCS_GET_FAIL:"rtcs_get_fail",RTCS_GET_UNIQUE_FAIL:"rtcs_get_unique_fail",SCREENCAST_UPLOAD_FAIL:"screencast_upload_fail",ARFX_VALIDATE_FAIL:"arfx_validate_fail",MASK_CREATION_FAIL:"mask_creation_fail",PROJECT_PROCESS_FAIL:"project_process_fail",THUMBNAIL_FAIL:"thumbnail_fail",LASER_TIER_FAIL:"laser_tier_fail",SRT_REVIEW_PRIORITY_PREDICTOR_FAIL:"srt_review_priority_predictor_fail",MANIFEST_TRIGGER_GK_FAIL:"manifest_trigger_gk_fail"})}),null);
__d("MediaEffectExceptionSource",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({DIALOG_LOCATION_SECTION:"dialog_location_section",MEDIA_EFFECT_ACTIVATION_HELPER:"media_effect_activation_helper",SAVE_DRAFT:"save_draft",UPLOAD_FORM:"upload_form"})}),null);
__d("MediaEffectExceptionsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:MediaEffectExceptionsLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:MediaEffectExceptionsLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:MediaEffectExceptionsLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setEffectID=function(a){this.$1.effect_id=a;return this};a.prototype.setExceptionMessage=function(a){this.$1.exception_message=a;return this};a.prototype.setExceptionReason=function(a){this.$1.exception_reason=a;return this};a.prototype.setExceptionSource=function(a){this.$1.exception_source=a;return this};a.prototype.setExceptionTrace=function(a){this.$1.exception_trace=b("GeneratedLoggerUtils").serializeVector(a);return this};a.prototype.setOwnerID=function(a){this.$1.owner_id=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};c={effect_id:!0,exception_message:!0,exception_reason:!0,exception_source:!0,exception_trace:!0,owner_id:!0,vc:!0};e.exports=a}),null);
__d("MediaEffectLocationRadiusSlider.react",["cx","fbt","FBSimpleSlider.react","React","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=.05,k=100;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.$1=function(a){this.props.onChange(Math.max(j,Math.min(k,Math.pow(10,a))))}.bind(this),b}a.prototype.render=function(){var a=b("joinClasses")("_13tx",this.props.className);return b("React").createElement("div",{className:a},b("React").createElement("span",{className:"_13ty"},h._("Adjust Radius:")),b("React").createElement("span",{className:"_13uk"},b("React").createElement(b("FBSimpleSlider.react"),{disabled:this.props.disabled,max:Math.log10(k),min:Math.log10(j),onChange:this.$1,value:Math.log10(this.props.radius)})))};e.exports=a}),null);
__d("MediaEffectLocationTargetingEnabledSelector.react",["fbt","React","XUIRadioList.react","XUIText.react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("XUIRadioList.react").Item;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){return b("React").createElement(b("XUIRadioList.react"),{disabled:this.props.disabled,onValueChange:this.props.onTypeSelected,selectedValue:this.props.locationTargetType},b("React").createElement(i,{disabled:this.props.disabled,value:"everyone"},b("React").createElement(b("XUIText.react"),{display:"block"},g._("Available anywhere"))),b("React").createElement(i,{disabled:this.props.disabled,value:"targeted"},b("React").createElement(b("XUIText.react"),{display:"block",key:"title"},g._("Only available in a specific location"))))};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectPageFetcherQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"LocalArgument",name:"id",type:"ID!",defaultValue:null}],b=[{kind:"Variable",name:"id",variableName:"id",type:"ID!"}],c={kind:"LinkedField",alias:null,name:"polygons",storageKey:null,args:null,concreteType:"Polygon",plural:!0,selections:[{kind:"LinkedField",alias:null,name:"points",storageKey:null,args:null,concreteType:"Location",plural:!0,selections:[{kind:"ScalarField",alias:"lat",name:"latitude",args:null,storageKey:null},{kind:"ScalarField",alias:"lng",name:"longitude",args:null,storageKey:null}]}]},d={kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null};return{kind:"Request",operationKind:"query",name:"MediaEffectPageFetcherQuery",id:"1749336131764185",text:null,metadata:{},fragment:{kind:"Fragment",name:"MediaEffectPageFetcherQuery",type:"Query",metadata:null,argumentDefinitions:a,selections:[{kind:"LinkedField",alias:null,name:"node",storageKey:null,args:b,concreteType:null,plural:!1,selections:[{kind:"InlineFragment",type:"Page",selections:[{kind:"LinkedField",alias:null,name:"geo_polygon",storageKey:null,args:null,concreteType:"MultiPolygon",plural:!1,selections:[c]}]}]}]},operation:{kind:"Operation",name:"MediaEffectPageFetcherQuery",argumentDefinitions:a,selections:[{kind:"LinkedField",alias:null,name:"node",storageKey:null,args:b,concreteType:null,plural:!1,selections:[{kind:"ScalarField",alias:null,name:"__typename",args:null,storageKey:null},d,{kind:"InlineFragment",type:"Page",selections:[{kind:"LinkedField",alias:null,name:"geo_polygon",storageKey:null,args:null,concreteType:"MultiPolygon",plural:!1,selections:[c,d]}]}]}]}}}();e.exports=a}),null);
__d("MediaEffectPageFetcher",["Promise","GraphAPI","RelayFBEnvironment","RelayModern","idx","MediaEffectPageFetcherQuery.graphql"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("RelayModern").fetchQuery;b("RelayModern").graphql;var h=function(){return b("MediaEffectPageFetcherQuery.graphql")};a={fetchLocation:function(a){return b("Promise").all([b("GraphAPI")("2.5").object("page",a).get({fields:"name, location, place_type"}),g(b("RelayFBEnvironment"),h,{id:a})]).then(function(a){var b,c=a[0];a=(a=a[1])!=null?(a=a.node)!=null?(a=a.geo_polygon)!=null?a.polygons:a:a:a;((b=c)!=null?b.location:b)&&a&&(c.location.geo_polygon=a.map(function(a){return(a=a)!=null?a.points:a}));return c})}};e.exports=a}),null);
__d("MediaEffectMetadataLocationV2.react",["cx","fbt","GeoCoordinates","InputLabel.react","Log","MediaEffectCard.react","MediaEffectExceptionReason","MediaEffectExceptionSource","MediaEffectExceptionsTypedLogger","MediaEffectLocationRadiusSlider.react","MediaEffectLocationTargetingEnabledSelector.react","MediaEffectLocationTargetingMap.react","MediaEffectLocationTargetingTypeahead.react","MediaEffectPageFetcher","MediaEffectPlaceDescriptionRecord","React","XUICheckboxInput.react","idx","promiseDone"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=.4;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={isLoading:!1},this.$4=function(a){this.$3(b("MediaEffectExceptionReason").LOCATION_TARGET_TYPE_SELECTION_FAIL,function(){a==="everyone"&&this.props.onLocationSelected(null),this.props.onLocationTargetTypeSelected(a)}.bind(this))}.bind(this),this.$5=function(a){this.$3(b("MediaEffectExceptionReason").TYPEAHEAD_LOCATION_SELECTION_FAIL,function(){this.props.onLocationSelected(a?new(b("MediaEffectPlaceDescriptionRecord"))({key:a}):null)}.bind(this))}.bind(this),this.$6=function(a){this.$3(b("MediaEffectExceptionReason").MAP_LOCATION_SELECTION_FAIL,function(){this.props.onLocationSelected(new(b("MediaEffectPlaceDescriptionRecord"))({latitude:a.latitude,longitude:a.longitude,radius:j,manual_geo:!0}))}.bind(this))}.bind(this),this.$7=function(a){this.$3(b("MediaEffectExceptionReason").RADIUS_SELECTION_FAIL,function(){this.props.location&&this.props.onLocationSelected(this.props.location.merge({radius:a,manual_geo:!0}))}.bind(this))}.bind(this),this.$8=function(a){this.$3(b("MediaEffectExceptionReason").MANNUAL_GEO_SELECTION_FAIL,function(){this.props.location&&this.props.onLocationSelected(this.props.location.merge({manual_geo:a}))}.bind(this))}.bind(this),this.$9=function(){this.props.location&&this.props.onLocationSelected(this.props.location.merge({constrain_eligibility:!this.props.location.constrain_eligibility}))}.bind(this),c}a.prototype.componentDidMount=function(){this.$1()};a.prototype.UNSAFE_componentWillReceiveProps=function(a){var b;this.state.isLoading&&(((b=a.location)!=null?b.name:b)||!((b=a.location)!=null?b.name:b))&&this.setState({isLoading:!1})};a.prototype.componentDidUpdate=function(a,b){this.$1()};a.prototype.$1=function(){this.props.location&&this.props.location.key&&!(this.props.location.name&&this.props.location.latitude&&this.props.location.longitude)&&!this.state.isLoading&&this.$2(this.props.location.key)};a.prototype.$2=function(a){this.setState({isLoading:!0},function(){b("promiseDone")(b("MediaEffectPageFetcher").fetchLocation(a),function(a){this.props.onLocationSelected(new(b("MediaEffectPlaceDescriptionRecord"))({name:a.name,key:a.id,latitude:a.location.latitude,longitude:a.location.longitude,polygons:a.location.geo_polygon,radius:j,manual_geo:!1}))}.bind(this),function(){b("Log").info("Failed to fetch Page %s",a),this.props.onLocationSelected(null)}.bind(this))}.bind(this))};a.prototype.$3=function(a,c){try{c!==undefined&&c()}catch(c){new(b("MediaEffectExceptionsTypedLogger"))().setExceptionReason(a).setExceptionSource(b("MediaEffectExceptionSource").DIALOG_LOCATION_SECTION).setExceptionTrace(c.stack.split("\n")).setExceptionMessage(c.name+": "+c.message)}};a.prototype.render=function(){var a=this.props.location,c=h._("Choose where you want this effect to be discovered.");return b("React").createElement("div",null,b("React").createElement(b("MediaEffectCard.react"),{className:"_64q4",title:h._("Location"),tooltip:c},b("React").createElement(b("MediaEffectLocationTargetingEnabledSelector.react"),{disabled:!!this.props.disabled,locationTargetType:this.props.locationTargetType,onTypeSelected:this.$4})),this.props.locationTargetType==="targeted"?b("React").createElement("div",null,b("React").createElement(b("InputLabel.react"),{className:"_3bu1",label:h._("Allow people outside this location to try the effect if it's shared")},b("React").createElement(b("XUICheckboxInput.react"),{defaultChecked:((c=this.props.location)!=null?c.constrain_eligibility:c)===!1||this.props.location===null,disabled:this.props.disabled,onClick:this.$9})),b("React").createElement(b("MediaEffectLocationTargetingTypeahead.react"),{disabled:this.props.disabled,isLoading:this.state.isLoading,isValidating:this.props.isValidating,location:this.props.location,onLocationSelected:this.$5,selectedOwner:this.props.selectedOwner}),!this.props.disabled&&a&&a.latitude&&a.longitude&&(a.manual_geo||!a.polygons)?b("React").createElement(b("MediaEffectLocationRadiusSlider.react"),{className:"_4szz _4sz-",onChange:this.$7,radius:a.radius||j}):null,b("React").createElement(b("MediaEffectLocationTargetingMap.react"),{className:"_4szz _4sz_",disabled:this.props.disabled,isLoading:this.state.isLoading,location:this.props.location,onLocationSelected:this.$6,onManualLocationToggled:this.$8})):null)};e.exports=a}),null);
__d("XMediaEffectValidationController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/media_effect/datasource/validation/",{name:{type:"String"},description:{type:"String"}})}),null);
__d("MediaEffectMaskDescriptionInput.react",["cx","fbt","AsyncRequest","MediaEffectCard.react","MediaEffectFrameEditorDispatcher","MediaEffectMaskUploadDataStore","MediaEffectMetadataActionCreators","React","SUITextArea.react","XMediaEffectValidationController","XUIError.react","XUIText.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(a){i.constructor.call(this,a),a.description&&this.$1(a.description)}a.prototype.UNSAFE_componentWillReceiveProps=function(a){a.description&&this.$1(a.description)};a.prototype.validateDescription=function(a){var c=b("MediaEffectMaskUploadDataStore").getState().hasFrameDescriptionError;if(c)return h._("Invalid description");return this.props.isValidating&&(!a||a.length<=0)?h._("Please provide a description of your effect to continue"):null};a.prototype.$1=function(a){if(!a)return;var c=b("XMediaEffectValidationController").getURIBuilder().getURI();new(b("AsyncRequest"))(c).setData({description:a}).setMethod("POST").setReadOnly(!0).setAllowCrossPageTransition(!0).setHandler(this.$2).send()};a.prototype.$2=function(a){a=!a.payload.valid;b("MediaEffectMetadataActionCreators").updateDescriptionValidation(a)};a.prototype.getErrorMessage=function(){return this.validateDescription(this.props.description)};a.prototype.updateDescriptionText=function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"effectDescription/change",payload:{text:a}})};a.prototype.render=function(){var a=this.props.description;return b("React").createElement(b("MediaEffectCard.react"),{className:"_3vkg",title:h._("Description for review")},b("React").createElement(b("XUIText.react"),{display:"block"},h._("Describe what your effect does and all the ways people can interact with it. If the effect uses targets within plane tracking, please mention this in the description.")),b("React").createElement(b("XUIError.react"),{xuiError:this.getErrorMessage()},b("React").createElement(b("SUITextArea.react"),{maxLength:2e3,onChange:this.updateDescriptionText,placeholder:h._("Example: Open your mouth to shoot a fireball. (Max 2000 characters)"),rows:4,value:a})))};e.exports=a}),null);
__d("MediaEffectHubLearnStringsV2",["fbt"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a={headerTitle:g._("Camera Effects Platform"),headerSubtitle:g._("Create art for the Facebook camera, from the simplest frame to the most stunning augmented reality experiences.")};b={home:g._("Home"),getInspired:g._("Get Inspired"),artistCollaborations:g._("Artist Collaborations"),partnerships:g._("Partner Spotlights"),manage:g._("Manage Effects"),createframe:g._("Open Frame Studio"),uploadarstudioeffect:g._("Upload AR Studio Effect")};c={frameStudioTitle:g._("Frame Studio"),frameStudio:g._("Turn your art into frames for profile pictures or for people to express themselves with in the Facebook camera."),arStudioTitle:g._("AR Studio"),arStudio:g._("Powerful, fully customizable tools for 3D artists and developers to create masks, animations and advanced AR effects.")};d={frameStudio:{title:g._("Announcing Frame Studio"),content:g._("Get inspired, design art in your favorite program and create your frame in our web-based tool."),ctaLabel:g._("Create a Frame")},arStudio:{title:g._("Presenting AR Studio"),content:g._("Build augmented reality experiences for the Facebook camera and Live broadcasts with AR Studio, our customizable suite of creative tools for Mac."),ctaLabel:g._("Apply")}};f={learnMore:g._("Learn More"),takeTour:g._("Take a Tour"),getInspired:g._("Get Inspired")};var h=["1288692601207781","1288691624541212","1288691931207848","1288690867874621","1288691124541262","1288690514541323","1288689074541467","1288689284541446","1288686657875042"],i={title:g._("Artist Collaborations"),artists:[{name:g._("Hattie Stewart"),role:g._("Illustrator"),description:g._("Hattie Stewart is an artist and illustrator based out of London, and is best known for her \"doodlebombs\" of famous magazine covers."),link:"hattiestewart.com",videoID:"1288929091184132"},{name:g._("Peru143"),role:g._("Muralist and Graphic Artist"),description:g._("Peru Dyer Jalea, better known as Peru143, dedicates his artistic energies to enriching the traditions of graffiti and muralism."),link:"peru143.com",image:"/images/media_effect/learn/peru.png"},{name:g._("Stefanie Posavec"),role:g._("Data Designer"),description:g._("Stefanie Posavec uses data as the foundation of her art, handcrafting illustrations of our world by the numbers."),link:"stefanieposavec.co.uk",image:"/images/media_effect/learn/stefanie.png"},{name:g._("Doug Coupland"),role:g._("Artist and Novelist"),description:g._("Doug Coupland's work explores the intersection of the individual and pop culture."),link:"coupland.com",videoID:"1289609561116085"}]},j={title:g._("Studio Effects"),effects:[{name:g._("Star Wars: The Last Jedi"),description:g._("Don your hood and brandish your lightsaber as a Sith or as a Jedi with this effect by Disney."),link:"part4.com",videoID:"10155270733098553"},{name:g._("Stranger Things 2"),description:g._("Be careful who follows you from the Upside Down with this effect by Netflix."),link:"themill.com",videoID:"10155270732088553"},{name:g._("Game of Thrones"),description:g._("Transform yourself into the Night King with this effect by HBO."),link:"themill.com",videoID:"10155270733938553"}]},k={title:g._("Get Involved"),description:g._("Join our community of artists, makers and developers who are already using AR Studio.")},l={getARStudio:g._("Get AR Studio"),createFrame:g._("Create a Frame")},m={title:g._("THE MAKING OF"),videos:[g._("Camera Effects x Peru143"),g._("Camera Effects x Doug Coupland")]};g={title:g._("Partner Spotlights"),partners:[{name:g._("Nike Run Club"),description:g._("Share your post-run selfie with details about your route, speed and more with this effect by Nike Run Club."),links:["nike.com"],videoID:"1288717357871972"},{name:g._("Manchester United and Real Madrid"),description:g._("Show off your team pride with this effect featuring Manchester United and Real Madrid."),links:["manutd.com","realmadrid.com"],videoID:"1289186401158401"},{name:g._("Mass Effect: Andromeda from Electronic Arts and Bioware"),description:g._("Step behind the helmet and share stats from your latest multiplayer session in Mass Effect: Andromeda."),videoID:"1288717087871999",links:["masseffect.com"]},{name:g._("TripIt"),description:g._("Share the status of your trip\u2014including when your flight's been delayed\u2014with friends and family with TripIt's camera effect."),videoID:"1288717544538620",links:["tripit.com"]},{name:g._("Justice League by Warner Brothers"),description:g._("Unite the League with five of your friends. Don the masks of Batman, Wonder Woman, Aquaman, the Flash, and Cyborg."),videoID:"1290061404404234",links:["justiceleaguethemovie.com"]},{name:g._("GIPHY Live"),description:g._("Engage your audiences during Facebook Live broadcasts by letting them vote with hashtags to unlock GIFs."),videoID:"1288715884538786",links:["giphy.com"]},{name:g._("GIPHY Thoughts"),description:g._("Find the perfect GIF for what's on your mind with GIPHY Thoughts. Shake your head to cycle through GIF\u2014you never know what'll come to mind."),videoID:"1288782587865449",links:["giphy.com"]}]};var n={frameStudio:"10154603114008553",arStudio:"10154612033343553"};e.exports={Hero:a,Navigation:b,StudioBlurb:c,StudioDetail:d,Common:f,ArtistCollaborations:i,MakingOfVideos:m,PartnerSpotlights:g,InspiredAssets:h,HeroVideo:n,StudioEffects:j,GetInvolved:k,CTA:l}}),null);
__d("XDeveloperPlatformPolicyController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/policy/{?path1}/",{path1:{type:"String"},locale:{type:"String"}})}),null);
__d("XMediaEffectARStudioDownloadController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/arstudio/download/",{})}),null);
__d("MediaEffectHubARStudioDialog.react",["cx","fbt","DialogExpansion","Image.react","LayerFadeOnHide","MediaEffectHubLearnStringsV2","React","SUILink.react","URI","XDeveloperPlatformPolicyController","XMediaEffectARStudioDownloadController","XUIDialog.react","XUIDialogBody.react","XUIDialogButton.react","XUIDialogFooter.react","XUIDialogTitle.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.getDialogHeader=function(){var a=new(b("URI"))("/images/media_effect/learn/AR-Studio-Screenshots.png").setSubdomain("www").toString();return b("React").createElement(b("Image.react"),{className:"_3j67",height:160,src:a,width:200})};a.prototype.getContent=function(){return b("React").createElement("div",{className:"_3j6e"},b("React").createElement("div",{className:"_3j6f"},h._("Download AR Studio")),b("React").createElement("div",{className:"_3j6l"},b("MediaEffectHubLearnStringsV2").StudioBlurb.arStudio))};a.prototype.getLeftFooterContent=function(){var a=b("XDeveloperPlatformPolicyController").getURIBuilder().getURI().setSubdomain("developers"),c=new(b("URI"))("/legal/ar_studio_terms").setSubdomain("www").toString();return b("React").createElement("div",{className:"_66kj"},h._("By clicking \"Download\" you agree to the {link to platform policy} and the AR Studio {link to AR Studio Terms}",[h._param("link to platform policy",b("React").createElement(b("SUILink.react"),{href:a,target:"_blank"},h._("Facebook Platform Policy"))),h._param("link to AR Studio Terms",b("React").createElement(b("SUILink.react"),{href:c,target:"_blank"},h._("Terms")))]))};a.prototype.getDownloadButton=function(){var a=b("XMediaEffectARStudioDownloadController").getURIBuilder().getURI().setSubdomain("www");return b("React").createElement(b("XUIDialogButton.react"),{href:a,label:h._("Download"),onClick:this.props.onClose,size:"large",target:"_blank",use:"confirm"})};a.prototype.render=function(){var a=this.props,c=a.isStrictlyControlled;a=a.onClose;return b("React").createElement(b("XUIDialog.react"),{behaviors:{DialogExpansion:b("DialogExpansion"),LayerFadeOnHide:b("LayerFadeOnHide"),LayerFadeOnShow:null},className:"_66kk",isStrictlyControlled:c,label:h._("Download AR Studio"),onHide:a,shown:!0,width:520},b("React").createElement(b("XUIDialogTitle.react"),{className:"_66kl"},this.getDialogHeader()),b("React").createElement(b("XUIDialogBody.react"),{className:"_66km",fontSize:"inherit",useCustomPadding:!0},this.getContent()),b("React").createElement(b("XUIDialogFooter.react"),{leftContent:this.getLeftFooterContent()},this.getDownloadButton()))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectMaskLegalAgreement.react",["cx","fbt","InputLabel_DEPRECATED.react","MediaEffectCard.react","MediaEffectFrameEditorDispatcher","React","XUICheckboxInput.react","XUIError.react","XUIText.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.onCheckboxChanged=function(event){b("MediaEffectFrameEditorDispatcher").dispatch({type:"legalAgreement/userIsAgreed",payload:{userIsAgreed:event.target.checked}})};a.prototype.getErrorMessage=function(){var a=this.props,b=a.isValidating;a=a.userIsAgreed;return!b||a?null:h._("Please accept the agreement to continue")};a.prototype.render=function(){var a=this.props.effectUploadLegalText,c=this.getErrorMessage();return b("React").createElement(b("MediaEffectCard.react"),{className:"_3vkg",title:h._("Legal Agreement")},b("React").createElement(b("XUIError.react"),{xuiError:c},b("React").createElement(b("InputLabel_DEPRECATED.react"),null,b("React").createElement(b("XUICheckboxInput.react"),{checked:this.props.userIsAgreed,onChange:this.onCheckboxChanged}),b("React").createElement(b("XUIText.react"),null,a))))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectMaskMegaphone.react",["cx","BUIAdoptionCloseButton.react","Image.react","React","SUIBusinessTheme","SUIText.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){var a=b("React").createElement(b("BUIAdoptionCloseButton.react"),{className_DEPRECATED:"_eyf",onClick:this.props.onClose,shade:"dark",style:{position:"absolute"}}),c=b("React").createElement(b("SUIText.react"),{className:"_2pim",display:"block",size:"medium_DEPRECATED",theme:b("SUIBusinessTheme"),weight:"bold"},this.props.title),d=this.props.imageSrc?b("React").createElement("div",{className:"_eyg"+(this.props.imageAlign==="center"?" _eyi":""),style:{backgroundColor:this.props.imageBackgroundColor}},b("React").createElement(b("Image.react"),{className:"_eyj",src:this.props.imageSrc})):null;d=b("React").createElement("div",{className:"_eyl"+(this.props.containerAlign==="center"?" _eym":"")},d,b("React").createElement("div",{className:"_eyn"},c,this.props.children),b("React").createElement("div",{className:"_eyo"},this.props.button));return b("React").createElement("div",{className:"_eyp"},d,a)};function a(){h.apply(this,arguments)}a.defaultProps={containerAlign:"center",imageAlign:"center"};e.exports=a}),null);
__d("MediaEffectMaskVersionWarning.react",["cx","fbt","Link.react","MediaEffectWarnings.react","React","XDeveloperDocumentationController","XUIText.react","formatDate"],(function(a,b,c,d,e,f,g,h){"use strict";a=function(a){var c=a.isOutOfDate,d=a.minVersion,e=a.currentVersion,f=a.latestVersion;a=a.discontinuationDate;if(!a||!e||!d||!f)return null;var g=b("XDeveloperDocumentationController").getURIBuilder().setString("path1","camera-effects").setString("path2","key-concepts").setString("path3","versioning").getURI().setSubdomain("developers");return c?b("React").createElement(b("MediaEffectWarnings.react"),{message:b("React").createElement(b("XUIText.react"),null,h._("This effect was created with AR Studio {arfx-version}. The minimum supported version is {ar-studio-min-version}. Please update AR Studio to the latest version {ar-studio-latest-version} before saving and resubmitting your effect.",[h._param("arfx-version"," "+e),h._param("ar-studio-min-version"," "+d),h._param("ar-studio-latest-version"," "+f+" ")]),b("React").createElement(b("Link.react"),{className:"_466q",href:g},h._("Learn more"))),use:"warn"}):b("React").createElement(b("MediaEffectWarnings.react"),{message:b("React").createElement(b("XUIText.react"),null,h._("This effect was created with AR Studio {arfx-version}. This version of AR Studio will be discontinued on {arfx-discontinuation-date}. Please update AR Studio to the latest version {ar-studio-latest-version} and resubmit your effect to ensure it will still appear in the camera.",[h._param("arfx-version"," "+e),h._param("arfx-discontinuation-date"," "+b("formatDate")(new Date(a),"F jS, Y")),h._param("ar-studio-latest-version"," "+f+" ")]),b("React").createElement(b("Link.react"),{className:"_466q",href:g},h._("Learn more"))),use:"recommend"})};e.exports=a}),null);
__d("MediaEffectMaskVersionNotice.react",["FluxContainer","MediaEffectMaskUploadDataStore","MediaEffectMaskVersionWarning.react","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MediaEffectMaskUploadDataStore")]};a.calculateState=function(){return{isOutOfDate:b("MediaEffectMaskUploadDataStore").isVersionOutOfDate(),latestVersion:b("MediaEffectMaskUploadDataStore").getLatestARStudioVersion(),minVersion:b("MediaEffectMaskUploadDataStore").getMinARStudioVersion(),topVersion:b("MediaEffectMaskUploadDataStore").getArfxTopVersion(),discontinuationDate:b("MediaEffectMaskUploadDataStore").getDiscontinuationDate()}};a.prototype.render=function(){var a=this.state,c=a.isOutOfDate,d=a.latestVersion,e=a.minVersion,f=a.topVersion;a=a.discontinuationDate;return b("React").createElement(b("MediaEffectMaskVersionWarning.react"),{currentVersion:f,discontinuationDate:a,isOutOfDate:c,latestVersion:d,minVersion:e})};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a)}),null);
__d("MediaEffectMaskArfxFileSelect.react",["fbt","AsyncUploadRequest","Image.react","MediaEffectFrameEditorDispatcher","MediaEffectMaskFileSelect.react","React","XMediaEffectARFXValidateController"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){__p&&__p();var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={isCheckingVersion:!1,isFileTypeValid:!0,isVersionValid:!0,isFileSizeValid:!0,canUploadVersion:"",showFileSizeWarning:!1,version:""},this.updateArfxFile=function(event){var a=event.target.files;if(a.length===0)return;var b=a[0];this.setState({isFileTypeValid:this.isFileTypeValid(b)},function(){if(!this.state.isFileTypeValid)return;this.validateVersion(b)}.bind(this))}.bind(this),b}a.prototype.isFileTypeValid=function(a){return a?a.name.endsWith(this.props.arfxFileType):!1};a.prototype.validateVersion=function(a){__p&&__p();var c=b("XMediaEffectARFXValidateController").getURIBuilder().getURI();c=new(b("AsyncUploadRequest"))(c).setAllowCrossOrigin(!1).setFiles({arfx:[a]});var d=this,e=[c.subscribe("success",function(c,e){c=e.getResponse().payload;d.setState({isVersionValid:c.isVersionValid,isFileSizeValid:c.isFileSizeValid,isCheckingVersion:!1,canUploadVersion:c.canUploadVersion,version:c.version,showFileSizeWarning:c.showFileSizeWarning},function(){if(!d.state.isVersionValid||!d.state.isFileSizeValid)return;b("MediaEffectFrameEditorDispatcher").dispatch({type:"arfxFile/selected",payload:{file:a,type:d.props.arfxFileType}})})}),c.subscribe("complete",function(a,b){while(e.length)e.pop().unsubscribe()})];d.setState({isCheckingVersion:!0});c.send()};a.prototype.getErrorMessage=function(){var a=this.state,b=a.isFileTypeValid,c=a.isVersionValid,d=a.isFileSizeValid,e=a.canUploadVersion,f=a.version;a.showFileSizeWarning;if(!b||this.props.isValidating&&(!this.props.arfxFile||this.props.missingFileForUpload))return g._("Please choose a file of type: {arfx file type}",[g._param("arfx file type",this.props.arfxFileType)]);if(!c)return g._("This ARFX file is created with AR Studio {current}. Only version {canUpload} and above can be uploaded. Please download and use new AR studio to update.",[g._param("current"," "+f),g._param("canUpload"," "+e+" ")]);return!d?g._("Upload a file that's smaller than 10MB."):null};a.prototype.render=function(){var a=this.props,c=a.arfxFile,d=a.arfxFileType;a=a.disabled;var e=this.state.isCheckingVersion;return b("React").createElement(b("MediaEffectMaskFileSelect.react"),{accept:".arfx",disabled:a,error:this.getErrorMessage(),expectFiles:1,files:c?[c]:[],multiple:!0,name:"mask_files",onChange:this.updateArfxFile,preview:b("React").createElement(b("Image.react"),{height:36,src:e?"/images/tablet/spinner/spinner-large-bgLight.gif":"/images/media_effect/icon/arfx-icon.png",width:36}),text:g._("Upload {arfx file type} File",[g._param("arfx file type",d)])})};e.exports=a}),null);
__d("MediaEffectMaskArfxFileUpload.react",["cx","fbt","immutable","MediaEffectARStudioEffectArfxFileTypes","MediaEffectCard.react","MediaEffectMaskArfxFileSelect.react","React","XUIText.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;b("immutable").Set;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(a){i.constructor.call(this,a)}a.prototype.render=function(){__p&&__p();var a=this.props,c=a.arfxFiles,d=a.disabled,e=a.isValidating,f=a.filesForUpload;a=a.popup;var g=b("React").createElement(b("XUIText.react"),{display:"block"},h._("Upload the \u0040uncompressed.arfx, \u0040pvr.arfx and \u0040etc.arfx files created when exporting your project in {ar studio link}.",[h._param("ar studio link",b("React").createElement("a",{href:"https://developers.facebook.com/products/camera-effects/ar-studio/",target:"_blank"},h._("AR Studio")))]));a&&(g=b("React").createElement(b("XUIText.react"),{display:"block"},h._("This file format also requires the additional files created when the effect was exported.")));var i=b("MediaEffectARStudioEffectArfxFileTypes");a&&(i=i.sort(function(a,b){return a.localeCompare(b)}));return b("React").createElement(b("MediaEffectCard.react"),{className:"_3vkg",hideHeader:a,title:h._("ARFX Files"),tooltip:h._("Upload all three ARFX files exported from your AR Studio project: \u0040uncompressed.arfx, \u0040pvr.afx and \u0040etc.arfx")},g,i.map(function(a){return b("React").createElement(b("MediaEffectMaskArfxFileSelect.react"),{arfxFile:c.find(function(b){return b.name?b.name.endsWith(a):!1}),arfxFileType:a,disabled:d,isValidating:e,key:a,missingFileForUpload:!f.isEmpty()&&!f.some(function(b){return b.name?b.name.endsWith(a):!1})})}))};e.exports=a}),null);
__d("MediaEffectMultiFileUploadForm.react",["immutable","MediaEffectMaskArfxFileUpload.react","MediaEffectMaskProjectFileUpload.react","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;b("immutable").Set;c=babelHelpers.inherits(a,b("React").PureComponent);g=c&&c.prototype;function a(a){g.constructor.call(this,a)}a.prototype.render=function(){var a=this.props,c=a.arfxFilesForUpload,d=a.disabled,e=a.isValidating,f=a.maskFiles;a=a.projectFile;return b("React").createElement("div",null,b("React").createElement(b("MediaEffectMaskProjectFileUpload.react"),{disabled:d,isValidating:e,projectFile:a}),b("React").createElement(b("MediaEffectMaskArfxFileUpload.react"),{arfxFiles:f,disabled:d,filesForUpload:c,isValidating:e}))};e.exports=a}),null);
__d("MediaEffectSwitchableUploadForm.react",["immutable","MediaEffectMaskArfxFileUpload.react","MediaEffectMaskProjectFileUpload.react","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;b("immutable").Set;c=babelHelpers.inherits(a,b("React").PureComponent);g=c&&c.prototype;function a(a){g.constructor.call(this,a)}a.prototype.render=function(){var a=this.props,c=a.arfxFilesForUpload,d=a.disabled,e=a.isValidating,f=a.maskFiles;a=a.projectFile;var g=null;a&&a.name&&!a.name.endsWith(".arexport")&&(g=b("React").createElement(b("MediaEffectMaskArfxFileUpload.react"),{arfxFiles:f,disabled:d,filesForUpload:c,isValidating:e,key:"mask_files",popup:!0}));return[b("React").createElement(b("MediaEffectMaskProjectFileUpload.react"),{disabled:d,isValidating:e,key:"project_file",projectFile:a}),g]};e.exports=a}),null);
__d("MediaEffectMaskFileUploadStep.react",["cx","fbt","ix","FluxContainer","immutable","MediaEffectFlowType","MediaEffectFrameCreateDialogDataStore","MediaEffectFrameCreationStepsConfig","MediaEffectFrameEditorDispatcher","MediaEffectHubARStudioDialog.react","MediaEffectMaskDescriptionInput.react","MediaEffectMaskLegalAgreement.react","MediaEffectMaskMegaphone.react","MediaEffectMaskScreencastUpload.react","MediaEffectMaskThumbnailUpload.react","MediaEffectMaskUploadDataStore","MediaEffectMaskVersionNotice.react","MediaEffectMetadataStore","MediaEffectMultiFileUploadForm.react","MediaEffectRejectedReviewResult.react","MediaEffectSwitchableUploadForm.react","React","SimpleNUXMessage","SimpleNUXMessageTypes","SUIBusinessTheme","SUICardDEPRECATED.react","SUIText.react","XUIButton.react","XUIText.react","mediaEffectGKCheck"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("immutable").Set;c=babelHelpers.inherits(a,b("React").PureComponent);j=c&&c.prototype;a.getStores=function(){return[b("MediaEffectFrameCreateDialogDataStore"),b("MediaEffectMaskUploadDataStore"),b("MediaEffectMetadataStore")]};a.calculateState=function(a){a=b("MediaEffectMaskUploadDataStore").getState();var c=b("MediaEffectMetadataStore").getState(),d=b("MediaEffectFrameCreateDialogDataStore").getState();d=b("MediaEffectFrameCreationStepsConfig").getStep(b("MediaEffectFlowType").MASK,d.get("validatingStep"));d=d!==b("MediaEffectFrameCreationStepsConfig").CreationSteps.NONE;return{arfxFilesForUpload:a.arfxFilesForUpload,cameraIconDimensions:a.get("effectThumbnailDimensions"),cameraIconFile:a.get("effectThumbnailFile"),cameraIconSrc:a.get("effectThumbnailSrc"),cameraIconIsAutogenerated:a.get("effectThumbnailIsAutogenerated"),description:a.get("effectDescription"),isValidating:d,maskFiles:a.get("arfxFiles"),projectFile:a.get("projectFile"),rejectReasons:c.get("rejectReasons"),reviewMaterialID:a.get("reviewMaterialID"),screencastFile:a.get("screencastFile"),screencastSrc:a.get("screencastSrc"),showARStudioDialog:!1,showDownloadBanner:!b("SimpleNUXMessage").hasUserSeenMessage(b("SimpleNUXMessageTypes").AR_STUDIO_DOWNLOAD_BANNER_NUX),userIsAgreed:a.get("userIsAgreed")}};function a(a,c){j.constructor.call(this,a,c),this.state={arfxFilesForUpload:k(),cameraIconDimensions:null,cameraIconFile:null,cameraIconSrc:null,cameraIconIsAutogenerated:!1,description:null,isValidating:!1,maskFiles:k(),projectFile:null,rejectReasons:null,reviewMaterialID:null,screencastFile:null,screencastSrc:null,showARStudioDialog:!1,showDownloadBanner:!1,userIsAgreed:!1},this.$1=function(){b("SimpleNUXMessage").markMessageSeenByUser(b("SimpleNUXMessageTypes").AR_STUDIO_DOWNLOAD_BANNER_NUX),this.setState({showDownloadBanner:!1})}.bind(this),this.$2=function(){this.setState({showARStudioDialog:!0})}.bind(this),this.$3=function(){this.setState({showARStudioDialog:!1})}.bind(this),b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores([b("MediaEffectFrameCreateDialogDataStore"),b("MediaEffectMaskUploadDataStore"),b("MediaEffectMetadataStore")]),a.hasUsedARStudio&&!b("SimpleNUXMessage").hasUserSeenMessage(b("SimpleNUXMessageTypes").AR_STUDIO_DOWNLOAD_BANNER_NUX)&&b("SimpleNUXMessage").markMessageSeenByUser(b("SimpleNUXMessageTypes").AR_STUDIO_DOWNLOAD_BANNER_NUX)}a.prototype.$4=function(){return b("React").createElement("div",{className:"_3-95"},b("React").createElement(b("MediaEffectMaskVersionNotice.react"),null))};a.prototype.$5=function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"uploadMethod/change",payload:{uploadMethod:a}})};a.prototype.render=function(){var a=this.props.effectUploadLegalText,c=this.state,d=c.arfxFilesForUpload,e=c.cameraIconDimensions,f=c.cameraIconFile,g=c.cameraIconSrc,j=c.cameraIconIsAutogenerated,k=c.description,l=c.isValidating,m=c.maskFiles,n=c.projectFile,o=c.rejectReasons,p=c.reviewMaterialID,q=c.screencastFile,r=c.screencastSrc,s=c.showARStudioDialog,t=c.showDownloadBanner;c=c.userIsAgreed;s=s?b("React").createElement(b("MediaEffectHubARStudioDialog.react"),{isStrictlyControlled:!0,onClose:this.$3}):null;t=t?b("React").createElement(b("MediaEffectMaskMegaphone.react"),{button:b("React").createElement(b("XUIButton.react"),{label:"Download AR Studio",onClick:this.$2,size:"large",use:"confirm"}),imageAlign:"center",imageSrc:i("362460"),onClose:this.$1,title:h._("Download AR Studio to Get Started")},b("React").createElement(b("SUIText.react"),{color:"secondary",display:"block",size:"meta1",theme:b("SUIBusinessTheme")},h._("This page is for uploading camera effects created in AR Studio, but it doesn't look like you have the app yet. Documentation for effect creators is available to help you get started. {ar studio link}.",[h._param("ar studio link",b("React").createElement("a",{href:"https://developers.facebook.com/products/camera-effects/ar-studio/",target:"_blank"},h._("Learn More")))]))):null;var u=void 0;b("mediaEffectGKCheck")("media_effects_upload_form_arexport")?u=b("React").createElement(b("MediaEffectSwitchableUploadForm.react"),{arfxFilesForUpload:d,disabled:!1,isValidating:l,maskFiles:m,onChangeUploadMethod:this.$5,projectFile:n}):u=b("React").createElement(b("MediaEffectMultiFileUploadForm.react"),{arfxFilesForUpload:d,disabled:!1,isValidating:l,maskFiles:m,projectFile:n});return b("React").createElement("div",{className:"_2041 _190n",style:{padding:"32px 80px"}},s,t,b("React").createElement(b("XUIText.react"),{className:"_3os1",display:"block"},h._("Upload effect")),o&&o.length>0?b("React").createElement(b("MediaEffectRejectedReviewResult.react"),{reasons:o}):null,this.$4(),b("React").createElement(b("SUICardDEPRECATED.react"),{className:"_2pin _3-98",theme:b("SUIBusinessTheme"),type:"padded"},b("React").createElement(b("MediaEffectMaskThumbnailUpload.react"),{cameraIconDimensions:e,cameraIconFile:j?null:f,cameraIconSrc:j?null:g,isValidating:l}),u,b("React").createElement(b("MediaEffectMaskLegalAgreement.react"),{effectUploadLegalText:a,isValidating:l,userIsAgreed:c})),b("React").createElement(b("XUIText.react"),{className:"_3os1",display:"block"},h._("Review Information")),b("React").createElement(b("SUICardDEPRECATED.react"),{className:"_2pin _3-98",theme:b("SUIBusinessTheme"),type:"padded"},b("React").createElement(b("MediaEffectMaskDescriptionInput.react"),{description:k,isValidating:l}),b("React").createElement(b("MediaEffectMaskScreencastUpload.react"),{isValidating:l,reviewMaterialID:p,screencastFile:q,screencastSrc:r})))};e.exports=b("FluxContainer").create(a)}),null);
__d("MediaEffectHubDispatcher",["ExplicitRegistrationReactDispatcher"],(function(a,b,c,d,e,f){var g;c=babelHelpers.inherits(a,b("ExplicitRegistrationReactDispatcher"));g=c&&c.prototype;function a(a){"use strict";g.constructor.call(this,a),this.dispatch=this.dispatch.bind(this)}e.exports=new a({strict:!0})}),null);
__d("XMediaEffectHubEffectActivationAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/effects/async/activation/",{activate:{type:"Bool",defaultValue:!1},effect_ids:{type:"FBIDVector",required:!0}})}),null);
__d("XMediaEffectHubEffectBoostedWeightAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/effects/async/boosted_weight/",{weight:{type:"String",required:!0},effect_id:{type:"String",required:!0}})}),null);
__d("MediaEffectMetadataDataLoader",["Promise","AsyncRequest","XMediaEffectHubEffectActivationAsyncController","XMediaEffectHubEffectBoostedWeightAsyncController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={changeActiveStatus:function(a,c){return new(b("Promise"))(function(d,e){var f=b("XMediaEffectHubEffectActivationAsyncController").getURIBuilder().setBool("activate",a).setFBIDVector("effect_ids",c.toSeq().map(function(a){return a.id}).toArray()).getURI();new(b("AsyncRequest"))().setURI(f).setHandler(d).setErrorHandler(e).send()})},changeBoostedWeight:function(a,c){return new(b("Promise"))(function(d,e){var f=b("XMediaEffectHubEffectBoostedWeightAsyncController").getURIBuilder().setString("weight",a).setString("effect_id",c.id).getURI();new(b("AsyncRequest"))().setURI(f).setHandler(d).setErrorHandler(e).send()})}};e.exports=a}),null);
__d("MediaEffectUploadManager",["Arbiter"],(function(a,b,c,d,e,f){"use strict";var g="MediaEffectUploadManager/upload";a={subscribeToUploadDone:function(a,c){return b("Arbiter").subscribe(g,a,c)},informUploadDone:function(a,c){return b("Arbiter").inform(g,a,c)}};e.exports=a}),null);
__d("XMediaEffectAsyncEditController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/effects/activation/submit/",{media_effect_id:{type:"FBID"}})}),null);
__d("XProcessImageBackgroundController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/media_effect/swipeable_frame/image/process_background/",{image_id:{type:"FBID",required:!0}})}),null);
__d("XRemoveImageBackgroundController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/media_effect/swipeable_frame/image/remove_background/",{image_id:{type:"FBID",required:!0}})}),null);
__d("MediaEffectMetadataActionCreators",["cx","invariant","regeneratorRuntime","Animation","AsyncRequest","AsyncResponse","AsyncUploadRequest","immutable","MediaEffectFlowType","MediaEffectFrameEditorDispatcher","MediaEffectHubDispatcher","MediaEffectMetadataDataLoader","MediaEffectReactFrameEditorAssetPositionRecord","MediaEffectRequestBuilder","MediaEffectTemplateVariationRecord","MediaEffectUploadManager","SimpleXUIDialog","Style","XMediaEffectAsyncEditController","XProcessImageBackgroundController","XRemoveImageBackgroundController","nullthrows","promiseDone"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("immutable").Set,j="_1tp7",k={addImage:function(a,c,d){a={type:"add/image",imageFile:a,position:c&&d?new(b("MediaEffectReactFrameEditorAssetPositionRecord").fromCenter)(c,d):null};b("MediaEffectFrameEditorDispatcher").dispatch(a)},replaceImage:function(a,c){b("MediaEffectFrameEditorDispatcher").dispatch({type:"replace/image",localAssetID:a,imageFile:c})},addTag:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"add/tag",data:a})},addText:function(a,c,d){a={type:"add/text",content:a,position:null};c&&d&&(a.position=new(b("MediaEffectReactFrameEditorAssetPositionRecord").fromCenter)(c,d));b("MediaEffectFrameEditorDispatcher").dispatch(a)},addWhitelistedUser:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"add/fbWhitelistedUser",data:a})},changeScheduleRange:function(a,c,d){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/scheduleRange",startTime:a,endTime:c,timezone:d})},changeBackgroundColor:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/backgroundColor",color:a})},changeBackgroundImage:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/backgroundImage",image:a})},changeCategory:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/category",value:a})},changePageLiked:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/fbPageLiked",value:a})},changeCatalogGKs:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/fbCatalogGKs",value:a})},changeEligibilityGKs:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/fbEligibilityGKs",value:a})},changeManualRankWeight:function(event){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/fbRankWeight",value:event.target.value})},changeLocales:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/locales",value:a})},changeLocationPage:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/locationPageID",value:a})},changeLocation:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/location",value:a})},changeLocationTarget:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/locationTarget",value:a})},changeName:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/name",value:a})},changeOwner:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/selectedOwnerID",value:a})},changeInstagramAttribution:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/selectedInstagramAttributionID",value:a})},setUseOwnerSelector:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/setUseOwnerSelector",value:a})},resetLocation:function(){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/locationTarget",value:"everyone"})},updateNameValidation:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/nameValidation",isError:a})},updateDescriptionValidation:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/descriptionValidation",isInvalid:a})},changeProductVisibiilityPolicy:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/productVisibilityPolicy",value:a})},changeRankingStrategy:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/fbRankingStrategy",value:a})},changeTimingSchedule:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/timingSchedule",value:a})},changeWhitelistCheckEligibility:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/fbWhitelistCheckEligibility",value:a})},removeBackground:function(a,c){b("MediaEffectFrameEditorDispatcher").dispatch({type:"replace/startRemovingBackground",localAssetID:a});c=b("XRemoveImageBackgroundController").getURIBuilder().setFBID("image_id",c).getURI();new(b("AsyncRequest"))().setURI(c).setHandler(function(c){return c.payload.updated_id&&b("MediaEffectFrameEditorDispatcher").dispatch({type:"replace/imageBackground",localAssetID:a,imageID:c.payload.updated_id,imageURI:c.payload.updated_uri})}).send()},processBackground:function(a,c){c=b("XProcessImageBackgroundController").getURIBuilder().setFBID("image_id",c).getURI();new(b("AsyncRequest"))().setURI(c).setHandler(function(c){return c.payload.updated_uri&&b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/image",localAssetID:a,imageURI:c.payload.updated_uri})}).send()},updateTextImage:function(a,c,d,e,f){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/textImage",localAssetID:a,textContent:c,localImageURI:d,file:e,assetSize:f})},checkOfflineOnly:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/offlineOnly",value:a})},changeAdsTargetingSpec:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/adsTargetingSpec",adsTargetingSpec:a})},checkSelfBirthday:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/selfBirthday",value:a})},removeWhitelistedUser:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"remove/fbWhitelistedUser",data:a})},removeTag:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"remove/tag",data:a})},updateAssetPosition:function(a,c){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/assetPosition",localAssetID:a,position:c})},setAutoSnapping:function(a,c,d){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/autoSnapping",localAssetID:a,autoSnappedType:c,specs:d})},setIsDragging:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"set/isDragging",isDragging:a})},setIsSaving:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"set/isSaving",isSaving:a})},updateAssetSize:function(a,c){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/assetSize",localAssetID:a,size:c})},updateAssetNativeSize:function(a,c){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/assetNativeSize",localAssetID:a,size:c})},updateStickerFBID:function(a,c,d){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/stickerFBID",localAssetID:a,stickerFBID:c,localTemplateID:d})},updateTextContent:function(a,c){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/textContent",localAssetID:a,content:c})},updateTextFonts:function(a,c){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/textFonts",localTextIDs:a,font:c})},updateTextColors:function(a,c){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/textColors",localTextIDs:a,color:c})},updateTextAlignments:function(a,c){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/textAlignments",localTextIDs:a,textAlignment:c})},setFrameFilterID:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/frameFilterID",filterID:a})},setThumbnail:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/thumbnail",thumbnail:a})},save:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"save",effectID:a})},saveAsDraft:function(){b("MediaEffectFrameEditorDispatcher").dispatch({type:"save/draft"})},selectAssetOnly:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"select/assetOnly",localAssetID:a})},selectAsset:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"select/asset",localAssetID:a})},deselectAsset:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"deselect/asset",localAssetID:a})},editText:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"edit/text",localAssetID:a})},selectAll:function(){b("MediaEffectFrameEditorDispatcher").dispatch({type:"select/all"})},deselectAll:function(){b("MediaEffectFrameEditorDispatcher").dispatch({type:"deselect/all"})},startCamera:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"set/cameraSource",cameraSource:a})},pauseCamera:function(){b("MediaEffectFrameEditorDispatcher").dispatch({type:"pause/camera"})},resumeCamera:function(){b("MediaEffectFrameEditorDispatcher").dispatch({type:"resume/camera"})},stopCamera:function(){b("MediaEffectFrameEditorDispatcher").dispatch({type:"set/cameraSource",cameraSource:null})},selectInstruction:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"select/instruction",instructionID:a})},raiseAsset:function(a){var c=arguments.length<=1||arguments[1]===undefined?!1:arguments[1];b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/asset/raise",localAssetID:a,toTop:c})},lowerAsset:function(a){var c=arguments.length<=1||arguments[1]===undefined?!1:arguments[1];b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/asset/lower",localAssetID:a,toBottom:c})},deleteAsset:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"delete/asset",localAssetID:a})},duplicateAsset:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"duplicate/asset",localAssetID:a})},initEffectMetadata:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"init/effectMetadata",data:a})},addValidation:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"validation/add",validation:a})},removeValidation:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"validation/remove",validation:a})},initFrameData:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"init/frameData",data:a})},initMaskUploadData:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"init/maskUploadData",data:a})},changeStep:function(a){a>=0&&b("MediaEffectFrameEditorDispatcher").dispatch({type:"change/step",step:a})},validate:function(a){a>=0&&(b("MediaEffectFrameEditorDispatcher").dispatch({type:"form/validate",step:a}),k.scrollToFirstError())},scrollToFirstError:function(){window.setTimeout(function(){var a=document.getElementsByClassName(j);if(a.length>0){var c=a[0].offsetTop-40;a=b("Style").getScrollParent(a[0]);new(b("Animation"))(a).to("scrollTop",c).duration(750).go()}},750)},initDialog:function(a,c,d,e){__p&&__p();b("MediaEffectFrameEditorDispatcher").dispatch({type:"init/dialog",creationReferrer:a,flowType:c,sourceID:e});switch(c){case b("MediaEffectFlowType").EVENT:if(e&&d){k.changeOwner(b("nullthrows")(e));a=d.ownersData.find(function(a){return a.id===e});a||h(0);this.changeName(a.name)}break;default:break}},addFontData:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"add/fontData",data:a})},addTemplateData:function(a,c){b("MediaEffectFrameEditorDispatcher").dispatch({type:"add/templateData",data:a,variants:c})},applyTemplate:function(a){k._genApplyTemplate(a)["catch"](function(a){})},_genApplyTemplate:function(a){__p&&__p();var c,d;return b("regeneratorRuntime").async(function(e){__p&&__p();while(1)switch(e.prev=e.next){case 0:c=this;if(a){e.next=5;break}b("MediaEffectFrameEditorDispatcher").dispatch({type:"clear/template"});e.next=16;break;case 5:c.deselectAll();e.prev=6;e.next=9;return b("regeneratorRuntime").awrap(a.genFrameData());case 9:d=e.sent;b("MediaEffectFrameEditorDispatcher").dispatch({type:"apply/template",templateFBID:a.templateFBID,frameData:d});e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](6),b("SimpleXUIDialog").showConfirm(e.t0.message,"Template loading failed. Retry?",function(b){b&&c.applyTemplate(a)},null);case 16:case"end":return e.stop()}},null,this,[[6,13]])},changeEffectHasText:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/effectHasText",value:a})},changeProductionVerification:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/productionVerification",value:a})},setScreenDimensions:function(a,c,d){b("MediaEffectFrameEditorDispatcher").dispatch({type:"set/screenDimensions",screenWidth:a,dialogHeight:c,flowType:d})},initEventDialogContext:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"init/eventDialog",dialogContext:a})},addInspirationCategoryNames:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"add/inspirationCategoryNames",value:a})},removeInspirationCategoryNames:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"remove/inspirationCategoryNames",value:a})},changeGatelogic:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/gatelogic",value:a})},changeIGCameraFormat:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/igCameraFormat",value:a})},changeHumanReadableDescription:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/humanReadableDescription",value:a})},setPlaceDescription:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"set/placeDescription",placeDescription:a})},selectTemplateCategoryID:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"select/templateCategoryID",value:a})},changeAttributedOwner:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"select/attributedOwnerID",value:a})},initEffectData:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"init/effectData",data:a})},changeActiveStatus:function(a,c,d,e){b("promiseDone")(b("MediaEffectMetadataDataLoader").changeActiveStatus(a,c).then(function(a){a=a.payload.effects;b("MediaEffectFrameEditorDispatcher").dispatch({type:"effect/edited",data:a[0]});b("MediaEffectHubDispatcher").dispatch({type:"effects_edited",payload:{effects:a}});d&&d()})["catch"](function(a){b("AsyncResponse").defaultErrorHandler(a),e&&e()}))},notifyEnterCreationFlowFromInlineNUX:function(){b("MediaEffectFrameEditorDispatcher").dispatch({type:"inlineNUX/enterCreationFlow"})},updateValidationResult:function(a,c){b("MediaEffectFrameEditorDispatcher").dispatch({type:"asset/validate",result:c,stickerFBID:a})},muteNotifications:function(){var a=i.of.apply(i,arguments);b("MediaEffectFrameEditorDispatcher").dispatch({type:"notification/mute",notificationTypes:a})},unmuteNotifications:function(){var a=i.of.apply(i,arguments);b("MediaEffectFrameEditorDispatcher").dispatch({type:"notification/unmute",notificationTypes:a})},highlightNotification:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"notification/highlight",location:a})},addSystemColorPalettes:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"add/systemColorPalettes",paletteData:a})},bootstrapFontData:function(){b("MediaEffectFrameEditorDispatcher").dispatch({type:"bootstrap/fontData"})},createNewTemplateVariation:function(a){a=b("MediaEffectTemplateVariationRecord").fromSourceTemplate(a);a.then(function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"new/templateVariation",templateVariation:a})})["catch"](function(a){})},setCurrentTemplateVariation:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"set/currentTemplateVariation",localTemplateID:a})},setTemplateSourceColorPalette:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"set/templateSourceColorPalette",palette:a})},setUserColorPalette:function(a,c){b("MediaEffectFrameEditorDispatcher").dispatch({type:"set/userColorPalette",palette:a,index:c})},checkFBOnlyMediaRestriction:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/fbOnlyMediaRestriction",value:a})},changeConnectApp:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"change/connectAppID",appID:a})},updateEffectID:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/effectID",effectID:a})},updateMetadata:function(a,c,d,e){a=b("XMediaEffectAsyncEditController").getURIBuilder().setFBID("media_effect_id",a).getURI();a=new(b("AsyncUploadRequest"))().setURI(a).setAllowCrossOrigin(!1).setData(c).setFiles(d);a.subscribe("success",function(a,c){b("MediaEffectUploadManager").informUploadDone(c.getResponse().payload),e&&e()});a.subscribe("failure",function(a,c){b("AsyncResponse").defaultErrorHandler(c)});a.send()},updateMaskFilesWithMetadata:function(a,c){b("MediaEffectRequestBuilder").forMask.forUpdate(a).setOnSuccessComplete(function(a){b("MediaEffectUploadManager").informUploadDone(a.payload),c&&c(!0)}).setOnFailureComplete(function(a){b("AsyncResponse").defaultErrorHandler(a),c&&c(!1)}).genSend()},updateIsAutoupgraded:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"update/isAutoupgraded",payload:{isAutoupgraded:a}})},addCaptureMode:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"add/captureMode",value:a})},removeCaptureMode:function(a){b("MediaEffectFrameEditorDispatcher").dispatch({type:"remove/captureMode",value:a})}};e.exports=k}),null);
__d("MediaEffectMetadataCategoryAndTags.react",["cx","fbt","MediaEffectCard.react","MediaEffectMetadataTagsTypeahead.react","React"],(function(a,b,c,d,e,f,g,h){"use strict";var i;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){return b("React").createElement(b("MediaEffectCard.react"),{className:"_2x0s",title:h._("Keywords"),tooltip:h._("Add up to 10 keywords to help people find your effect. Keywords must follow the platform's terms and policies.")},b("React").createElement(b("MediaEffectMetadataTagsTypeahead.react"),this.props))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectConnectAppSelector.react",["cx","fbt","Image.react","MediaEffectCard.react","MediaEffectWebdriverIDs","React","XUISingleSelector.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("XUISingleSelector.react").Option,k="0";c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.$1=function(a){a=a.value===k?null:a.value;this.props.onConnectAppChange(a)}.bind(this),b}a.prototype.render=function(){var a=this.props,c=a.appID,d=a.appsData;a=a.disabled;var e=b("React").createElement(j,{value:k},h._("None"));d=d.map(function(a){return b("React").createElement(j,{icon:b("React").createElement(b("Image.react"),{className:"_5hh3",src:a.src}),key:a.id,value:a.id},a.name)});var f=h._("Select the app connected to this effect. This is used for attribution on Facebook.");c=c||k;return b("React").createElement(b("MediaEffectCard.react"),{className:"_1t24",title:h._("Connected App"),tooltip:f},b("React").createElement(b("XUISingleSelector.react"),{"data-testid":b("MediaEffectWebdriverIDs").LWE_EFFECT_APP_POPOVER_BUTTON,defaultValue:c,disabled:!!a,maxwidth:268,onChange:this.$1,size:"xlarge",value:c},e,d))};e.exports=a}),null);
__d("MediaEffectMetadataThirdPartyThumbnailUploader.react",["cx","fbt","FileInput.react","Image.react","InlineBlock.react","LeftRight.react","MediaEffectCard.react","React","XUIButton.react","XUINotice.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(a){__p&&__p();i.constructor.call(this,a),this.onFileInputChange=function(event){__p&&__p();var a=event.target.files[0],b=a.size/1024/1024;if(b<1){b=new FileReader();b.readAsDataURL(a);b.addEventListener("loadend",function(b){b=b.target;b=b.result;this.setState({sizeError:!1,uploadedFile:a,uploadedFileURI:b});this.props.onFileInputChange(a)}.bind(this))}else this.setState({sizeError:!0,uploadedFile:null,uploadedFileURI:null})}.bind(this),this.state={sizeError:!1,uploadedFile:null,uploadedFileURI:null}}a.prototype.render=function(){var a=this.props,c=a.thumbnailName;a=a.thumbnailURI;return a!==null&&this.state.uploadedFile===null?null:b("React").createElement(b("MediaEffectCard.react"),{title:"Thumbnail",tooltip:h._("Upload thumbnail image for your effect")},b("React").createElement(b("LeftRight.react"),{direction:"left"},b("React").createElement(b("Image.react"),{className:"_3-91",height:144,src:this.state.uploadedFileURI,width:144}),b("React").createElement("div",null,b("React").createElement("div",{className:"_2phz"},h._("Upload a square thumbnail that will be displayed in squircle shape in the camera tray, must be less than 1MB.")),this.state.sizeError?b("React").createElement(b("XUINotice.react"),{use:"warn"},h._("Size is more than 1MB")):null,b("React").createElement("div",null,b("React").createElement("div",{className:"_2phz"},b("React").createElement(b("FileInput.react"),{accept:"image/*",name:"thumbnail_file",onChange:this.onFileInputChange},b("React").createElement(b("XUIButton.react"),{href:{url:"#"},label:h._("Upload Image")}))),b("React").createElement(b("InlineBlock.react"),{alignv:"middle"},c)))))};e.exports=a}),null);
__d("XMediaEffectFBOnlySettingsController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/targeting/",{flow_type:{type:"Enum",required:!0,enumType:1}})}),null);
__d("MediaEffectMetadataContainer.react",["cx","fbt","AsyncRequest","DOMContainer.react","FluxContainer","FXEntMediaEffectSubmissionStatus","immutable","MediaEffectConnectAppSelector.react","MediaEffectFirstPartySettingsCard.react","MediaEffectFlowType","MediaEffectFrameCreateDialogDataStore","MediaEffectFrameCreationStepsConfig","MediaEffectFrameEditorDispatcher","MediaEffectMetadataActionCreators","MediaEffectMetadataCategoryAndTags.react","MediaEffectMetadataLocation.react","MediaEffectMetadataLocationV2.react","MediaEffectMetadataNameContainer.react","MediaEffectMetadataSchedule.react","MediaEffectMetadataStore","MediaEffectMetadataThirdPartyThumbnailUploader.react","MediaEffectMetadataViewStore","MediaEffectPlaceDescriptionRecord","MediaEffectUserContext","MediaEffectWarnings.react","React","XMediaEffectFBOnlySettingsController","XUICard.react","XUIText.react","mediaEffectGKCheck"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("MediaEffectFrameCreationStepsConfig").CreationSteps,k=b("immutable").List,l="124024574287414",m="ig_camera_core_team";c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;a.getStores=function(){return[b("MediaEffectFrameCreateDialogDataStore"),b("MediaEffectMetadataStore"),b("MediaEffectMetadataViewStore")]};a.calculateState=function(a,c){a=b("MediaEffectMetadataStore").getState();var d=b("MediaEffectMetadataViewStore").getState(),e=a.get("thumbnail"),f=a.get("selectedOwnerID");c=b("MediaEffectFrameCreationStepsConfig").getStep(c.flowType,b("MediaEffectFrameCreateDialogDataStore").getState().get("validatingStep"));c=c===j.TARGETING;var g=a.get("gatelogic")===null&&f===l?m:a.get("gatelogic");b("MediaEffectMetadataActionCreators").changeGatelogic(g);return{endTime:a.get("endTime"),errors:d.get("errors"),location:a.get("location"),locationPageID:a.get("locationPageID"),startTime:a.get("startTime"),selectedCategoryID:a.get("selectedCategoryID"),selectedConnectAppID:a.get("connectAppID"),selectedOwner:b("MediaEffectMetadataViewStore").getOwner(f),tags:a.get("tags"),thumbnailName:e&&e.name,thumbnailURI:e?URL.createObjectURL(e):a.get("thumbnailURI"),timezone:a.get("timezone"),isValidating:c,locationTarget:a.get("locationTarget"),fbOnlySection:a.get("fbOnlySection")}};function a(a,b){i.constructor.call(this,a,b)}a.prototype.componentDidMount=function(){this.$1()};a.prototype.$1=function(){var a=b("XMediaEffectFBOnlySettingsController").getURIBuilder().setEnum("flow_type",this.props.flowType).getURI();new(b("AsyncRequest"))().setURI(a).setAllowCrossOrigin(!0).send()};a.prototype.$2=function(a){b("MediaEffectMetadataActionCreators").changeOwner(a),b("MediaEffectMetadataActionCreators").resetLocation()};a.prototype.$3=function(a){return!b("MediaEffectUserContext").includesFBOnly||a||!b("mediaEffectGKCheck")("cep_can_see_capture_mode")?null:b("React").createElement(b("MediaEffectFirstPartySettingsCard.react"),{effect:null})};a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores([b("MediaEffectFrameCreateDialogDataStore"),b("MediaEffectMetadataStore"),b("MediaEffectMetadataViewStore")])};a.prototype.getLocationSection=function(){var a=this.props.flowType,c=this.state,d=c.isValidating,e=c.location,f=c.locationPageID,g=c.locationTarget;c=c.selectedOwner;return!c||!this.props.context.allowLocationFrameCreation||!(a!==b("MediaEffectFlowType").MASK||c.isFirstParty||this.props.context.canThirdPartyMaskLocation)?null:b("React").createElement("div",null,b("mediaEffectGKCheck")("cep_location_targeting_v2")?b("React").createElement(b("MediaEffectMetadataLocationV2.react"),{disabled:this.props.disabled,isValidating:d,location:e,locationTargetType:g,onLocationSelected:b("MediaEffectMetadataActionCreators").changeLocation,onLocationTargetTypeSelected:b("MediaEffectMetadataActionCreators").changeLocationTarget,selectedOwner:c}):b("React").createElement(b("MediaEffectMetadataLocation.react"),{disabled:this.props.disabled,isValidating:d,locationPageID:f,locationTarget:g,onLocationDescriptionLoaded:b("MediaEffectMetadataActionCreators").setPlaceDescription,onLocationPageSelected:b("MediaEffectMetadataActionCreators").changeLocationPage,onLocationTargetSelected:b("MediaEffectMetadataActionCreators").changeLocationTarget,selectedOwner:c}),b("React").createElement("div",{className:"_204i"}))};a.prototype.render=function(){var a=this.props.flowType,c=this.state,d=c.endTime,e=c.fbOnlySection,f=c.isValidating,g=c.selectedCategoryID,i=c.selectedConnectAppID,j=c.selectedOwner,l=c.startTime,m=c.tags,n=c.thumbnailName,o=c.thumbnailURI;c=c.timezone;var p=this.props.bootstrapData.metadataJSData.submissionStatus,q=!!this.props.bootstrapData.metadataJSData.id;p=p===b("FXEntMediaEffectSubmissionStatus").DRAFT||p===b("FXEntMediaEffectSubmissionStatus").DENIED||j&&j.isFirstParty;var r=a===b("MediaEffectFlowType").MASK&&j&&(j.isFirstParty||j.type==="page"),s=this.state.errors.toArray().map(function(a,c){return b("React").createElement(b("MediaEffectWarnings.react"),{items:a.messageItems,key:c+a.code,message:a.message||""})}),t=this.props.bootstrapData.appsData;e=e!==null?b("React").createElement(b("DOMContainer.react"),null,e):null;return b("React").createElement("div",{className:"_2041 _190n"},s,!q||p?b("React").createElement("div",{className:"_3or3"},b("React").createElement("div",{className:"_4s2u"},b("React").createElement(b("XUIText.react"),{className:"_3os1",display:"block"},h._("Required details"))),b("React").createElement(b("XUICard.react"),{className:"_3os2"},b("React").createElement(b("MediaEffectMetadataNameContainer.react"),{disabled:!1,flowType:a,placeholder:h._("Create a name for your effect")}),this.props.canThirdPartyUpdateThumbnail?b("React").createElement(b("MediaEffectMetadataThirdPartyThumbnailUploader.react"),{onFileInputChange:b("MediaEffectMetadataActionCreators").setThumbnail,thumbnailName:n,thumbnailURI:o}):null)):null,this.$3(q),b("React").createElement("div",{className:"_3or3"},b("React").createElement("div",{className:"_4s2u"},b("React").createElement(b("XUIText.react"),{className:"_3os1",display:"block"},h._("Optional details"))),b("React").createElement(b("XUICard.react"),{className:"_3os2"},r?b("React").createElement("div",null,b("React").createElement(b("MediaEffectConnectAppSelector.react"),{appID:i,appsData:k(t),disabled:this.props.disabled,isValidating:f&&(!j||!j.isFirstParty),onConnectAppChange:b("MediaEffectMetadataActionCreators").changeConnectApp})):null,this.getLocationSection(),b("React").createElement(b("MediaEffectMetadataSchedule.react"),{disabled:this.props.disabled,endTime:d,onDateRangeChange:b("MediaEffectMetadataActionCreators").changeScheduleRange,owner:j,startTime:l,timezone:c}),b("React").createElement("div",{className:"_204i"}),b("React").createElement(b("MediaEffectMetadataCategoryAndTags.react"),{disabled:this.props.disabled,onAddTag:b("MediaEffectMetadataActionCreators").addTag,onCategorySelected:b("MediaEffectMetadataActionCreators").changeCategory,onRemoveTag:b("MediaEffectMetadataActionCreators").removeTag,selectedCategoryID:g,tags:m}))),e)};e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MediaEffectMetadataLocation.react",["cx","fbt","AdsTargetingAggregatedMap.react","AdsTargetingLocationMapRecord","CameraEffectsPOITypeaheadSearchGK","GeoCoordinates","GraphAPI","LeafletView","LocationConstants","Log","MediaEffectCard.react","MediaEffectEditorFunnelLogger","MediaEffectMetadataValidationUtils","MediaEffectPlaceDescriptionRecord","MediaEffectProfilePolicy","PlaceSearchConstants","PlaceSearchSuppressionVersion","React","ReactComposerLocationSearchSource","SearchableEntry","Tooltip.react","XUIGrayText.react","XUIRadioList.react","XUIText.react","XUITypeahead.react","XUITypeaheadView.react","mediaEffectGKCheck","promiseDone"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("XUIRadioList.react").Item;c=b("React").PropTypes;var k={everyone:"everyone",targeted:"targeted"},l=200;d=babelHelpers.inherits(a,b("React").PureComponent);i=d&&d.prototype;function a(a){__p&&__p();i.constructor.call(this,a),this.$3=function(a){a===k.everyone&&(this.props.onLocationPageSelected(null),this.setState(this.$1()));if(a===k.targeted){var b=this.props.selectedOwner;b&&this.$4()&&(this.props.onLocationPageSelected(b.id),this.updateStateByLocationPageID(b.id))}this.props.onLocationTargetSelected(a)}.bind(this),this.onSelectTypeahead=function(a,event){a=a.getUniqueID();b("MediaEffectEditorFunnelLogger").logChangeLocation();this.props.onLocationPageSelected(a);this.updateStateByLocationPageID(a)}.bind(this),this.$10=function(a){this.setState({view:a})}.bind(this),this.state=Object.assign({},this.$1())}a.prototype.componentDidMount=function(){this.props.locationPageID&&this.updateStateByLocationPageID(this.props.locationPageID)};a.prototype.UNSAFE_componentWillReceiveProps=function(a){a.selectedOwner.id!==this.props.selectedOwner.id&&(this.setState(this.$1()),this.props.onLocationPageSelected(null))};a.prototype.$2=function(){var a={event_name:b("PlaceSearchConstants").SOURCE_CAMERA_MEDIA_EFFECT_UPLOAD,event_specific_data:{context:"places_typeahead:"+b("PlaceSearchConstants").SOURCE_CAMERA_MEDIA_EFFECT_UPLOAD,source:b("PlaceSearchConstants").SOURCE_CAMERA_MEDIA_EFFECT_UPLOAD,ref:"MediaEffectMetadataLocation.react"}};return b("ReactComposerLocationSearchSource")({},{hide_geo:!1,allow_poi:b("CameraEffectsPOITypeaheadSearchGK").gkResult,allow_country:this.props.selectedOwner.isFirstParty||b("mediaEffectGKCheck")("media_effect_allow_country_location_targeting"),suppression_version:b("PlaceSearchSuppressionVersion").CAMERA_LOCATION_FRAMES},a)};a.prototype.$1=function(){return{searchSource:this.$2(),selectedPlace:null,selectedPlaceLocation:{},view:b("LeafletView").DEFAULT,query:""}};a.prototype.$5=function(){var a=b("React").createElement(b("XUIText.react"),{display:"block",key:"title"},this.props.locationTargetTypeTargetedLabel);a=this.$6()?b("React").createElement(b("Tooltip.react"),{tooltip:h._("This option is unavailable")},a):a;return b("React").createElement(b("XUIRadioList.react"),{disabled:this.props.disabled,onValueChange:this.$3,selectedValue:this.props.locationTarget},b("React").createElement(j,{disabled:this.props.disabled,value:k.everyone},b("React").createElement(b("XUIText.react"),{display:"block"},this.props.locationTargetTypeEveryoneLabel)),b("React").createElement(j,{disabled:this.props.disabled||this.$6(),value:k.targeted},a))};a.prototype.$7=function(){var a=this.props,c=a.isValidating;a=a.locationPageID;a=b("MediaEffectMetadataValidationUtils").validateLocationPageID(a);return c&&this.props.locationTarget===k.targeted&&!a?h._("Please select a location"):null};a.prototype.$8=function(){if(this.props.locationTarget===k.everyone)return null;return this.$4()?null:b("React").createElement(b("XUITypeahead.react"),{className:"_3_kx",clearable:!0,disabled:this.props.disabled,highlightOnSelect:!0,initialEntry:null,onChange:function(event){this.setState({query:event.target.value})}.bind(this),onClear:function(){this.setState({query:"",selectedPlace:null})}.bind(this),onSelectAttempt:this.onSelectTypeahead,placeholder:h._("Type the name of a country, city or landmark"),presenter:{ViewRenderer:b("XUITypeaheadView.react"),useLayer:!0},queryString:this.state.query,searchSource:this.state.searchSource,selectedEntry:this.state.selectedPlace,showEntriesOnFocus:!0,tallInput:!0,xuiError:this.$7()})};a.prototype.$9=function(){var a=this.state.selectedPlace,c=this.state.selectedPlaceLocation,d=this.props.locationTarget;if(a&&c&&d===k.targeted){d={name:a.getTitle(),key:a.getUniqueID(),type:a.getType()==="city"?b("LocationConstants").CITY:b("LocationConstants").CUSTOM_LOCATION,latitude:c.latitude,longitude:c.longitude};c=b("AdsTargetingLocationMapRecord").fromGeoLocations((a={},a[b("LocationConstants").CUSTOM_LOCATIONS]=[d],a));if(c&&c.size>0)return b("React").createElement(b("AdsTargetingAggregatedMap.react"),{disableCollapseButton:!0,height:l,locationRecords:c,onViewChange:this.$10,view:this.state.view})}return null};a.prototype.updateStateByLocationPageID=function(a){b("promiseDone")(b("GraphAPI")("2.5").object("page",a).get({fields:"name, location, place_type"}),function(a){var c=new(b("GeoCoordinates"))(a.location.latitude,a.location.longitude);c=new(b("LeafletView"))({center:c,zoom:5});this.setState({selectedPlace:new(b("SearchableEntry"))({uniqueID:a.id,title:a.name,type:a.place_type}),selectedPlaceLocation:a.location,query:a.name,view:c});this.props.onLocationDescriptionLoaded(new(b("MediaEffectPlaceDescriptionRecord"))({name:a.name,key:a.id,type:a.place_type==="city"?b("LocationConstants").CITY:b("LocationConstants").CUSTOM_LOCATION,latitude:a.location.latitude,longitude:a.location.longitude}))}.bind(this),function(){this.props.onLocationPageSelected(null),b("Log").info("Failed to fetch Page %s",a),this.setState(this.$1())}.bind(this))};a.prototype.$4=function(){var a=this.props.selectedOwner;return!a?!1:a.policies.includes(b("MediaEffectProfilePolicy").SELF_LOCATION_ONLY)};a.prototype.$6=function(){var a=this.props.selectedOwner;return!a?!1:a.policies.includes(b("MediaEffectProfilePolicy").LOCATION_PROHIBITED)};a.prototype.render=function(){var a=h._("Choose where you want this effect to be discovered..");return b("React").createElement(b("MediaEffectCard.react"),{title:h._("Location"),tooltip:a},this.$5(),this.$8(),this.$9())};a.propTypes={locationPageID:c.string,selectedOwner:c.object,onLocationPageSelected:c.func.isRequired};a.defaultProps={locationTargetTypeEveryoneLabel:h._("People in any location"),locationTargetTypeTargetedLabel:h._("People in a set location")};e.exports=a}),null);
__d("MediaEffectMetadataName.react",["cx","fbt","MediaEffectCard.react","MediaEffectEditorFunnelLogger","MediaEffectMetadataValidationUtils","MediaEffectWebdriverIDs","React","XUITextInput.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(a){i.constructor.call(this,a),this.$2=function(event){b("MediaEffectEditorFunnelLogger").logChangeName(),this.props.onNameChange(event.target.value)}.bind(this),this.props.handleServerValidationResponse(a.nameData)}a.prototype.UNSAFE_componentWillReceiveProps=function(a){this.props.handleServerValidationResponse(a.nameData)};a.prototype.$1=function(){if(this.props.isValidating){var a=b("MediaEffectMetadataValidationUtils").validateName(this.props.nameData);if(!a)return h._("You must provide a name.")}return this.props.isError?h._("Invalid name"):null};a.prototype.render=function(){return b("React").createElement(b("MediaEffectCard.react"),{className:"_2x0s",title:h._("Name"),tooltip:h._("Choose a name for your effect.")},b("React").createElement(b("XUITextInput.react"),{className:"_3_kx","data-testid":b("MediaEffectWebdriverIDs").LWE_EFFECT_FRAME_NAME_INPUT,disabled:this.props.disabled,height:"tall",onChange:this.$2,placeholder:this.props.placeholder,value:this.props.nameData,xuiError:this.$1()},this.props.nameData))};e.exports=a}),null);
__d("MediaEffectMetadataNameContainer.react",["cx","AsyncRequest","FluxContainer","MediaEffectFrameCreateDialogDataStore","MediaEffectFrameCreationStepsConfig","MediaEffectMetadataActionCreators","MediaEffectMetadataName.react","MediaEffectMetadataStore","React","XMediaEffectValidationController"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("MediaEffectFrameCreationStepsConfig").CreationSteps;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$1=function(a){if(a){var c=b("XMediaEffectValidationController").getURIBuilder().getURI();new(b("AsyncRequest"))(c).setData({name:a}).setMethod("GET").setReadOnly(!0).setAllowCrossPageTransition(!0).setHandler(this.$2).send()}}.bind(this),c}a.getStores=function(){return[b("MediaEffectFrameCreateDialogDataStore"),b("MediaEffectMetadataStore")]};a.calculateState=function(a,c){a=b("MediaEffectFrameCreationStepsConfig").getStep(c.flowType,b("MediaEffectFrameCreateDialogDataStore").getState().get("validatingStep"));c=b("MediaEffectMetadataStore").getState().hasFrameNameError;return{isError:c,isValidating:a===i.TARGETING,nameData:b("MediaEffectMetadataStore").getState().get("name")}};a.prototype.$2=function(a){a=!a.payload.valid;b("MediaEffectMetadataActionCreators").updateNameValidation(a)};a.prototype.render=function(){return b("React").createElement(b("MediaEffectMetadataName.react"),babelHelpers["extends"]({},this.props,{className:"_1wl8",handleServerValidationResponse:this.$1,isError:this.state.isError,isValidating:this.state.isValidating,nameData:this.state.nameData,onNameChange:b("MediaEffectMetadataActionCreators").changeName}))};e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("OzConfig",["immutable","Reflux"],(function(a,b,c,d,e,f){__p&&__p();var g=b("immutable").Map,h=b("Reflux").createAction({sync:!0}),i=b("Reflux").createAction({sync:!0}),j=b("Reflux").createStore({init:function(){this.data=g(),this.listenTo(h,this._onSetConfig),this.listenTo(i,this._onUpdateConfig)},getInitialState:function(){return this.data},_onSetConfig:function(a){this.data=a,this.trigger(this.data)},_onUpdateConfig:function(a){this.data=this.data.mergeDeep(a),this.trigger(this.data)}});function a(a){return j.data.get(a)}function c(a){return j.data.getIn(a)}e.exports={ConfigStore:j,getInStaticConfig:c,getStaticConfig:a,setConfig:h,updateConfig:i}}),null);
__d("OzActions",["Reflux"],(function(a,b,c,d,e,f){__p&&__p();a={};a.activateThread=b("Reflux").createAction();a.scrollThreadToTimestamp=b("Reflux").createAction();a.doneScrollingToTimestamp=b("Reflux").createAction();a.updateThreads=b("Reflux").createAction();a.maybeUpdateThreads=b("Reflux").createAction();a.clearReassignState=b("Reflux").createAction();a.deleteTask=b("Reflux").createAction();a.updateMerchants=b("Reflux").createAction();a.deleteMerchants=b("Reflux").createAction();a.updateWitIntents=b("Reflux").createAction();a.updateReps=b("Reflux").createAction();a.replaceReps=b("Reflux").createAction();a.replaceHumans=b("Reflux").createAction();a.updateRequirements=b("Reflux").createAction();a.showDialog=b("Reflux").createAction();a.hideDialog=b("Reflux").createAction();a.updateComposer=b("Reflux").createAction();a.addBubble=b("Reflux").createAction();a.addAutopilot=b("Reflux").createAction();a.isActive=b("Reflux").createAction();a.isInactive=b("Reflux").createAction();a.sendPulse=b("Reflux").createAction();a.updateQueueFilters=b("Reflux").createAction();a.intentCreator=b("Reflux").createActions(["toggle","select","clear"]);a.emailComposer=b("Reflux").createActions(["delete","add"]);a.emailComposer.update=b("Reflux").createAction({sync:!0});a.inviteComposer=b("Reflux").createActions(["delete","add","create"]);a.inviteComposer.update=b("Reflux").createAction({sync:!0});a.twilio=b("Reflux").createActions(["connect","endCall","hangUp","incoming","incomingAccept","incomingReject","mute","ready","setup","startCall","unmute","updateIncomingInfo","useIntent","updateRating","dialAgain"]);a.twilio.changeTo=b("Reflux").createAction({sync:!0});a.twilio.sendDigits=b("Reflux").createAction({sync:!0});a.sendMessageStart=b("Reflux").createAction();a.sendMessageFinish=b("Reflux").createAction();a.addHandledEvents=b("Reflux").createAction();a.updateServerOffset=b("Reflux").createAction();a.updateLoadingState=b("Reflux").createAction();a.updateCalendarEvents=b("Reflux").createAction();a.skywalkerMessage=b("Reflux").createAction();a.skywalkerStalled=b("Reflux").createAction();a.selectAIPick=b("Reflux").createAction();e.exports=a}),null);
__d("OzImmutablePureRenderMixin",["immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("immutable").is;function h(a,b){__p&&__p();if(g(a,b))return!0;if(typeof a!=="object"||a===null||typeof b!=="object"||b===null)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(var d=0;d<c.length;d++)if(!hasOwnProperty.call(b,c[d])||!g(a[c[d]],b[c[d]])){window._debugLogs&&!1;return!1}return!0}function i(a,b,c){return!h(a.props,b)||!h(a.state,c)}a={shouldComponentUpdate:function(a,b){return i(this,a,b)}};e.exports=a}),null);
__d("OzNotify",["cx","immutable","OzImmutablePureRenderMixin","React","ReactCSSTransitionGroup","Reflux","ShimButton.react","joinClasses"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("immutable").OrderedMap,i=b("immutable").Map,j={addNotif:b("Reflux").createAction({sync:!0}),removeNotif:b("Reflux").createAction({sync:!0})};c=b("Reflux").createStore({init:function(){this.data=h(),this.listenTo(j.addNotif,this._onAddNotif),this.listenTo(j.removeNotif,this._onRemoveNotif)},getInitialState:function(){return this.data},_onAddNotif:function(a){this.data=this.data.set(a.get("id"),a),this.trigger(this.data)},_onRemoveNotif:function(a){this.data=this.data["delete"](a),this.trigger(this.data)}});var k=i({info:"_4nqo",warn:"_4nqp",error:"_4nqq"});d=b("React").createClass({displayName:"OzNotify",mixins:[b("Reflux").connect(c,"notifs"),b("OzImmutablePureRenderMixin")],render:function(){return b("React").createElement(b("ReactCSSTransitionGroup"),{component:"div",transitionName:"oz-fade-in-out",className:"_4nqr",transitionEnterTimeout:500,transitionLeaveTimeout:500},this.state.notifs.reverse().map(function(c,a){return b("React").createElement("div",{key:a,className:b("joinClasses")("_4nqs",k.get(c.get("level")))},c.get("msg"),b("React").createElement(b("ShimButton.react"),{className:"_ok9",inline:!0,onClick:function(){return j.removeNotif(a)}},"\xd7"))}).valueSeq())}});var l=7e3,m=0;function a(a){return function(b){m+=1,j.addNotif(i({id:m,level:a,msg:b})),(function(a){window.setTimeout(function(b){return j.removeNotif(a)},l)})(m)}}f={Component:d,info:a("info"),warn:a("warn"),error:a("error")};e.exports=f}),null);
__d("OzAPI",["invariant","Arbiter","ChannelConstants","ChannelManager","immutable","OzActions","OzAJAX","OzConfig","OzHelpers","OzNotify","OzStores","RTISubscriptionManager","promiseDone","promiseFinally"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("immutable").List,i=b("immutable").Map,j=b("OzAJAX").ajax,k=b("OzAJAX").beacon,l=b("OzAJAX").buildURI,m=b("OzStores").ActiveThreadStore,n=b("OzStores").ThreadStore;b("ChannelManager").startChannelManager();function o(a){a.attachment&&!a.attachments&&(a.attachments=[a.attachment]);a=b("immutable").fromJS(a);return a}function p(a){return h(a.map(function(a){a=o(a);return[b("OzHelpers").msgID(a),a]})).fromEntrySeq().toMap()}function q(a){a.messages||(a.messages=(a["last-events"]||[]).map(function(a){a.sender=a.from;return a}));a.messages=p(a.messages);a=b("immutable").fromJS(a);return a}function r(a){return h(a.map(q))}function s(a){a=r([a]);b("OzActions").updateThreads(a);b("OzActions").addHandledEvents(a.first().get("handled-events",h()));a.count()===1||g(0);return a.first()}function t(a){Number.isSafeInteger(a.offset)||g(0);Number.isSafeInteger(a.limit)||g(0);return j({type:"GET",url:l("threads",b("OzConfig").getStaticConfig("PAGE_ID")),params:a}).then(function(a){a=a.threads;a=r(a);b("OzActions").updateThreads(a);return a})}function u(a){__p&&__p();var c=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],d=arguments.length<=2||arguments[2]===undefined?null:arguments[2];typeof a==="string"||g(0);typeof c==="object"||g(0);var e,f=!1;c instanceof FormData?e=c:(e=JSON.stringify(c),f=!0);var k=function(){var a=m.data.get("activeIntent"),b=m.data.get("threadID");b=a&&b&&n.data.getIn([b,"intents"],h()).findLast(function(b){return b.get("id")===a},null,i()).get("state");return b==="open"&&a},o={type:"PUT",url:l("sync"),params:{t:a,"intent-id":d||k(),page:b("OzConfig").getStaticConfig("PAGE_ID")},body:e};f&&(o.headers=o.headers||{},o.headers["content-type"]="application/json");b("OzHelpers").info("[sync] "+a,c);return j(o)}function a(a){return function(c){return u(a,{tid:c}).then(function(a){a=q(a);b("OzActions").updateThreads(h([a]));return a})}}function v(a){var c=a["user-id"],d=a["owner-id"];a=a["last-owner-id"];var e=b("OzConfig").getStaticConfig("uid");return n.data.get(c)||d===e||a===e}var w={metrics:i({}),bumpMetric:function(a){w.metrics=w.metrics.updateIn(a,function(a){return(a||0)+1})},setMetric:function(a,b){w.metrics=w.metrics.setIn(a,b)},_witIntentCSV:function(){b("promiseDone")(w.witIntents(),function(a){var b="data:text/csv;charset=utf-8,";a.forEach(function(a){return b+='"'+a.get("name")+'","'+a.get("id")+'","'+a.get("doc")+'"\n'});window.open(window.encodeURI(b))})},grab:a("grab"),release:a("release"),ready:a("ready"),notready:a("notready"),ack:a("ack"),lockThread:a("lock-thread"),markRead:a("mark-read"),unlockThread:function(a,b){return u("unlock-thread",{tid:a,"locked-at":b}).then(s)},assignTo:function(a,b){return u("assign-to",{tid:a,id:b})},escalate:function(a){return w.createTag(a,"escalated")},escalateTo:function(a,b){return w.escalate(a).then(function(){return w.assignTo(a,b)})},typing:function(a){return u("rep-typing",{tid:a})},notTyping:function(a){return u("rep-not-typing",{tid:a})},createReminder:function(a,b){return u("create-reminder",babelHelpers["extends"]({tid:a},b.toJS()))},createTask:function(a,b){return u("create-task",{tid:a,task:b.toJS()})},completeTask:function(a,b){return u("complete-task",{tid:a,task:b.toJS()}).then(s)},editTask:function(a,b){return u("edit-task",{tid:a,task:b.toJS()}).then(s)},cancelTask:function(a,c){var d=arguments.length<=2||arguments[2]===undefined?!1:arguments[2];b("OzActions").deleteTask(a,c.get("id"));return u("cancel-task",{tid:a,task:c.toJS(),"cancel-future":d}).then(s)},openTask:function(a,b){return u("open-task",{tid:a,task:b.toJS()}).then(s)},closeReminder:function(a,b,c){return u("close-reminder",{tid:a,id:b,all:c}).then(s)},editReminder:function(a,b){return u("edit-reminder",{tid:a,reminder:b.toJS()}).then(s)},snoozeReminder:function(a,b){return u("snooze-reminder",{tid:a,id:b}).then(s)},deleteIntentRequirement:function(a,b,c){return u("delete-intent-requirement",{tid:a,"intent-id":b,"requirement-id":c},b).then(s)},deleteThreadRequirement:function(a,b){return u("delete-thread-requirement",{tid:a,"requirement-id":b}).then(s)},createIntentRequirement:function(a,b,c){return u("create-intent-requirement",{tid:a,"intent-id":b,"requirement-name":c},b).then(s)},createThreadRequirement:function(a,b){return u("create-thread-requirement",{tid:a,"requirement-name":b}).then(s)},createIntent:function(a,b){return u("create-intent",babelHelpers["extends"]({tid:a},b.toJS())).then(s)},openIntent:function(a,b){return u("open-intent",{tid:a,id:b},b).then(s)},triggerAIForIntent:function(a,b){return u("trigger-ai-for-intent",{tid:a,id:b},b)},closeIntent:function(a,b,c,d,e){a={tid:a,id:b,"close-state":c,feedback:d,"send-survey":e};return u("close-intent",a,b).then(s)},blockIntent:function(a,b){return u("block-intent",{tid:a,id:b},b).then(s)},unblockIntent:function(a,b){return u("unblock-intent",{tid:a,id:b},b).then(s)},addPhoneNumber:function(a,b){return u("add-phone-number",{tid:a,"intent-id":b},b)},editIntent:function(a,b){return u("edit-intent",babelHelpers["extends"]({tid:a},b.toJS()),b.get("id")).then(s)},createTag:function(a,b){return u("add-thread-tag",{tid:a,tag:b}).then(s)},deleteTag:function(a,b){return u("remove-thread-tag",{tid:a,tag:b}).then(s)},view:a("create-subscription"),unview:function(a){return u("delete-subscription",{tid:a})},updateMessage:function(a,b){return u("update-message",{tid:a,message:b.toJS()}).then(s)},everstoreUpload:function(a){var b=new FormData();a.forEach(function(a,c){return b.append(c,a)});return u("everstore-upload",b)},upload:function(a){var c=new FormData();a.forEach(function(a,b){return c.append(b,a)});return u("upload",c).then(function(a){return b("immutable").fromJS(a)})},sendMessage:function(a){var c=u("send",a).then(function(b){return s({"user-id":a.tid,"last-events":b})});b("promiseFinally")(c,function(c){return b("OzActions").sendMessageFinish(a.tid)});window.setTimeout(function(){return b("OzActions").sendMessageStart(a.tid)},200);return c},scheduleMessage:function(a){return u("schedule-send",a)},suggest:function(a){return u("suggest",a).then(s)},scheduleSuggest:function(a){return u("schedule-suggest",a)},deleteScheduled:function(a,b){return u("delete-scheduled",{tid:a,id:b}).then(s)},saveNote:function(a,b){a={tid:a,infos:{notes:b}};return u("update-infos",a).then(s)},saveMeta:function(a,b){a={tid:a,infos:{"metadata-json":b.toJS()}};return u("update-infos",a).then(s)},saveMuted:function(a,b){a={tid:a,infos:{muted:b}};return u("update-infos",a).then(s)},createMerchant:function(a){return u("create-merchant",a.toJS()).then(function(a){a=h([i(a)]);b("OzActions").updateMerchants(a);return a})},editMerchant:function(a){return u("edit-merchant",a.toJS()).then(function(a){a=h([i(a)]);b("OzActions").updateMerchants(a);return a})},deleteMerchant:function(a){return u("delete-merchant",a.toJS()).then(function(a){if(a&&a.id){var c=h([a.id]);b("OzActions").deleteMerchants(c);return c}else b("OzHelpers").warn("[api] unexpected delete-merchant response",a)})},sendEmail:function(a,b){var c=m.data.get("threadID");return u("send-email",babelHelpers["extends"]({tid:c},a.toJS()),b)},sendInvite:function(a,b){var c=m.data.get("threadID");return u("send-calendar",babelHelpers["extends"]({tid:c},a.toJS()),b)},fetchCalendar:function(a){return j({type:"GET",url:l("threads",b("OzConfig").getStaticConfig("PAGE_ID"),a,"calendar")}).then(function(c){b("OzActions").updateCalendarEvents({tid:a,calendarEvents:c});return c})},bookOpenTable:function(a,b,c,d,e){return u("book-reservation",{tid:a,rid:c,ts:d,covers:e},b)},everstoreURI:function(a){return u("everstore-uri",{handle:a})},witIntents:function(){return j({type:"GET",url:l("wit-intents",b("OzConfig").getStaticConfig("PAGE_ID"))}).then(function(a){a=b("immutable").fromJS(a);b("OzActions").updateWitIntents(a);return a})},merchants:function(){return j({type:"GET",url:l("merchants")}).then(function(a){b("OzActions").updateMerchants(h(a).map(function(a){return i(a)}))})},repsSync:function(){return j({type:"GET",url:l("reps-sync")})},requirements:function(){return j({type:"GET",url:l("requirements")}).then(function(a){b("OzActions").updateRequirements(b("immutable").fromJS(a))})},AIModules:function(){return j({type:"GET",url:l("ai-modules")}).then(function(a){return h(a)})},authorFeedback:function(a){return j({type:"GET",url:l("author-feedback"),params:{author_id:a}}).then(function(a){return i(a.map(function(a){a=b("immutable").fromJS(a);return[b("OzHelpers").msgID(a),a]}))})},myThreads:function(){var a=b("OzConfig").getStaticConfig("PAGE_ID");return j({type:"GET",params:{page:a},url:l("mythreads")}).then(function(a){a=a.mythreads;b("OzActions").updateThreads(r(a))})},allThreads:function(a,b,c,d){c={all:!0,first_tags:a.toJS(),last_tags:b.toJS(),offset:c,limit:d};a.has("ready")?(a=a["delete"]("ready"),c.ready=!0):b.has("ready")&&(b=b["delete"]("ready"),c.ready=!1);return t(c)},thread:function(a){return j({type:"GET",url:l("threads",b("OzConfig").getStaticConfig("PAGE_ID"),a)}).then(s)},handledEvents:function(a){return j({type:"GET",params:{"intent-id":a},url:l("handled-events")}).then(function(a){b("OzActions").addHandledEvents(b("immutable").fromJS(a["handled-events"]))})},tasksForIntent:function(a,c){var d=b("OzConfig").getStaticConfig("PAGE_ID");return j({type:"GET",params:{page:d},url:l("tasks",a)}).then(function(a){s({"user-id":c,tasks:a})})},history:function(a,c,d){return j({type:"GET",params:{timestamp:c,limit:d},url:l("threads",b("OzConfig").getStaticConfig("PAGE_ID"),a,"history")}).then(function(b){b=s({"user-id":a,messages:b});return b.get("messages")})},topIntents:function(){return j({type:"GET",url:l("top-intents")}).then(function(a){return b("immutable").fromJS(a)})},intentsDashboard:function(a){return j({type:"GET",params:a,url:l("dashboard","intent",b("OzConfig").getStaticConfig("PAGE_ID"))}).then(function(a){return b("immutable").fromJS(a)})},aiDashboard:function(a){return j({type:"GET",params:a,url:l("dashboard","ai",b("OzConfig").getStaticConfig("PAGE_ID"))}).then(function(a){return b("immutable").fromJS(a)})},statsDashboard:function(a){return j({type:"GET",params:a,url:l("dashboard","trainer",a["trainer-id"])}).then(function(a){return b("immutable").fromJS(a)})},teamStatsDashboard:function(a){return j({type:"GET",params:a,url:l("dashboard","trainer-team-stats")}).then(function(a){return b("immutable").fromJS(a)})},humans:function(){return j({type:"GET",url:l("humans")}).then(function(a){return b("OzActions").replaceHumans(b("immutable").fromJS(a))})},search:function(a){return j({params:a,type:"GET",url:l("search")}).then(function(a){return b("immutable").fromJS(a).flatten(!0)})},requestAutopilot:function(a){window.postMessage(a,"*")},notifyExtension:function(a){b("OzHelpers").debug("[oz-ext] notifying toto",a),window.postMessage(babelHelpers["extends"]({type:"notification"},{data:a}),"*")},recordActivity:function(a,b){return u("activity",babelHelpers["extends"]({tid:a},{activity:b}))},sendPulse:function(a,c){return j({type:"POST",url:l("pulse"),headers:{"content-type":"application/json"},params:{page:b("OzConfig").getStaticConfig("PAGE_ID"),duration:a},body:JSON.stringify(c)})},sendDisconnectPulse:function(a,c){return k({url:l("pulse"),params:{page:b("OzConfig").getStaticConfig("PAGE_ID"),duration:a},body:JSON.stringify(c)})},threadFocus:function(a,b){return u("thread-focus",{tid:a,intentID:b},b)},away:function(a){return u("away",{away:a})},coachMode:function(a){return u("coach-mode",{"coach-mode":a})},timestamp:function(){var a=Date.now();return j({type:"POST",url:l("timestamp")}).then(function(c){c=c.timestamp;var d=Date.now();if(d-a>1e3)b("OzHelpers").warn("[oz-api] timestamp took over 1 second, not updating offset");else{c=d-(c+(d-a)/2);b("OzActions").updateServerOffset({offsetMs:c})}})},init:function(){return j({type:"GET",url:l("init")}).then(function(a){a["twilio-token"]&&b("OzActions").twilio.setup(a["twilio-token"]),b("OzConfig").updateConfig(b("immutable").fromJS(a))})},realTime:function(a,c){__p&&__p();var d,e=6e4,f=function(){var a=Date.now();clearInterval(d);d=setInterval(function(c){c=Math.round((Date.now()-a)/1e3);b("OzActions").skywalkerStalled();b("OzHelpers").warn("[rti] no payload in "+c+"seconds")},e)},j={repsVersion:-1},k=function(a,c){__p&&__p();var d=c.payload;c=c.topic;a==="sky"||a==="msg"||g(0);f();a=a==="sky"?a+" "+c+" ->":a;var e=d.type,k=e||"";b("OzHelpers").debug("[rti] "+a+" "+k,d);if(!d.data){b("OzHelpers").error("[sky] got sky event without data",d,c);return}a=d.data["page-id"];if(a&&a!==b("OzConfig").getStaticConfig("PAGE_ID")){b("OzHelpers").debug("[sky] junk event on "+c,d);return}w.bumpMetric(["realtime",e]);b("OzActions").skywalkerMessage({payload:d,timestamp:b("OzHelpers").serverNow()});switch(e){case"thread":k=d.data;s(k);break;case"thread-metrics":k=d.data;n.data.get(k["user-id"])&&(w.bumpMetric(["realtime","thread-metrics-update-thread"]),s(k));break;case"maybe-thread":k=d.data;b("OzActions").maybeUpdateThreads(r([k]));break;case"delivered":case"seen":k=d.data;s({"user-id":k["user-id"],"last-seen":k["last-seen"]});break;case"presence":k=d.data;s({"user-id":k["user-id"],"last-presence":k["last-presence"]});break;case"carebear":(function(){var b=d.data,a=b.type;b=b.tid;b={"user-id":b};b["ui-"+a]=!0;s(b)})();break;case"inactive":b("OzActions").isInactive();break;case"updated-merchant":b("OzActions").updateMerchants(h([i(d.data)]));break;case"deleted-merchant":b("OzActions").deleteMerchants(h([d.data.id]));break;case"phone-call":b("OzActions").twilio.updateIncomingInfo(b("immutable").fromJS(d.data));break;case"humans":b("OzActions").replaceHumans(b("immutable").fromJS(d.data));break;case"reps-sync":j=babelHelpers["extends"]({},j,{repsVersion:d.version});b("OzActions").replaceReps(b("immutable").fromJS(d.data));break;case"reps-diff":j.repsVersion!==d.version-1?(b("OzHelpers").warn("[api] reps version out of sync",{"our-version":j.repsVersion,"next-version":d.version}),j=babelHelpers["extends"]({},j,{repsVersion:-1}),w.repsSync()):(j.repsVersion=d.version,b("OzActions").updateReps(b("immutable").fromJS(d.data)));break;case"handled-events":b("OzActions").addHandledEvents(b("immutable").fromJS(d.data));break;case"config":b("OzConfig").updateConfig(b("immutable").fromJS(d.data));break;case"notify":a=d.data;c=a.level;k=a.message;b("OzNotify")[c](k);break;case"updated-thread":a=d.data["user-id"];v(d.data)&&(w.bumpMetric(["realtime","updated-thread-fetch-thread"]),b("OzHelpers").info("[api] fetching thread after update",a),w.thread(a));break;case"ping":c=d.data.timestamp;k=b("OzHelpers").serverNow()-c;w.setMetric(["realtime","pingLatency"],k);break;default:b("OzHelpers").debug("[sky] unk type",e,d)}},l=function(){for(var a=arguments.length,c=Array(a),d=0;d<a;d++)c[d]=arguments[d];try{k.apply(undefined,c)}catch(a){try{b("OzHelpers").error.apply(b("OzHelpers"),["[sky] error handling message"].concat(c))}catch(a){!1}}},m=b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("msg"),function(a,b){l("msg",b.obj)}),o=x(function(){b("Arbiter").unsubscribe(m),b("RTISubscriptionManager").unsubscribeAll()});b("RTISubscriptionManager").subscribe(a,l.bind(this,"sky"),null,x(function(a){var b=a.data;a=a.error;a?(o(),c(a,b)):(f(),c(null,b,m))}));return o}};function x(a){var b,c,d=this;return function(){b||(c=a.apply(d,arguments),b=!0);return c}}e.exports=w}),null);
__d("ozMakeColor",["immutable","randomShuffle"],(function(a,b,c,d,e,f){__p&&__p();var g=b("immutable").Map,h=b("immutable").List,i=b("immutable").Range,j=function(a,b){return"hsla("+a+", 85%, 30%, "+b+")"};function a(){var a=arguments.length<=0||arguments[0]===undefined?25:arguments[0],c=arguments.length<=1||arguments[1]===undefined?.9:arguments[1],d=h(b("randomShuffle")(i(10,360,a).toJS())),e=0,f=g();return function(a){if(f.has(a))return j(f.get(a),c);else{var b=d.get(e);f=f.set(a,b);e=(e+1)%d.count();return j(b)}}}function c(){var a=arguments.length<=0||arguments[0]===undefined?77:arguments[0];return function(b){return j(b*a%360,.9)}}e.exports={makeColorShuffle:a,makeColor:c}}),null);
__d("OzHelpers",["BanzaiScuba","DatePickerRestraints","ErrorUtils","immutable","LogHistory","OzConfig","OzConstants","OzImmutablePureRenderMixin","OzServerTime","React","URI","getURLRanges","ozMakeColor"],(function(a,b,c,d,e,f){__p&&__p();var g=b("ozMakeColor").makeColor,h=b("immutable").List,i=b("immutable").Map,j=b("immutable").Set,k=b("immutable").OrderedMap,l=b("OzConstants").AUTHOR_TYPES,m=b("OzConstants").REMINDERS,n=/^image\//,o={color:g(),blobURI:function(a){return window.URL.createObjectURL(a)},blobFromDataURI:function(a){a=a.split(",");var b=atob(a[1]);a=a[0].split(":")[1].split(";")[0];var c=new ArrayBuffer(b.length),d=new Uint8Array(c);for(var e=0;e<b.length;e++)d[e]=b.charCodeAt(e);return new Blob([c],{type:a})},toLocaleDate:function(a){return new Date(a).toLocaleDateString()},toLocaleTime:function(a){return new Date(a).toLocaleTimeString()},hasCmdOrCtrl:function(a){return a.getModifierState("Meta")||a.getModifierState("Control")},keysIn:function(){var a=j(arguments);return function(b,c){return a.has(c)}},safeParse:function(a){var b={};try{b=JSON.parse(a)}catch(b){o.info("invalid json",a)}return b},safeURI:function(a){var c=null;try{c=b("URI").tryParseURI(a)}catch(b){o.info("invalid uri",a)}return c},pure:a,memoize:c,values:function(a){return Object.keys(a).map(function(b){return a[b]})},nonempty:function(a){return a&&!a.isEmpty()?a:null},uniqId:d,debug:s("debug",!1),info:s("info",!0),warn:s("warn",!0),error:s("error",!0),isImageType:function(a){return n.test(a)},isStickerType:function(a){return a==="image/sticker"},dateRestraints:f,moveCursorToInputEnd:function(a){if(a.setSelectionRange){var b=a.value.length;a.setSelectionRange(b,b)}},toTitleCase:function(a){var b=j(["a","an","the","at","by","for","in","of","on","to","up","and","as","but","or","nor"]),c=function(b,c,a){return c===0||c+b.length===a.length},d=function(d,e,a){return c(d,e,a)||!b.has(d)?d.charAt(0).toUpperCase()+d.substr(1):d};return a.toLowerCase().replace(/\w\S*/g,d)},scrollToBottom:function(a){a.scrollTop=a.scrollHeight},threadID:function(a){return a.get("user-id")},isNew:function(a){return!o.intents(a).find(o.isClosedIntent)},hasOwner:function(a){return a.getIn(["owner","id"])},hasAllTags:function(a,b){return b.every(function(b){return o.hasTag(a,b)})},hasSomeTag:function(a,b){return b.some(function(b){return o.hasTag(a,b)})},hasTag:function(a,b){return a.get("tags")&&a.get("tags").contains(b)},isEscalated:function(a){return o.hasTag(a,"escalated")},hasEngage:function(a){return!!a.get("engagement-type")},photo:function(a){return a.getIn(["user-vcard","photo"])||a.getIn(["user-vcard","picture"])},compareNums:function(a,b){if(a&&b)return b-a;else if(a)return-1;else if(b)return 1;else return 0},compareBools:function(a,b){if(a&&b)return 0;else if(a)return-1;else if(b)return 1},getIncomingThreads:function(a){return a.filter(function(a){return a.get("ready")&&!o.hasOwner(a)}).sort(o.threadComparator)},threadComparator:function(a,b){var c=o.compareBools(o.hasTag(a,"vip"),o.hasTag(b,"vip")),d=o.compareBools(o.hasTag(a,"urgent"),o.hasTag(b,"urgent")),e=o.compareNums(o.urgentReminders(a).getIn([0,"scheduled-time"]),o.urgentReminders(b).getIn([0,"scheduled-time"]));a=o.compareNums(a.get("last-event-at"),b.get("last-event-at"));return c||d||e||a},lastEvents:function(a){return a.get("last-events",h()).sortBy(function(a){return a.get("timestamp")})},lastUserMessage:function(a){return o.lastEvents(a).findLast(function(a){return o.authorType(a)===l.USER})},shortDesc:function(){var a=arguments.length<=0||arguments[0]===undefined?i():arguments[0],b=a.getIn(["attachments",0,"mime_type"]),c=a.getIn(["attachments",0,"sticker_id"]);return a.get("text")||c&&"sent a sticker."||b&&(b.match(/video/i)&&"sent a video."||b.match(/audio/i)&&"sent an audio clip."||b.match(/image/i)&&"sent an image")},preferredName:function(a){return a.getIn(["metadata-json","preferred-name"])||a.getIn(["user-vcard","first-name"])},userEmail:function(a){return a.getIn(["metadata-json","email"])},intents:function(a){return a.get("intents",h()).sortBy(function(a){return a.get("created-at")})},isOwner:function(a,b){a=a.getIn(["owner","id"]);return a&&b&&a==b},wasOwner:function(a,b){a=a.getIn(["last-owner","id"]);return a&&b&&a==b},isLocker:function(a,b){return a.get("locked")&&a.get("locker-id")===b},nameOrId:function(a){return a&&(a.get("name")||a.get("id"))||""},isSubscriber:function(a,b){return!!a.get("subscriptions",h()).find(function(a){return a===b})},hasUnblockedIntents:function(a){return a.get("intents",h()).some(function(a){return!o.isBlockedIntent(a)})},hasOpenIntents:function(a){return a.get("intents",h()).some(function(a){return o.isOpenIntent(a)})},openIntents:function(a){return o.intents(a).filter(o.isOpenIntent)},closedIntents:function(a){return o.intents(a).filter(o.isClosedIntent)},intentById:function(a,b){return o.intents(a).findLast(function(a){return a.get("id")===b})},isBlockedIntent:function(a){return a.get("blocked")},intentName:function(a){return a.get("name")||"Unknown intent"},intentAlias:function(a){return a.get("alias")||a.get("name")||"Unknown intent"},isOpenIntent:function(a){return a.get("state")==="open"},isClosedIntent:function(a){return!o.isOpenIntent(a)},isDeleted:function(a){return a.get("state")==="deleted"},getName:function(a){return a.getIn(["user-vcard","name"],"Unknown user")},lastPresence:function(a){return Math.max(a.get("last-seen")||0,a.get("last-presence")||0)},timeSpent:function(a){if(a.get("ready")&&a.get("last-ready-at"))return o.serverNow()-a.get("last-ready-at")},locationLastSeen:function(a){if(a.getIn(["location","last-seen"]))return new Date(a.getIn(["location","last-seen"]))},timezone:function(a){return a.getIn(["location","timezone"])},durationStr:function(a){__p&&__p();if(a==null){o.warn("[durationStr] strange duration "+a);return"[invalid duration]"}else if(a<-1e3){o.warn("[durationStr] strange duration "+a);return"-"+o.durationStr(-a)}else if(a<0){o.warn("[durationStr] strange duration "+a);return"< 0s"}else if(a===0)return"0s";else if(a<1e3)return"< 1s";else if(a<60*1e3)return Math.floor(a/1e3)+"s";else if(a<60*60*1e3)return Math.floor(a/(60*1e3))+"m";else if(a<24*60*60*1e3)return Math.floor(a/(60*60*1e3))+"h";else return Math.floor(a/(24*60*60*1e3))+"d"},serverNow:function(){return b("OzServerTime").serverNow()},repName:function(a,b){b=b.get(a);return b&&b.get("name")||a||null},authorType:function(a){var c=l.BOT,d=l.USER,e=l.TRAINER,f=a.get("sender")||a.get("from");a=a.get("author-type");return a===c&&c||(a===e||f===b("OzConfig").getStaticConfig("PAGE_ID"))&&e||d},msgID:function(){var a=arguments.length<=0||arguments[0]===undefined?i():arguments[0];return a.get("offline-threading-id")||a.get("mid")||o.warn("[msgID] had to resort to timestamp",a)&&null||a.get("timestamp")},isActivePulse:function(a){a=a&&a.get("pulse-data");return!a?!1:!a.get("away?")&&a.get("inactive-ms",Infinity)<3e4},EMPTY_BODY:b("immutable").fromJS([{"content-type":"text/plain; charset=UTF-8",body:{contents:""}}]),eventToEmail:function(a){return{email:a.get("data"),intentId:a.get("intent-id"),id:a.get("id")}},reEmail:function(a){var b=a.getIn(["data","subject"]);b=b.toUpperCase().startsWith("RE:")?b:"Re: "+b;return a.setIn(["data","subject"],b).setIn(["data","body"],this.EMPTY_BODY)},switchRecip:function(a){var b=a.get("data"),c=b.get("from");b=b.get("to");return a.setIn(["data","from"],b).setIn(["data","to"],h([c]))},eventToInvite:function(a){return{invite:a.get("data"),id:a.get("id"),intentId:a.get("intent-id"),disabled:!0}},urgentReminders:function(a){return a.get("reminders",h()).sortBy(function(a){return a.get("scheduled-time")}).filter(o.isUrgentReminder)},paidReminders:function(a){return o.urgentReminders(a).filter(o.isPaidReminder)},isUrgentReminder:function(a){a=a.get("state");return a==="active"||a==="active-snoozed"},isPaidReminder:function(a){return!!a.getIn(["body","suggestion"])},isSnoozedReminder:function(a){a=a.get("state");return a==="snoozed"||a==="active-snoozed"},isUrgentTask:function(a){var b=a.get("state");return b==="dispatched"&&a.get("deadline")<o.serverNow()},isPaidTask:function(a){return!!a.getIn(["data","suggestion"])},isCompletedTask:function(a){return a.get("state")==="completed"},isCanceledTask:function(a){return a.get("state")==="canceled"},isWaitingTask:function(a){return a.get("state")==="waiting"},isClosedTask:function(a){return o.isCompletedTask(a)||o.isCanceledTask(a)},isOpenTask:function(a){return!o.isClosedTask(a)},isUnread:function(a){return a.get("read-state")==="unread"},soonestDueTask:function(a){return a.filterNot(o.isClosedTask).minBy(function(a){return a.get("start-at")})},nextTaskForIntent:function(a){var b=arguments.length<=1||arguments[1]===undefined?h():arguments[1];return o.soonestDueTask(b.filter(function(b){return b.get("intent-id")===a.get("id")}))},nextTaskForThread:function(a){return o.soonestDueTask(a.get("tasks",h()))},unreadTs:function(a){return b("OzConfig").ConfigStore.data.getIn(["GK","responsivenessV2"])?a.get("unread-timestamp"):(o.lastUserMessage(a)||i()).get("timestamp")},hasPaid:function(a){return!!o.paidReminders(a).size},hasReminder:function(a){return!!o.urgentReminders(a).size},minAge:function(a){a=+a.getIn(["user-vcard","age-range","min"]);return Number.isSafeInteger(a)?a:0},shimURI:function(a){return new(b("URI"))("https://l.facebook.com/l.php").setQueryData({u:a,h:b("OzConfig").getStaticConfig("shimhash")}).toString()},uiSuggestion:function(a){var b=a.has("amount")?"$"+(a.get("amount")/100).toFixed(2):"";return{id:a.get("item-id")||"-1",name:a.get("name"),desc:a.get("description"),thumb_url:a.get("thumb-url"),merchant_name:a.get("merchant-name")||"",total_cost:a.get("amount")?i({amount:a.get("amount")}):null,display_total_cost:b,target_url:o.shimURI(a.get("target-url")),payment_id:a.get("payment-id"),expiration_time:a.get("expiration-time")}},parsePhoneNumber:function(a){if(!a)return"";a.length==12&&a[0]=="+"&&(a=a.substr(1));a.length==11&&a[0]=="1"&&(a=a.substr(1));switch(a.length){case 10:return"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6,4);case 7:return a.substr(0,3)+"-"+a.substr(3,4);default:return a}},validateURL:function(a){return!!a&&typeof a==="string"&&b("getURLRanges")(a).length&&b("URI").isValidURI(a)},normalizeMerchant:function(a){return a.updateIn(["website"],function(a){if(!a)return a;var c=b("getURLRanges")(a);return!c||c.length===0?a:c[0].entity.url}).updateIn(["page-id"],function(a){return Number.isFinite(a)||typeof a==="string"?parseInt(a,10):null})},validateMerchant:function(a){__p&&__p();var b=j(["name-dba","country"]),c=j(["address","website","page-id"]),d={},e=a.get("website","");e&&!this.validateURL(e)&&(d.website="Website is an invalid URL");e=a.get("page-id",null);e!=null&&!Number.isFinite(e)&&(d["page-id"]="FB Page must be a number");b.map(function(b){a.get(b)||(d[b]="This field is required")});if(j(a.filter(function(a){return a}).keys()).intersect(c).isEmpty()){var f="At least one of "+c.join(", ")+" is required";c.forEach(function(a){d[a]=f})}return i(d)},isDaytime:function(a){a=(Date.now()+a)%(24*60*60*1e3);a=a/(60*60*1e3);return a>=6},fullThreadData:function(a,b,c){var d=a.get(c);return!d?null:d.update("intents",function(a){return(a||h()).map(function(a){a=p(b,a);a=q(d,a);return a})})},threadPath:function(a){var b=a.threadid,c=a.intentid,d=a.taskid;a=a.eventid;c=c?"/intent/"+c:"";d=d?"/task/"+d:"";a=a?"/event/"+a:"";return"/inbox/"+b+c+(d||a)},updateInWhen:function(a,b,c){var d={};return a.getIn(b,d)!==d?a.updateIn(b,c):a},getRequirement:function(a,b){return a.get("requirements",h()).find(function(a){return a.get("name")===b})}};function p(a,b){a=a.getIn(["byIntent",b.get("id")],i());return b.set("events",a)}function q(a,b){a=a.getIn(["tasks-by-intent",b.get("id")]);return b.set("tasks",a)}function a(a){var c=arguments.length<=1||arguments[1]===undefined?"OzPureComponent":arguments[1];return b("React").createClass({displayName:c,mixins:[b("OzImmutablePureRenderMixin")],render:function(){return a(this.props)}})}function c(a,b){__p&&__p();var c=arguments.length<=2||arguments[2]===undefined?1e3:arguments[2],d=k();return function(){for(var e=arguments.length,f=Array(e),g=0;g<e;g++)f[g]=arguments[g];var h=b.apply(this,f);if(d.get(h))return d.get(h);else{var i=a.apply(this,f);d=d.set(h,i).takeLast(c);return i}}.bind(this)}var r=0;function d(){return r++}function f(){var a=new Date();a=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()));var c=new Date(+a);c.setFullYear(a.getFullYear()+m.RANGE_IN_YEARS);return{dateRestraints:[b("DatePickerRestraints").enforceDateIsNoEarlierThan(a),b("DatePickerRestraints").enforceDateIsNoLaterThan(c)]}}b("ErrorUtils").addListener(function(a){a=v({level:"error",message:"[unhandled-error]["+a.name+"] "+a.message,data:"--stack\n"+a.stack+"\n\n--originalError\n"+a._originalError});u(a);t(a)});function s(a,b){return function(){for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];var f=d[0],g=d.slice(1);window.console.log(a,f,g);var h=v({level:a,message:f,data:g});u(h);b&&t(h)}}function t(a){var c=new(b("BanzaiScuba"))(b("OzConfig").getStaticConfig("scubaCategory"));Object.entries(a).forEach(function(a){var b=a[0];a=a[1];Number.isSafeInteger(a)?c.addInteger(b,a):c.addNormal(b,a)});c.post()}function u(a){var c=b("LogHistory").getInstance("oz-logger");(c[a.level]||c.debug).call(c,a.message,"")}function v(a){return babelHelpers["extends"]({},a,{uid:b("OzConfig").getStaticConfig("uid"),public_name:b("OzConfig").getStaticConfig("publicName"),rev:b("OzConfig").getStaticConfig("rev"),timestamp:o.serverNow()})}e.exports=o}),null);
__d("OzServerTime",["OzAPI","OzStores"],(function(a,b,c,d,e,f){var g=b("OzStores").ServerOffsetStore,h;function a(){return Math.floor(Date.now()-g.data.get("offsetMs"))}function i(){window.clearInterval(h)}function c(){b("OzAPI").timestamp(),i(),h=window.setInterval(function(){return b("OzAPI").timestamp()},1e3*60*60*3)}e.exports={serverNow:a,setup:c,tearDown:i}}),null);
__d("OzStores",["invariant","immutable","OzActions","OzHelpers","Reflux"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("immutable").List,i=b("immutable").Map,j=b("immutable").OrderedMap,k=b("immutable").OrderedSet,l=b("immutable").Set;b("immutable").Iterable;a=b("Reflux").createStore({init:function(){this.data=i(),this.listenTo(b("OzActions").updateRequirements,this._onUpdateRequirements)},getInitialState:function(){return this.data},_onUpdateRequirements:function(a){this.data=this.data.withMutations(function(b){a.forEach(function(a){var c=a.get("name");a=b.get(c,i()).merge(a).update("wit-intent-uuids",function(a){return a&&a.toSet()||l()});b.set(c,a)})}),b("OzHelpers").debug("[oz] updated RequirementStore"),this.trigger(this.data)}});c=b("Reflux").createStore({init:function(){this.data=k(),this.listenTo(b("OzActions").addBubble,this._onAddBubble)},getInitialState:function(){return this.data},_onAddBubble:function(a){i.isMap(a)||g(0),this.data=this.data.add(a).takeLast(100),this.trigger(this.data)},metrics:function(){return i({bubbleCount:this.data.count()})}});d=b("Reflux").createStore({init:function(){this.data=j(),this.listenTo(b("OzActions").addAutopilot,this._onAddAutopilot)},getInitialState:function(){return this.data},_onAddAutopilot:function(a){i.isMap(a)||g(0),this.data=this.data.set(a.get("id"),a.get("data")).takeLast(100),this.trigger(this.data)}});var m="id";f=b("Reflux").createStore({init:function(){this.data=i(),this.listenTo(b("OzActions").updateWitIntents,this._onUpdateWitIntents)},getInitialState:function(){return this.data},_onUpdateWitIntents:function(a){b("immutable").List.isList(a)||g(0),this.data=this.data.withMutations(function(b){return a.reduce(function(a,b){return a.set(b.get(m),b)},b)}),this.trigger(this.data)},metrics:function(){return i({witIntentCount:this.data.count()})}});var n=b("Reflux").createStore({init:function(){this.data=i(),this.listenTo(b("OzActions").activateThread,this._onActivateThread)},getInitialState:function(){return this.data},_onActivateThread:function(a){var c=a.threadID,d=a.intentID,e=a.taskID;a=a.eventID;b("OzHelpers").info("[store/activeThread] set active thread: ",{threadID:c,intentID:d,taskID:e,eventID:a});this.data=this.data.set("oldThreadID",this.data.get("threadID")).set("threadID",c).set("activeIntent",d).set("activeTask",e).set("activeEvent",a);this.trigger(this.data)}}),o="user-id",p=function(a,b){return a.reduce(function(a,c){a[c.get(b)]=c;return a},{})};function q(a,c){__p&&__p();i.isMap(a)&&i.isMap(c)||g(0);var d=p(a,"offline-threading-id"),e=p(a,"mid");return a.withMutations(function(a){return c.valueSeq().filterNot(function(a){a=a.get("attachments");return a?a.first()&&a.first().getIn(["xma","body"])===null:!1}).reduce(function(a,c){var f=c.get("offline-threading-id"),g=c.get("mid"),h=f&&d[f]||g&&e[g]||a.get(b("OzHelpers").msgID(c));h&&(a=a["delete"](b("OzHelpers").msgID(h)),c=h.merge(c),f=c.get("offline-threading-id"),g=c.get("mid"));f&&(d[f]=c);g&&(e[g]=c);return a.set(b("OzHelpers").msgID(c),c)},a)})}var r=function(a,b,c){__p&&__p();switch(c){case"messages":return q(a,b);case"intents":case"reminders":c=i().withMutations(function(b){return(a||h()).reduce(function(a,b){return a.set(b.get("id"),b)},b)});c=b.reduce(function(a,b){var c=b.get("id");return a.set(c,(a.get(c)||i()).merge(b))},c).valueSeq().toList();return c;case"tasks":var d=b.map(function(a){return a.get("intent-id")}).toSet();return a.filterNot(function(a){return d.has(a.get("intent-id"))}).concat(b);case"light-thread":return a&&b;default:return b}},s=function(a){return a.set("tasks-by-intent",a.get("tasks",h()).groupBy(function(a){return a.get("intent-id")}))},t=function(a){typeof a==="function"||g(0);return function(b,c){i.isMap(c)&&i.isMap(b)||g(0);var d=c.get(o);c=(b.get(d)||i()).mergeWith(a,c);c=s(c);return b.set(d,c)}},u=b("Reflux").createStore({init:function(){this.data=i(),this.updatedAt=Date.now(),this.listenTo(b("OzActions").updateThreads,this._onUpdateThreads),this.listenTo(b("OzActions").maybeUpdateThreads,this._onMaybeUpdateThreads),this.listenTo(b("OzActions").clearReassignState,this._onClearReassignState),this.listenTo(b("OzActions").deleteTask,this._onDeleteTask)},getInitialState:function(){return this.data},_onUpdateThreads:function(a){h.isList(a)||g(0),this.data=this.data.withMutations(function(b){return a.reduce(t(r),b)}),this.updatedAt=Date.now(),this.trigger(this.data)},_onMaybeUpdateThreads:function(a){__p&&__p();h.isList(a)||g(0);var c=a.filter(function(a){return this.data.has(a.get(o))}.bind(this));if(c.isEmpty()){b("OzHelpers").debug("[threads] not updating partial threads");return}this.data=this.data.withMutations(function(a){return c.reduce(t(r),a)});this.updatedAt=Date.now();this.trigger(this.data)},_onClearReassignState:function(){this.data=this.data.map(function(a){return a.get("ui-reassign")?a["delete"]("ui-reassign"):a}),this.trigger(this.data)},_onDeleteTask:function(a,b){this.data=this.data.updateIn([a,"tasks"],function(a){return a.filterNot(function(a){return a.get("id")===b})}),this.trigger(this.data)},metrics:function(){return i({threadCount:this.data.count(),taskCount:this.data.reduce(function(a,b){return b.get("tasks",h()).count()+a},0)})}}),v=b("Reflux").createStore({init:function(){this.data=this._make(null,null),this.listenTo(b("OzActions").showDialog,this._onShowDialog),this.listenTo(b("OzActions").hideDialog,this._onHideDialog)},getInitialState:function(){return this.data},_make:function(a,b){return{dialogClass:a,dialogProps:b}},_onShowDialog:function(a,b){this.data=this._make(a,b),this.trigger(this.data)},_onHideDialog:function(){this.data=this._make(null,null),this.trigger(this.data)}}),w=b("Reflux").createStore({init:function(){this.data=i(),this.listenTo(b("OzActions").updateMerchants,this._onUpdateMerchants),this.listenTo(b("OzActions").deleteMerchants,this._onDeleteMerchants)},getInitialState:function(){return this.data},_onUpdateMerchants:function(a){h.isList(a)||g(0),this.data=this.data.withMutations(function(b){return a.reduce(function(a,b){var c=b.get("id");b=a.get(c,i()).merge(b);return a.set(c,b)},b)}),b("OzHelpers").debug("[oz] updated merchants",this.data.toJS()),this.trigger(this.data)},_onDeleteMerchants:function(a){h.isList(a)||g(0),this.data=a.reduce(function(a,b){return a["delete"](b)},this.data),b("OzHelpers").debug("[oz] deleted merchants",this.data.toJS()),this.trigger(this.data)},metrics:function(){return i({merchantCount:this.data.count()})}}),x=b("Reflux").createStore({init:function(){this.data=i(),this.listenTo(b("OzActions").updateReps,this._onUpdateReps),this.listenTo(b("OzActions").replaceReps,this._onReplaceReps)},getInitialState:function(){return this.data},_onReplaceReps:function(a){this.data=i().withMutations(function(b){a.reduce(function(a,b){return a.set(b.get("fbid"),b)},b)}),this.trigger(this.data)},_onUpdateReps:function(a){this.data=this.data.withMutations(function(b){return a.reduce(function(a,b){return a.mergeIn([b.get("fbid")],b)},b)}),this.trigger(this.data)},metrics:function(){return i({repCount:this.data.count()})}}),y=b("Reflux").createStore({init:function(){this.data=i(),this.listenTo(b("OzActions").replaceHumans,this._onReplace)},getInitialState:function(){return this.data},_onReplace:function(a){this.data=a,this.trigger(this.data)},metrics:function(){return i({humanCount:this.data.count()})}}),z=b("Reflux").createStore({init:function(){this.data=i({queue:i({showTags:l(),hideTags:l()}),all:i({showTags:l(),hideTags:l()})}),this.listenTo(b("OzActions").updateQueueFilters,this._onUpdateFilters)},getInitialState:function(){return this.data},_onUpdateFilters:function(a){this.data=this.data.merge(a),this.trigger(this.data)}}),A=b("Reflux").createStore({init:function(){this._data=i(),this.listenTo(b("OzActions").sendMessageStart,this._onShiftSending.bind(this,1)),this.listenTo(b("OzActions").sendMessageFinish,this._onShiftSending.bind(this,-1))},getInitialState:function(){return this._data},_onShiftSending:function(a,b){this._data=this._data.update(b,function(b){return(b||0)+a}),this.trigger(this._data)}}),B=b("Reflux").createStore({init:function(){this.data=i({byIntent:i(),byThread:i(),byId:i()}),this.listenTo(b("OzActions").addHandledEvents,this._onAddHandledEvents)},getInitialState:function(){return this.data},_onAddHandledEvents:function(a){this.data=this.data.withMutations(function(b){a.reduce(function(a,b){return a.setIn(["byIntent",b.get("intent-id"),b.get("id")],b).setIn(["byId",b.get("id")],b)},b)}),this.trigger(this.data)},metrics:function(){return i({handledEventCount:this.data.get("byId").count()})}}),C=b("Reflux").createStore({init:function(){this.data=i({offsetMs:0}),this.listenTo(b("OzActions").updateServerOffset,this._onUpdateServerOffset)},getInitialState:function(){return this.offsetMs},_onUpdateServerOffset:function(a){a=a.offsetMs;this.data=this.data.set("offsetMs",a);this.trigger(this.data)}}),D=i({state:"loading",error:null,result:null,skip:!1}),E=b("Reflux").createStore({init:function(){this.data=i({skywalker:D,init:D,"wit-intents":D,merchants:D,humans:D,requirements:D}),this.listenTo(b("OzActions").updateLoadingState,this._onUpdateLoadingState)},getInitialState:function(){return this.data},_onUpdateLoadingState:function(a){var c=a.component,d=a.state,e=a.error,f=a.result;a=a.skip;b("OzHelpers").info("[store/loading] "+d+" "+c);this.data.has(c)||b("OzHelpers").warn("[store/loading] "+c+" wasn't listed in LoadingStore.init");this.data=this.data.set(c,i({state:d,error:e,result:f,skip:a}));this.trigger(this.data)}}),F=b("Reflux").createStore({init:function(){this.data=i(),this.listenTo(b("OzActions").updateCalendarEvents,this._onUpdateCalendarEvents)},getInitialState:function(){return this.data},_onUpdateCalendarEvents:function(a){var b=a.tid;a=a.calendarEvents;a=a&&a.sort?a:[];this.data=this.data.set(b,a.sort(function(a,b){a=new Date(a.startDate);b=new Date(b.startDate);return a.getTime()-b.getTime()}));this.trigger(this.data)},metrics:function(){return i({calendarEventCount:this.data.count()})}}),G=b("Reflux").createStore({init:function(){this.data=i({isStalled:!1}),this.listenTo(b("OzActions").skywalkerMessage,this._onSkywalkerMessage),this.listenTo(b("OzActions").skywalkerStalled,this._onSkywalkerStalled)},getInitialState:function(){return this.data},_onSkywalkerMessage:function(a){a=a.timestamp;this.data=this.data.set("last-receive-ts",a).set("isStalled",!1);this.trigger(this.data)},_onSkywalkerStalled:function(){this.data=this.data.set("isStalled",!0),this.trigger(this.data)}});e.exports={ActiveThreadStore:n,BubbleStore:c,DialogStore:v,MerchantStore:w,AutopilotStore:d,QueueFilterStore:z,RepStore:x,HumanStore:y,LoadingStore:E,RequirementStore:a,ThreadStore:u,WitIntentStore:f,PendingMessageStateStore:A,HandledEventsStore:B,ServerOffsetStore:C,CalendarEventStore:F,SkywalkerStore:G}}),null);
__d("OzAJAX",["invariant","Promise","OzConfig","OzHelpers","OzNotify","URI"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h={metrics:{pendingCount:0,requestCount:0,failedCount:0,totalRequestMs:0,averageRequestMs:0},updateMetricsStart:function(){h.metrics.pendingCount+=1},updateMetricsEnd:function(a,b){var c=h.metrics;c.pendingCount-=1;(!a.status||a.status===0||a.status>399)&&(c.failedCount+=1);c.requestCount+=1;c.totalRequestMs+=b;c.averageRequestMs=Math.round(c.totalRequestMs/c.requestCount)},ajax:function(a){__p&&__p();var b=a.type,c=a.headers,d=a.params,e=a.body;a=a.url;d=j(d);var f={type:b,url:a,headers:c,params:d,body:e};h.updateMetricsStart();var g=Date.now();return i(f).then(function(a){h.updateMetricsEnd(a,Date.now()-g);return JSON.parse(a.responseText)},function(a){h.updateMetricsEnd(a,Date.now()-g);var b=void 0;try{b=JSON.parse(a.responseText)}catch(a){}k(b||{},a,f);throw b||a})},beacon:function(a){window.navigator&&window.navigator.sendBeacon||g(0);var c=a.params,d=a.body;a=a.url;c=j(c);return window.navigator.sendBeacon(new(b("URI"))(a).addQueryData(c).toString(),new Blob([d],{type:"application/json"}))},buildURI:function(){var a=b("OzConfig").getStaticConfig("API_PATH");a||g(0);for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return[a].concat(d).join("/")}};function i(a){__p&&__p();var c=a.type,d=a.headers,e=a.params,f=a.body,g=a.url;return new(b("Promise"))(function(a,h){__p&&__p();var i=new XMLHttpRequest(),j=new(b("URI"))(g);e&&j.addQueryData(e);i.timeout=1e3*60*3;i.open(c,j.toString(),!0);if(d)for(var j=Object.keys(d),k=Array.isArray(j),l=0,j=k?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var m;if(k){if(l>=j.length)break;m=j[l++]}else{l=j.next();if(l.done)break;m=l.value}m=m;i.setRequestHeader(m,d[m])}i.onreadystatechange=function(){if(i.readyState!==4)return;i.status===200?a(i):h(i)};i.send(f)})}function j(a){b("OzConfig").getStaticConfig("authToken")||g(0);b("OzConfig").getStaticConfig("uid")||g(0);b("OzConfig").getStaticConfig("API_VERSION")||g(0);return babelHelpers["extends"]({xs:b("OzConfig").getStaticConfig("authToken"),c_user:b("OzConfig").getStaticConfig("uid"),rep_name:b("OzConfig").getStaticConfig("fullName"),v:b("OzConfig").getStaticConfig("API_VERSION")},a)}function k(a,c,d){b("OzHelpers").error("[oz-api] backend rejected",a,c,d);d=a.error||"Something went wrong, the team has been notified already.";a.info?b("OzNotify").info(d):c.status===400?b("OzNotify").warn(d):c.status===0?b("OzNotify").error("Something went wrong. If this continues, please contact the Wit oncall"):b("OzNotify").error(d)}e.exports=h}),null);
__d("OzDateTimePicker.react",["cssVar","cx","AbstractDateTimePicker.react","AdsTimezone","Arbiter","BUIDatePicker.react","BUITimeInput.react","DatePickerRestraints","immutable","LocalDateTime","OzConfig","OzHelpers","React","ReactComponentWithPureRenderMixin","ReactDOM","Reflux","SUIAudiencePlatformTheme","SUITheme","SUITimeZoneSelector.react","Timezone","XUIError.react","joinClasses"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i;a=b("React").PropTypes;c=b("immutable").Map;d=b("React").createClass({displayName:"OzDateTimePicker",mixins:[b("ReactComponentWithPureRenderMixin"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:babelHelpers["extends"]({dateRestraints:a.arrayOf(a.func),disabled:a.bool,height:a.oneOf(["short","tall"]),layout:a.oneOf(["one-line","two-line","three-line"]),onChange:a.func.isRequired,showTimezoneName:a.bool,timestamp:a.number,timezone:a.string,showTimezoneSelector:a.bool},b("XUIError.react").PropTypes),getDefaultProps:function(){return{dateRestraints:p(),disabled:!1,height:"short",layout:"one-line",showTimezoneName:!0,showTimezoneSelector:!0,timezone:l()}},render:function(){__p&&__p();var a=this.props,c=a.className;a.dateRestraints;var d=a.disabled,e=a.height,f=a.layout;a.onChange;var g=a.showTimezoneName,h=a.showTimezoneSelector,i=a.timestamp,k=a.timezone,l=a.xuiError,m=a.xuiErrorAlignh,n=a.xuiErrorPosition;a=babelHelpers.objectWithoutProperties(a,["className","dateRestraints","disabled","height","layout","onChange","showTimezoneName","showTimezoneSelector","timestamp","timezone","xuiError","xuiErrorAlignh","xuiErrorPosition"]);l={xuiError:l,xuiErrorAlignh:m,xuiErrorPosition:n};var p=o(k),r=j(i,p);m=b("joinClasses")("_3hma"+(d?" _3hmb":""),c);n=f==="two-line"&&g&&202||!g&&110||"auto";k=h?b("React").createElement(q,{style:!i&&{display:"none"},className:"_3hmo"+(f==="one-line"?" _3hmm":"")+(f!=="one-line"?" _3hmn":""),isDisabled:d,onChange:function(a){return this._handleChange(r,a.get("timeZoneId"))}.bind(this),shouldShowSubtitleInSelector:g,value:b("SUITimeZoneSelector.react").VALUE({timeZoneId:p}),width:n}):null;return b("React").createElement(b("XUIError.react"),l,b("React").createElement("div",{className:m},b("React").createElement(b("AbstractDateTimePicker.react"),babelHelpers["extends"]({},a,{className:"_3hmc",classNames:{innerWrapper:"_3hmd"},datePicker:b("React").createElement(b("BUIDatePicker.react"),{className:"_3hme",dateRestraints:this._dateRestraints(p),height:e,placeholder:"mm/dd/yyyy"}),disabled:d,onChange:function(a){return this._handleChange(a,p)}.bind(this),timeInput:b("React").createElement(b("BUITimeInput.react"),{className:"_3hml"+(f!=="three-line"?" _3hmm":"")+(f==="three-line"?" _3hmn":""),height:e}),timezoneID:p,value:r})),k))},_handleChange:function(a,b){a=k(a,b);b=m(b);this.props.onChange({timestamp:a,timezone:b})},_dateRestraints:function(a){return this.props.dateRestraints&&this.props.dateRestraints.map(function(b){return function(c){return b(c&&c.toDateTime(a).toDate())}})}});function j(a,c){try{if(a&&c!=null)return b("LocalDateTime").fromInstant(Math.round(a/1e3),c);else return null}catch(d){b("OzHelpers").warn("[dateTimePicker] cannot convert to LocalDateTime",a,c,d);return null}}function k(a,c){try{if(a&&c!=null){var d=a.toInstant(c)*1e3;d=d-d%6e4;return d}else return null}catch(d){b("OzHelpers").warn("[dateTimePicker] cannot convert from LocalDateTime",a,c,d);return null}}function l(){var a=b("Timezone").getEnvironmentTimezoneID();a==null&&b("OzHelpers").warn("[dateTimePicker] could not get environment time zone");return m(a)}function m(a){var c=b("AdsTimezone").names[a];c==null&&b("OzHelpers").warn("[dateTimePicker] unknown timezone id",a);return c}var n=c(b("AdsTimezone").names.map(function(a,b){return[a,b]}));function o(a){var c=n.get(a);c===undefined&&b("OzHelpers").warn("[timezoneIDForName] unrecognized timezone",a);return c||n.get("America/Los_Angeles")}function p(){var a=new Date();a=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()));var c=new Date(+a),d=new Date(+a);c.setFullYear(a.getFullYear()-5);d.setFullYear(a.getFullYear()+5);return[b("DatePickerRestraints").enforceDateIsNoEarlierThan(c),b("DatePickerRestraints").enforceDateIsNoLaterThan(d)]}i=babelHelpers.inherits(q,b("React").PureComponent);i&&i.prototype;q.prototype.componentDidMount=function(){"use strict";b("ReactDOM").findDOMNode(this.refs.timezoneSelector).addEventListener("focusout",function(a){return window.setTimeout(function(a){return b("Arbiter").inform("reflow")})})};q.prototype.render=function(){"use strict";return b("React").createElement(b("SUITimeZoneSelector.react"),babelHelpers["extends"]({},this.props,{ref:"timezoneSelector",theme:b("SUIAudiencePlatformTheme")}))};function q(){"use strict";i.apply(this,arguments)}d.timezoneIDForName=o;e.exports=d}),null);
__d("MediaEffectMetadataScheduleDatePicker.react",["cx","fbt","DateConsts","DatePickerRestraints","DateTime","Grid.react","Link.react","MediaEffectMetadataValidationUtils","OzDateTimePicker.react","React","XUICloseButton.react","XUIText.react","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("Grid.react").GridItem;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$2=function(a){var b=a&&a.timezone;!a||!a.timestamp?this.props.onEndTimeChange(null,b):this.props.onEndTimeChange(new Date(a.timestamp),b)}.bind(this),this.$3=function(a){var b=a&&a.timezone;!a||!a.timestamp?this.props.onStartTimeChange(null,b):this.props.onStartTimeChange(new Date(a.timestamp),b)}.bind(this),this.$4=function(){if(!this.props.startTime)return;var a=new Date(this.props.startTime);a.setDate(a.getDate()+b("DateConsts").DAYS_PER_WEEK);this.props.onEndTimeChange(a,this.props.timezone)}.bind(this),this.$5=function(){this.props.onEndTimeChange(null,this.props.timezone)}.bind(this),c}a.prototype.$1=function(){var a=this.props,c=a.startTime;a=a.endTime;c=b("MediaEffectMetadataValidationUtils").validateTimeRange(c,a);return!c?h._("Time range is invalid."):null};a.prototype.render=function(){__p&&__p();var a=this.props.startTime||new Date(),c=b("OzDateTimePicker.react").timezoneIDForName(this.props.timezone),d=[b("DatePickerRestraints").enforceDateIsNoEarlierThan(b("DateTime").now(c).startOfDay().toDate())],e=null;if(this.props.endTime){var f=this.props.endTime,g=new(b("DateTime"))(f/1e3,c);d.push(b("DatePickerRestraints").enforceDateIsNoLaterThan(g.endOfDay().toDate()));g=new(b("DateTime"))(a/1e3,c);e=b("React").createElement(b("OzDateTimePicker.react"),{dateRestraints:[b("DatePickerRestraints").enforceDateIsNoEarlierThan(g.startOfDay().toDate())],disabled:this.props.disabled,height:"tall",layout:"two-line",onChange:this.$2,showTimezoneSelector:!1,timestamp:f.getTime(),timezone:this.props.timezone,xuiError:this.$1()})}else e=this.props.disabled?h._("Not specified"):b("React").createElement(b("Link.react"),{onClick:this.$4},h._("add an end date"));c="_9vd";return b("React").createElement(b("Grid.react"),{alignv:"middle",className:"_3-8m",cols:3},b("React").createElement(j,null,b("React").createElement(b("XUIText.react"),null,h._("Start"))),b("React").createElement(j,null,b("React").createElement("div",{className:b("joinClasses")(c,"_3-8h _2pir")},b("React").createElement(b("OzDateTimePicker.react"),{dateRestraints:d,disabled:this.props.disabled,height:"tall",layout:"two-line",onChange:this.$3,timestamp:a.getTime(),timezone:this.props.timezone}))),b("React").createElement(j,null),b("React").createElement(j,null,b("React").createElement(b("XUIText.react"),null,h._("End"))),b("React").createElement(j,null,b("React").createElement("div",{className:b("joinClasses")(c,"_3-8h _2pir")},e)),b("React").createElement(j,null,this.props.endTime&&!this.props.disabled?b("React").createElement(b("XUICloseButton.react"),{className:"_3-9a",onClick:this.$5,size:"small"}):null))};e.exports=a}),null);
__d("MediaEffectMetadataSchedule.react",["cx","fbt","MediaEffectEditorFunnelLogger","MediaEffectMetadataScheduleDatePicker.react","MediaEffectProfilePolicy","React","XUIRadioList.react","MediaEffectCard.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("XUIRadioList.react").Item;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=function(a){a==="no_constraint"?this.props.onDateRangeChange(null,null,null):this.props.onDateRangeChange(new Date(),null,null)}.bind(this),this.$4=function(a,c){var d=this.props.startTime;b("MediaEffectEditorFunnelLogger").logChangeEndTime();this.props.onDateRangeChange(d,a,c)}.bind(this),this.$5=function(a,c){var d=this.props.endTime;b("MediaEffectEditorFunnelLogger").logChangeStartTime();this.props.onDateRangeChange(a,d,c)}.bind(this),c}a.prototype.$2=function(){if(this.props.startTime||this.props.endTime)return"specified";else return"no_constraint"};a.prototype.$3=function(){return this.$2()!=="specified"?null:b("React").createElement("div",{className:"_2pis"},b("React").createElement(b("MediaEffectMetadataScheduleDatePicker.react"),babelHelpers["extends"]({onEndTimeChange:this.$4,onStartTimeChange:this.$5},this.props)))};a.prototype.render=function(){var a=!this.props.owner||this.props.owner.policies.includes(b("MediaEffectProfilePolicy").USE_TRAILING_REVIEW)?h._("Make active right away"):h._("Make active once approved");return b("React").createElement(b("MediaEffectCard.react"),{className:"_64q4",title:h._("Schedule"),tooltip:h._("Choose whether your effect will be available for people to use immediately once it's approved or only between specific dates.")},b("React").createElement(b("XUIRadioList.react"),{disabled:this.props.disabled,onValueChange:this.$1,selectedValue:this.$2()},b("React").createElement(j,{disabled:this.props.disabled,value:"no_constraint"},a),b("React").createElement(j,{disabled:this.props.disabled,value:"specified"},h._("Set a start and end date"))),this.$3())};a.propTypes={endTime:c.oneOfType([c.oneOf([null]),c.instanceOf(Date)]),onDateRangeChange:c.func.isRequired,startTime:c.oneOfType([c.oneOf([null]),c.instanceOf(Date)]),timezone:c.string};e.exports=a}),null);
__d("MediaEffectMetadataRecord",["FXEntMediaEffectSubmissionStatus","immutable","React"],(function(a,b,c,d,e,f){"use strict";var g;c=b("immutable").Record;g=babelHelpers.inherits(a,c({adsTargetingSpec:"{age_min: 13, age_max: 65}",attributedOwnerID:null,captureModes:[],connectAppID:null,effectHasText:!1,endTime:null,fbBoosted:!1,fbCatalogGKs:[],fbEligibilityGKs:[],fbExperimentID:null,fbOnlyMediaRestriction:!1,fbOnlySection:null,fbPageLiked:null,fbRankWeight:null,fbWhitelistCheckEligibility:!1,fbWhitelistedUsers:[],gatelogic:null,hasFrameNameError:!1,humanReadableDescription:null,id:null,igCameraFormat:null,inspirationCategoryNames:[],locales:[],location:null,locationPageID:null,locationTarget:"everyone",name:null,offlineOnly:!1,placeDescription:null,productionVerification:!1,productVisibilityPolicy:null,rejectReasons:null,saveAsDraft:!1,selectedCategoryID:null,selectedInstagramAttributionID:null,selectedInstructionID:null,selectedOwnerID:null,selectedTemplateCategoryID:null,selfBirthday:!1,sourceTemplateID:null,startTime:null,submissionStatus:b("FXEntMediaEffectSubmissionStatus").DRAFT,tags:[],thumbnail:null,thumbnailURI:null,timezone:null,timingSchedule:null,use_owner_selector:!0}));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectMetadataStore",["FluxReduceStore","LocationConstants","MediaEffectFlowType","MediaEffectFrameCreateDialogDataStore","MediaEffectFrameEditorDispatcher","MediaEffectMaskUploadDataStore","MediaEffectMetadataRecord","MediaEffectMetadataValidationUtils","MediaEffectMetadataViewStore","MediaEffectPlaceDescriptionRecord"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("FluxReduceStore"));g&&g.prototype;a.prototype.getInitialState=function(){return new(b("MediaEffectMetadataRecord"))()};a.prototype.reduce=function(a,c){__p&&__p();var d=void 0,e=void 0,f=void 0,g=void 0;switch(c.type){case"add/tag":d=a.get("tags");d.push(c.data);a=a.set("tags",d);break;case"apply/template":a=a.set("sourceTemplateID",c.templateFBID);break;case"clear/template":a=a.set("sourceTemplateID",null);break;case"remove/tag":var h=c.data;d=a.get("tags");d=d.filter(function(a){return a.uniqueID!==h.uniqueID&&a.title!==h.title});a=a.set("tags",d);break;case"add/fbWhitelistedUser":e=a.get("fbWhitelistedUsers");e.push(c.data);a=a.set("fbWhitelistedUsers",e);break;case"remove/fbWhitelistedUser":var i=c.data;e=a.get("fbWhitelistedUsers");e=e.filter(function(a){return a.uniqueID!==i.uniqueID&&a.name!==i.name});a=a.set("fbWhitelistedUsers",e);break;case"save/draft":a=a.set("saveAsDraft",!0);break;case"select/instruction":a=a.set("selectedInstructionID",c.instructionID);break;case"update/category":a=a.set("selectedCategoryID",c.value);break;case"change/connectAppID":a=this.getState().set("connectAppID",c.appID);break;case"update/effectID":a=this.getState().set("id",c.effectID);break;case"update/fbRankingStrategy":a=a.set("fbBoosted",c.value==="BOOST");c.value!=="MANUAL"&&(a=a.set("fbRankWeight",null));break;case"update/fbRankWeight":a=a.set("fbRankWeight",c.value);break;case"update/fbWhitelistCheckEligibility":a=a.set("fbWhitelistCheckEligibility",c.value);break;case"update/fbCatalogGKs":a=a.set("fbCatalogGKs",c.value);break;case"update/fbEligibilityGKs":a=a.set("fbEligibilityGKs",c.value);break;case"update/fbOnlyMediaRestriction":a=a.set("fbOnlyMediaRestriction",c.value);break;case"update/fbPageLiked":a=a.set("fbPageLiked",c.value);break;case"update/gatelogic":a=a.set("gatelogic",c.value);break;case"update/igCameraFormat":a=a.set("igCameraFormat",c.value);break;case"update/locales":a=a.set("locales",c.value);break;case"update/locationPageID":a=a.set("locationPageID",c.value);c.value===null&&(a=a.set("placeDescription",null));break;case"update/location":a=a.set("location",c.value);break;case"update/locationTarget":a=a.set("locationTarget",c.value);break;case"update/name":a=a.set("name",c.value);break;case"update/offlineOnly":a=a.set("offlineOnly",c.value);break;case"update/productVisibilityPolicy":a=a.set("productVisibilityPolicy",c.value);break;case"update/selectedInstagramAttributionID":a=a.set("selectedInstagramAttributionID",c.value);break;case"update/selectedOwnerID":a=a.set("selectedOwnerID",c.value);break;case"update/selfBirthday":a=a.set("selfBirthday",c.value);break;case"update/thumbnail":a=a.set("thumbnail",c.thumbnail);break;case"update/timingSchedule":a=a.set("timingSchedule",c.value);break;case"update/adsTargetingSpec":a=a.set("adsTargetingSpec",c.adsTargetingSpec);break;case"update/scheduleRange":a=a.set("startTime",c.startTime).set("endTime",c.endTime).set("timezone",c.timezone);break;case"update/nameValidation":a=a.set("hasFrameNameError",c.isError);break;case"init/effectMetadata":d=Object.assign({},c.data.activationJSData);d=Object.assign(d,c.data.metadataJSData);d.startTime&&(d.startTime=new Date(d.startTime*1e3));d.endTime&&(d.endTime=new Date(d.endTime*1e3));d.locationPageID&&(d.locationTarget="targeted");d.location&&(d.locationTarget="targeted",d.location.distance_unit=b("LocationConstants").KILOMETER_UNIT,d.location=new(b("MediaEffectPlaceDescriptionRecord"))(d.location));a=new(b("MediaEffectMetadataRecord"))(d);break;case"update/effectHasText":a=a.set("effectHasText",c.value);break;case"update/humanReadableDescription":a=a.set("humanReadableDescription",c.value);break;case"update/productionVerification":a=a.set("productionVerification",c.value);break;case"set/placeDescription":a=a.set("placeDescription",c.placeDescription);break;case"select/templateCategoryID":a=a.set("selectedTemplateCategoryID",c.value);break;case"select/attributedOwnerID":a=a.set("attributedOwnerID",c.value);break;case"remove/inspirationCategoryNames":f=c.value;g=a.get("inspirationCategoryNames");g=g.filter(function(a){return a!==f});a=a.set("inspirationCategoryNames",g);break;case"add/inspirationCategoryNames":f=c.value;g=a.get("inspirationCategoryNames");g.push(f);a=a.set("inspirationCategoryNames",g);break;case"update/setUseOwnerSelector":a=a.set("use_owner_selector",c.value);break;case"remove/captureMode":f=c.value;g=a.get("captureModes");g=g.filter(function(a){return a!==f});a=a.set("captureModes",g);break;case"add/captureMode":f=c.value;g=a.get("captureModes");g.push(f);a=a.set("captureModes",g);break;case"update/fbOnlySection":a=a.set("fbOnlySection",c.section);break}return a};a.prototype.getUseOwnerSelector=function(){return this.getState().get("use_owner_selector")};a.prototype.hasEffectID=function(){return this.getState().get("id")!==null};a.prototype.getRequestData=function(a){__p&&__p();var c=this.getState(),d=c.get("selectedOwnerID"),e=c.get("location");e=e?{page_id:e.key||undefined,location:e.manual_geo?{latitude:e.latitude,longitude:e.longitude,radius_km:e.radius}:undefined,constrain_eligibility:!!e.constrain_eligibility}:undefined;d={connected_app_id:c.get("connectAppID"),effect_description:b("MediaEffectMaskUploadDataStore").getState().effectDescription,end_time:c.get("endTime")?Math.floor(c.get("endTime").getTime()/1e3):undefined,flow_type:b("MediaEffectFrameCreateDialogDataStore").getState().flowType,media_effect_category:c.get("selectedCategoryID"),media_effect_owner:d,media_effect_save_as_draft:c.get("saveAsDraft"),media_effect_tags:c.get("tags").map(function(a){return a.title}),name:c.get("name"),start_time:c.get("startTime")?Math.floor(c.get("startTime").getTime()/1e3):undefined,source_template_id:c.get("sourceTemplateID"),targeting_place_page:c.get("locationPageID"),targeting_place:e,timezone:c.get("timezone")};if(!a)return d;e=c.get("selectedTemplateCategoryID");e!==null?e=[e]:e=[];d=Object.assign(d,{fb_catalog_gks:c.get("fbCatalogGKs").length>0?c.get("fbCatalogGKs"):undefined,fb_eligibility_gks:c.get("fbEligibilityGKs").length>0?c.get("fbEligibilityGKs"):undefined,fb_only_media_restriction:c.get("fbOnlyMediaRestriction"),fb_page_liked:c.get("fbPageLiked")||undefined,fb_ranking_boosted:c.get("fbBoosted"),fb_ranking_weight:c.get("fbRankWeight"),fb_whitelisted_user_ids:c.get("fbWhitelistedUsers").map(function(a){return a.uniqueID}),fb_whitelist_check_eligibility:c.get("fbWhitelistCheckEligibility"),gatelogic:c.get("gatelogic"),has_text:c.get("effectHasText"),human_readable_description:c.get("humanReadableDescription"),ig_camera_format:c.get("igCameraFormat"),locales:c.get("locales"),meida_effect_instruction:c.get("selectedInstructionID"),media_effect_template_categories:e,offline_only:!!c.get("offlineOnly"),product_visibility_policy:c.get("productVisibilityPolicy"),self_birthday:!!c.get("selfBirthday"),timing_schedule:c.get("timingSchedule"),thumbnail:c.get("thumbnail"),ads_targeting_spec:c.get("adsTargetingSpec"),inspiration_category_names:c.get("inspirationCategoryNames"),capture_modes:c.get("captureModes"),instagram_attribution_id:c.get("selectedInstagramAttributionID")});a=c.get("attributedOwnerID");a!==null?d.attributed_owner=a:delete d.attributed_owner;return d};a.prototype.isBasicMetadataValid=function(){var a=this.getState(),c=b("MediaEffectFrameCreateDialogDataStore").getState().flowType===b("MediaEffectFlowType").TEMPLATE;if(a.get("hasFrameNameError"))return!1;if(!b("MediaEffectMetadataValidationUtils").validateTimeRange(a.get("startTime"),a.get("endTime")))return!1;if(a.get("locationTarget")==="targeted"&&!b("MediaEffectMetadataValidationUtils").validateLocationPageID(a.get("locationPageID"))&&!b("MediaEffectMetadataValidationUtils").validateLocation(a.get("location")))return!1;return c&&a.selectedTemplateCategoryID===null?!1:!0};a.prototype.isOwnerValid=function(){__p&&__p();var a=this.getState(),c=a.get("selectedOwnerID"),d=!a.get("id");if(!b("MediaEffectMetadataValidationUtils").validateOwnerID(c))return!1;if(d){d=a.get("productionVerification");a=b("MediaEffectMetadataViewStore").getOwner(c);if(a&&a.isProductionFirstParty&&!d)return!1}return!0};a.prototype.isNameValid=function(){return b("MediaEffectMetadataValidationUtils").validateName(this.getState().get("name"))};a.prototype.isAllMetadataValid=function(){if(!this.isNameValid())return!1;return!this.isOwnerValid()?!1:this.isBasicMetadataValid()};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("MediaEffectFrameEditorDispatcher"))}),null);
__d("XMediaEffectTagsDataSourceController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/media_effect/datasource/tags/",{is_featured:{type:"Bool",defaultValue:!1},value:{type:"String"}})}),null);
__d("MediaEffectMetadataTagsTypeahead.react",["fbt","MediaEffectEditorFunnelLogger","React","SearchableEntry","WebAsyncSearchSource","XMediaEffectTagsDataSourceController","XUITokenizer.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;var i=10;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;a.prototype.componentDidUpdate=function(){this.state.resetQueryString&&this.setState({resetQueryString:!1})};function a(a){h.constructor.call(this,a),this.searchSource=new(b("WebAsyncSearchSource"))({queryRequests:[{uri:b("XMediaEffectTagsDataSourceController").getURIBuilder().setBool("is_featured",!1).getURI()}]}),this.state={resetQueryString:!1}}a.prototype.render=function(){return b("React").createElement(b("XUITokenizer.react"),{disabled:this.props.disabled,entries:this.props.tags.map(function(a){return new(b("SearchableEntry"))({title:a.title,uniqueID:a.uniqueID||a.title})}),limit:i,onAddEntryAttempt:this.$1.bind(this),onEnterWithoutSelection:this.$2.bind(this),onRemoveEntryAttempt:this.$3.bind(this),placeholder:g._("Add up to 10 keywords"),queryString:this.state.resetQueryString?"":undefined,searchSource:this.searchSource,tokenizeQueryStringOnBlur:this.$2.bind(this)})};a.prototype.$1=function(a){__p&&__p();this.$2();if(this.props.tags.length>=i)return;var b=a.getTitle();if(!b||!b.length)return;var c=this.props.tags.map(function(a){return a.title});if(c.includes(b))return;c=a.getUniqueID();this.$4();this.props.onAddTag({uniqueID:c,title:b})};a.prototype.$3=function(a){this.$2();var b=a.getUniqueID();a=a.getTitle();this.$4();this.props.onRemoveTag({uniqueID:b,title:a})};a.prototype.$2=function(){this.setState({resetQueryString:!0})};a.prototype.$4=function(){b("MediaEffectEditorFunnelLogger").logChangeTag()};a.propTypes={disabled:c.bool,tags:c.array,onAddTag:c.func.isRequired,onRemoveTag:c.func.isRequired};a.defaultProps={tags:[]};e.exports=a}),null);
__d("MediaEffectProfileOwnerTile.react",["cx","ProfileTile.react","React"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){a=a.owner;return!a?null:b("React").createElement(b("ProfileTile.react"),{id:a.id,imageProps:{className:"_etu"},name:a.name,tileProps:{className:"_etv"},titleProps:{className:"_eu3"}})};e.exports=a}),null);
__d("MediaEffectOwnerByline.react",["MediaEffectEventOwnerBylineTileContainer.react","MediaEffectProfileOwnerTile.react","React"],(function(a,b,c,d,e,f){"use strict";a=function(a){switch(a.owner.type){case"event":return b("React").createElement(b("MediaEffectEventOwnerBylineTileContainer.react"),null);default:return b("React").createElement(b("MediaEffectProfileOwnerTile.react"),{owner:a.owner})}};e.exports=a}),null);
__d("MediaEffectDialogValidationConfigs",["fbt","MediaEffectValidationTypes"],(function(a,b,c,d,e,f,g){"use strict";var h=(c={},c[b("MediaEffectValidationTypes").CANVAS_COVERAGE_LIMIT]={title:g._("Please Review Your Frame"),content:g._("Frames can't cover too much canvas space with opaque pixels.")},c[b("MediaEffectValidationTypes").ASSET_NUMBER_LIMIT]={title:g._("Please Review Your Frame"),content:g._("Please limit the number of images in a frame to no more than 15.")},c);d=[b("MediaEffectValidationTypes").CANVAS_COVERAGE_LIMIT,b("MediaEffectValidationTypes").ASSET_NUMBER_LIMIT];function a(a){return h[a]}e.exports={getContentByType:a,blockingTypes:d}}),null);
__d("MediaEffectValidationStore",["FluxReduceStore","immutable","MediaEffectDialogValidationConfigs","MediaEffectFrameEditorDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("FluxReduceStore"));g&&g.prototype;a.prototype.getInitialState=function(){return b("immutable").Set()};a.prototype.reduce=function(a,c){switch(c.type){case"validation/add":return a.add(c.validation);case"validation/remove":return a.remove(c.validation);case"init/dialog":return b("immutable").Set()}return a};a.prototype.getBlockingValidation=function(){__p&&__p();for(var a=b("MediaEffectDialogValidationConfigs").blockingTypes,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;if(this.getState().has(e))return e}return null};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("MediaEffectFrameEditorDispatcher"))}),null);
__d("MediaEffectValidationDialogContainer.react",["fbt","FluxContainer","MediaEffectDialogValidationConfigs","MediaEffectFrameEditorDispatcher","MediaEffectMetadataActionCreators","MediaEffectValidationStore","React","XUIButton.react","XUIDialog.react","XUIDialogBody.react","XUIDialogFooter.react","XUIDialogTitle.react","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$1=function(){this.state.validationType&&b("MediaEffectMetadataActionCreators").removeValidation(this.state.validationType)}.bind(this),c}a.getStores=function(){return[b("MediaEffectValidationStore")]};a.calculateState=function(){return{validationType:b("MediaEffectValidationStore").getBlockingValidation()}};a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.constructor.getStores())};a.prototype.render=function(){return this.state.validationType?b("React").createElement(b("XUIDialog.react"),{layerHideOnBlur:!1,shown:!0,width:445},b("React").createElement(b("XUIDialogTitle.react"),{showCloseButton:!1},b("MediaEffectDialogValidationConfigs").getContentByType(this.state.validationType).title),b("React").createElement(b("XUIDialogBody.react"),null,b("MediaEffectDialogValidationConfigs").getContentByType(b("nullthrows")(this.state.validationType)).content),b("React").createElement(b("XUIDialogFooter.react"),null,b("React").createElement(b("XUIButton.react"),{label:g._("OK"),onClick:this.$1,use:"confirm"}))):null};e.exports=b("FluxContainer").create(a)}),null);
__d("MediaEffectFrameEditorTemplateGrid.react",["cx","ix","Grid.react","MediaEffectMetadataActionCreators","Image.react","React","ScrollableArea.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=b("Grid.react").GridItem;c=babelHelpers.inherits(l,b("React").PureComponent);i=c&&c.prototype;function l(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=function(){b("MediaEffectMetadataActionCreators").applyTemplate(this.props.template)}.bind(this),c}l.prototype.render=function(){var a=this.props.template?this.props.template.previewURL:h("86677");return b("React").createElement("a",{className:"_2w6x"+(this.props.selected?" _2w6_":"")+" _3-fi"+(this.props.template?"":" _2w70")+" _3-fj",href:"#",onClick:this.$1},b("React").createElement(b("Image.react"),{className:"_2w71",src:a}))};j=babelHelpers.inherits(a,b("React").PureComponent);j&&j.prototype;a.prototype.render=function(){var a=98*this.props.rows+6,c=this.props,d=c.activeTemplate,e=c.showNoTemplate;c=c.templates;return b("React").createElement("div",{className:"_2w72"},b("React").createElement(b("ScrollableArea.react"),{height:a},b("React").createElement("div",{className:"_2w73"},b("React").createElement(b("Grid.react"),{cols:2},e?b("React").createElement(k,null,b("React").createElement(l,{selected:d===null})):null,c.toArray().map(function(a){return b("React").createElement(k,{key:a.templateFBID},b("React").createElement(l,{selected:a===d||d&&d.sourceTemplateFBID&&a.templateFBID===d.sourceTemplateFBID,template:a}))})))))};function a(){j.apply(this,arguments)}a.defaultProps={rows:3,showNoTemplate:!0};e.exports=a}),null);
__d("MediaEffectColorPaletteWheel.react",["cx","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,b("React").PureComponent);h&&h.prototype;j.prototype.render=function(){var a=360*this.props.size,c=Math.max(a,180)-180;a=Math.min(a,180);return b("React").createElement("div",{className:"_3p7c",style:{transform:"rotate("+this.props.offset*360+"deg)"}},b("React").createElement("div",{className:"_3p7f _3p7e"},b("React").createElement("div",{className:"_3p7d",style:{backgroundColor:this.props.color,transform:"translateX(-100%) rotate("+c+"deg)"}})),b("React").createElement("div",{className:"_3p7g _3p7e"},b("React").createElement("div",{className:"_3p7d",style:{backgroundColor:this.props.color,transform:"translateX(-100%) rotate("+a+"deg)"}})))};function j(){h.apply(this,arguments)}c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.$1=function(){this.props.onHover&&this.props.onHover(!0)}.bind(this),this.$2=function(){this.props.onHover&&this.props.onHover(!1)}.bind(this),b}a.prototype.render=function(){var a=this.props.ratio.reduce(function(a,b){return a+b},0),c=this.props.ratio.map(function(b,c){return this.props.ratio.slice(0,c).reduce(function(a,b){return a+b},0)/a}.bind(this)),d=this.props.palette.components.map(function(d,e){return b("React").createElement(j,{color:d.toRGB(),key:e,offset:c[e],size:this.props.ratio[e]/a})}.bind(this));return b("React").createElement("div",{className:"_3p7b",onClick:this.props.onClick,onMouseEnter:this.$1,onMouseLeave:this.$2,role:"presentation",style:{height:this.props.size,width:this.props.size}},d)};a.defaultProps={ratio:[4,3,2,1],size:50};e.exports=a}),null);
__d("MediaEffectFrameEditorTemplatePaletteSelector.react",["cx","MediaEffectColorPaletteWheel.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i;c=babelHelpers.inherits(j,b("React").PureComponent);h=c&&c.prototype;function j(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=function(a){this.props.onPaletteSelect(a?this.props.palette:null)}.bind(this),b}j.prototype.render=function(){return b("React").createElement("div",{className:"_4xob"},b("React").createElement(b("MediaEffectColorPaletteWheel.react"),{onHover:this.$1,palette:this.props.palette}))};i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_4xob"},this.props.colorPalettes.map(function(a,c){return b("React").createElement(j,{key:c,onPaletteSelect:this.props.onPaletteSelect,palette:a})}.bind(this)))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectFrameEditorTemplatePaletteSelectorContainer.react",["FluxContainer","MediaEffectFrameEditorDispatcher","MediaEffectFrameEditorTemplatePaletteSelector.react","MediaEffectTemplateDataStore","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MediaEffectTemplateDataStore")]};a.calculateState=function(a,c,d){return{colorPalettes:b("MediaEffectTemplateDataStore").getState().systemColorPalettes}};a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.constructor.getStores())};a.prototype.render=function(){var a=babelHelpers["extends"]({},this.props,this.state);return b("React").createElement(b("MediaEffectFrameEditorTemplatePaletteSelector.react"),a)};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MediaEffectFrameEditorTemplatePanel.react",["cx","fbt","immutable","MediaEffectFrameEditorBirthdayCelebrationTemplateSelector.react","MediaEffectFrameEditorMultiCategoryTemplateSelector.react","MediaEffectFrameEditorTemplateGrid.react","MediaEffectFrameEditorTemplateVariationPicker.react","React","XUIText.react","mediaEffectGKCheck"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("immutable").List;function k(a){var c=a.templates;return!c||c.size<2||!b("mediaEffectGKCheck")("media_effect_frame_editor_template_variations")?null:b("React").createElement("div",null,b("React").createElement(b("XUIText.react"),{className:"_2dih",display:"block"},h._("Color Palette")),b("React").createElement(b("MediaEffectFrameEditorTemplateVariationPicker.react"),{activeTemplate:a.activeTemplate,templates:c}))}i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.$1=function(a,c){__p&&__p();if(a===1||c<=5){c=this.props.categories.reduce(function(a,b){return a.concat(b)},j());return b("React").createElement(b("MediaEffectFrameEditorTemplateGrid.react"),{activeTemplate:this.props.activeTemplate,templates:c})}if(a===2&&this.props.categories.has("Birthdays")&&this.props.categories.get("Birthdays").size>0&&this.props.categories.has("Celebrations")&&this.props.categories.get("Celebrations").size>0){c=this.props.categories.get("Birthdays");a=this.props.categories.get("Celebrations");return b("React").createElement(b("MediaEffectFrameEditorBirthdayCelebrationTemplateSelector.react"),{activeTemplate:this.props.activeTemplate,birthdayTemplates:c,celebrationTemplates:a})}return b("React").createElement(b("MediaEffectFrameEditorMultiCategoryTemplateSelector.react"),{activeTemplate:this.props.activeTemplate,categories:this.props.categories})};a.prototype.render=function(){var a=this.props,c=a.activeTemplate;a=a.categories;var d=a.count();a=a.reduce(function(a,b){return a+b.size},0);return d===0||a===0?null:b("React").createElement("div",null,b("React").createElement(b("XUIText.react"),{className:"_2dih",display:"block"},h._("Template")),this.$1(d,a),b("React").createElement("div",{className:"_3-8x"},b("React").createElement(k,{activeTemplate:c,templates:this.props.variations})))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectFrameEditorTemplatePanelContainer.react",["FluxContainer","immutable","MediaEffectFrameEditorDispatcher","MediaEffectFrameEditorTemplatePanel.react","MediaEffectReactFrameEditorCanvasDataStore","MediaEffectReactFrameEditorDataStore","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("immutable").List;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MediaEffectReactFrameEditorDataStore"),b("MediaEffectReactFrameEditorCanvasDataStore")]};a.calculateState=function(a,c){a=b("MediaEffectReactFrameEditorDataStore").getState();var d=b("MediaEffectReactFrameEditorCanvasDataStore").getState();return{activeTemplate:d.getTemplate(a.templateFBID),categories:d.templateCategories.map(function(a){return h(a.map(function(a){return d.templates.get(a)}))}),templates:d.templates,variations:d.getTemplateVariants(a.templateFBID)}};a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.constructor.getStores())};a.prototype.render=function(){var a=babelHelpers["extends"]({},this.props,this.state);return b("React").createElement(b("MediaEffectFrameEditorTemplatePanel.react"),a)};function a(){g.apply(this,arguments)}a.defaultProps={};e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MediaEffectFrameEditorTemplateVariationPicker.react",["cx","Grid.react","MediaEffectMetadataActionCreators","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("Grid.react").GridItem;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$1=function(a){return function(){return b("MediaEffectMetadataActionCreators").applyTemplate(a)}},c}a.prototype.render=function(){return b("React").createElement(b("Grid.react"),{cols:5},this.props.templates.map(function(a){return b("React").createElement(i,{key:a.templateFBID},b("React").createElement("a",{className:"_18pf _2w6x"+(a===this.props.activeTemplate?" _2w6_":"")+" _zjf",href:"#",onClick:this.$1(a),style:{backgroundColor:a.getColor()}}))}.bind(this)))};e.exports=a}),null);
__d("MediaEffectFrameEditorTemplatePaletteComponentEditor.react",["cx","Event","FBSimpleSlider.react","React","SubscriptionsHandler","chroma","color-picker"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,b("React").PureComponent);h&&h.prototype;j.prototype.render=function(){return b("React").createElement("div",null,b("React").createElement("span",null,this.props.label),b("React").createElement(b("FBSimpleSlider.react"),{max:1,min:0,onChange:this.props.onChange,onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp,value:this.props.value}))};function j(){h.apply(this,arguments)}c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(a){__p&&__p();i.constructor.call(this,a),this.$4=function(a){var c=this.props.component;if(!c)return;a=b("chroma").hex(a).hsl();isNaN(a[0])&&(a[0]=c.hue);this.props.onComponentChange(c.set("hue",a[0]/360).set("saturation",a[1]).set("lightness",a[2]))}.bind(this),this.$5=function(a){var b=this.props.component;if(!b)return;this.props.onComponentChange(b.set("hueVariation",a/2))}.bind(this),this.$6=function(a){var b=this.props.component;if(!b)return;this.props.onComponentChange(b.set("saturationVariation",a))}.bind(this),this.$7=function(a){var b=this.props.component;if(!b)return;this.props.onComponentChange(b.set("lightnessVariation",a))}.bind(this),this.$8=function(){this.props.onHighlightComponent&&this.props.onHighlightComponent(this.props.componentIndex),this.$2=!0}.bind(this),this.$3=function(){this.$2&&(this.props.onHighlightComponent&&this.props.onHighlightComponent(null),this.$2=!1)}.bind(this),this.$1=new(b("SubscriptionsHandler"))()}a.prototype.UNSAFE_componentWillMount=function(){this.$1.addSubscriptions(b("Event").listen(document.body,"mouseup",this.$3))};a.prototype.componentWillUnmount=function(){this.$1.release()};a.prototype.render=function(){var a=this.props.component;return b("React").createElement("div",{className:"_1m8o"},a?b("React").createElement("div",null,b("React").createElement("div",{className:"_5-nq",onMouseDown:this.$8},b("React").createElement(b("color-picker"),{color:a.toRGB(),onChange:this.$4})),this.props.showVariation?b("React").createElement("div",null,b("React").createElement(j,{label:"Hue Variation",onChange:this.$5,onMouseDown:this.$8,onMouseUp:this.$3,value:a.hueVariation*2}),b("React").createElement(j,{label:"Saturation Variation",onChange:this.$6,onMouseDown:this.$8,onMouseUp:this.$3,value:a.saturationVariation}),b("React").createElement(j,{label:"Lightness Variation",onChange:this.$7,onMouseDown:this.$8,onMouseUp:this.$3,value:a.lightnessVariation})):null):null)};a.defaultProps={showVariation:!0,onHighlightComponent:null};e.exports=a}),null);
__d("MediaEffectFrameEditorTemplatePaletteComponentSelector.react",["cx","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=4;c=babelHelpers.inherits(k,b("React").PureComponent);h=c&&c.prototype;function k(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=function(){this.props.onButtonClick(this.props.index)}.bind(this),this.$2=function(){this.props.onHighlightComponent&&this.props.onHighlightComponent(this.props.index)}.bind(this),this.$3=function(){this.props.onHighlightComponent&&this.props.onHighlightComponent(null)}.bind(this),b}k.prototype.render=function(){return b("React").createElement("a",{className:"_wru _2w6x"+(this.props.selected?" _2w6_":"")+" _3-fi",href:"#",onClick:this.$1,onMouseEnter:this.$2,onMouseLeave:this.$3,style:{backgroundColor:this.props.color}},this.props.index)};i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_2__5"},this.props.colorPalette.components.map(function(a,c){return b("React").createElement(k,{color:a.toRGB(),index:c+1,key:c+1,onButtonClick:this.props.onButtonClick,onHighlightComponent:this.props.onHighlightComponent,selected:this.props.selectedComponentIndex===c+1})}.bind(this)),this.props.onAddComponent&&this.props.colorPalette.components.size<j?b("React").createElement("a",{className:"_wru",href:"#",onClick:this.props.onAddComponent},"+"):null)};function a(){i.apply(this,arguments)}a.defaultProps={onAddComponent:null,onHighlightComponent:null};e.exports=a}),null);
__d("MediaEffectTemplateColorStep.react",["cx","MediaEffectColorPaletteComponentRecord","MediaEffectFrameEditorPixelCanvasContainer.react","MediaEffectFrameEditorTemplatePaletteComponentEditor.react","MediaEffectFrameEditorTemplatePaletteComponentSelector.react","MediaEffectFrameEditorTemplatePaletteSelectorContainer.react","MediaEffectMetadataActionCreators","React","colr-convert"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(a){__p&&__p();h.constructor.call(this,a),this.$1=[],this.$2=function(a){if(a[3]===0)return;this.$1.push(a);this.state.selectedComponentIndex&&b("MediaEffectMetadataActionCreators").setTemplateSourceColorPalette(this.props.colorPalette.set("components",this.props.colorPalette.components.set(this.state.selectedComponentIndex-1,this.$3())))}.bind(this),this.$4=function(){this.$1=[]}.bind(this),this.$5=function(a){this.setState({selectedComponentIndex:a})}.bind(this),this.$6=function(){var a=this.props.colorPalette.set("components",this.props.colorPalette.components.push(new(b("MediaEffectColorPaletteComponentRecord"))()));b("MediaEffectMetadataActionCreators").setTemplateSourceColorPalette(a);this.setState({selectedComponentIndex:a.components.size})}.bind(this),this.$7=function(a){var c=this.state.selectedComponentIndex;if(!c)return;c=this.props.colorPalette.set("components",this.props.colorPalette.components.set(c-1,a));b("MediaEffectMetadataActionCreators").setTemplateSourceColorPalette(c)}.bind(this),this.$8=function(a){this.setState({transformPalette:a})}.bind(this),this.$9=function(a){this.setState({highlightComponent:a})}.bind(this),this.state={selectedComponentIndex:this.props.colorPalette.components.size>0?1:null,transformPalette:null,highlightComponent:null}}a.prototype.$3=function(){__p&&__p();var a=this.$1.map(b("colr-convert").rgb.hsl),c=a.map(function(a){return a[0]/360}).sort(),d=a.map(function(a){return a[1]/100});a=a.map(function(a){return a[2]/100});var e=d.reduce(function(a,b){return Math.max(a,b)});d=d.reduce(function(a,b){return Math.min(a,b)});var f=a.reduce(function(a,b){return Math.max(a,b)});a=a.reduce(function(a,b){return Math.min(a,b)});var g=c.map(function(a,b){return b===c.length-1?c[0]-a+1:c[b+1]-a}),h=g.indexOf(Math.max.apply(Math,g));g=1-g[h];h=c[h]-g/2;h<0&&(h+=1);return new(b("MediaEffectColorPaletteComponentRecord"))({hue:h,saturation:(e+d)/2,lightness:(f+a)/2,hueVariation:Math.min(g*1.1+.05,.5),saturationVariation:Math.min((e-d)/2*1.1+.1,1),lightnessVariation:Math.min((f-a)/2*1.1+.1,1)})};a.prototype.render=function(){return b("React").createElement("div",{className:"_2yb8"},b("React").createElement("div",{className:"_2yb9"},b("React").createElement("div",{className:"_2yba"},b("React").createElement(b("MediaEffectFrameEditorPixelCanvasContainer.react"),{highlightComponent:this.state.highlightComponent,onAddSample:this.$2,onSamplingStart:this.$4,sourcePalette:this.props.colorPalette,transformPalette:this.state.transformPalette})),b("React").createElement(b("MediaEffectFrameEditorTemplatePaletteComponentSelector.react"),{colorPalette:this.props.colorPalette,onAddComponent:this.$6,onButtonClick:this.$5,onHighlightComponent:this.$9,selectedComponentIndex:this.state.selectedComponentIndex}),b("React").createElement(b("MediaEffectFrameEditorTemplatePaletteComponentEditor.react"),{component:this.state.selectedComponentIndex?this.props.colorPalette.components.get(this.state.selectedComponentIndex-1):null,componentIndex:this.state.selectedComponentIndex,onComponentChange:this.$7,onHighlightComponent:this.$9})),b("React").createElement(b("MediaEffectFrameEditorTemplatePaletteSelectorContainer.react"),{onPaletteSelect:this.$8}))};e.exports=a}),null);
__d("MediaEffectTemplateColorStepContainer.react",["FluxContainer","MediaEffectFrameEditorDispatcher","MediaEffectTemplateColorStep.react","MediaEffectTemplateDataStore","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MediaEffectTemplateDataStore")]};a.calculateState=function(a,c){a=b("MediaEffectTemplateDataStore").getState();return{colorPalette:a.sourceColorPalette}};a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.constructor.getStores())};a.prototype.render=function(){return b("React").createElement(b("MediaEffectTemplateColorStep.react"),this.state)};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a)}),null);
__d("MediaEffectTemplateDataStore",["FluxReduceStore","immutable","MediaEffectColorPaletteRecord","MediaEffectFrameCreateDialogDataStore","MediaEffectFrameEditorDispatcher","MediaEffectReactFrameDeserializer","MediaEffectReactFrameEditorDataStore","MediaEffectReactFrameEditorImageAssetRecord","MediaEffectTemplateVariationRecord"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h;c=b("immutable").List;d=b("immutable").Map;f=b("immutable").Record;var i=1,j=3;function k(){return i++}g=babelHelpers.inherits(l,f({systemColorPalettes:c(),userColorPalettes:c(),sourceColorPalette:new(b("MediaEffectColorPaletteRecord"))({components:c()}),templateVariations:d(),currentTemplateVariationID:null,sourceFrameData:b("MediaEffectReactFrameEditorDataStore").getInitialState()}));g&&g.prototype;l.prototype.withSystemColorPalettes=function(a){var c=this.systemColorPalettes.withMutations(function(c){a.forEach(function(a){a=b("MediaEffectReactFrameDeserializer").deserializeColorPalette(a);c.contains(a)||c.push(a)})});while(c.size<j)c=c.push(b("MediaEffectColorPaletteRecord").random());return this.set("systemColorPalettes",c)};l.prototype.withVariationMutation=function(a,b){var c=this.templateVariations,d=c.get(a);return!d?this:this.set("templateVariations",c.set(a,d.withMutations(b)))};l.prototype.reset=function(){return new l().set("systemColorPalettes",this.systemColorPalettes)};function l(){g.apply(this,arguments)}h=babelHelpers.inherits(a,b("FluxReduceStore"));h&&h.prototype;a.prototype.getInitialState=function(){return new l()};a.prototype.reduce=function(a,c){__p&&__p();if(!b("MediaEffectFrameCreateDialogDataStore").isTemplateFlow())return a;switch(c.type){case"add/systemColorPalettes":a=a.withSystemColorPalettes(c.paletteData);break;case"set/userColorPalette":a=a.set("userColorPalettes",a.userColorPalettes.set(c.index-1,c.palette));break;case"set/currentTemplateVariation":a=a.set("currentTemplateVariationID",c.localTemplateID);break;case"change/step":a=a.set("currentTemplateVariationID",null);break;case"set/templateSourceColorPalette":a=a.set("sourceColorPalette",c.palette);break;case"new/templateVariation":var d=k(),e=c.templateVariation.set("localTemplateID",d);a=a.set("templateVariations",a.templateVariations.set(d,e));a=a.set("currentTemplateVariationID",d);e.frameData.assets.forEach(function(a){a instanceof b("MediaEffectReactFrameEditorImageAssetRecord")&&a.uploadForVariation(d)});break;case"init/frameData":a=this.$MediaEffectTemplateDataStore1(a.reset());e=c.data;e&&(a=a.set("sourceColorPalette",b("MediaEffectReactFrameDeserializer").deserializeColorPalette(e.color_palette)),e.variations.forEach(function(d){var c=k();a=a.set("templateVariations",a.templateVariations.set(c,new(b("MediaEffectTemplateVariationRecord"))({localTemplateID:c,colorPalette:b("MediaEffectReactFrameDeserializer").deserializeColorPalette(d.color_palette),templateVariationFBID:d.fbid,frameData:b("MediaEffectReactFrameDeserializer").deserializeData(d)})))}));break;case"add/image":case"replace/image":case"add/text":case"duplicate/asset":case"update/assetPosition":case"update/assetSize":case"update/assetNativeSize":case"update/asset/raise":case"update/asset/lower":case"delete/asset":case"update/textContent":case"update/textFonts":case"update/textColors":case"update/textAlignments":a=this.$MediaEffectTemplateDataStore1(a);break;case"update/stickerFBID":var f=c.localAssetID,g=c.stickerFBID;!c.localTemplateID?a.set("sourceFrameData",a.sourceFrameData.withAssetMutation(f,function(a){return a.set("stickerFBID",g)})):a=a.withVariationMutation(c.localTemplateID,function(a){return a.set("frameData",a.frameData.withAssetMutation(f,function(a){return a.set("stickerFBID",g)}))});break}return a};a.prototype.$MediaEffectTemplateDataStore1=function(a){b("MediaEffectFrameEditorDispatcher").waitFor([b("MediaEffectReactFrameEditorDataStore").getDispatchToken()]);!a.currentTemplateVariationID?a=a.set("sourceFrameData",b("MediaEffectReactFrameEditorDataStore").getState()):a=a.withVariationMutation(a.currentTemplateVariationID,function(a){return a.set("frameData",b("MediaEffectReactFrameEditorDataStore").getState())});return a};a.prototype.getFrameData=function(a){var b=this.getState();if(!a)return b.sourceFrameData;else return b.templateVariations.get(a).frameData};function a(){h.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("MediaEffectFrameEditorDispatcher"))}),null);
__d("MediaEffectTemplatePalettePicker.react",["cx","MediaEffectColorPaletteWheel.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i;c=babelHelpers.inherits(j,b("React").PureComponent);h=c&&c.prototype;function j(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=function(a){this.props.previewPalette(a?this.props.palette:null)}.bind(this),this.$2=function(){this.props.selectPalette(this.props.palette,this.props.userIndex)}.bind(this),b}j.prototype.render=function(){return b("React").createElement("div",{className:"_4xob"},b("React").createElement(b("MediaEffectColorPaletteWheel.react"),{onClick:this.$2,onHover:this.$1,palette:this.props.palette}))};i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_w63"},b("React").createElement(j,{palette:this.props.sourcePalette,previewPalette:this.props.previewPalette,selectPalette:this.props.selectPalette,userIndex:null}),this.props.systemPalettes.map(function(a,c){return b("React").createElement(j,{key:c,palette:a,previewPalette:this.props.previewPalette,selectPalette:this.props.selectPalette,userIndex:null})}.bind(this)),this.props.userPalettes.map(function(a,c){return b("React").createElement(j,{key:c,palette:a,previewPalette:this.props.previewPalette,selectPalette:this.props.selectPalette,userIndex:c+1})}.bind(this)))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectTemplateNewColorStep.react",["cx","MediaEffectFrameEditorPixelCanvasContainer.react","MediaEffectFrameEditorTemplatePaletteComponentEditor.react","MediaEffectFrameEditorTemplatePaletteComponentSelector.react","MediaEffectMetadataActionCreators","MediaEffectTemplatePalettePicker.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(a){__p&&__p();h.constructor.call(this,a),this.$1=function(a){this.setState({selectedComponentIndex:a})}.bind(this),this.$2=function(a){var c=this.state.selectedComponentIndex;if(!c)return;c=this.state.selectedPalette.set("components",this.state.selectedPalette.components.set(c-1,a));a=this.state.selectedUserPaletteIndex;a=a?a:this.props.userPalettes.size+1;b("MediaEffectMetadataActionCreators").setUserColorPalette(c,a);this.setState({selectedUserPaletteIndex:a,selectedPalette:c})}.bind(this),this.$3=function(a,b){this.setState({selectedPalette:a,selectedUserPaletteIndex:b,selectedComponentIndex:1})}.bind(this),this.$4=function(a){this.setState({previewPalette:a})}.bind(this),this.state={selectedComponentIndex:this.props.sourcePalette.components.size>0?1:null,previewPalette:null,selectedUserPaletteIndex:null,selectedPalette:a.sourcePalette}}a.prototype.render=function(){return b("React").createElement("div",{className:"_2yb9"},b("React").createElement(b("MediaEffectTemplatePalettePicker.react"),{previewPalette:this.$4,selectPalette:this.$3,sourcePalette:this.props.sourcePalette,systemPalettes:this.props.systemPalettes,userPalettes:this.props.userPalettes}),b("React").createElement(b("MediaEffectFrameEditorTemplatePaletteComponentSelector.react"),{colorPalette:this.state.selectedPalette,onButtonClick:this.$1,selectedComponentIndex:this.state.selectedComponentIndex}),b("React").createElement(b("MediaEffectFrameEditorTemplatePaletteComponentEditor.react"),{component:this.state.selectedComponentIndex&&this.state.selectedPalette?this.state.selectedPalette.components.get(this.state.selectedComponentIndex-1):null,componentIndex:this.state.selectedComponentIndex,onComponentChange:this.$2,showVariation:!1}),b("React").createElement("div",{className:"_2yba"},b("React").createElement(b("MediaEffectFrameEditorPixelCanvasContainer.react"),{sourcePalette:this.props.sourcePalette,transformPalette:this.state.previewPalette?this.state.previewPalette:this.state.selectedPalette})))};e.exports=a}),null);
__d("MediaEffectTemplateNewColorStepContainer.react",["FluxContainer","MediaEffectFrameEditorDispatcher","MediaEffectTemplateDataStore","MediaEffectTemplateNewColorStep.react","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MediaEffectTemplateDataStore")]};a.calculateState=function(a,c){a=b("MediaEffectTemplateDataStore").getState();return{sourcePalette:a.sourceColorPalette,systemPalettes:a.systemColorPalettes,userPalettes:a.userColorPalettes}};a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.constructor.getStores())};a.prototype.render=function(){return b("React").createElement(b("MediaEffectTemplateNewColorStep.react"),this.state)};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a)}),null);
__d("MediaEffectTemplateVariationCanvas.react",["cx","MediaEffectReactFrameEditorCanvasContainer.react","React","ResponsiveBlock.react","Vector","mediaEffectGKCheck"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(a){h.constructor.call(this,a),this.$2=function(a,c){this.setState({size:new(b("Vector"))(a,c)})}.bind(this),this.state={size:null}}a.prototype.componentDidMount=function(){this.$1=!0};a.prototype.componentWillUnmount=function(){this.$1=!1};a.prototype.setState=function(a){this.$1&&h.setState.call(this,a)};a.prototype.$3=function(){var a=this.state.size;return!a?null:b("React").createElement("div",{className:"_3g0k"},b("React").createElement(b("MediaEffectReactFrameEditorCanvasContainer.react"),{enableEditorFreeText:b("mediaEffectGKCheck")("media_effect_template")||b("mediaEffectGKCheck")("media_effect_frame_editor_free_text"),enableFontSettingsDialog:b("mediaEffectGKCheck")("media_effect_font_settings_dialog"),height:a.y,width:a.x}))};a.prototype.render=function(){return b("React").createElement("div",{className:"_2yba"},b("React").createElement(b("ResponsiveBlock.react"),{className:"_3g0j",onResize:this.$2},this.$3()))};e.exports=a}),null);
__d("MediaEffectTemplateVariationRecord",["regeneratorRuntime","Promise","immutable","MediaEffectColorPaletteRecord","MediaEffectReactFrameEditorDataStore","MediaEffectTemplateDataStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("immutable").Map;a=b("immutable").Record;g=babelHelpers.inherits(i,a({localTemplateID:null,colorPalette:b("MediaEffectColorPaletteRecord"),templateVariationFBID:null,frameData:b("MediaEffectReactFrameEditorDataStore").getInitialState()}));g&&g.prototype;i.fromSourceTemplate=function(a){__p&&__p();var c,d,e,f,g,j,k;return b("regeneratorRuntime").async(function(l){__p&&__p();while(1)switch(l.prev=l.next){case 0:c=b("MediaEffectTemplateDataStore").getState();d=c.sourceColorPalette;e=c.sourceFrameData;f=e.assets.valueSeq().toArray().map(function(b){return b.reColored(d,a)});l.next=6;return b("regeneratorRuntime").awrap(b("Promise").all(f));case 6:g=l.sent;j=h(g.map(function(a){return[a.localAssetID,a]}));k=e.withMutations(function(a){return b("regeneratorRuntime").async(function(b){while(1)switch(b.prev=b.next){case 0:a.set("frameFBID",null),a.set("templateFBID",null),a.set("assets",j);case 3:case"end":return b.stop()}},null,this)});return l.abrupt("return",new i({colorPalette:a,frameData:k}));case 10:case"end":return l.stop()}},null,this)};function i(){g.apply(this,arguments)}e.exports=i}),null);
__d("MediaEffectTemplateVariationAvailablePalettePicker.react",["cx","MediaEffectColorPaletteWheel.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i;c=babelHelpers.inherits(j,b("React").PureComponent);h=c&&c.prototype;function j(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=function(a){this.props.previewPalette(a?this.props.palette:null)}.bind(this),this.$2=function(){this.props.createVariation(this.props.palette)}.bind(this),b}j.prototype.render=function(){return b("React").createElement("div",{className:"_4xob"},b("React").createElement(b("MediaEffectColorPaletteWheel.react"),{onClick:this.$2,onHover:this.$1,palette:this.props.palette}))};i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_w63"},this.props.colorPalettes.map(function(a,c){return b("React").createElement(j,{createVariation:this.props.createVariation,key:c,palette:a,previewPalette:this.props.previewPalette})}.bind(this)))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectTemplateVariationSelector.react",["cx","MediaEffectColorPaletteWheel.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i;c=babelHelpers.inherits(j,b("React").PureComponent);h=c&&c.prototype;function j(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=function(){if(!this.props.onVariationSelect)return;this.props.onVariationSelect(this.props.localTemplateID)}.bind(this),b}j.prototype.render=function(){return b("React").createElement("div",{className:"_4xob"},b("React").createElement(b("MediaEffectColorPaletteWheel.react"),{onClick:this.$1,palette:this.props.palette}))};d=babelHelpers.inherits(a,b("React").PureComponent);i=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.$1=function(){if(!this.props.onVariationSelect)return;this.props.onVariationSelect(null)}.bind(this),b}a.prototype.render=function(){return b("React").createElement("div",{className:"_w64"},b("React").createElement("div",{className:"_4xob"},b("React").createElement(b("MediaEffectColorPaletteWheel.react"),{onClick:this.$1,palette:this.props.sourceColorPalette})),this.props.templateVariations.valueSeq().map(function(a){return b("React").createElement(j,{key:a.localTemplateID,localTemplateID:a.localTemplateID,onVariationSelect:this.props.onVariationSelect,palette:a.colorPalette,selected:this.props.currentTemplateVariationID===a.localTemplateID})}.bind(this)))};e.exports=a}),null);
__d("MediaEffectTemplateVariationStep.react",["cx","immutable","MediaEffectFrameEditorConstants","MediaEffectFrameEditorPixelCanvasContainer.react","MediaEffectMetadataActionCreators","MediaEffectTemplateVariationAvailablePalettePicker.react","MediaEffectTemplateVariationCanvas.react","MediaEffectTemplateVariationSelector.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("immutable").OrderedSet,j=b("MediaEffectFrameEditorConstants").EDITOR_BUFFER_SIZE;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(a){h.constructor.call(this,a),this.$1=function(a){b("MediaEffectMetadataActionCreators").setCurrentTemplateVariation(a),this.$2(null)}.bind(this),this.$3=function(a){b("MediaEffectMetadataActionCreators").createNewTemplateVariation(a),this.$2(null)}.bind(this),this.$2=function(a){this.setState({previewPalette:a})}.bind(this),this.state={previewPalette:null}}a.prototype.render=function(){var a=i(this.props.templateVariations.valueSeq().map(function(a){return a.colorPalette}));a=i(this.props.systemPalettes).union(this.props.userPalettes).subtract(a).toList();return b("React").createElement("div",{className:"_w62"},b("React").createElement(b("MediaEffectTemplateVariationAvailablePalettePicker.react"),{colorPalettes:a,createVariation:this.$3,previewPalette:this.$2}),b("React").createElement(b("MediaEffectTemplateVariationSelector.react"),{currentTemplateVariationID:this.props.currentTemplateVariationID,onVariationSelect:this.$1,sourceColorPalette:this.props.sourceColorPalette,templateVariations:this.props.templateVariations}),this.state.previewPalette?b("React").createElement("div",{className:"_2yba"},b("React").createElement("div",{style:{position:"absolute",top:j,bottom:j,left:j,right:j}},b("React").createElement(b("MediaEffectFrameEditorPixelCanvasContainer.react"),{sourcePalette:this.props.sourceColorPalette,transformPalette:this.state.previewPalette?this.state.previewPalette:this.props.sourceColorPalette}))):b("React").createElement(b("MediaEffectTemplateVariationCanvas.react"),null))};e.exports=a}),null);
__d("MediaEffectTemplateVariationStepContainer.react",["FluxContainer","MediaEffectFrameEditorDispatcher","MediaEffectTemplateDataStore","MediaEffectTemplateVariationStep.react","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MediaEffectTemplateDataStore")]};a.calculateState=function(a,c){a=b("MediaEffectTemplateDataStore").getState();return{systemPalettes:a.systemColorPalettes,userPalettes:a.userColorPalettes,sourceColorPalette:a.sourceColorPalette,templateVariations:a.templateVariations,currentTemplateVariationID:a.currentTemplateVariationID}};a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.constructor.getStores())};a.prototype.render=function(){var a=babelHelpers["extends"]({},this.props,this.state);return b("React").createElement(b("MediaEffectTemplateVariationStep.react"),a)};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a)}),null);
__d("XMediaEffectFrameAsyncSubmitController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/effects/frame/submit/",{flow_type:{type:"Enum",required:!0,enumType:1},creation_referrer:{type:"Enum",enumType:1},source_id:{type:"FBID"},action_context:{type:"String"},active_tab:{type:"Enum",enumType:1},preview_on_camera:{type:"Bool",defaultValue:!1}})}),null);
__d("XMediaEffectMaskAsyncUploadController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/effects/ar_effect/upload/",{effect_id:{type:"FBID"},preview_on_camera:{type:"Bool",defaultValue:!1}})}),null);
__d("MediaEffectRequestBuilder",["invariant","regeneratorRuntime","AsyncResponse","AsyncUploadRequest","immutable","MediaEffectFrameCreateDialogDataStore","MediaEffectMaskUploadDataStore","MediaEffectMetadataActionCreators","MediaEffectMetadataStore","MediaEffectReactFrameEditorDataStore","MediaEffectReactFrameSerializer","MediaEffectTemplateDataStore","MediaEffectUserContext","XMediaEffectAsyncEditController","XMediaEffectFrameAsyncSubmitController","XMediaEffectMaskAsyncUploadController","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j,k,l,m;function a(a){this.effectID=a,this.fbOnly=b("MediaEffectUserContext").includesFBOnly,this.previewOnCamera=!1,this.onSuccessComplete=b("emptyFunction"),this.onFailureComplete=b("emptyFunction")}a.forCreate=function(){return new this(null)};a.forUpdate=function(a){return new this(a)};a.prototype.setOnSuccessComplete=function(a){this.onSuccessComplete=a;return this};a.prototype.setOnFailureComplete=function(a){this.onFailureComplete=a;return this};a.prototype.setSendPreviewNotification=function(a){this.previewOnCamera=a;return this};a.prototype.genRequest=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:throw new Error("Abstract method!");case 1:case"end":return a.stop()}},null,this)};a.prototype.genSend=function(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(this.genRequest());case 2:a=c.sent,a.send();case 4:case"end":return c.stop()}},null,this)};h=babelHelpers.inherits(c,a);h&&h.prototype;c.prototype.getFrameData=function(a,c,d){return b("immutable").Map(b("MediaEffectMetadataStore").getRequestData(this.fbOnly)).withMutations(function(b){a.toSeq().forEach(function(a,c){b.set(c,a)}),c&&b.set("color_palette",c),d&&b.set("variant_of_template",d)})};c.prototype.getFrameUploadRequest=function(a){var c=b("MediaEffectFrameCreateDialogDataStore").getState();c=b("XMediaEffectFrameAsyncSubmitController").getURIBuilder().setString("action_context",JSON.stringify(c.eventDialogContext.actionContext)).setEnum("active_tab",c.eventDialogContext.activeTab).setFBID("source_id",c.sourceID).setEnum("flow_type",c.flowType).setEnum("creation_referrer",c.creationReferrer).setBool("preview_on_camera",this.previewOnCamera).getURI();a=a.toObject();String(a.fbid)===String(this.effectID)||g(0);var d={thumbnail_file:a.thumbnail};return new(b("AsyncUploadRequest"))().setURI(c).setAllowCrossOrigin(!1).setData(a).setFiles(d)};function c(){h.apply(this,arguments)}i=babelHelpers.inherits(d,c);i&&i.prototype;d.prototype.genRequest=function(){__p&&__p();var a,c,d;return b("regeneratorRuntime").async(function(e){__p&&__p();while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(b("MediaEffectReactFrameSerializer").genSerializeFrame(b("MediaEffectReactFrameEditorDataStore").getState()));case 2:a=e.sent;c=b("immutable").Map(a);d=this.getFrameUploadRequest(this.getFrameData(c,null));d.subscribe("success",function(a,b){this.onSuccessComplete(b.getResponse())}.bind(this));d.subscribe("failure",function(a,b){this.onFailureComplete(b.getResponse())}.bind(this));return e.abrupt("return",d);case 8:case"end":return e.stop()}},null,this)};function d(){i.apply(this,arguments)}j=babelHelpers.inherits(f,c);j&&j.prototype;f.prototype.genRequest=function(){__p&&__p();var a,c,d,e;return b("regeneratorRuntime").async(function(f){__p&&__p();while(1)switch(f.prev=f.next){case 0:a=b("MediaEffectTemplateDataStore").getState();f.next=3;return b("regeneratorRuntime").awrap(b("MediaEffectReactFrameSerializer").genSerializeFrame(b("MediaEffectReactFrameEditorDataStore").getState()));case 3:c=f.sent;d=b("immutable").Map(c);e=this.getFrameUploadRequest(this.getFrameData(d,a.sourceColorPalette.toString()));e.subscribe("success",function(c,d){__p&&__p();var e=0;c=d.getResponse();var f=c.payload;a.templateVariations.map(function(d){var c,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:h.next=2;return b("regeneratorRuntime").awrap(b("MediaEffectReactFrameSerializer").genSerializeFrame(d.frameData));case 2:c=h.sent,g=this.getFrameUploadRequest(this.getFrameData(b("immutable").Map(c),d.colorPalette.toString(),f.effect.id)),g.subscribe("success",function(b,c){e++,e===a.templateVariations.count()&&this.onSuccessComplete(f)}.bind(this)),g.send();case 6:case"end":return h.stop()}},null,this)}.bind(this))}.bind(this));e.subscribe("failure",function(a,b){this.onFailureComplete(b.getResponse())}.bind(this));return f.abrupt("return",e);case 9:case"end":return f.stop()}},null,this)};function f(){j.apply(this,arguments)}k=babelHelpers.inherits(n,a);k&&k.prototype;n.prototype.genRequest=function(){return this.getRequest()};n.prototype.getRequest=function(){__p&&__p();var a=b("XMediaEffectMaskAsyncUploadController").getURIBuilder().setFBID("effect_id",this.effectID).setBool("preview_on_camera",this.previewOnCamera).getURI(),c=b("MediaEffectMetadataStore").getRequestData(this.fbOnly),d=c.media_effect_save_as_draft,e=Object.assign({},c);c.media_effect_save_as_draft=!0;c=b("MediaEffectMaskUploadDataStore").getRequestFiles();var f=c.effect_review_material_id,g=c.thumbnail_file,h=babelHelpers.objectWithoutProperties(c,["effect_review_material_id","thumbnail_file"]);e.effect_review_material_id=f;c=new(b("AsyncUploadRequest"))().setURI(a).setAllowCrossOrigin(!1).setData(e).setFiles({mask_thumbnail_file:g});c.subscribe("failure",function(a,b){this.onFailureComplete(b.getResponse())}.bind(this));c.subscribe("success",function(a,c){__p&&__p();a=c.getResponse().payload.effect.id;b("MediaEffectMetadataActionCreators").updateEffectID(a);var f=b("XMediaEffectMaskAsyncUploadController").getURIBuilder().setFBID("effect_id",a).getURI();a=new(b("AsyncUploadRequest"))().setURI(f).setAllowCrossOrigin(!1).setData(e).setFiles(h);a.subscribe("complete",function(a,g){__p&&__p();a=g.find(function(a){return!a.isSuccess()});if(a){this.onFailureComplete(a.getResponse());return}if(!d){e.media_effect_save_as_draft=!1;a=new(b("AsyncUploadRequest"))().setURI(f).setAllowCrossOrigin(!1).setData(e);a.subscribe("success",function(a,b){this.onSuccessComplete(b.getResponse())}.bind(this));a.subscribe("failure",function(a,b){this.onFailureComplete(b.getResponse())}.bind(this));a.send()}else this.onSuccessComplete(g.length?g[g.length-1].getResponse():c.getResponse())}.bind(this));a.send()}.bind(this));return c};function n(){k.apply(this,arguments)}l=babelHelpers.inherits(o,a);l&&l.prototype;o.prototype.genRequest=function(){return this.getRequest()};o.prototype.getRequest=function(){var a=b("XMediaEffectAsyncEditController").getURIBuilder().setFBID("media_effect_id",this.effectID).getURI(),c=b("MediaEffectMetadataStore").getRequestData(this.fbOnly),d={thumbnail_file:c.thumbnail};a=new(b("AsyncUploadRequest"))().setURI(a).setAllowCrossOrigin(!1).setData(c).setFiles(d);a.subscribe("success",function(a,b){this.onSuccessComplete(b.getResponse())}.bind(this));a.subscribe("failure",function(a,b){this.onFailureComplete(b.getResponse())}.bind(this));return a};function o(){l.apply(this,arguments)}c=babelHelpers.inherits(p,a);m=c&&c.prototype;function p(a,b,c,d,e){m.constructor.call(this),this.effectID=a,this.previewOnCamera=b,this.isApproved=c,this.data=d,this.files=e}p.forSave=function(a,b,c,d,e){return new this(a,b,c,d,e)};p.prototype.genRequest=function(){return this.getRequest()};p.prototype.getRequest=function(){__p&&__p();var a=b("XMediaEffectMaskAsyncUploadController").getURIBuilder().setFBID("effect_id",this.effectID).setBool("preview_on_camera",this.previewOnCamera).getURI(),c=this.data,d=this.files,e=d.effect_review_material_id,f=d.thumbnail_file,g=d.project_file,h=d.mask_files,i=c.media_effect_save_as_draft,j=Object.assign({},c);c.media_effect_save_as_draft=!0;j.effect_review_material_id=e;d=new(b("AsyncUploadRequest"))().setURI(a).setAllowCrossOrigin(!1).setData(j).setFiles({mask_thumbnail_file:f});d.subscribe("failure",function(a,b){this.onFailureComplete(b.getResponse())}.bind(this));d.subscribe("success",function(a,c){__p&&__p();a=c.getResponse().payload.effect.id;b("MediaEffectMetadataActionCreators").updateEffectID(a);var d=b("XMediaEffectMaskAsyncUploadController").getURIBuilder().setFBID("effect_id",a).getURI();a=new(b("AsyncUploadRequest"))().setURI(d).setAllowCrossOrigin(!1).setData(j).setFiles({project_file:g,mask_files:h});a.subscribe("complete",function(a,e){__p&&__p();a=e.find(function(a){return!a.isSuccess()});if(a){this.onFailureComplete(a.getResponse());return}if(!i){j.media_effect_save_as_draft=!1;a=new(b("AsyncUploadRequest"))().setURI(d).setAllowCrossOrigin(!1).setData(j);a.subscribe("success",function(a,b){this.onSuccessComplete(b.getResponse())}.bind(this));a.subscribe("failure",function(a,b){this.onFailureComplete(b.getResponse())}.bind(this));a.send()}else this.onSuccessComplete(e.length?e[e.length-1].getResponse():c.getResponse())}.bind(this));a.send()}.bind(this));return d};e.exports={forARStudioEffect:p,forMask:n,forFrame:d,forTemplate:f,forMetadata:o}}),null);
__d("EventPermalinkCameraFramesCreateWithDefaultFrame.react",["cx","fbt","ix","AsyncDialog","AsyncRequest","Button.react","DialogX","EventPermalinkCameraFramesLogging","EventsActionsLogger","FBToggleSwitch.react","FXEntMediaEffectStatus","Image.react","MediaEffectCreateStep","MediaEffectCreationReferrer","MediaEffectFlowType","MediaEffectHubViewTab","MediaEffectMetadataActionCreators","MediaEffectOwnerHubHeader.react","React","XMediaEffectCreateDialogController","XUICard.react","XUICardSection.react","XUIText.react","BackgroundImage.react"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=100,l=158;c=babelHelpers.inherits(a,b("React").PureComponent);j=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=j.constructor).call.apply(a,[this].concat(e)),this.$1=function(){b("EventPermalinkCameraFramesLogging").logClick(b("EventsActionsLogger").Target.FRAME_CREATE_RHC,this.props.eventID,this.props.actionContext);var a=b("XMediaEffectCreateDialogController").getURIBuilder().setEnum("flow_type",b("MediaEffectFlowType").EVENT).setFBID("source_id",this.props.eventID).setEnum("step",b("MediaEffectCreateStep").CREATE).setEnum("ref",b("MediaEffectCreationReferrer").EVENT_PAGE).getURI(),c=this.props.effect.effectData.id;b("AsyncDialog").send(new(b("AsyncRequest"))(a),function(a){a.subscribe(["hide","success"],function(a,event){this.props.effectUpdateHandler(c)}.bind(this))}.bind(this))}.bind(this),c}a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectMetadataActionCreators").initFrameData(this.props.effect.effectEditorData)};a.prototype.isToggleEnabled=function(){var a=this.props.effect.effectData.status;return a===b("FXEntMediaEffectStatus").INACTIVE||a===b("FXEntMediaEffectStatus").ACTIVE};a.prototype.render=function(){var a=this.props.effect.effectData,c=a.status;return b("React").createElement(b("XUICard.react"),{className:"_634s"},b("React").createElement(b("MediaEffectOwnerHubHeader.react"),{title:this.props.title,hubLinkTab:b("MediaEffectHubViewTab").LEARN}),b("React").createElement(b("XUICardSection.react"),null,b("React").createElement("div",{className:"_46ca"},a.hasEnabledActivations?b("React").createElement(b("Image.react"),{src:i("353079")}):b("React").createElement(b("Image.react"),{src:i("353078")}),b("React").createElement("div",{className:"_46cb"},this.isToggleEnabled()?b("React").createElement(b("FBToggleSwitch.react"),{checked:c===b("FXEntMediaEffectStatus").ACTIVE,animate:!0,onToggle:function(){return this.props.toggleEventHandler(a.id,c===b("FXEntMediaEffectStatus").INACTIVE)}.bind(this),tooltip:c===b("FXEntMediaEffectStatus").ACTIVE?h._("Your camera frame is on"):h._("Your camera frame is off")}):null),b("React").createElement("div",{className:"_46cd"},b("React").createElement(b("BackgroundImage.react"),{backgroundSize:"contain",height:l,src:a.thumbnailPortrait,width:k})),b("React").createElement("div",{className:"_46cf"},b("React").createElement(b("XUIText.react"),{size:"header4",weight:"bold",className:"_46cg"},h._("Help people share at your event")),b("React").createElement("p",{className:"_46ch"},h._("You can use the default camera frame or create a custom one for your guests to use in photos and videos they share.")),b("React").createElement("div",{className:"_46ci"},b("React").createElement(b("Button.react"),{onClick:this.$1,use:"default",label:h._("Upload New")}))))))};e.exports=a}),null);
__d("MediaEffectsPlatformPerformanceTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:MediaEffectsPlatformPerformanceLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:MediaEffectsPlatformPerformanceLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:MediaEffectsPlatformPerformanceLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setEffectID=function(a){this.$1.effect_id=a;return this};a.prototype.setEffectType=function(a){this.$1.effect_type=a;return this};a.prototype.setExecTimeMs=function(a){this.$1.exec_time_ms=a;return this};a.prototype.setGkOff=function(a){this.$1.gk_off=b("GeneratedLoggerUtils").serializeVector(a);return this};a.prototype.setGkOn=function(a){this.$1.gk_on=b("GeneratedLoggerUtils").serializeVector(a);return this};a.prototype.setIdentifier=function(a){this.$1.identifier=a;return this};a.prototype.setMemoryUsage=function(a){this.$1.memory_usage=a;return this};a.prototype.setOwnerType=function(a){this.$1.owner_type=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};c={effect_id:!0,effect_type:!0,exec_time_ms:!0,gk_off:!0,gk_on:!0,identifier:!0,memory_usage:!0,owner_type:!0,vc:!0};e.exports=a}),null);
__d("MediaEffectHubFunnelLogger",["FunnelLogger","URI","UserAgentData","keyMirror"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="CREATIVE_STUDIO_HUB_FUNNEL",h=b("keyMirror")({HUB_VIEW_CHANGE:"",HUB_FILTER_APPLY:"",HUB_ACTOR_CHANGE:"",HUB_GRID_VIEW_SWITCH:"",HUB_EFFECT_SELECT:"",HUB_EFFECT_OPEN:"",HUB_EFFECT_PAGER_CHANGE:"",HUB_EFFECT_ACTIVE_STATUS_CHANGE:"",HUB_EFFECT_ARCHIVE:"",HUB_EFFECT_DUPLICATE:"",HUB_EFFECT_CHANGE_PROFILE_PICTURE:"",HUB_NEW_FRAME:"",HUB_NEW_MASK:""}),i=b("keyMirror")({BROWSER_NAME:"",DOMAIN:"",PATH:""}),j=!1;a={startFunnel:function(){if(j)return;b("FunnelLogger").startFunnel(g);j=!0;b("FunnelLogger").addFunnelTag(g,i.BROWSER_NAME,b("UserAgentData").browserName);b("FunnelLogger").addFunnelTag(g,i.DOMAIN,b("URI").getRequestURI().getDomain());b("FunnelLogger").addFunnelTag(g,i.PATH,b("URI").getRequestURI().getPath())},logActionWithTag:function(a,c){if(!j)return;b("FunnelLogger").appendActionWithTag(g,h[a],c||"")}};e.exports=a}),null);
__d("MediaEffectPerformanceLogger",["invariant","MediaEffectsPlatformPerformanceTypedLogger"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a.prototype.setIdentifier=function(a){this.identifier=a;return this};a.prototype.setEffectType=function(a){this.effectType=a;return this};a.prototype.setOwnerType=function(a){this.ownerType=a;return this};a.prototype.setEffectID=function(a){this.effectID=a;return this};a.prototype.setGKOn=function(a){this.gkOn=a;return this};a.prototype.setGKOff=function(a){this.gkOff=a;return this};a.prototype.startRecording=function(){this.startTime&&g(0);this.startTime=window.performance.now();this.startMemory=window.performance.memory?window.performance.memory.usedJSHeapSize:0;return this};a.prototype.endRecordingAndLog=function(){this.endTime&&g(0);this.endTime=window.performance.now();this.endMemory=window.performance.memory?window.performance.memory.usedJSHeapSize:0;this.$1();return this};a.prototype.$1=function(){this.startTime>0||g(0);this.endTime>0||g(0);var a=this.startMemory>this.endMemory?0:this.endMemory-this.startMemory;new(b("MediaEffectsPlatformPerformanceTypedLogger"))().setIdentifier(this.identifier).setExecTimeMs(Math.round(this.endTime-this.startTime)).setMemoryUsage(a).setEffectType(this.effectType).setOwnerType(this.ownerType).setEffectID(this.effectID).setGkOn(this.gkOn).setGkOff(this.gkOff).log();this.$2()};a.prototype.$2=function(){this.startTime=0,this.endTime=0,this.startMemory=0,this.endMemory=0};function a(){}e.exports=a}),null);
__d("MediaEffectARStudioFileUtils",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={getProjectFileIcon:function(a){return a&&!a.iconSrc&&a.name?"/images/media_effect/icon/arprojpkg-icon.png":null},getArfxFileIcon:function(a){return a&&!a.iconSrc&&a.name?"/images/media_effect/icon/arfx-icon.png":null},getDefaultContentNameFromFile:function(a){if(a&&a.name){a=a.name;var b=a.lastIndexOf(".");return b===-1?a:a.substring(0,b)}return""}};e.exports=a}),null);
__d("MediaEffectDialogsDispatcher",["ExplicitRegistrationReactDispatcher"],(function(a,b,c,d,e,f){"use strict";var g;c=babelHelpers.inherits(a,b("ExplicitRegistrationReactDispatcher"));g=c&&c.prototype;function a(a){g.constructor.call(this,a),this.dispatch=this.dispatch.bind(this)}e.exports=new a({strict:!0})}),null);
__d("MediaEffectARStudioFileDetailsStore",["FluxReduceStore","immutable","MediaEffectARStudioFileUtils","MediaEffectDialogsDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h;c=b("immutable").Record;g=babelHelpers.inherits(i,c({thumbnailFile:{width:0,height:0,size:0,isFetching:!1,src:""},projectFile:{isFetching:!1},etcArfxFile:{},pvrArfxFile:{},uncompressedArfxFile:{},screencastFile:{isFetching:!1,src:""},reviewDescription:{value:""},previousVersions:[],isAgreedWithLegalAgreement:{value:!1},legalAgreementText:"",isAutoupgraded:!1,latestVersion:null,minVersion:null,currentVersion:null,discontinuationDate:null,isOutOfDate:!1,projectHardSizeLimit:null,arfxSizeSoftLimit:null,isStoreDirty:!1}));g&&g.prototype;function i(){g.apply(this,arguments)}d=babelHelpers.inherits(a,b("FluxReduceStore"));h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.arfxTypeToFieldName={"@etc.arfx":"etcArfxFile","@pvr.arfx":"pvrArfxFile","@uncompressed.arfx":"uncompressedArfxFile"},b}a.prototype.getInitialState=function(){return new i()};a.prototype.reduce=function(a,c){__p&&__p();var d=void 0;void 0;var e=void 0,f=void 0;void 0;var g;void 0;var h;void 0;var i=!0;switch(c.type){case"ARStudioFileDetails/init":var j=c.payload;j.effectThumbnailIsAutogenerated||(a=a.set("thumbnailFile",Object.assign({},j.effectThumbnailFile,{iconSrc:j.effectThumbnailSrc,src:j.effectThumbnailSrc})));d=Object.assign({},j.projectFile);g=b("MediaEffectARStudioFileUtils").getProjectFileIcon(d);g&&(d=Object.assign({},d,{iconSrc:g}));a=a.set("projectFile",d);a=a.set("screencastFile",Object.assign({},j.screencastFile,{src:j.screencastSrc,reviewMaterialID:j.reviewMaterialID}));j.arfxFiles&&j.arfxFiles.forEach(function(c){if(!c||!c.name)return;e=this.arfxTypeToFieldName[c.name.substr(c.name.lastIndexOf("@"))];e&&(h=b("MediaEffectARStudioFileUtils").getArfxFileIcon(c),h&&(c=Object.assign({},c,{iconSrc:h})),a=a.set(e,c))}.bind(this));a=a.set("reviewDescription",{value:j.effectDescription}).set("previousVersions",j.previousVersions).set("isAutoupgraded",j.isAutoupgraded);var k=j.currentARStudioVersions,l=j.arStudioVersionDiscontinuationDates;if(k&&k.length>0){var m=Math.max.apply(Math,k);k=Math.min.apply(Math,k);var n=Math.max.apply(Math,j.arfxFiles.map(function(a){return Number(a.version)||0}));l=l?l[n]:null;var o=Boolean(n)&&Boolean(k)&&n<k;a=a.set("latestVersion",m).set("minVersion",k).set("currentVersion",n).set("discontinuationDate",l).set("isOutOfDate",o)}m=j.projectHardSizeLimit;k=j.arfxSizeSoftLimit;a=a.set("projectHardSizeLimit",m).set("arfxSizeSoftLimit",k);i=!1;break;case"ARStudioFileDetails/projectFile/update":a=this.getState();d=a.get("projectFile");d=Object.assign({},d,{error:null,warn:null,noticeTitle:null},c.payload);g=b("MediaEffectARStudioFileUtils").getProjectFileIcon(d);g&&(d=Object.assign({},d,{iconSrc:g}));a=a.set("projectFile",d);c.payload.file&&(a=a.set("etcArfxFile",{}).set("pvrArfxFile",{}).set("uncompressedArfxFile",{}));break;case"ARStudioFileDetails/projectFile/startFetching":a=this.getState();d=a.get("projectFile");a=a.set("projectFile",Object.assign({},d,{isFetching:!0}));break;case"ARStudioFileDetails/projectFile/stopFetching":a=this.getState();d=a.get("projectFile");a=a.set("projectFile",Object.assign({},d,{isFetching:!1}));break;case"ARStudioFileDetails/screencastFile/update":a=this.getState();n=a.get("screencastFile");a=a.set("screencastFile",Object.assign({},n,{error:null},c.payload));break;case"ARStudioFileDetails/screencastFile/startFetching":a=this.getState();n=a.get("screencastFile");a=a.set("screencastFile",Object.assign({},n,{isFetching:!0}));break;case"ARStudioFileDetails/screencastFile/stopFetching":a=this.getState();n=a.get("screencastFile");a=a.set("screencastFile",Object.assign({},n,{isFetching:!1}));break;case"ARStudioFileDetails/arfxFile/update":a=this.getState();e=this.arfxTypeToFieldName[c.arfxType];e&&(f=a.get(e),g=b("MediaEffectARStudioFileUtils").getProjectFileIcon(f),g&&(f=Object.assign({},f,{iconSrc:g})),f=Object.assign({},f,{error:null,isVersionValid:null,canUploadVersion:null,version:null},c.payload),a=a.set(e,f));break;case"ARStudioFileDetails/arfxFile/startFetching":a=this.getState();e=this.arfxTypeToFieldName[c.arfxType];a=a.set(e,Object.assign({},a.get(e),{isFetching:!0}));break;case"ARStudioFileDetails/arfxFile/stopFetching":a=this.getState();e=this.arfxTypeToFieldName[c.arfxType];a=a.set(e,Object.assign({},a.get(e),{isFetching:!1}));break;case"ARStudioFileDetails/thumbnailFile/update":a=this.getState();l=a.get("thumbnailFile");a=a.set("thumbnailFile",Object.assign({},l,{error:null},c.payload));break;case"ARStudioFileDetails/thumbnailFile/startFetching":a=this.getState();l=a.get("thumbnailFile");a=a.set("thumbnailFile",Object.assign({},l,{isFetching:!0}));break;case"ARStudioFileDetails/thumbnailFile/stopFetching":a=this.getState();l=a.get("thumbnailFile");a=a.set("thumbnailFile",Object.assign({},l,{isFetching:!1}));break;case"ARStudioFileDetails/isAgreedWithLegalAgreement/update":a=this.getState();a=a.set("isAgreedWithLegalAgreement",Object.assign({},a.get("isAgreedWithLegalAgreement"),{error:null},c.payload));break;case"ARStudioFileDetails/legalAgreementText/update":a=this.getState().set("legalAgreementText",c.payload.legalAgreementText);break;case"ARStudioFileDetails/reviewDescription/update":a=this.getState();a=a.set("reviewDescription",Object.assign({},a.get("reviewDescription"),{error:null},c.payload));break;case"MediaEffectARStudioDetailDialog/open":case"ARStudioFileUploadDialog/open":a=this.getInitialState();break;default:i=!1;break}a=a.set("isStoreDirty",i);return a};a.prototype.shouldShowArfxFiles=function(){var a=this.getState();a=a.get("projectFile");return Boolean(a&&a.name&&!a.name.endsWith(".arexport"))};a.__moduleID=e.id;e.exports=new a(b("MediaEffectDialogsDispatcher"))}),null);
__d("FXInspirationsCategoryName",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({TOP:"top",PRECAPTURE_TOP:"precapture_top",POSTCAPTURE_TOP:"postcapture_top",ALPHA_TOP:"alpha_top",MOST_RECENT:"most_recent",PRECAPTURE_MOST_RECENT:"precapture_most_recent",POSTCAPTURE_MOST_RECENT:"postcapture_most_recent",MASKS:"masks",STYLE:"style",PRECAPTURE_STYLE:"precapture_style",POSTCAPTURE_STYLE:"postcapture_style",FRAMES:"frames",PRECAPTURE_FRAMES:"precapture_frames",POSTCAPTURE_FRAMES:"postcapture_frames",FB_ONLY:"fb_only",PRECAPTURE_FB_ONLY:"precapture_fb_only",POSTCAPTURE_FB_ONLY:"postcapture_fb_only",SELF:"self",DOODLES:"doodles",ADJUSTMENT_MODES:"adjustment_modes",EDITING:"editing"})}),null);
__d("FXProductVisibilityPolicyType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ALL_PRODUCTS:0,OWNING_PRODUCT_ONLY:1,SPECIFIC_PRODUCTS:2,ALL_EXCEPT_PRODUCTS:3,ANY_FACEBOOK_UNIVERSE:4})}),null);
__d("MediaEffectContentGeneralDetailsStore",["fbt","DayPartingGrid","FluxReduceStore","FXEntMediaEffectStatus","FXInspirationsCategoryName","FXMediaEffectProduct","FXProductVisibilityPolicyType","FXProductVisibilityPolicyTypeLabels","immutable","InspirationsCaptureMode","MediaEffectARStudioFileUtils","MediaEffectARStudioSaveUtils","MediaEffectDialogsDispatcher"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i;c=b("immutable").List;d=b("immutable").Record;var j="124024574287414",k="ig_camera_core_team";f=function(){return{value:[b("FXInspirationsCategoryName").MASKS,b("FXInspirationsCategoryName").FRAMES,b("FXInspirationsCategoryName").STYLE].map(function(a){return{name:a,value:!1}})}};var l=function(){return{value:Object.keys(b("InspirationsCaptureMode")).map(function(a){return{name:a,value:!1}})}},m=function(){return Object.keys(b("FXProductVisibilityPolicyType")).map(function(a){return{label:b("FXProductVisibilityPolicyTypeLabels")[a],value:b("FXProductVisibilityPolicyType")[a]}})},n=function(){return{value:Object.keys(b("FXMediaEffectProduct")).map(function(a){return{name:a,value:!1}})}},o=function(a){return!a?[]:Object.keys(a).map(function(b){return{label:a[b],value:b}})};h=babelHelpers.inherits(p,d({contentName:{value:""},showSchedule:!1,startTime:{},endTime:{},timezone:{},keywords:{value:[]},inspirationCategories:f(),humanDescription:{},isContentContainLiteralText:{value:!1},isFBOnlyVisibility:{value:!1},selectedPolicyType:{value:1},productVisibility:n(),selectedInstruction:{},offlineOnly:{value:!1},selfBirthdayOnly:{value:!1},fbExperimentID:null,page:{value:{}},selectedRankingType:{},rankingCustomValue:{},locales:{value:[]},adsTargeting:{},hasWhitelistUsersEligibility:{value:!1},whitelistUsers:{value:[]},eligibilityGateKeepers:{value:[]},catalogGateKeepers:{value:[]},attributedOwner:{value:{}},selectedInstagramAttribution:null,instagramCameraFormat:{},instagramGatelogic:{value:null},igLaunchTimeForBadging:{value:null},timing:{value:new(b("DayPartingGrid"))()},showTiming:!1,showLocation:!1,location:{value:{}},locationPin:{isFetching:!1,showRadius:!1,value:{}},locationConstrained:{value:!1},multiLocation:{},id:null,status:{},reviewStatus:null,additionalStatus:null,couldToggleManually:!1,submissionStatus:null,flowType:null,creationTime:"",creator:null,trailingReviewRejected:!1,hasEnabledActivations:!1,rejectedReasons:[],policyTypes:m(),instructions:[],instagramAttributions:c(),captureModes:l(),cryptoHash:"",testingLinkRemainingDailyUses:null,isStoreDirty:!1,fbOnlySection:null}));h&&h.prototype;function p(){h.apply(this,arguments)}i=babelHelpers.inherits(a,b("FluxReduceStore"));i&&i.prototype;a.prototype.getInitialState=function(){return new p()};a.prototype.reduce=function(a,c){__p&&__p();var d=this,e=void 0,f=void 0,h=void 0,i=void 0,l=void 0,m=void 0;void 0;var p=void 0,q=void 0,r=!0;switch(c.type){case"MediaEffectGeneralContentDetails/contentName/update":a=this.getState();a=a.set("contentName",Object.assign({},a.get("contentName"),{error:null},c.payload));break;case"MediaEffectGeneralContentDetails/humanDescription/update":a=this.getState();a=a.set("humanDescription",Object.assign({},a.get("humanDescription"),c.payload));break;case"ARStudioFileDetails/projectFile/update":a=this.getState();a.get("contentName").value||(a=a.set("contentName",Object.assign({},a.get("contentName"),{error:null,value:b("MediaEffectARStudioFileUtils").getDefaultContentNameFromFile(c.payload)})));break;case"MediaEffectGeneralContentDetails/showSchedule/update":a=this.getState().set("showSchedule",c.payload);break;case"MediaEffectGeneralContentDetails/startTime/update":a=this.getState();a=a.set("startTime",Object.assign({},a.get("startTime"),c.payload));break;case"MediaEffectGeneralContentDetails/endTime/update":a=this.getState();var s=c.payload.value,t=a.get("startTime").value;a=a.set("endTime",Object.assign({},a.get("endTime"),c.payload,{error:s<t?g._("Time range is invalid."):null}));break;case"MediaEffectGeneralContentDetails/timezone/update":a=this.getState();a=a.set("timezone",Object.assign({},a.get("timezone"),c.payload));break;case"MediaEffectGeneralContentDetails/schedule/clear":a=this.getState().set("startTime",{}).set("endTime",{}).set("timezone",{});break;case"MediaEffectGeneralContentDetails/endTime/clear":a=this.getState().set("endTime",{});break;case"MediaEffectGeneralContentDetails/keywords/add":a=this.getState();e=a.get("keywords").value;a=a.set("keywords",{value:e.concat([c.payload])});break;case"MediaEffectGeneralContentDetails/keywords/remove":a=this.getState();e=a.get("keywords").value;var u=c.payload;s=e.findIndex(function(a){return a.title===u.title});a=a.set("keywords",{value:[].concat(e.slice(0,s),e.slice(s+1))});break;case"MediaEffectGeneralContentDetails/whitelistUsers/add":a=this.getState();f=a.get("whitelistUsers").value;a=a.set("whitelistUsers",{value:f.concat([c.payload])});break;case"MediaEffectGeneralContentDetails/whitelistUsers/remove":a=this.getState();f=a.get("whitelistUsers").value;var v=c.payload;t=f.findIndex(function(a){return a.title===v.title});a=a.set("whitelistUsers",{value:[].concat(f.slice(0,t),f.slice(t+1))});break;case"MediaEffectGeneralContentDetails/hasWhitelistUsersEligibility/update":a=this.getState();a=a.set("hasWhitelistUsersEligibility",Object.assign({},a.get("hasWhitelistUsersEligibility"),c.payload));break;case"MediaEffectGeneralContentDetails/isContentContainLiteralText/update":a=this.getState();a=a.set("isContentContainLiteralText",Object.assign({},a.get("isContentContainLiteralText"),c.payload));break;case"MediaEffectGeneralContentDetails/isFBOnlyVisibility/update":a=this.getState();a=a.set("isFBOnlyVisibility",Object.assign({},a.get("isFBOnlyVisibility"),c.payload));break;case"MediaEffectGeneralContentDetails/selectedPolicyType/update":a=this.getState();a=a.set("selectedPolicyType",Object.assign({},a.get("selectedPolicyType"),c.payload));this.shouldShowProducts()||(a=a.set("productVisibility",n()));break;case"MediaEffectGeneralContentDetails/productVisibility/update":e=function(){a=d.getState();var b=a.get("productVisibility").value,e=c.payload,f=b.findIndex(function(a){return a.name===e.name});a=a.set("productVisibility",{value:[].concat(b.slice(0,f),[e],b.slice(f+1))});return"break"}();if(e==="break")break;case"MediaEffectGeneralContentDetails/offlineOnly/update":a=this.getState();a=a.set("offlineOnly",Object.assign({},a.get("offlineOnly"),c.payload));break;case"MediaEffectGeneralContentDetails/selfBirthdayOnly/update":a=this.getState();a=a.set("selfBirthdayOnly",Object.assign({},a.get("selfBirthdayOnly"),c.payload));break;case"MediaEffectGeneralContentDetails/page/update":a=this.getState();a=a.set("page",Object.assign({},a.get("page"),c.payload));break;case"MediaEffectGeneralContentDetails/page/clear":a=this.getState().set("page",{value:{}});break;case"MediaEffectGeneralContentDetails/attributedOwner/update":a=this.getState();a=a.set("attributedOwner",Object.assign({},a.get("attributedOwner"),c.payload));break;case"MediaEffectGeneralContentDetails/attributedOwner/clear":a=this.getState().set("attributedOwner",{value:{}});break;case"MediaEffectGeneralContentDetails/selectedRankingType/update":a=this.getState();a=a.set("selectedRankingType",Object.assign({},a.get("selectedRankingType"),c.payload));c.payload.value!=="MANUAL"&&(a=a.set("rankingCustomValue",{}));break;case"MediaEffectGeneralContentDetails/rankingCustomValue/update":a=this.getState();a=a.set("rankingCustomValue",Object.assign({},a.get("rankingCustomValue"),c.payload));break;case"MediaEffectGeneralContentDetails/eligibilityGateKeepers/add":a=this.getState();l=a.get("eligibilityGateKeepers").value;a=a.set("eligibilityGateKeepers",{value:l.concat([c.payload])});break;case"MediaEffectGeneralContentDetails/eligibilityGateKeepers/remove":a=this.getState();l=a.get("eligibilityGateKeepers").value;h=c.payload;i=l.findIndex(function(a){return a.title===h.title});a=a.set("eligibilityGateKeepers",{value:[].concat(l.slice(0,i),l.slice(i+1))});break;case"MediaEffectGeneralContentDetails/catalogGateKeepers/add":a=this.getState();m=a.get("catalogGateKeepers").value;a=a.set("catalogGateKeepers",{value:m.concat([c.payload])});break;case"MediaEffectGeneralContentDetails/catalogGateKeepers/remove":a=this.getState();m=a.get("catalogGateKeepers").value;h=c.payload;i=m.findIndex(function(a){return a.title===h.title});a=a.set("catalogGateKeepers",{value:[].concat(m.slice(0,i),m.slice(i+1))});break;case"MediaEffectGeneralContentDetails/instagramCameraFormat/update":a=this.getState();a=a.set("instagramCameraFormat",Object.assign({},a.get("instagramCameraFormat"),c.payload));break;case"MediaEffectGeneralContentDetails/instagramGatelogic/update":a=this.getState();a=a.set("instagramGatelogic",Object.assign({},a.get("instagramGatelogic").value,c.payload));break;case"MediaEffectGeneralContentDetails/igLaunchTimeForBadging/update":a=this.getState();a=a.set("igLaunchTimeForBadging",Object.assign({},a.get("igLaunchTimeForBadging").value,c.payload));break;case"MediaEffectContentOwner/selectedOwner/update":q=c.payload.value;p=null;a=this.getState();q===j&&(p=a.get("instagramGatelogic").value,p===null&&a.get("id")===null&&(p=k));a=a.set("instagramGatelogic",{value:p});break;case"MediaEffectGeneralContentDetails/timing/update":a=this.getState();a=a.set("timing",Object.assign({},c.payload));break;case"MediaEffectGeneralContentDetails/timing/clear":a=this.getState().set("timing",{value:new(b("DayPartingGrid"))()});break;case"MediaEffectGeneralContentDetails/showTiming/update":a=this.getState().set("showTiming",c.payload);break;case"MediaEffectGeneralContentDetails/location/update":a=this.getState();a=a.set("location",Object.assign({},a.get("location"),{error:null},c.payload));break;case"MediaEffectGeneralContentDetails/location/clear":a=this.getState().set("location",{value:{}});break;case"MediaEffectGeneralContentDetails/showLocation/update":a=this.getState().set("showLocation",c.payload);break;case"MediaEffectGeneralContentDetails/locationPin/update":a=this.getState();a=a.set("locationPin",Object.assign({},a.get("locationPin"),{error:null},c.payload));break;case"MediaEffectGeneralContentDetails/locationPin/clear":a=this.getState().set("locationPin",{value:{}});break;case"MediaEffectGeneralContentDetails/locationPin/startFetching":a=this.getState();a=a.set("locationPin",Object.assign({},a.get("locationPin"),{error:null},{isFetching:!0}));break;case"MediaEffectGeneralContentDetails/locationPin/stopFetching":a=this.getState();a=a.set("locationPin",Object.assign({},a.get("locationPin"),{error:null},{isFetching:!1}));a=a.set("location",Object.assign({},a.get("location"),{error:null}));break;case"MediaEffectGeneralContentDetails/showRadius/update":a=this.getState();s=a.get("locationPin");a=a.set("locationPin",Object.assign({},s,{showRadius:c.payload}));break;case"MediaEffectGeneralContentDetails/radius/update":a=this.getState();s=a.get("locationPin");a=a.set("locationPin",Object.assign({},s,{value:Object.assign({},s.value,{radius:c.payload})}));break;case"MediaEffectGeneralContentDetails/locationAll/clear":a=this.getState().set("location",{value:{}}).set("locationPin",{value:{}});break;case"MediaEffectGeneralContentDetails/locationConstrained/update":a=this.getState();a=a.set("locationConstrained",Object.assign({},c.payload));break;case"MediaEffectGeneralContentDetails/multiLocation/update":a=this.getState();a=a.set("multiLocation",Object.assign({},a.get("multiLocation"),c.payload));break;case"MediaEffectGeneralContentDetails/inspirationCategory/update":a=this.getState();f=a.get("inspirationCategories").value;var w=c.payload;t=f.findIndex(function(a){return a.name===w.name});a=a.set("inspirationCategories",{value:[].concat(f.slice(0,t),[w],f.slice(t+1))});break;case"MediaEffectGeneralContentDetails/locales/update":a=this.getState();a=a.set("locales",Object.assign({},a.get("locales"),c.payload));break;case"MediaEffectGeneralContentDetails/adsTargeting/update":a=this.getState();a=a.set("adsTargeting",Object.assign({},a.get("adsTargeting"),c.payload));break;case"MediaEffectGeneralContentDetails/selectedInstruction/update":a=this.getState();a=a.set("selectedInstruction",Object.assign({},a.get("selectedInstruction"),c.payload));break;case"MediaEffectGeneralContentDetails/status/startFetching":a=this.getState();a=a.set("status",Object.assign({},a.get("status"),{error:null},{isFetching:!0}));break;case"MediaEffectGeneralContentDetails/status/stopFetching":a=this.getState();a=a.set("status",Object.assign({},a.get("status"),{error:null},{isFetching:!1}));break;case"MediaEffectGeneralContentDetails/status/update":a=this.getState();a=a.set("status",Object.assign({},c.payload));break;case"MediaEffectGeneralContentDetails/hasEnabledActivations/update":a=this.getState();a=a.set("hasEnabledActivations",c.payload);break;case"MediaEffectGeneralContentDetails/testingLink/update":a=this.getState();a=a.set("cryptoHash",c.payload);break;case"MediaEffectGeneralContentDetails/initEffect":e=function(){__p&&__p();a=d.getState();var e=c.payload.activationData;e.startTime&&(a=a.set("startTime",{value:e.startTime*1e3}).set("showSchedule",!0));e.endTime&&(a=a.set("endTime",{value:e.endTime*1e3}));a=a.set("timezone",{value:e.timezone});var f=e.location;f&&(a=a.set("showLocation",!0),a=a.set("location",{value:{uniqueID:f.key,title:f.name}}),a=a.set("locationPin",{showRadius:f.manual_geo,value:{latitude:f.latitude,longitude:f.longitude,polygons:f.polygons,radius:f.radius}}),a=a.set("locationConstrained",{value:f.constrain_eligibility}));f=c.payload.metadataData;a=a.set("keywords",{value:f.tags});a=a.set("submissionStatus",f.submissionStatus);a=a.set("attributedOwner",{value:{uniqueID:f.attributedOwnerID,title:f.attributedOwnerTitle}});var g=c.payload.content;a=a.set("id",g.id).set("status",{value:g.status}).set("reviewStatus",g.reviewStatus).set("additionalStatus",g.additionalStatus).set("couldToggleManually",g.couldToggleManually).set("creator",g.creator).set("trailingReviewRejected",g.trailingReviewRejected).set("flowType",g.flowType).set("contentName",{value:g.name}).set("hasEnabledActivations",g.hasEnabledActivations).set("rejectedReasons",g.rejectedReasons||[]).set("creationTime",g.creationTime).set("cryptoHash",g.cryptoHash).set("testingLinkRemainingDailyUses",g.testingLinkRemainingDailyUses);a=a.set("catalogGateKeepers",{value:e.fbCatalogGKs.map(function(a){return{uniqueID:a,title:a}})});a=a.set("eligibilityGateKeepers",{value:e.fbEligibilityGKs.map(function(a){return{uniqueID:a,title:a}})});a=a.set("page",{value:e.fbPageLiked});a=a.set("selectedRankingType",{value:e.fbBoosted?"BOOST":e.fbRankWeight!==null?"MANUAL":"DEFAULT"});e.fbRankWeight!==null&&(a=a.set("rankingCustomValue",{value:e.fbRankWeight}));a=a.set("whitelistUsers",{value:f.fbWhitelistedUsers.map(function(a){return{uniqueID:a.uniqueID,title:a.name}})});a=a.set("hasWhitelistUsersEligibility",{value:f.fbWhitelistCheckEligibility});p=e.gatelogic;p===null&&a.get("id")===null&&f.connectAppID===j&&(p=k);a=a.set("instagramGatelogic",{value:p});a=a.set("selectedInstagramAttribution",f.selectedInstagramAttributionID);a=a.set("instagramAttributions",f.instagramAttributions);a=a.set("isContentContainLiteralText",{value:f.effectHasText});a=a.set("isFBOnlyVisibility",{value:f.fbOnlyMediaRestriction});a=a.set("humanDescription",{value:f.humanReadableDescription});a=a.set("instagramCameraFormat",{value:e.igCameraFormat});a=a.set("locales",{value:e.locales});a=a.set("selectedInstruction",{value:f.selectedInstructionID});a=a.set("offlineOnly",{value:f.offlineOnly});a=a.set("selfBirthdayOnly",{value:e.selfBirthday});a=a.set("selectedPolicyType",{value:f.productVisibilityPolicy.type});var h=f.productVisibilityPolicy.products;h&&h.length>0&&(function(){var b=a.get("productVisibility").value,c=h.map(function(a){return a.toUpperCase()});b=b.map(function(a){return{name:a.name,value:c.includes(a.name)}});a=a.set("productVisibility",{value:b})})();a=a.set("timing",{value:b("MediaEffectARStudioSaveUtils").convertTimingToGrid(e.timingSchedule)});a=a.set("showTiming",e.timingSchedule&&e.timingSchedule.length>0);a=a.set("adsTargeting",{value:e.adsTargetingSpec?JSON.parse(e.adsTargetingSpec):null});var i=f.inspirationCategoryNames;if(i&&i.length>0){g=a.get("inspirationCategories").value;g=g.map(function(a){return{name:a.name,value:i.includes(a.name)}});a=a.set("inspirationCategories",{value:g})}var l=f.captureModes;if(l&&l.length>0){e=a.get("captureModes").value;e=e.map(function(a){return{name:a.name,value:l.includes(a.name.toLowerCase())}});a=a.set("captureModes",{value:e})}r=!1;return"break"}();if(e==="break")break;case"MediaEffectGeneralContentDetails/initDropdowns":a=this.getState().set("instructions",o(c.payload.instructions));break;case"MediaEffectARStudioDetailDialog/open":case"ARStudioFileUploadDialog/open":a=this.getInitialState();break;case"MediaEffectGeneralContentDetails/captureModes/update":a=this.getState();l=a.get("captureModes").value;var x=c.payload;m=l.findIndex(function(a){return a.name.toLowerCase()===x.name.toLowerCase()});a=a.set("captureModes",{value:[].concat(l.slice(0,m),[x],l.slice(m+1))});break;case"MediaEffectGeneralContentDetails/instagramAttribution/update":a=this.getState();a=a.set("selectedInstagramAttribution",c.payload.value);break;case"MediaEffectGeneralContentDetails/update/fbOnlySection":a=a.set("fbOnlySection",c.payload);r=!1;break;default:r=!1;break}a=a.set("isStoreDirty",r);return a};a.prototype.shouldShowProducts=function(){var a=this.getState().get("selectedPolicyType").value;return a===b("FXProductVisibilityPolicyType").SPECIFIC_PRODUCTS||a===b("FXProductVisibilityPolicyType").ALL_EXCEPT_PRODUCTS};a.prototype.shouldShowRankingCustom=function(){return this.getState().get("selectedRankingType").value==="MANUAL"};a.prototype.getInstagramAttribution=function(){__p&&__p();var a=this.getState(),b=a.get("selectedInstagramAttribution");if(!b)return null;var c={id:b};a=a.get("instagramAttributions");if(a){a=a.filter(function(a){return a.id===b});a&&a.length>0&&(c=a[0])}return c};a.prototype.shouldShowLocation=function(){return this.getState().get("showLocation")};a.prototype.isArchived=function(){return this.getState().get("status").value===b("FXEntMediaEffectStatus").ARCHIVED};a.prototype.isRejected=function(){return this.getState().get("status").value===b("FXEntMediaEffectStatus").NOT_APPROVED};a.prototype.isDraft=function(){return this.getState().get("status").value===b("FXEntMediaEffectStatus").DRAFT};a.prototype.isEditDisabled=function(){var a=this.getState().get("status");return a.value===b("FXEntMediaEffectStatus").ARCHIVED||a.value===b("FXEntMediaEffectStatus").NOT_APPROVED};function a(){i.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("MediaEffectDialogsDispatcher"))}),null);
__d("MediaEffectARStudioSaveUtils",["AsyncResponse","DayPartingGrid","DayPartingUtils","FXEntMediaEffectSubmissionStatus","MediaEffectFBOnlyUtils","MediaEffectRequestBuilder","WebStorage"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("WebStorage").getLocalStorage(),h="media_effects_legal_agreement_indication",i=60*60;a={saveEffectDetails:function(a,c){var d=this.getDetailDialogRequestData(a),e=d.data;d=d.files;this.save(a.contentId,!1,a.submissionStatus===b("FXEntMediaEffectSubmissionStatus").APPROVED,e,d,c)},publishEffect:function(a,b){var c=this.getUploadDialogRequestData(a),d=c.data;c=c.files;this.save(a.contentId,!1,!1,d,c,b)},saveDraftEffect:function(a,b,c){var d=this.getUploadDialogRequestData(a),e=d.data;d=d.files;e.media_effect_save_as_draft=!0;this.save(a.contentId,b,!1,e,d,c)},save:function(a,c,d,e,f,g){b("MediaEffectRequestBuilder").forARStudioEffect.forSave(a,c,d,e,f).setOnSuccessComplete(function(a){g&&g(!0,a)}).setOnFailureComplete(function(a){g&&g(!1,a),b("AsyncResponse").defaultErrorHandler(a)}).genSend()},getUploadDialogRequestData:function(a){a=this.getDialogRequestData(a,a.contentName.value,a.selectedOwner.value?a.selectedOwner.value.id:null);var b=a.data;a=a.files;return{data:b,files:a}},getDetailDialogRequestData:function(a){a=this.getDialogRequestData(a,a.contentName.value,a.selectedOwner.value?a.selectedOwner.value.id:null);var b=a.data;a=a.files;return{data:b,files:a}},getDataFromWrapperTypeArray:function(a,b){if(!a)return undefined;a=a.map(b).filter(function(a){return a!==""});return a.length===0?undefined:a},convertTimingToGrid:function(a){__p&&__p();var c=new(b("DayPartingGrid"))();if(!a||a.length===0)return c;var d=0,e=0;for(var f=0;f<b("DayPartingUtils").DAYS_IN_WEEK;f++)for(var g=0;g<b("DayPartingUtils").HOURS_IN_DAY;g++){var h=a[d];if(!h)return c;c.hours[f][g]=h.start_time<=e&&e<h.end_time;e>=h.end_time&&d++;e+=i}return c},convertTimingFromGrid:function(a){var c=null,d=[];if(!a||a.length===0)return undefined;var e=0;for(var f=0;f<b("DayPartingUtils").DAYS_IN_WEEK;f++)for(var g=0;g<b("DayPartingUtils").HOURS_IN_DAY;g++)c===null?a.hours[f][g]&&(c=e):a.hours[f][g]||(d[d.length]={start_time:c,end_time:e-1},c=null),e+=i;c&&(d[d.length]={start_time:c,end_time:e-1});return d},getDialogRequestData:function(a,c,d){__p&&__p();var e=a.shouldShowFBOnlyMetadata,f=b("MediaEffectFBOnlyUtils").getFBOnlyFields(),g=a.locationPin,h=a.showLocation&&g.value&&g.value.latitude&&g.value.longitude;h=h?{page_id:a.location.value?a.location.value.uniqueID:undefined,location:g.showRadius&&g.value?{latitude:g.value.latitude,longitude:g.value.longitude,radius_km:g.value.radius}:undefined,constrain_eligibility:!!a.locationConstrained.value}:undefined;g={connected_app_id:a.selectedApp.value&&a.selectedApp.value.id,effect_description:a.reviewDescription.value,end_time:a.endTime&&a.endTime.value?Math.floor(a.endTime.value/1e3):undefined,media_effect_owner:d,media_effect_save_as_draft:!1,media_effect_tags:a.keywords.value.map(function(a){return a.title}),multi_location_targeting:a.multiLocation.value?JSON.stringify(a.multiLocation.value):undefined,name:c,start_time:a.startTime&&a.startTime.value?Math.floor(a.startTime.value/1e3):undefined,targeting_place:h,timezone:a.timezone.value};if(e){d=function(a){return a.uniqueID?a.uniqueID:""};g=Object.assign(g,{fb_catalog_gks:this.getDataFromWrapperTypeArray(f.catalogGateKeepers.value,d),fb_eligibility_gks:this.getDataFromWrapperTypeArray(f.eligibilityGateKeepers.value,d),fb_only_media_restriction:f.isFBOnlyVisibility.value,fb_page_liked:f.page.value&&f.page.value.uniqueID?f.page.value.uniqueID:undefined,fb_ranking_boosted:f.selectedRankingType.value==="BOOST",fb_ranking_weight:f.selectedRankingType.value==="MANUAL"?f.rankingCustomValue.value:undefined,fb_whitelisted_user_ids:this.getDataFromWrapperTypeArray(f.whitelistUsers.value,d),fb_whitelist_check_eligibility:f.hasWhitelistUsersEligibility.value,gatelogic:f.instagramGatelogic?f.instagramGatelogic.value:undefined,ig_launch_time_for_badging:f.igLaunchTimeForBadging?f.igLaunchTimeForBadging.value:0,instagram_attribution_id:f.instagramAttribution?f.instagramAttribution.id:undefined,has_text:f.isContentContainLiteralText.value,human_readable_description:f.humanDescription.value,ig_camera_format:f.instagramCameraFormat.value,locales:f.locales.value,meida_effect_instruction:f.selectedInstruction.value,offline_only:f.offlineOnly.value,product_visibility_policy:f.selectedPolicyType.value?{type:f.selectedPolicyType.value,products:this.getDataFromWrapperTypeArray(f.productVisibility.value.filter(function(a){return a.value}),function(a){return a.name?a.name.toLowerCase():""})}:undefined,self_birthday:f.selfBirthdayOnly.value,timing_schedule:this.convertTimingFromGrid(f.timing.value),ads_targeting_spec:f.adsTargeting.value?JSON.stringify(f.adsTargeting.value):undefined,inspiration_category_names:this.getDataFromWrapperTypeArray(f.inspirationCategories.value.filter(function(a){return a.value}),function(a){return a.name?a.name:""}),capture_modes:this.getDataFromWrapperTypeArray(a.captureModes.value.filter(function(a){return a.value}),function(a){return a.name?a.name.toLowerCase():""})});c=f.attributedOwner.value&&f.attributedOwner.value.uniqueID?f.attributedOwner.value.uniqueID:null;c!==null?g.attributed_owner=c:delete g.attributed_owner;h=f.instagramAttribution&&f.instagramAttribution.id?f.instagramAttribution.id:null;h!==null?g.instagram_attribution_id=h:delete g.instagram_attribution_id}e=a.uncompressedArfxFile;d=a.etcArfxFile;c=a.pvrArfxFile;f=[];e&&e.file&&f.push(e.file);d&&d.file&&f.push(d.file);c&&c.file&&f.push(c.file);h=a.screencastFile?a.screencastFile.reviewMaterialID:null;e={data:g,files:{effect_review_material_id:h,thumbnail_file:a.thumbnailFile?a.thumbnailFile.file:null,project_file:a.projectFile?a.projectFile.file:null,mask_files:f}};return e},saveLegalAgreementStateForEffect:function(a,b){if(!g)return!1;!1;var c=this.getEffectsToLegalAgreementMapping();c[a]=b;try{g.setItem(h,JSON.stringify(c)),a=!0}catch(b){a=!1}return a},getEffectsToLegalAgreementMapping:function(){if(!g)return{};var a={},b=g.getItem(h);if(b)try{a=JSON.parse(b)}catch(b){a={}}return a}};e.exports=a}),null);
__d("MediaEffectFBOnlyUtils",["MediaEffectARStudioFileDetailsStore","MediaEffectContentGeneralDetailsStore","MediaEffectDialogsDispatcher"],(function(a,b,c,d,e,f){"use strict";a={getFBOnlyFields:function(){var a=b("MediaEffectARStudioFileDetailsStore").getState(),c=b("MediaEffectContentGeneralDetailsStore").getState();return{inspirationCategories:c.get("inspirationCategories"),humanDescription:c.get("humanDescription"),isContentContainLiteralText:c.get("isContentContainLiteralText"),isFBOnlyVisibility:c.get("isFBOnlyVisibility"),selectedPolicyType:c.get("selectedPolicyType"),policyTypes:c.get("policyTypes"),productVisibility:c.get("productVisibility"),selectedInstruction:c.get("selectedInstruction"),instructions:c.get("instructions"),offlineOnly:c.get("offlineOnly"),selfBirthdayOnly:c.get("selfBirthdayOnly"),fbExperimentID:c.get("fbExperimentID"),page:c.get("page"),selectedRankingType:c.get("selectedRankingType"),rankingCustomValue:c.get("rankingCustomValue"),locales:c.get("locales"),adsTargeting:c.get("adsTargeting"),hasWhitelistUsersEligibility:c.get("hasWhitelistUsersEligibility"),whitelistUsers:c.get("whitelistUsers"),eligibilityGateKeepers:c.get("eligibilityGateKeepers"),catalogGateKeepers:c.get("catalogGateKeepers"),attributedOwner:c.get("attributedOwner"),instagramAttribution:b("MediaEffectContentGeneralDetailsStore").getInstagramAttribution(),instagramCameraFormat:c.get("instagramCameraFormat"),instagramGatelogic:c.get("instagramGatelogic"),igLaunchTimeForBadging:c.get("igLaunchTimeForBadging"),timing:c.get("timing"),showTiming:c.get("showTiming"),thumbnailFile:a.get("thumbnailFile"),isEditDisabled:b("MediaEffectContentGeneralDetailsStore").isEditDisabled()}},showFBOnlySection:function(a){b("MediaEffectDialogsDispatcher").dispatch({type:"MediaEffectGeneralContentDetails/update/fbOnlySection",payload:a})}};e.exports=a}),null);
__d("XMediaEffectAsyncMaskDialogDataController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/mask/dialog/data/",{})}),null);
__d("XMediaEffectAsyncMaskDialogFetchController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/mask/dialog/fetch/",{media_effect_id:{type:"FBID"}})}),null);
__d("MediaEffectARStudioStoreUtils",["Promise","AsyncRequest","FXEntMediaEffectStatus","MediaEffectARStudioSaveUtils","MediaEffectDialogsDispatcher","URI","XMediaEffectAsyncMaskDialogDataController","XMediaEffectAsyncMaskDialogFetchController","goURI","promiseDone"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={openUploadPage:function(a){this.openDialog(b("FXEntMediaEffectStatus").DRAFT),b("promiseDone")(g.fetchDialogData())},openTestPage:function(a,c){this.openDialog(b("FXEntMediaEffectStatus").DRAFT);a=this.fetchDialogData().then(this.fetchARStudioEffectData.bind(this,a)).then(c);b("promiseDone")(a)},openUploadDialog:function(a){this.openDialog(b("FXEntMediaEffectStatus").DRAFT);a=this.fetchDialogData().then(a);b("promiseDone")(a)},openDialog:function(a){a===b("FXEntMediaEffectStatus").DRAFT?b("MediaEffectDialogsDispatcher").dispatch({type:"ARStudioFileUploadDialog/open"}):b("MediaEffectDialogsDispatcher").dispatch({type:"MediaEffectARStudioDetailDialog/open"})},openDialogForEffect:function(a,c,d){if(window.location.pathname.indexOf("/fbcameraeffects/")===0&&b("URI").getRequestURI(!1).getFragment().indexOf("effect_id=")===-1){var e=new(b("URI"))(window.location.href);e.setFragment("effect_id="+a);b("goURI")(e.toString(),!1,!0)}this.openDialog(c);e=this.fetchDialogData().then(this.fetchARStudioEffectData.bind(this,a)).then(d);b("promiseDone")(e)},fetchDialogData:function(){var a=b("XMediaEffectAsyncMaskDialogDataController").getURIBuilder().getURI();return new(b("Promise"))(function(c){new(b("AsyncRequest"))(a).setHandler(function(a){a=a.getPayload();a&&(b("MediaEffectDialogsDispatcher").dispatch({type:"ARStudioFileDetails/legalAgreementText/update",payload:{legalAgreementText:a.effectUploadLegalText}}),b("MediaEffectDialogsDispatcher").dispatch({type:"MediaEffectContentOwner/init",payload:{owners:a.ownersData}}),b("MediaEffectDialogsDispatcher").dispatch({type:"MediaEffectContentOwner/selectedOwner/update",payload:{value:a.selectedOwner}}),b("MediaEffectDialogsDispatcher").dispatch({type:"MediaEffectGeneralContentDetails/initDropdowns",payload:{instructions:a.instructionsData}}),b("MediaEffectDialogsDispatcher").dispatch({type:"MediaEffectContentApp/init",payload:{apps:a.appsData}}),b("MediaEffectDialogsDispatcher").dispatch({type:"MediaEffectEnvironmentStore/init",payload:{shouldShowFBOnlyMetadata:a.shouldShowFBOnlyMetadata,shouldShowFirstPartySection:a.shouldShowFirstPartySection,isInternalEnv:a.isInternalEnv}}))}).setFinallyHandler(function(){c()}).send()})},fetchARStudioEffectData:function(a){__p&&__p();var c=b("XMediaEffectAsyncMaskDialogFetchController").getURIBuilder().setFBID("media_effect_id",a).getURI();return new(b("Promise"))(function(a){__p&&__p();new(b("AsyncRequest"))(c).setHandler(function(a){__p&&__p();a=a.getPayload();if(a){b("MediaEffectDialogsDispatcher").dispatch({type:"ARStudioFileDetails/init",payload:a.maskUploadBootstrapData});b("MediaEffectDialogsDispatcher").dispatch({type:"MediaEffectDetailsGallery/init",payload:a.effectUsages});b("MediaEffectDialogsDispatcher").dispatch({type:"MediaEffectGeneralContentDetails/initEffect",payload:{activationData:a.activationData,content:a.effect,metadataData:a.metadataData}});b("MediaEffectDialogsDispatcher").dispatch({type:"MediaEffectContentApp/selectedApp/update",payload:{value:a.metadataData.connectAppID}});b("MediaEffectDialogsDispatcher").dispatch({type:"MediaEffectARStudioDetailDialog/init",payload:Object.assign({},a,{ownerData:a.effect.owner})});b("MediaEffectDialogsDispatcher").dispatch({type:"MediaEffectContentOwner/init",payload:{owners:[a.effect.owner]}});b("MediaEffectDialogsDispatcher").dispatch({type:"MediaEffectContentOwner/selectedOwner/update",payload:{value:a.effect.owner.id}});a.effect.status!==b("FXEntMediaEffectStatus").DRAFT&&b("MediaEffectDialogsDispatcher").dispatch({type:"ARStudioFileDetails/isAgreedWithLegalAgreement/update",payload:{value:!0}});if(a.effect&&a.effect.id){a=b("MediaEffectARStudioSaveUtils").getEffectsToLegalAgreementMapping()[a.effect.id];a&&b("MediaEffectDialogsDispatcher").dispatch({type:"ARStudioFileDetails/isAgreedWithLegalAgreement/update",payload:a})}}}).setFinallyHandler(function(){a()}).send()})}};e.exports=g}),null);
__d("MediaEffectShareReferrer",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CONFIRM_DIALOG:"confirm_dialog",DETAIL_DIALOG:"detail_dialog",HUB_EFFECT_PREVIEW:"hub_effect_preview"})}),null);
__d("XMediaEffectAsyncRequestEffectNotificationController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/async/request_notification/",{effect_id:{type:"FBID"},share_actor_id:{type:"FBID"},share_target_id:{type:"FBID"}})}),null);
__d("XMediaEffectAsyncRequestTryEffectNotificationController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/async/request_try_effect_notification/",{request_source:{type:"Enum",defaultValue:"direct",enumType:1},effect_id:{type:"FBID"},hash:{type:"String"},__asyncDialog:{type:"Int"}})}),null);
__d("XMediaEffectHubEffectArchiveAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/effects/async/archive/",{effect_ids:{type:"FBIDVector",required:!0}})}),null);
__d("XMediaEffectRegenerateTestingLinkAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/async/regenerate_testing_link/",{effect_id:{type:"FBID"}})}),null);
__d("XMediaEffectShareEffectDialogController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/media_effect/share/dialog/",{effect_id:{type:"FBID"},ref:{type:"Enum",required:!0,enumType:1},__asyncDialog:{type:"Int"}})}),null);
__d("MediaEffectHubEffectActionConfig",["fbt","AsyncDialog","AsyncRequest","AsyncResponse","FXMediaEffectType","immutable","MediaEffectARStudioStoreUtils","MediaEffectCreateStep","MediaEffectCreationReferrer","MediaEffectFlowType","MediaEffectHubDispatcher","MediaEffectHubFunnelLogger","MediaEffectMetadataDataLoader","MediaEffectPerformanceLogger","MediaEffectShareReferrer","React","SimpleXUIDialog","URI","XMediaEffectAsyncRequestEffectNotificationController","XMediaEffectAsyncRequestTryEffectNotificationController","XMediaEffectCreateDialogController","XMediaEffectHubEffectArchiveAsyncController","XMediaEffectRegenerateTestingLinkAsyncController","XMediaEffectShareEffectDialogController","XProfilePictureOverlayLandingController","XUIDialogButton.react","XUIDialogCancelButton.react","goURI","mediaEffectGKCheck","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("immutable").Set;function a(a,c,d,e){b("MediaEffectHubFunnelLogger").logActionWithTag("HUB_EFFECT_ACTIVE_STATUS_CHANGE","send:"+(a?"enable":"disable")),b("promiseDone")(b("MediaEffectMetadataDataLoader").changeActiveStatus(a,c).then(function(a){a=a.payload.effects;b("MediaEffectHubFunnelLogger").logActionWithTag("HUB_EFFECT_ACTIVE_STATUS_CHANGE","receive");b("MediaEffectHubDispatcher").dispatch({type:"effects_edited",payload:{effects:a}});d&&d()})["catch"](function(a){b("AsyncResponse").defaultErrorHandler(a),e&&e()}))}function i(a,c,d){__p&&__p();b("MediaEffectHubFunnelLogger").logActionWithTag("HUB_EFFECT_ARCHIVE","send");a=b("XMediaEffectHubEffectArchiveAsyncController").getURIBuilder().setFBIDVector("effect_ids",a.toSeq().map(function(a){return a.id}).toArray()).getURI();new(b("AsyncRequest"))().setURI(a).setHandler(function(a){a=a.payload.effects;b("MediaEffectHubFunnelLogger").logActionWithTag("HUB_EFFECT_ARCHIVE","receive");b("MediaEffectHubDispatcher").dispatch({type:"effects_edited",payload:{effects:a}});b("MediaEffectHubDispatcher").dispatch({type:"effects_selected",payload:{effectIDs:h()}});c&&c()}).setErrorHandler(function(a){b("AsyncResponse").defaultErrorHandler(a),d&&d()}).send()}c={getLabel:function(){return g._("Turn On")},onClick:a.bind(null,!0)};d={getLabel:function(){return g._("Turn Off")},onClick:a.bind(null,!1)};f={getLabel:function(){return g._("Edit")},onClick:function(a){__p&&__p();b("MediaEffectHubFunnelLogger").logActionWithTag("HUB_EFFECT_OPEN","menu-edit");var c=new(b("MediaEffectPerformanceLogger"))().startRecording().setIdentifier("EditAction.onClick").setEffectID(a.id).setEffectType(a.type),d=function(){c.endRecordingAndLog()},e=b("mediaEffectGKCheck")("cep_separated_effect_dialogs");if(e){c.setGKOn(["cep_separated_effect_dialogs"]);if(a.type===b("FXMediaEffectType").MSQRD_MASK){b("MediaEffectARStudioStoreUtils").openDialogForEffect(a.id,a.status,d);return}}else c.setGKOff(["cep_separated_effect_dialogs"]);e=b("XMediaEffectCreateDialogController").getURIBuilder().setEnum("flow_type",b("MediaEffectFlowType").BASIC_HUB).setEnum("step",b("MediaEffectCreateStep").EDIT).setFBID("media_effect_id",a.id).setEnum("ref",b("MediaEffectCreationReferrer").HUB).getURI();b("AsyncDialog").send(new(b("AsyncRequest"))(e),d)}};var j={getLabel:function(){return g._("Duplicate")},onClick:function(a){b("MediaEffectHubFunnelLogger").logActionWithTag("HUB_EFFECT_DUPLICATE");a=b("XMediaEffectCreateDialogController").getURIBuilder().setEnum("flow_type",b("MediaEffectFlowType").BASIC_HUB).setEnum("step",b("MediaEffectCreateStep").DUPLICATE).setFBID("media_effect_id",a.id).setEnum("ref",b("MediaEffectCreationReferrer").HUB).getURI();b("AsyncDialog").send(new(b("AsyncRequest"))(a))}},k={getLabel:function(){return g._("Debug")},onClick:function(a){a=a.id.toString();a=new(b("URI"))("/intern/fx/debug/").setQueryData({effectid:a});b("goURI")(a)}},l={getLabel:function(){return g._("Archive")},onClick:function(a,c,d){return b("SimpleXUIDialog").showEx(g._("Once you archive an effect, it won't be available for people to discover or try. You won't be able to make the effect active again."),g._({"*":"Archive Effects?","_1":"Archive Effect?"},[g._plural(a.size)]),b("React").createElement("div",null,b("React").createElement(b("XUIDialogCancelButton.react"),{action:"cancel"}),b("React").createElement(b("XUIDialogButton.react"),{action:"cancel",label:g._("Archive"),onClick:function(){return i(a,c,d)},use:"confirm"})))}},m={getLabel:function(){return g._("Add to Profile Picture")},onClick:function(a){b("MediaEffectHubFunnelLogger").logActionWithTag("HUB_EFFECT_CHANGE_PROFILE_PICTURE");var c=a.profileFrame&&a.profileFrame.id;if(c){c=b("XProfilePictureOverlayLandingController").getURIBuilder().setInt("selected_overlay_id",c).setInt("profile_id",a.owner.id).getURI();b("goURI")(c)}}},n={getLabel:function(){return g._("Preview On Mobile")},onClick:function(a){a=b("XMediaEffectAsyncRequestEffectNotificationController").getURIBuilder().setFBID("effect_id",a).getURI();new(b("AsyncRequest"))(a).setHandler(function(a){b("SimpleXUIDialog").show(g._("Check your notification on mobile to preview the frame."))}).setErrorHandler(function(a){b("SimpleXUIDialog").show(g._("There was a problem sending the notification."))}).send()}},o={onClick:function(a,c,d){a=b("XMediaEffectAsyncRequestTryEffectNotificationController").getURIBuilder().setFBID("effect_id",a).getURI();new(b("AsyncRequest"))(a).setHandler(function(a){return c&&c()}).setErrorHandler(function(a){return d&&d()}).send()}},p={getLabel:function(){return g._("Share as Page")},onClick:function(a){a=b("XMediaEffectShareEffectDialogController").getURIBuilder().setFBID("effect_id",a.id.toString()).setEnum("ref",b("MediaEffectShareReferrer").HUB_EFFECT_PREVIEW).getURI();b("AsyncDialog").send(new(b("AsyncRequest"))(a))}},q={onClick:function(a,c){a=b("XMediaEffectRegenerateTestingLinkAsyncController").getURIBuilder().setFBID("effect_id",a).getURI();new(b("AsyncRequest"))(a).setHandler(function(a){return c&&c(a.payload)}).send()}};e.exports={activate:c,archive:l,debug:k,changeActiveStatus:a,changeProfilePicture:m,deactivate:d,duplicate:j,edit:f,previewOnMobile:n,tryEffectOnMobileAction:o,shareEffect:p,regenerateTestingLinkAction:q}}),null);
__d("MediaEffectGenerationType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({AUTO_GENERATED:"auto_generated",USER_GENERATED:"user_generated",UNKNOWN:""})}),null);
__d("MediaEffectStatusText.react",["MediaEffectHubStrings","React"],(function(a,b,c,d,e,f){"use strict";a=function(a){a=a.status;if(!a)return null;a=b("MediaEffectHubStrings").getStatusText(a);return!a?null:b("React").createElement("span",null,a)};e.exports=a}),null);
__d("MediaEffectContentStatusTitle.react",["cx","FXEntMediaEffectStatus","MediaEffectStatusText.react","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";var h=(a={},a[b("FXEntMediaEffectStatus").NOT_REVIEWED]="_2l85",a[b("FXEntMediaEffectStatus").IN_REVIEW]="_2l87",a[b("FXEntMediaEffectStatus").NOT_APPROVED]="_2l89",a[b("FXEntMediaEffectStatus").APPROVED]="_2l7j",a[b("FXEntMediaEffectStatus").UPDATE_IN_REVIEW]="_2l87",a[b("FXEntMediaEffectStatus").UPDATE_REJECTED]="_2l89",a);c=function(a){var c=a.className;a=a.status;var d=a?h[a]:null;return b("React").createElement("div",{className:b("joinClasses")("_2l7i",c)},d&&b("React").createElement("span",{className:b("joinClasses")("_3-8_ _4ppg _2l7h",d)}),b("React").createElement("span",{className:"_4ppi"},b("React").createElement(b("MediaEffectStatusText.react"),{status:a})))};e.exports=c}),null);
__d("MediaEffectOwnerHubEffectCard.react",["cx","fbt","AsyncDialog","AsyncRequest","ContextualDialogArrow","ContextualLayerAutoFlip","FXEntMediaEffectStatus","Layout.react","List.react","MediaEffectContentStatusTitle.react","MediaEffectMetadataActionCreators","Link.react","Log","MediaEffectCreateStep","MediaEffectHubViewTab","MediaEffectOwnerHubHeader.react","MediaEffectReactFrameEditorPreviewCanvasContainer.react","PopoverMenu.react","React","ReactXUIMenu","XMediaEffectCreateDialogController","XUICard.react","XUICardSection.react","XUIText.react","MediaEffectCreationReferrer"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("Layout.react").Column,k=b("Layout.react").FillColumn,l=b("ReactXUIMenu").Item,m="archive",n="toggle";c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.onEffectLinkClick=function(){var a=b("XMediaEffectCreateDialogController").getURIBuilder().setEnum("flow_type",this.props.flowType).setEnum("step",b("MediaEffectCreateStep").EDIT).setFBID("media_effect_id",this.props.effectID).setEnum("ref",b("MediaEffectCreationReferrer").HUB).getURI();b("AsyncDialog").send(new(b("AsyncRequest"))(a),function(a){a.subscribe(["hide","success"],function(a,event){this.props.effectUpdateHandler(this.props.effectID)}.bind(this))}.bind(this))}.bind(this),this.onMenuItemClick=function(event,a){a=a.item.getValue();switch(a){case n:this.isToggleEnabled()&&this.props.toggleEventHandler(this.props.effectID,this.props.effect.effectData.status===b("FXEntMediaEffectStatus").INACTIVE);break;case m:this.props.archiveEventHandler(this.props.effect.effectData);break;default:b("Log").warn("Unexpected action sent to this handler: "+a)}}.bind(this),c}a.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectMetadataActionCreators").initFrameData(this.props.effect.effectEditorData)};a.prototype.buildMenu=function(){var a=this.props.effect.effectData.status;a=a===b("FXEntMediaEffectStatus").INACTIVE?h._("Turn On"):h._("Turn Off");var c=this.isToggleEnabled();return b("React").createElement(b("ReactXUIMenu"),{onItemClick:this.onMenuItemClick},b("React").createElement(l,{value:n},b("React").createElement("span",{className:(c?"_2ugo":"")+(c?"":" _2ugp")},a)),b("React").createElement(l,{value:m},h._("Archive")))};a.prototype.isToggleEnabled=function(){var a=this.props.effect.effectData.status;return a===b("FXEntMediaEffectStatus").INACTIVE||a===b("FXEntMediaEffectStatus").ACTIVE};a.prototype.render=function(){return b("React").createElement(b("XUICard.react"),null,b("React").createElement(b("MediaEffectOwnerHubHeader.react"),{hubLinkTab:b("MediaEffectHubViewTab").MANAGE,title:this.props.title}),b("React").createElement(b("XUICardSection.react"),null,b("React").createElement(b("Layout.react"),{className:"_2ugq"},b("React").createElement(j,null,b("React").createElement(b("MediaEffectReactFrameEditorPreviewCanvasContainer.react"),{previewHeight:80,previewWidth:80})),b("React").createElement(k,{className:"_2ugr"},b("React").createElement(b("List.react"),{border:"none",spacing:"small"},b("React").createElement("li",null,b("React").createElement(b("Link.react"),{href:"#",onClick:this.onEffectLinkClick},b("React").createElement(b("XUIText.react"),null,this.props.effect.effectData.name))),b("React").createElement("li",null,b("React").createElement(b("MediaEffectContentStatusTitle.react"),{className:"_2ugs",status:this.props.effect.effectData.status})),b("React").createElement("li",null,b("React").createElement(b("XUIText.react"),null,h._({"*":{"*":"{activateCount} Uses","_1":"{activateCount} Use"}},[h._param("activateCount",this.props.effect.effectData.activateCount,[0]),h._plural(this.props.effect.effectData.activateCount)]))))),b("React").createElement(j,{className:"_2ugt"},b("React").createElement(b("PopoverMenu.react"),{alignh:"right",behaviors:[b("ContextualDialogArrow")],layerBehaviors:[b("ContextualLayerAutoFlip")],menu:this.buildMenu(),position:"below"},b("React").createElement("div",{className:"_2ugu"}))))))};e.exports=a}),null);
__d("MediaEffectOwnerHubNullStateCard.react",["cx","invariant","EventPermalinkCameraFramesCreate.react","EventPermalinkCameraFramesCreateWithDefaultFrame.react","MediaEffectFlowType","MediaEffectGenerationType","MediaEffectOwnerHubHeader.react","React","XUICard.react","XUICardSection.react","idx"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){var a;switch(this.props.flowType){case b("MediaEffectFlowType").EVENT:a=(a=this.props)!=null?(a=a.optionalData)!=null?a.eventActionContext:a:a;a||h(0);var c=this.props.effect;if(c&&c.effectData&&c.effectData.generationType===b("MediaEffectGenerationType").AUTO_GENERATED)return b("React").createElement(b("EventPermalinkCameraFramesCreateWithDefaultFrame.react"),{actionContext:a,effect:c,effectUpdateHandler:this.props.effectUpdateHandler,eventID:this.props.owner,flowType:this.props.flowType,key:"EffectCard"+c.effectData.id,title:this.props.title,toggleEventHandler:this.props.toggleEventHandler});else return b("React").createElement(b("EventPermalinkCameraFramesCreate.react"),{actionContext:a,eventID:this.props.owner,title:this.props.title});default:return b("React").createElement(b("XUICard.react"),{className:"_634s"},b("React").createElement(b("MediaEffectOwnerHubHeader.react"),{title:this.props.title}),b("React").createElement(b("XUICardSection.react"),null,b("React").createElement("div",{className:"_fw6"},"No data!")))}};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MediaEffectStoreSharedDispatcher",["ExplicitRegistrationReactDispatcher"],(function(a,b,c,d,e,f){"use strict";var g;c=babelHelpers.inherits(a,b("ExplicitRegistrationReactDispatcher"));g=c&&c.prototype;function a(a){g.constructor.call(this,a),this.dispatch=this.dispatch.bind(this)}e.exports=new a({strict:!1})}),null);
__d("XMediaEffectAsyncFetchEffectController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/async_load_effect/",{effect_ids:{type:"FBIDSet"}})}),null);
__d("MediaEffectStore",["AsyncRequest","FluxLoadObjectStore","LoadObject","MediaEffectGenerationType","MediaEffectStoreSharedDispatcher","XMediaEffectAsyncFetchEffectController","idx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("FluxLoadObjectStore"));g=c&&c.prototype;function a(a){g.constructor.call(this,a),a.explicitlyRegisterStore(this)}a.prototype.reduce=function(a,c){__p&&__p();switch(c.action){case"media_effect/add":return this.__handleOne(a,c.key,c.value);case"media_effect_saved":var d=a.filter(function(a,c){c=a.getValue();return((a=c)!=null?(a=a.effectData)!=null?a.generationType:a:a)===b("MediaEffectGenerationType").USER_GENERATED});return this.__handleOne(d,c.effect.effectData.id,c.effect);case"media_effect/bootstrap":c.bootstrapData.forEach(function(c){a.set(c.effect,b("LoadObject").withValue(c.data))});break;case"media_effect/error":return this.__handleOne(a,c.key,c.error);case"media_effect/reload":this.__load(c.key);return a.remove(c.key);case"media_effect/remove":return a.remove(c.key);case"media_effect/update_effect":d=a.get(c.key).getValue();if(d){d=Object.assign({},d);d.effectData=c.effectData;return this.__handleOne(a.remove(c.key),c.key,d)}break}return a};a.prototype.__load=function(a){var c=b("XMediaEffectAsyncFetchEffectController").getURIBuilder().setFBIDSet("effect_ids",[a]).getURI();new(b("AsyncRequest"))(c).setHandler(function(c){b("MediaEffectStoreSharedDispatcher").dispatch({action:"media_effect/add",key:a,value:c.getPayload().effects[0]})}).setErrorHandler(function(c){b("MediaEffectStoreSharedDispatcher").dispatch({action:"media_effect/error",key:a,error:c.getError()})}).send()};a.__moduleID=e.id;e.exports=new a(b("MediaEffectStoreSharedDispatcher"))}),null);
__d("XMediaEffectAsyncFetchController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/async_load/",{owner_ids:{type:"FBIDSet"},creator_ids:{type:"FBIDSet"},statuses:{type:"EnumSet",enumType:null},submission_statuses:{type:"EnumSet",enumType:null},types:{type:"EnumSet",enumType:null},creation_date_range:{type:"StringToIntMap"},effect_id:{type:"FBID"},effect_name:{type:"String"},effect_tag:{type:"String"},whitelisted:{type:"Bool",defaultValue:!1},gatekeeper:{type:"String"}})}),null);
__d("MediaEffectOwnerStore",["AsyncRequest","FluxLoadObjectStore","FXEntMediaEffectStatus","LoadObject","MediaEffectStore","MediaEffectStoreSharedDispatcher","XMediaEffectAsyncFetchController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=[b("FXEntMediaEffectStatus").ACTIVE,b("FXEntMediaEffectStatus").COMPLETED,b("FXEntMediaEffectStatus").DRAFT,b("FXEntMediaEffectStatus").IN_REVIEW,b("FXEntMediaEffectStatus").INACTIVE,b("FXEntMediaEffectStatus").NOT_APPROVED,b("FXEntMediaEffectStatus").SCHEDULED];c=babelHelpers.inherits(a,b("FluxLoadObjectStore"));g=c&&c.prototype;function a(a){g.constructor.call(this,a),a.explicitlyRegisterStore(this)}a.prototype.reduce=function(a,c){__p&&__p();switch(c.action){case"media_effect_owner/add":return this.__handleOne(a,c.key,{ownerID:c.key,effects:c.effects});case"media_effect_owner/bootstrap":c.bootstrapData.forEach(function(c){a.set(c.ownerID,b("LoadObject").withValue(c))});break;case"media_effect_owner/error":return this.__handleOne(a,c.key,c.error);case"media_effect_owner/reload":this.__load(c.key);return a.remove(c.key);case"media_effect_owner/remove":return a.remove(c.key);case"media_effect_owner/update_add_effect":var d=a.get(c.key).getValue();if(d){d.effects.push(c.effect);return this.__handleOne(a,c.key,{ownerID:c.key,effects:d.effects})}break;case"media_effect_saved":d=c.effect.effectData.owner.id;var e=a.get(d).getValue();if(e){this.$MediaEffectOwnerStore1();return this.__handleOne(a,d,{ownerID:d,effects:b("MediaEffectStore").getState().keySeq().toArray()})}break;case"media_effect_owner/update_remove_effect":e=a.get(c.key).getValue();if(e&&e.effects.indexOf(c.effect)>=0){d=e.effects;d.splice(d.indexOf(c.effect),1);return this.__handleOne(a,c.key,{ownerID:c.key,effects:d})}break}return a};a.prototype.$MediaEffectOwnerStore1=function(){b("MediaEffectStoreSharedDispatcher").waitFor([b("MediaEffectStore").getDispatchToken()])};a.prototype.__load=function(a){var c=b("XMediaEffectAsyncFetchController").getURIBuilder().setFBIDSet("owner_ids",[a]).setEnumSet("statuses",h).getURI();new(b("AsyncRequest"))(c).setHandler(function(c){b("MediaEffectStoreSharedDispatcher").dispatch({action:"media_effect_owner/add",key:a,effects:c.payload.effects.map(function(a){return a.id})})}).setErrorHandler(function(c){b("MediaEffectStoreSharedDispatcher").dispatch({action:"media_effect_owner/error",key:a,error:c.getError()})}).send()};a.__moduleID=e.id;e.exports=new a(b("MediaEffectStoreSharedDispatcher"))}),null);
__d("MediaEffectStoresBootstrapper",["MediaEffectFrameEditorDispatcher","MediaEffectMetadataActionCreators","MediaEffectOwnerStore","MediaEffectReactFrameEditorCanvasDataStore","MediaEffectReactFrameEditorDataStore","MediaEffectStore","MediaEffectStoreSharedDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=[b("MediaEffectReactFrameEditorDataStore"),b("MediaEffectReactFrameEditorCanvasDataStore")],h=[b("MediaEffectStore"),b("MediaEffectOwnerStore")];a={isBootstrapped:!1,getEditorStores:function(){return g},getMediaEffectStores:function(){return h},bootstrap:function(){if(this.isBootstrapped)return;b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.getEditorStores());b("MediaEffectStoreSharedDispatcher").explicitlyRegisterStores(this.getMediaEffectStores());this.bootstrapFontData();this.isBootstrapped=!0},bootstrapWithData:function(a){if(this.isBootstrapped)return;b("MediaEffectFrameEditorDispatcher").explicitlyRegisterStores(this.getEditorStores());b("MediaEffectStoreSharedDispatcher").explicitlyRegisterStores(this.getMediaEffectStores());a.fontData?b("MediaEffectMetadataActionCreators").addFontData(a.fontData):this.bootstrapFontData();a.ownerData&&b("MediaEffectStoreSharedDispatcher").dispatch({action:"media_effect_owner/bootstrap",bootstrapData:a.ownerData});a.effectData&&b("MediaEffectStoreSharedDispatcher").dispatch({action:"media_effect/bootstrap",bootstrapData:a.effectData});this.isBootstrapped=!0},bootstrapFontData:function(){b("MediaEffectMetadataActionCreators").bootstrapFontData()}};e.exports=a}),null);
__d("MediaEffectOwnerHubContainer.react",["cx","AsyncRequest","AsyncResponse","CenteredContainer.react","FluxContainer","immutable","MediaEffectFlowType","MediaEffectGenerationType","MediaEffectHubEffectActionConfig","MediaEffectOwnerHubEffectCard.react","MediaEffectOwnerHubHeader.react","MediaEffectOwnerHubNullStateCard.react","MediaEffectOwnerStore","MediaEffectStore","MediaEffectStoresBootstrapper","MediaEffectStoreSharedDispatcher","React","XMediaEffectHubEffectActivationAsyncController","XUICard.react","XUISpinner.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j,k=b("immutable").Set;h=babelHelpers.inherits(l,b("React").PureComponent);h&&h.prototype;l.prototype.render=function(){return b("React").createElement(b("XUICard.react"),null,b("React").createElement(b("MediaEffectOwnerHubHeader.react"),{title:this.props.title}),b("React").createElement(b("XUICard.react"),null,b("React").createElement(b("CenteredContainer.react"),{className:"_60ll"},b("React").createElement(b("XUISpinner.react"),{size:"large"}))))};function l(){h.apply(this,arguments)}i=babelHelpers.inherits(m,b("React").PureComponent);i&&i.prototype;m.prototype.render=function(){return b("React").createElement(b("XUICard.react"),null,b("React").createElement(b("MediaEffectOwnerHubHeader.react"),{title:this.props.title}),b("React").createElement(b("XUICard.react"),null,b("React").createElement("div",{className:"_5-nb"},this.props.errorMessage)))};function m(){i.apply(this,arguments)}a=babelHelpers.inherits(n,b("React").PureComponent);j=a&&a.prototype;n.getStores=function(){return[b("MediaEffectStore"),b("MediaEffectOwnerStore")]};n.calculateState=function(a){__p&&__p();var c={isLoading:!0};if(!a)return c;var d=b("MediaEffectOwnerStore").get(a.ownerID);if(d.hasError()){var e=d.getError();e&&(c={errorMessage:e.message,isError:!0,isLoading:!1})}if(!d.hasValue())return c;e=a.defaultFlowType;d=d.getValueEnforcing().effects;if(d.length===0)c={effectData:null,effectIDs:[],flowType:e,isError:!1,isLoading:!1,selectedEffectIndex:-1};else{a=a.selectedEffectIndex<d.length&&a.selectedEffectIndex>=0?a.selectedEffectIndex:0;var f=b("MediaEffectStore").get(d[a]);if(f.hasError()){var g=f.getError();g&&(c={errorMessage:g.message,isError:!0,isLoading:!1})}else if(f.hasValue()){g=f.getValueEnforcing();e=g.effectData.flowType;c={effectData:g,effectIDs:d,flowType:e,isError:!1,isLoading:!1,selectedEffectIndex:a}}else c={isLoading:!0}}return c};function n(a){__p&&__p();j.constructor.call(this,a);this.effectUpdateHandler=function(a){var c=this.state.effectIDs.length>0&&this.state.selectedEffectIndex>=0?this.state.effectIDs[this.state.selectedEffectIndex]:"";a===c&&this.setState({isLoading:!0});b("MediaEffectStoreSharedDispatcher").dispatch({action:"media_effect/reload",key:a})}.bind(this);this.toggleEventHandler=function(a,c){c=b("XMediaEffectHubEffectActivationAsyncController").getURIBuilder().setBool("activate",c).setFBIDVector("effect_ids",[a]).getURI();new(b("AsyncRequest"))().setURI(c).setHandler(function(a){a=a.getPayload().effects;a.map(function(a){b("MediaEffectStoreSharedDispatcher").dispatch({action:"media_effect/update_effect",key:a.id,effectData:a})})}).setErrorHandler(function(a){b("AsyncResponse").defaultErrorHandler(a)}).send()};this.archiveEventHandler=function(a){b("MediaEffectHubEffectActionConfig").archive.onClick(k([a]),function(){this.setState({isLoading:!0}),b("MediaEffectStoreSharedDispatcher").dispatch({action:"media_effect_owner/update_remove_effect",key:this.state.ownerID,effect:a.id})}.bind(this))}.bind(this);a={defaultFlowType:a.flowType?a.flowType:b("MediaEffectFlowType").BASIC_HUB,effectData:null,effectIDs:[],errorMessage:"",flowType:a.flowType?a.flowType:b("MediaEffectFlowType").BASIC_HUB,isError:!1,isLoading:!0,ownerID:a.owner,selectedEffectIndex:-1};var c=n.calculateState(a);this.state=Object.assign({},a,c)}n.prototype.UNSAFE_componentWillMount=function(){b("MediaEffectStoresBootstrapper").bootstrap()};n.prototype.render=function(){__p&&__p();var a=this.props,c=a.title;a=a.optionalData;var d=this.state,e=d.effectData,f=d.effectIDs,g=d.errorMessage,h=d.flowType,i=d.isError,j=d.isLoading;d=d.ownerID;if(i)return b("React").createElement(m,{errorMessage:g,title:c});else if(j)return b("React").createElement(l,{title:c});else if(f.length>0&&e&&e.effectData.generationType===b("MediaEffectGenerationType").USER_GENERATED){i=e;return b("React").createElement(b("MediaEffectOwnerHubEffectCard.react"),{archiveEventHandler:this.archiveEventHandler,effect:i,effectID:i.effectData.id,effectUpdateHandler:this.effectUpdateHandler,flowType:h,key:"EffectCard"+i.effectData.id,title:c,toggleEventHandler:this.toggleEventHandler})}else return b("React").createElement(b("MediaEffectOwnerHubNullStateCard.react"),{effect:e,effectUpdateHandler:this.effectUpdateHandler,flowType:h,optionalData:a,owner:d,title:c,toggleEventHandler:this.toggleEventHandler})};e.exports=b("FluxContainer").create(n)}),null);
__d("MediaEffectOwnerHubWidgetInit",["MediaEffectOwnerHubContainer.react","MediaEffectStoresBootstrapper","React","ReactRenderer"],(function(a,b,c,d,e,f){"use strict";a={init:function(a){a.bootstrapData?b("MediaEffectStoresBootstrapper").bootstrapWithData(a.bootstrapData):b("MediaEffectStoresBootstrapper").bootstrap(),b("ReactRenderer").renderComponent(b("React").createElement(b("MediaEffectOwnerHubContainer.react"),a.ownerWidgetProps),a.root)}};e.exports=a}),null);
__d("XMediaEffectHubEditSettingsAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbcameraeffects/edit_settings/async/",{table_results_per_page:{type:"Int"},hub_actor:{type:"FBID"},view_all:{type:"Bool",defaultValue:!1},table_layout:{type:"String"},table_columns:{type:"StringVector"}})}),null);