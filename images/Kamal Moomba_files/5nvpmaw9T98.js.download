if (self.CavalryLogger) { CavalryLogger.start_js(["j9Vyc"]); }

__d("ComposerCitySharer",["Arbiter","ArbiterMixin","AsyncRequest","CSS","DOM","Event","Parent","mixin"],(function(a,b,c,d,e,f){__p&&__p();var g,h={};c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));g=c&&c.prototype;function a(a){"use strict";g.constructor.call(this),this.root=a}a.prototype.init=function(a,c,d,e,f){"use strict";this.cityLink=a,this.closeButton=c,this.input=d,this.disableShareInput=e,this._options=f,this.cityName=b("DOM").find(this.cityLink,".cityName"),this.data={},b("Event").listen(this.closeButton,"click",function(){this.clearCity(),this.disableShareInput.value="true"}.bind(this)),h[this.root]=this,this.inform("init",null,b("Arbiter").BEHAVIOR_PERSISTENT)};a.prototype.changeCity=function(a,b,c){"use strict";this.setCityId(a,b,c),this.toggleLocationSharing(a,b,c,!1)};a.prototype.setCityId=function(a,c,d){"use strict";__p&&__p();if(c){this.data={city_name:a,city_page_id:c,city_id:d};this.input.value=c;d=a.lastIndexOf(",");d!=-1&&(a=a.substring(0,d));c=a;b("DOM").setContent(this.cityName,c);b("CSS").addClass(this.root,"ComposerCitySharerCitySelected");b("CSS").conditionShow(this.closeButton,!this._placeSelected);this.inform("change",this.data,b("Arbiter").BEHAVIOR_PERSISTENT)}};a.prototype.toggleLocationSharing=function(a,c,d,e){"use strict";c&&new(b("AsyncRequest"))().setURI("/ajax/places/toggle_location_sharing").setData({city_id:d,city_page_id:c,city_name:a,is_default:e,session_id:this._options.session_id}).send()};a.prototype.setDefaultCity=function(a,b,c){"use strict";this._defaultCityData=[a,b,c]};a.prototype.useDefaultCity=function(){"use strict";if(this._defaultCityData){var a=this._defaultCityData[0],b=this._defaultCityData[1],c=this._defaultCityData[2];this.setCityId(a,b,c);this.toggleLocationSharing(a,b,c,!0)}};a.prototype.addPlace=function(a){"use strict";a.city_id?this.changeCity(a.city_name,a.city_page_id,a.city_id):this.clearCity(),this._placeSelected=!0,b("CSS").addClass(this.cityLink,"placeIconSelected"),b("CSS").hide(this.closeButton)};a.prototype.clearPlace=function(a){"use strict";this._placeSelected=!1,b("CSS").removeClass(this.cityLink,"placeIconSelected"),b("CSS").conditionShow(this.closeButton,this.getValue())};a.prototype.clearCity=function(){"use strict";this.data={},this.input.value="",b("DOM").setContent(this.cityName,""),b("CSS").removeClass(this.root,"ComposerCitySharerCitySelected"),b("CSS").hide(this.closeButton),this.inform("change",null,b("Arbiter").BEHAVIOR_PERSISTENT)};a.prototype.getIcon=function(){"use strict";return this.root};a.prototype.getValue=function(){"use strict";return this.input.value};a.getInstance=function(a){"use strict";a=b("Parent").byClass(a,"ComposerCitySharer");return a&&h[a]};e.exports=a}),null);
__d("ContextualBlind",["cx","Animation","Arbiter","DOM","Event","Rect","Vector","joinClasses","shield"],(function(a,b,c,d,e,f,g){__p&&__p();var h=0;c=1;var i=.8,j=500;function a(){"use strict";__p&&__p();this.updatePosition=function(a,c,d,e,f,g){__p&&__p();var h=b("Vector").getDocumentDimensions().y;a=b("Rect").getElementBounds(a);a=new(b("Rect"))(a.t-(c||0),a.r+(d||0),a.b+(e||0),a.l-(f||0),a.domain);c=document;d=c&&c.documentElement&&c.documentElement.scrollWidth||c&&c.body&&c.body.scrollWidth||0;this.$8(this.$2[0],new(b("Rect"))(g?g+window.scrollY:0,d,a.t,0,"document"));this.$8(this.$2[1],new(b("Rect"))(a.t,d,a.b,a.r,"document"));this.$8(this.$2[2],new(b("Rect"))(a.b,d,h,0,"document"));this.$8(this.$2[3],new(b("Rect"))(a.t,a.l,a.b,0,"document"));this.$4&&this.$8(this.$4,a)}.bind(this)}a.prototype.$7=function(){"use strict";this.$1&&b("Arbiter").unsubscribe(this.$1),this.$1=null,this.$2=[],this.$3&&this.$3.remove(),this.$3=null,this.$4&&b("DOM").remove(this.$4),this.$5=!1};a.prototype.show=function(a,c,d,e,f,g,j,k,l,m){"use strict";__p&&__p();if(this.$6)return;this.$6=!0;j==null&&(j=i);k=k||h;this.hide();m=b("joinClasses")((k===h?"_2xgb":"")+(k!==h?" _2xgc":""),m);for(var n=0;n<4;n++)this.$2.push(b("DOM").create("div",{className:m,style:"opacity:"+j}));b("DOM").appendContent(document.body,this.$2);g!==!1&&(m=k===h?"_2xgd":"_2xge",this.$4=b("DOM").create("div",{className:m}),b("DOM").appendContent(document.body,this.$4));n=b("shield")(this.updatePosition,this,a,c,d,e,f,l);n();this.$1=b("Arbiter").subscribe("reflow",n);this.$3=b("Event").listen(window,"resize",n);this.$5=!0;this.$6=!1};a.prototype.fadeIn=function(a,c,d,e,f,g,k,l,m,n,o){"use strict";l=l||j;k==null&&(k=i);this.show(a,c,d,e,f,g,0,m==null?h:m,n,o);for(var a=0;a<this.$2.length;a++){c=this.$2[a];new(b("Animation"))(c).duration(l).from("opacity",0).to("opacity",k).go()}};a.prototype.hide=function(){"use strict";this.$2&&this.$2.forEach(b("DOM").remove),this.$7()};a.prototype.fadeOut=function(a){var c=arguments.length<=1||arguments[1]===undefined?j:arguments[1];if(!this.$2)return;a==null&&(a=i);for(var d=0;d<this.$2.length;d++){var e=this.$2[d];new(b("Animation"))(e).duration(c).from("opacity",a).to("opacity",0).ondone(b("DOM").remove.bind(null,e)).go()}this.$7()};a.prototype.$8=function(a,b){"use strict";b.getPositionVector().setElementPosition(a),b.getDimensionVector().setElementDimensions(a)};a.STYLE_LIGHT=h;a.STYLE_DARK=c;e.exports=a}),null);
__d("ContextualBlindSingleton",["ContextualBlind"],(function(a,b,c,d,e,f){e.exports=new(b("ContextualBlind"))()}),null);
__d("TourAutoPilot",["ContextualBlindSingleton","DOMScroll","Tour"],(function(a,b,c,d,e,f){__p&&__p();var g,h;g=babelHelpers.inherits(a,b("Tour"));h=g&&g.prototype;a.prototype.registerStep=function(a,b){"use strict";a.subscribe("tour-dialog-show",this.handleShowDialog.bind(this,a,b)),h.registerStep.call(this,a,b)};a.prototype.handleLeavePage=function(){"use strict";this.openDialog&&this.openDialog.destroy(),this.hideContextualBlind(),h.handleLeavePage.call(this)};a.prototype.handleShowDialog=function(a,c){"use strict";c=a.getContext();this.showContextualBlind(c,!0);b("DOMScroll").scrollTo(c,!0,!0,0)};a.prototype.handleTourStop=function(){"use strict";this.hideContextualBlind(!0),h.handleTourStop.call(this)};a.prototype.showContextualBlind=function(a,c){"use strict";this.blindShowing?b("ContextualBlindSingleton").show(a,0,0,0,0,c,this.opacity):b("ContextualBlindSingleton").fadeIn(a,0,0,0,0,c,this.opacity),this.blindShowing=!0};a.prototype.hideContextualBlind=function(a){"use strict";a?b("ContextualBlindSingleton").fadeOut():b("ContextualBlindSingleton").hide(),this.blindShowing=!1};function a(){"use strict";g.apply(this,arguments)}Object.assign(a.prototype,{blindShowing:!1,opacity:null});f.TourAutoPilot=a}),null);
__d("ComposerTour",["Arbiter","AsyncRequest","ComposerCitySharer","CSS","DOM","Parent","Tour","TourAutoPilot","URI","$"],(function(a,b,c,d,e,f){__p&&__p();var g,h;a=b("TourAutoPilot").TourAutoPilot;g=babelHelpers.inherits(i,a);h=g&&g.prototype;i.prototype.handleShowDialog=function(a,c){"use strict";var d=b("Parent").byClass(b("$")("composerTourStart"),"uiComposer");c!="start"&&(h.handleShowDialog.call(this,a,c),this.showContextualBlind(d))};i.prototype.showContextualBlind=function(a){"use strict";b("CSS").addClass(document.body,"composerTourInProgress"),h.showContextualBlind.call(this,a)};i.prototype.hideContextualBlind=function(a){"use strict";h.hideContextualBlind.call(this,a),b("CSS").removeClass(document.body,"composerTourInProgress")};i.openComposer=function(){"use strict";var a=b("Parent").byClass(b("$")("composerTourStart"),"uiComposerAttachment"),c=b("Parent").byTag(a,"form");c.action=a.getAttribute("data-endpoint");c.xhpc.value=a.id;c.xhpc.click()};i.closeOnComposerReset=function(){"use strict";b("Arbiter").subscribe("composer/reset",function(){b("Tour").getInstance().setTourStop()})};i.sendLocationOption=function(a,c){"use strict";c=new(b("URI"))(c).addQueryData({use_location:a});new(b("AsyncRequest"))(c.toString()).send()};i.addCity=function(){"use strict";var a=b("Parent").byClass(b("$")("composerTourLocation"),"uiComposer");a=b("ComposerCitySharer").getInstance(b("DOM").scry(a,"span.ComposerCitySharer")[0]);a&&a.useDefaultCity()};i.clearCity=function(){"use strict";var a=b("Parent").byClass(b("$")("composerTourLocation"),"uiComposer");a=b("ComposerCitySharer").getInstance(b("DOM").scry(a,"span.ComposerCitySharer")[0]);a&&a.clearCity()};i.hideStartDialog=function(){"use strict";var a=b("Tour").getInstance().steps.start;a&&a.hide()};i.enableAutoPilot=function(){"use strict";new i().init()};function i(){"use strict";g.apply(this,arguments)}e.exports=i}),null);
__d("ContextualLayerBlind",["cx","ContextualBlind","CSS"],(function(a,b,c,d,e,f,g){__p&&__p();var h={isModal:!1,opacity:.3,paddingTop:8,paddingRight:8,paddingBottom:8,paddingLeft:8,style:b("ContextualBlind").STYLE_DARK,fadeDuration:0,marginTop:0,className:null},i=250;function j(a,b){"use strict";b=babelHelpers["extends"]({},h,b),this.$4=b.isModal,this.$2=a,this.$5=b.opacity,this.$6=b.paddingTop,this.$7=b.paddingRight,this.$8=b.paddingBottom,this.$9=b.paddingLeft,this.$10=b.style,this.$11=b.fadeDuration,this.$12=b.marginTop,this.$13=b.className}j.prototype.enable=function(){"use strict";this.$3=[this.$2.subscribe(["show","reposition"],this.$14.bind(this)),this.$2.subscribe("hide",this.$15.bind(this))],b("CSS").addClass(this.$2.getRoot(),"_4746"),this.$1=new(b("ContextualBlind"))()};j.prototype.disable=function(){"use strict";this.$15();b("CSS").removeClass(this.$2.getRoot(),"_4746");while(this.$3.length)this.$3.pop().unsubscribe();this.$3=null;this.$1=null};j.prototype.$14=function(){"use strict";if(this.$2.isShown()){var a=this.$2.getContext();this.$11>0?this.$1.fadeIn(a,this.$6,this.$7,this.$8,this.$9,this.$4,this.$5,this.$11,this.$10,this.$12,this.$13):this.$1.show(a,this.$6,this.$7,this.$8,this.$9,this.$4,this.$5,this.$10,this.$12,this.$13)}};j.prototype.$15=function(){"use strict";this.$11>0?this.$1.fadeOut(this.$5,this.$11):this.$1.hide()};j.withFade=function(){var a=arguments.length<=0||arguments[0]===undefined?i:arguments[0],b=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];return function(){var c,d;c=babelHelpers.inherits(e,j);d=c&&c.prototype;function e(c,e){"use strict";d.constructor.call(this,c,babelHelpers["extends"]({},e,{fadeDuration:a},b))}return e}()};e.exports=j}),null);